<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Adapters</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css">
  </head>
  <body>
    <section id="adapters" class="level1">
      <h1>Adapters</h1>
      <p>Before you can deploy your SvelteKit app, you need to <em>adapt</em> it for your deployment target. Adapters are small plugins that take the built app as input and generate output for deployment.</p>
      <p>By default, projects are configured to use <code>@sveltejs/adapter-auto</code>, which detects your production environment and selects the appropriate adapter where possible. If your platform isn't (yet) supported, you may need to <a href="../20-core-concepts/50-adapters.html#community-adapters">install a custom adapter</a> or <a href="../20-core-concepts/50-adapters.html#writing-custom-adapters">write one</a>.</p>
      <blockquote>
        <p>See the <a href="https://github.com/sveltejs/kit/tree/master/packages/adapter-auto">adapter-auto README</a> for information on adding support for new environments.</p>
      </blockquote>
      <section id="supported-environments" class="level2">
        <h2>Supported environments</h2>
        <p>SvelteKit offers a number of officially supported adapters.</p>
        <p>You can deploy to the following platforms with the default adapter, <code>adapter-auto</code>:</p>
        <ul>
          <li><a href="https://developers.cloudflare.com/pages/">Cloudflare Pages</a> via <a href="https://github.com/sveltejs/kit/tree/master/packages/adapter-cloudflare"><code>adapter-cloudflare</code></a></li>
          <li><a href="https://netlify.com">Netlify</a> via <a href="https://github.com/sveltejs/kit/tree/master/packages/adapter-netlify"><code>adapter-netlify</code></a></li>
          <li><a href="https://vercel.com">Vercel</a> via <a href="https://github.com/sveltejs/kit/tree/master/packages/adapter-vercel"><code>adapter-vercel</code></a></li>
        </ul>
        <section id="nodejs" class="level3">
          <h3>Node.js</h3>
          <p>To create a simple Node server, install the <a href="https://github.com/sveltejs/kit/tree/master/packages/adapter-node"><code>@sveltejs/adapter-node</code></a> package and update your <code>svelte.config.js</code>:</p>
          <pre class="language-diff"><code class="language-diff">/// file: svelte.config.js
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import adapter from '@sveltejs/adapter-auto';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import adapter from '@sveltejs/adapter-node';</span></span></code></pre>
          <p>With this, <code>vite build</code> will generate a self-contained Node app inside the <code>build</code> directory. You can pass options to adapters, such as customising the output directory:</p>
          <pre class="language-diff"><code class="language-diff">/// file: svelte.config.js
import adapter from '@sveltejs/adapter-node';

export default {
	kit: {
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">		adapter: adapter()
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">		adapter: adapter({ out: 'my-output-directory' })
</span></span>	}
};</code></pre>
        </section>
        <section id="static-sites" class="level3">
          <h3>Static sites</h3>
          <p>Most adapters will generate static HTML for any <a href="../20-core-concepts/40-page-options.html#prerender">prerenderable</a> pages of your site. In some cases, your entire app might be prerenderable, in which case you can use <a href="https://github.com/sveltejs/kit/tree/master/packages/adapter-static"><code>@sveltejs/adapter-static</code></a> to generate static HTML for <em>all</em> your pages. A fully static site can be hosted on a wide variety of platforms, including static hosts like <a href="https://pages.github.com/">GitHub Pages</a>.</p>
          <pre class="language-diff"><code class="language-diff">/// file: svelte.config.js
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import adapter from '@sveltejs/adapter-auto';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import adapter from '@sveltejs/adapter-static';</span></span></code></pre>
          <p>You can also use <code>adapter-static</code> to generate single-page apps (SPAs) by specifying a <a href="https://github.com/sveltejs/kit/tree/master/packages/adapter-static#spa-mode">fallback page and disabling SSR</a>.</p>
          <blockquote>
            <p>You must ensure <a href="../20-core-concepts/40-page-options.html#trailingslash"><code>trailingSlash</code></a> is set appropriately for your environment. If your host does not render <code>/a.html</code> upon receiving a request for <code>/a</code> then you will need to set <code>trailingSlash: 'always'</code> to create <code>/a/index.html</code> instead.</p>
          </blockquote>
        </section>
        <section id="platform-specific-context" class="level3">
          <h3>Platform-specific context</h3>
          <p>Some adapters may have access to additional information about the request. For example, Cloudflare Workers can access an <code>env</code> object containing KV namespaces etc. This can be passed to the <code>RequestEvent</code> used in <a href="../30-advanced/20-hooks.html">hooks</a> and <a href="../20-core-concepts/10-routing.html#server">server routes</a> as the <code>platform</code> property â€” consult each adapter's documentation to learn more.</p>
        </section>
      </section>
      <section id="community-adapters" class="level2">
        <h2>Community adapters</h2>
        <p>Additional <a href="https://sveltesociety.dev/components#adapters">community-provided adapters</a> exist for other platforms. After installing the relevant adapter with your package manager, update your <code>svelte.config.js</code>:</p>
        <pre class="language-diff"><code class="language-diff">/// file: svelte.config.js
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import adapter from '@sveltejs/adapter-auto';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import adapter from 'svelte-adapter-[x]';</span></span></code></pre>
      </section>
      <section id="writing-custom-adapters" class="level2">
        <h2>Writing custom adapters</h2>
        <p>We recommend <a href="https://github.com/sveltejs/kit/tree/master/packages">looking at the source for an adapter</a> to a platform similar to yours and copying it as a starting point.</p>
        <p>Adapters packages must implement the following API, which creates an <code>Adapter</code>:</p>
        <pre class="language-js"><code class="language-js"><span class="token comment">// @filename: ambient.d.ts</span>
type <span class="token maybe-class-name">AdapterSpecificOptions</span> <span class="token operator">=</span> any<span class="token punctuation">;</span>

<span class="token comment">// @filename: index.js</span>
<span class="token comment">// cut---</span>
<span class="token doc-comment comment">/** <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>AdapterSpecificOptions<span class="token punctuation">}</span></span> <span class="token parameter">options</span> */</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'@sveltejs/kit'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Adapter<span class="token punctuation">}</span></span> */</span>
	<span class="token keyword">const</span> adapter <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'adapter-package-name'</span><span class="token punctuation">,</span>
		<span class="token keyword">async</span> <span class="token function">adapt</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// adapter implementation</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword control-flow">return</span> adapter<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        <p>The types for <code>Adapter</code> and its parameters are available in <a href="https://github.com/sveltejs/kit/blob/master/packages/kit/types/index.d.ts">types/index.d.ts</a>.</p>
        <p>Within the <code>adapt</code> method, there are a number of things that an adapter should do:</p>
        <ul>
          <li>Clear out the build directory</li>
          <li>Write SvelteKit output with <code>builder.writeClient</code>, <code>builder.writeServer</code>, and <code>builder.writePrerendered</code></li>
          <li>Output code that:
            <ul>
              <li>Imports <code>Server</code> from <code>${builder.getServerDirectory()}/index.js</code></li>
              <li>Instantiates the app with a manifest generated with <code>builder.generateManifest({ relativePath })</code></li>
              <li>Listens for requests from the platform, converts them to a standard <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request">Request</a> if necessary, calls the <code>server.respond(request, { getClientAddress })</code> function to generate a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response">Response</a> and responds with it</li>
              <li>expose any platform-specific information to SvelteKit via the <code>platform</code> option passed to <code>server.respond</code></li>
              <li>Globally shims <code>fetch</code> to work on the target platform, if necessary. SvelteKit provides a <code>@sveltejs/kit/install-fetch</code> helper for platforms that can use <code>node-fetch</code></li>
            </ul>
          </li>
          <li>Bundle the output to avoid needing to install dependencies on the target platform, if necessary</li>
          <li>Put the user's static files and the generated JS/CSS in the correct location for the target platform</li>
        </ul>
        <p>Where possible, we recommend putting the adapter output under the <code>build/</code> directory with any intermediate output placed under <code>.svelte-kit/[adapter-name]</code>.</p>
        <blockquote>
          <p>
            The adapter API may change before 1.0.
            <span style="float: footnote;"><a href="../../index.html#toc">Go to TOC</a></span>
          </p>
        </blockquote>
      </section>
    </section>
  </body>
</html>
