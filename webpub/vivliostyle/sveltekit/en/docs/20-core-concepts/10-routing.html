<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Routing</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css">
  </head>
  <body>
    <section id="routing" class="level1">
      <h1>Routing</h1>
      <p>At the heart of SvelteKit is a <em>filesystem-based router</em>. The routes of your app — i.e. the URL paths that users can access — are defined by the directories in your codebase:</p>
      <ul>
        <li><code>src/routes</code> is the root route</li>
        <li><code>src/routes/about</code> creates an <code>/about</code> route</li>
        <li><code>src/routes/blog/[slug]</code> creates a route with a <em>parameter</em>, <code>slug</code>, that can be used to load data dynamically when a user requests a page like <code>/blog/hello-world</code></li>
      </ul>
      <blockquote>
        <p>You can change <code>src/routes</code> to a different directory by editing the <a href="../50-api-reference/10-configuration.html">project config</a>.</p>
      </blockquote>
      <p>Each route directory contains one or more <em>route files</em>, which can be identified by their <code>+</code> prefix.</p>
      <section id="page" class="level2">
        <h2>+page</h2>
        <section id="pagesvelte" class="level3">
          <h3>+page.svelte</h3>
          <p>A <code>+page.svelte</code> component defines a page of your app. By default, pages are rendered both on the server (<a href="../60-appendix/30-glossary.html#ssr">SSR</a>) for the initial request and in the browser (<a href="../60-appendix/30-glossary.html#csr-and-spa">CSR</a>) for subsequent navigation.</p>
          <pre class="language-svelte"><code class="language-svelte">/// file: src/routes/+page.svelte
&#x3C;h1>Hello and welcome to my site!&#x3C;/h1>
&#x3C;a href="/about">About my site&#x3C;/a></code></pre>
          <pre class="language-svelte"><code class="language-svelte">/// file: src/routes/about/+page.svelte
&#x3C;h1>About this site&#x3C;/h1>
&#x3C;p>TODO...&#x3C;/p>
&#x3C;a href="/">Home&#x3C;/a></code></pre>
          <pre class="language-svelte"><code class="language-svelte">/// file: src/routes/blog/[slug]/+page.svelte
&#x3C;script>
	/** @type {import('./$types').PageData} */
	export let data;
&#x3C;/script>

&#x3C;h1>{data.title}&#x3C;/h1>
&#x3C;div>{@html data.content}&#x3C;/div></code></pre>
          <blockquote>
            <p>Note that SvelteKit uses <code>&#x3C;a></code> elements to navigate between routes, rather than a framework-specific <code>&#x3C;Link></code> component.</p>
          </blockquote>
        </section>
        <section id="pagejs" class="level3">
          <h3>+page.js</h3>
          <p>Often, a page will need to load some data before it can be rendered. For this, we add a <code>+page.js</code> (or <code>+page.ts</code>, if you're TypeScript-inclined) module that exports a <code>load</code> function:</p>
          <pre class="language-js"><code class="language-js"><span class="token comment">/// file: src/routes/blog/[slug]/+page.js</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> error <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@sveltejs/kit'</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'./$types'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>PageLoad<span class="token punctuation">}</span></span> */</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token property-access">slug</span> <span class="token operator">===</span> <span class="token string">'hello-world'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
			# <span class="token string">'Hello world!'</span><span class="token punctuation">,</span>
			<span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'Welcome to our blog. Lorem ipsum dolor sit amet...'</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword control-flow">throw</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> <span class="token string">'Not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
          <p>This function runs alongside <code>+page.svelte</code>, which means it runs on the server during server-side rendering and in the browser during client-side navigation. See <a href="../20-core-concepts/20-load.html"><code>load</code></a> for full details of the API.</p>
          <p>As well as <code>load</code>, <code>+page.js</code> can export values that configure the page's behaviour:</p>
          <ul>
            <li><code>export const prerender = true</code> or <code>false</code> or <code>'auto'</code></li>
            <li><code>export const ssr = true</code> or <code>false</code></li>
            <li><code>export const csr = true</code> or <code>false</code></li>
          </ul>
          <p>You can find more information about these in <a href="../20-core-concepts/40-page-options.html">page options</a>.</p>
        </section>
        <section id="pageserverjs" class="level3">
          <h3>+page.server.js</h3>
          <p>If your <code>load</code> function can only run on the server — for example, if it needs to fetch data from a database or you need to access private <a href="../50-api-reference/30-modules.html#$env-static-private">environment variables</a> like API keys — then you can rename <code>+page.js</code> to <code>+page.server.js</code> and change the <code>PageLoad</code> type to <code>PageServerLoad</code>.</p>
          <pre class="language-js"><code class="language-js"><span class="token comment">/// file: src/routes/blog/[slug]/+page.server.js</span>

<span class="token comment">// @filename: ambient.d.ts</span>
declare global <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token function-variable function">getPostFromDatabase</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">slug</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
		# string<span class="token punctuation">;</span>
		<span class="token literal-property property">content</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token exports"><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">;</span>

<span class="token comment">// @filename: index.js</span>
<span class="token comment">// cut---</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> error <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@sveltejs/kit'</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'./$types'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>PageServerLoad<span class="token punctuation">}</span></span> */</span>
<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">getPostFromDatabase</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token property-access">slug</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>post<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword control-flow">return</span> post<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword control-flow">throw</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> <span class="token string">'Not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
          <p>During client-side navigation, SvelteKit will load this data from the server, which means that the returned value must be serializable using <a href="https://github.com/rich-harris/devalue">devalue</a>. See <a href="../20-core-concepts/20-load.html"><code>load</code></a> for full details of the API.</p>
          <p>Like <code>+page.js</code>, <code>+page.server.js</code> can export <a href="../20-core-concepts/40-page-options.html">page options</a> — <code>prerender</code>, <code>ssr</code> and <code>csr</code>.</p>
          <p>A <code>+page.server.js</code> file can also export <em>actions</em>. If <code>load</code> lets you read data from the server, <code>actions</code> let you write data <em>to</em> the server using the <code>&#x3C;form></code> element. To learn how to use them, see the <a href="../20-core-concepts/30-form-actions.html">form actions</a> section.</p>
        </section>
      </section>
      <section id="error" class="level2">
        <h2>+error</h2>
        <p>If an error occurs during <code>load</code>, SvelteKit will render a default error page. You can customise this error page on a per-route basis by adding an <code>+error.svelte</code> file:</p>
        <pre class="language-svelte"><code class="language-svelte">/// file: src/routes/blog/[slug]/+error.svelte
&#x3C;script>
	import { page } from '$app/stores';
&#x3C;/script>

&#x3C;h1>{$page.status}: {$page.error.message}&#x3C;/h1></code></pre>
        <p>SvelteKit will 'walk up the tree' looking for the closest error boundary — if the file above didn't exist it would try <code>src/routes/blog/+error.svelte</code> and <code>src/routes/+error.svelte</code> before rendering the default error page. If <em>that</em> fails (or if the error was thrown from the <code>load</code> function of the root <code>+layout</code>, which sits 'above' the root <code>+error</code>), SvelteKit will bail out and render a static fallback error page, which you can customise by creating a <code>src/error.html</code> file.</p>
        <blockquote>
          <p><code>+error.svelte</code> is <em>not</em> used when an error occurs inside <a href="../30-advanced/20-hooks.html#server-hooks-handle"><code>handle</code></a> or a <a href="#server">+server.js</a> request handler.</p>
        </blockquote>
        <p>You can read more about error handling <a href="/docs/errors">here</a>.</p>
      </section>
      <section id="layout" class="level2">
        <h2>+layout</h2>
        <p>So far, we've treated pages as entirely standalone components — upon navigation, the existing <code>+page.svelte</code> component will be destroyed, and a new one will take its place.</p>
        <p>But in many apps, there are elements that should be visible on <em>every</em> page, such as top-level navigation or a footer. Instead of repeating them in every <code>+page.svelte</code>, we can put them in <em>layouts</em>.</p>
        <section id="layoutsvelte" class="level3">
          <h3>+layout.svelte</h3>
          <p>To create a layout that applies to every page, make a file called <code>src/routes/+layout.svelte</code>. The default layout (the one that SvelteKit uses if you don't bring your own) looks like this...</p>
          <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>slot</span><span class="token punctuation">></span></span></code></pre>
          <p>...but we can add whatever markup, styles and behaviour we want. The only requirement is that the component includes a <code>&#x3C;slot></code> for the page content. For example, let's add a nav bar:</p>
          <pre class="language-html"><code class="language-html">/// file: src/routes/+layout.svelte
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>nav</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/about<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>About<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/settings<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Settings<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>nav</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>slot</span><span class="token punctuation">></span></span></code></pre>
          <p>If we create pages for <code>/</code>, <code>/about</code> and <code>/settings</code>...</p>
          <pre class="language-html"><code class="language-html">/// file: src/routes/+page.svelte
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span></code></pre>
          <pre class="language-html"><code class="language-html">/// file: src/routes/about/+page.svelte
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>About<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span></code></pre>
          <pre class="language-html"><code class="language-html">/// file: src/routes/settings/+page.svelte
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Settings<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span></code></pre>
          <p>...the nav will always be visible, and clicking between the three pages will only result in the <code>&#x3C;h1></code> being replaced.</p>
          <p>Layouts can be <em>nested</em>. Suppose we don't just have a single <code>/settings</code> page, but instead have nested pages like <code>/settings/profile</code> and <code>/settings/notifications</code> with a shared submenu (for a real-life example, see <a href="https://github.com/settings">github.com/settings</a>).</p>
          <p>We can create a layout that only applies to pages below <code>/settings</code> (while inheriting the root layout with the top-level nav):</p>
          <pre class="language-svelte"><code class="language-svelte">/// file: src/routes/settings/+layout.svelte
&#x3C;script>
	/** @type {import('./$types').LayoutData} */
	export let data;
&#x3C;/script>

&#x3C;h1>Settings&#x3C;/h1>

&#x3C;div class="submenu">
	{#each data.sections as section}
		&#x3C;a href="/settings/{section.slug}">{section.title}&#x3C;/a>
	{/each}
&#x3C;/div>

&#x3C;slot>&#x3C;/slot></code></pre>
          <p>By default, each layout inherits the next layout above it. Sometimes that isn't what you want - in this case, <a href="../30-advanced/10-advanced-routing.html-routing#advanced-layouts">advanced layouts</a> can help you.</p>
        </section>
        <section id="layoutjs" class="level3">
          <h3>+layout.js</h3>
          <p>Just like <code>+page.svelte</code> loading data from <code>+page.js</code>, your <code>+layout.svelte</code> component can get data from a <a href="../20-core-concepts/20-load.html"><code>load</code></a> function in <code>+layout.js</code>.</p>
          <pre class="language-js"><code class="language-js"><span class="token comment">/// file: src/routes/settings/+layout.js</span>
<span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'./$types'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>LayoutLoad<span class="token punctuation">}</span></span> */</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">sections</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token punctuation">{</span> <span class="token literal-property property">slug</span><span class="token operator">:</span> <span class="token string">'profile'</span><span class="token punctuation">,</span> # <span class="token string">'Profile'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">{</span> <span class="token literal-property property">slug</span><span class="token operator">:</span> <span class="token string">'notifications'</span><span class="token punctuation">,</span> # <span class="token string">'Notifications'</span> <span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
          <p>If a <code>+layout.js</code> exports <a href="../20-core-concepts/40-page-options.html">page options</a> — <code>prerender</code>, <code>ssr</code> and <code>csr</code> — they will be used as defaults for child pages.</p>
          <p>Data returned from a layout's <code>load</code> function is also available to all its child pages:</p>
          <pre class="language-svelte"><code class="language-svelte">/// file: src/routes/settings/profile/+page.svelte
&#x3C;script>
	/** @type {import('./$types').PageData} */
	export let data;

	console.log(data.sections); // [{ slug: 'profile', # 'Profile' }, ...]
&#x3C;/script></code></pre>
          <blockquote>
            <p>Often, layout data is unchanged when navigating between pages. SvelteKit will intelligently re-run <a href="../20-core-concepts/20-load.html"><code>load</code></a> functions when necessary.</p>
          </blockquote>
        </section>
        <section id="layoutserverjs" class="level3">
          <h3>+layout.server.js</h3>
          <p>To run your layout's <code>load</code> function on the server, move it to <code>+layout.server.js</code>, and change the <code>LayoutLoad</code> type to <code>LayoutServerLoad</code>.</p>
          <p>Like <code>+layout.js</code>, <code>+layout.server.js</code> can export <a href="../20-core-concepts/40-page-options.html">page options</a> — <code>prerender</code>, <code>ssr</code> and <code>csr</code>.</p>
        </section>
      </section>
      <section id="server" class="level2">
        <h2>+server</h2>
        <p>As well as pages, you can define routes with a <code>+server.js</code> file (sometimes referred to as an 'API route' or an 'endpoint'), which gives you full control over the response. Your <code>+server.js</code> file (or <code>+server.ts</code>) exports functions corresponding to HTTP verbs like <code>GET</code>, <code>POST</code>, <code>PATCH</code>, <code>PUT</code> and <code>DELETE</code> that take a <code>RequestEvent</code> argument and return a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> object.</p>
        <p>For example we could create an <code>/api/random-number</code> route with a <code>GET</code> handler:</p>
        <pre class="language-js"><code class="language-js"><span class="token comment">/// file: src/routes/api/random-number/+server.js</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> error <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@sveltejs/kit'</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'./$types'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>RequestHandler<span class="token punctuation">}</span></span> */</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token constant">GET</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> url <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> min <span class="token operator">=</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token property-access">searchParams</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'min'</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> max <span class="token operator">=</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token property-access">searchParams</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'max'</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">const</span> d <span class="token operator">=</span> max <span class="token operator">-</span> min<span class="token punctuation">;</span>

	<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">||</span> d <span class="token operator">&#x3C;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword control-flow">throw</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token string">'min and max must be numbers, and min must be less than max'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">const</span> random <span class="token operator">=</span> min <span class="token operator">+</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> d<span class="token punctuation">;</span>

	<span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token known-class-name class-name">String</span><span class="token punctuation">(</span>random<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
        <p>The first argument to <code>Response</code> can be a <a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream"><code>ReadableStream</code></a>, making it possible to stream large amounts of data or create server-sent events (unless deploying to platforms that buffer responses, like AWS Lambda).</p>
        <p>You can use the <a href="../50-api-reference/30-modules.html#sveltejs-kit-error"><code>error</code></a>, <a href="../50-api-reference/30-modules.html#sveltejs-kit-redirect"><code>redirect</code></a> and <a href="../50-api-reference/30-modules.html#sveltejs-kit-json"><code>json</code></a> methods from <code>@sveltejs/kit</code> for convenience (but you don't have to).</p>
        <p>If an error is thrown (either <code>throw error(...)</code> or an unexpected error), the response will be a JSON representation of the error or a fallback error page — which can be customised via <code>src/error.html</code> — depending on the <code>Accept</code> header. The <a href="#error"><code>+error.svelte</code></a> component will <em>not</em> be rendered in this case. You can read more about error handling <a href="/docs/errors">here</a>.</p>
        <section id="receiving-data" class="level3">
          <h3>Receiving data</h3>
          <p>By exporting <code>POST</code>/<code>PUT</code>/<code>PATCH</code>/<code>DELETE</code> handlers, <code>+server.js</code> files can be used to create a complete API:</p>
          <pre class="language-svelte"><code class="language-svelte">/// file: src/routes/add/+page.svelte
&#x3C;script>
	let a = 0;
	let b = 0;
	let total = 0;

	async function add() {
		const response = await fetch('/api/add', {
			method: 'POST',
			body: JSON.stringify({ a, b }),
			headers: {
				'content-type': 'application/json'
			}
		});

		total = await response.json();
	}
&#x3C;/script>

&#x3C;input type="number" bind:value={a}> +
&#x3C;input type="number" bind:value={b}> =
{total}

&#x3C;button on:click={add}>Calculate&#x3C;/button></code></pre>
          <pre class="language-js"><code class="language-js"><span class="token comment">/// file: src/routes/api/add/+server.js</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> json <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@sveltejs/kit'</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'./$types'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>RequestHandler<span class="token punctuation">}</span></span> */</span>
<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">POST</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> request <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword control-flow">await</span> request<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword control-flow">return</span> <span class="token function">json</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
          <blockquote>
            <p>In general, <a href="../20-core-concepts/30-form-actions.html">form actions</a> are a better way to submit data from the browser to the server.</p>
          </blockquote>
        </section>
        <section id="content-negotiation" class="level3">
          <h3>Content negotiation</h3>
          <p><code>+server.js</code> files can be placed in the same directory as <code>+page</code> files, allowing the same route to be either a page or an API endpoint. To determine which, SvelteKit applies the following rules:</p>
          <ul>
            <li><code>PUT</code>/<code>PATCH</code>/<code>DELETE</code> requests are always handled by <code>+server.js</code> since they do not apply to pages</li>
            <li><code>GET</code>/<code>POST</code> requests are treated as page requests if the <code>accept</code> header prioritises <code>text/html</code> (in other words, it's a browser page request), else they are handled by <code>+server.js</code></li>
          </ul>
        </section>
      </section>
      <section id="types" class="level2">
        <h2>$types</h2>
        <p>Throughout the examples above, we've been importing types from a <code>$types.d.ts</code> file. This is a file SvelteKit creates for you in a hidden directory if you're using TypeScript (or JavaScript with JSDoc type annotations) to give you type safety when working with your root files.</p>
        <p>For example, annotating <code>export let data</code> with <code>PageData</code> (or <code>LayoutData</code>, for a <code>+layout.svelte</code> file) tells TypeScript that the type of <code>data</code> is whatever was returned from <code>load</code>:</p>
        <pre class="language-svelte"><code class="language-svelte">/// file: src/routes/blog/[slug]/+page.svelte
&#x3C;script>
	/** @type {import('./$types').PageData} */
	export let data;
&#x3C;/script></code></pre>
        <p>In turn, annotating the <code>load</code> function with <code>PageLoad</code>, <code>PageServerLoad</code>, <code>LayoutLoad</code> or <code>LayoutServerLoad</code> (for <code>+page.js</code>, <code>+page.server.js</code>, <code>+layout.js</code> and <code>+layout.server.js</code> respectively) ensures that <code>params</code> and the return value are correctly typed.</p>
      </section>
      <section id="other-files" class="level2">
        <h2>Other files</h2>
        <p>Any other files inside a route directory are ignored by SvelteKit. This means you can colocate components and utility modules with the routes that need them.</p>
        <p>
          If components and modules are needed by multiple routes, it's a good idea to put them in <a href="../50-api-reference/30-modules.html#$lib"><code>$lib</code></a>.
          <span style="float: footnote;"><a href="../../index.html#toc">Go to TOC</a></span>
        </p>
      </section>
    </section>
  </body>
</html>
