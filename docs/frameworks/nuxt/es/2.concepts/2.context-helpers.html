<!doctypehtml><html lang="es"><meta charset="utf-8"><title>Context and Helpers</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="description"content="The context provides additional and often optional information about the current request to the application."><meta name="category"content="concepts"><meta name="csb_link_context"content="https://codesandbox.io/embed/github/nuxt-academy/guides-examples/tree/master/02_concepts/02_context_helpers-context?fontsize=14&#x26;hidenavigation=1&#x26;theme=dark"><meta name="csb_link_helpers"content="https://codesandbox.io/embed/github/nuxt-academy/guides-examples/tree/master/02_concepts/02_context_helpers-helpers?fontsize=14&#x26;hidenavigation=1&#x26;theme=dark"><link rel="stylesheet"href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css"><section id="context-and-helpers"class="level1"><h1>Context and helpers</h1><p>The context provides <em>additional</em> and often optional information about the current request to the application.<hr><p><img src="../docs/context.svg"><p>The <code>context</code> object is available in specific Nuxt functions like <a href="./features/data-fetching#async-data">asyncData</a>, <a href="./directory-structure/plugins">plugins</a>, <a href="./directory-structure/middleware">middleware</a> and <a href="./directory-structure/store#the-nuxtserverinit-action">nuxtServerInit</a>. It provides <em>additional</em> and often optional information about the current request to the application.<p>First and foremost, the context is used to provide access to other parts of the Nuxt application, e.g. the Vuex store or the underlying <code>connect</code> instance. Thus, we have the <code>req</code> and <code>res</code> objects in the context available on the server side and <code>store</code> always available. But with time, the context was extended with many other helpful variables and shortcuts. Now we have access to HMR (Hot Module Reload / Replacement) functionalities in <code>development</code> mode, the current <code>route</code>, page <code>params</code> and <code>query</code>, as well as the option to access environment variables through the context. Furthermore, module functions and helpers can be exposed through the context to be available on both - the client and the server side.<p><strong>All context keys that are present by default</strong><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Could be asyncData, nuxtServerInit, ...</span>
  <span class="token comment">// Always available</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">,</span>
    store<span class="token punctuation">,</span>
    route<span class="token punctuation">,</span>
    params<span class="token punctuation">,</span>
    query<span class="token punctuation">,</span>
    env<span class="token punctuation">,</span>
    isDev<span class="token punctuation">,</span>
    isHMR<span class="token punctuation">,</span>
    redirect<span class="token punctuation">,</span>
    error<span class="token punctuation">,</span>
    $config
  <span class="token punctuation">}</span> <span class="token operator">=</span> context

  <span class="token comment">// Only available on the Server-side</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">server</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> beforeNuxtRender <span class="token punctuation">}</span> <span class="token operator">=</span> context
  <span class="token punctuation">}</span>

  <span class="token comment">// Only available on the Client-side</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">client</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword module">from</span><span class="token punctuation">,</span> nuxtState <span class="token punctuation">}</span> <span class="token operator">=</span> context
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><section id="warning"class="level4"><h4>Warning</h4><p>The <em>context</em> we refer to here is not to be confused with the <code>context</code> object available in <a href="https://vuex.vuejs.org/guide/actions.html">Vuex Actions</a> or the one available in the <code>build.extend</code> function in your <code>nuxt.config.js</code>. These are not related to each other!<p>Learn more about the different context keys in our <a href="./internals-glossary/context">Internals Glossary</a></section><section id="using-page-parameters-for-your-api-query"class="level3"><h3>Using page parameters for your API query</h3><p>The context directly exposes possible dynamic parameters of the route via <code>context.params</code>. In the following example, we call an API via the <code>nuxt/http</code> module using a dynamic page parameter as part of the URL. Modules, like the <a href="https://http.nuxtjs.org/">nuxt/http</a> module, can expose own functions which are then available through the <a href="./internals-glossary/context#app">context.app</a> object.<p>Also, we wrap the API call in a <code>try/catch</code> statement to handle potential errors. With the <code>context.error</code> function, we can directly show Nuxt's error page and pass in the occurred error.<pre class="language-js{}[pages/posts/_id.vue]"><code class="language-js{}[pages/posts/_id.vue]">export default {
  async asyncData(context) {
    const id = context.params.id
    try {
      // Using the nuxtjs/http module here exposed via context.app
      const post = await context.app.$http.$get(
        `https://api.nuxtjs.dev/posts/${id}`
      )
      return { post }
    } catch (e) {
      context.error(e) // Show the nuxt error page with the thrown error
    }
  }
}</code></pre><p>With <a href="https://hacks.mozilla.org/2015/05/es6-in-depth-destructuring/">ES6</a> you can use this syntax to destructure your context object. You can pass in the objects you want to have access to and then you can use them in the code without using the word context.<pre class="language-js{}[pages/posts/_id.vue]"><code class="language-js{}[pages/posts/_id.vue]">export default {
  async asyncData({ params, $http, error }) {
    const id = params.id

    try {
      // Using the nuxtjs/http module here exposed via context.app
      const post = await $http.$get(`https://api.nuxtjs.dev/posts/${id}`)
      return { post }
    } catch (e) {
      error(e) // Show the nuxt error page with the thrown error
    }
  }
}</code></pre><p>Want to use query parameters instead? You then use <a href="./internals-glossary/context#query">context.query.id</a>.</section><section id="redirecting-users--accessing-the-store"class="level3"><h3>Redirecting users &#x26; accessing the store</h3><p>Accessing the <a href="./directory-structure/store">Vuex store</a> (when you have it set up through the <code>store</code> directory) is also possible through the context. It provides a <code>store</code> object which can be treated as <code>this.$store</code> in Vue components. In addition, we use the <code>redirect</code> method, an exposed helper through the context, to redirect the user in case the <code>authenticated</code> state is <a href="https://developer.mozilla.org/en-US/docs/Glossary/Falsy">falsy</a>.<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  <span class="token function">middleware</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store<span class="token punctuation">,</span> redirect <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// retrieving keys via object destructuring</span>
    <span class="token keyword">const</span> isAuthenticated <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">authenticated</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isAuthenticated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><section id="next"class="level4"><h4>Next</h4><p>Check out the Internals Glossary book for more examples of the <a href="./internals-glossary/context#redirect">redirect method</a></section></section><section id="helpers"class="level2"><h2>Helpers</h2><p>Besides the shortcuts in the context, there are also other tiny helpers present in your Nuxt application.</section><section id="nuxt-the-nuxt-helper"class="level2"><h2><code>$nuxt</code>: The Nuxt helper</h2><p><code>$nuxt</code> is a helper designed to improve the user experience and to be an escape hatch in some situations. It is accessible via <code>this.$nuxt</code> in Vue components and via <code>window.$nuxt</code> otherwise on the client side.<section id="connection-checker"class="level3"><h3>Connection checker</h3><p>The <code>$nuxt</code> helper provides a quick way to find out whether the internet connection of a user is present or not: It exposes the boolean values <code>isOffline</code> and <code>isOnline</code>. We can use these to show a message as soon as the user is offline (for example).<pre class="language-html{}[layouts/default.vue]"><code class="language-html{}[layouts/default.vue]">&#x3C;template>
  &#x3C;div>
    &#x3C;div v-if="$nuxt.isOffline">You are offline&#x3C;/div>
    &#x3C;Nuxt />
  &#x3C;/div>
&#x3C;/template></code></pre></section><section id="accessing-the-root-instance"class="level3"><h3>Accessing the root instance</h3><p>Besides providing DX/UX (Developer Experience / User Experience) features, the <code>$nuxt</code> helper also provides a shortcut to the root instance of your application from every other component. But that's not everything — you can also access the <code>$nuxt</code> helper through <code>window.$nuxt</code> which can be used as an escape hatch to gain access to module methods like <code>$axios</code> from outside your Vue components. This should be used wisely and <strong>only as last resort</strong>.</section><section id="refreshing-page-data"class="level3"><h3>Refreshing page data</h3><p>When you want to refresh the current page for the user, you don't want to fully reload the page because you might hit the server again and at least re-initialize the whole Nuxt application. Instead, you often only want to refresh the data, provided by <code>asyncData</code> or <code>fetch</code>.<p>You can do so, by using <code>this.$nuxt.refresh()</code>!<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span>{{ content }}<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>refresh<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Refresh<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
    <span class="token function">asyncData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'Created at: '</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">$nuxt</span><span class="token punctuation">.</span><span class="token method function property-access">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span></code></pre><section id="controlling-the-loading-bar"class="level4"><h4>Controlling the loading bar</h4><p>With <code>$nuxt</code>, you can also control Nuxt's loading bar programmatically via <code>this.$nuxt.$loading</code>.<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">$nuxt</span><span class="token punctuation">.</span><span class="token property-access">$loading</span><span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">$nuxt</span><span class="token punctuation">.</span><span class="token property-access">$loading</span><span class="token punctuation">.</span><span class="token method function property-access">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Read more in the corresponding <a href="./features/loading">loading feature chapter</a></section></section></section><section id="onnuxtready-helper"class="level2"><h2>onNuxtReady helper</h2><p>If you want to run some scripts <em>after</em> your Nuxt application has been loaded and is ready, you can use the <code>window.onNuxtReady</code> function. This can be useful when you want to execute a function on the client-side without increasing the time to interactive of your site.<pre class="language-js"><code class="language-js"><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">onNuxtReady</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Nuxt is ready and mounted'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section id="process-helpers"class="level2"><h2>Process helpers</h2><p>Nuxt injects three boolean values (<code>client</code>, <code>server</code>, and <code>static</code>) into the global <code>process</code> object which will help you to determine whether your app was rendered on the server or fully on the client, as well as checking for static site generation. These helpers are available across your application and are commonly used in <code>asyncData</code> userland code.<pre class="language-html{}[pages/about.vue]"><code class="language-html{}[pages/about.vue]">&#x3C;template>
  &#x3C;h1>I am rendered on the {{ renderedOn }} side&#x3C;/h1>
&#x3C;/template>

&#x3C;script>
  export default {
    asyncData() {
      return { renderedOn: process.client ? 'client' : 'server' }
    }
  }
&#x3C;/script></code></pre><p>In the example, <code>renderedOn</code> will evaluate to <code>'server'</code> when using server-side rendering and a user accesses the page directly. When the user would navigate to the page from another part of the application, e.g. by click on a <code>&#x3C;NuxtLink></code>, it will evaluate to client. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>