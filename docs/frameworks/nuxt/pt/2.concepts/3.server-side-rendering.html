<!doctype html><html lang="pt"><meta charset="utf-8"><title>Interpretação do Lado do Servidor</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="description"content="A interpretação do lado do servidor (SSR), é a capacidade duma aplicação contribuir para a visualização da página da Web no servidor em vez de desenhá-la no navegador."><meta name="category"content="concepts"><link rel="stylesheet"type="text/css"href="../../../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="interpretação-do-lado-do-servidor"><h1 id="interpretação-do-lado-do-servidor">Interpretação do Lado do Servidor</h1><p>A interpretação do lado do servidor (SSR), é a capacidade duma aplicação contribuir para a visualização da página da Web no servidor em vez de desenhá-la no navegador. O lado do servidor envia uma página totalmente desenhada para o cliente; o pacote de JavaScript do cliente assume o controlo, o que permite que a aplicação de Vue.js se <a href="https://v2.ssr.vuejs.org/guide/hydration.html">hidrate</a>.<hr><section class="level2"aria-labelledby="servidor-de-nodejs-necessário"><h2 id="servidor-de-nodejs-necessário">Servidor de Node.js necessário</h2><p>É necessário um ambiente de JavaScript para desenhar a nossa página da Web. Um servidor de Node.js precisa de ser configurado para executar a nossa aplicação de Vue.js.</section><section class="level2"aria-labelledby="extender-e-controlar-o-servidor"><h2 id="extender-e-controlar-o-servidor">Extender e controlar o servidor</h2><p>Podemos estender o servidor com intermediário do servidor (<code>serverMiddleware</code>) e controlar as rotas com o intermediário:<pre class="language-js{}[server-middleware/logger.js]"><code class="language-js{}[server-middleware/logger.js]">export default function (req, res, next) {
  console.log(req.url)
  next()
}</code></pre><pre class="language-js{}[nuxt.config.js]"><code class="language-js{}[nuxt.config.js]">export default {
  serverMiddleware: ['~/server-middleware/logger']

}</code></pre></section><section class="level2"aria-labelledby="ambientes-de-servidor-vs-navegador"><h2 id="ambientes-de-servidor-vs-navegador">Ambientes de Servidor vs. Navegador</h2><p>Como estamos num ambiente de Node.js, temos acesso aos objetos da Node.js como <code>req</code> e <code>res</code>. Não temos acesso aos objetos <code>window</code> ou <code>document</code>, pois estes pertencem ao ambiente do navegador. No entanto, podemos utilizar <code>window</code> ou <code>document</code> utilizando as funções gatilhos <code>beforeMount</code> ou <code>mounted</code>:<pre class="language-js"><code class="language-js"><span class="token function">beforeMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">alert</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">alert</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section><section class="level2"aria-labelledby="etapas-de-interpretação-do-lado-do-servidor-com-a-nuxt"><h2 id="etapas-de-interpretação-do-lado-do-servidor-com-a-nuxt">Etapas de interpretação do lado do servidor com a Nuxt</h2><section class="level3"aria-labelledby="passo-1-navegador-ao-servidor"><h3 id="passo-1-navegador-ao-servidor">Passo 1: Navegador ao Servidor</h3><p>Quando um navegador envia o pedido inicial, este atingirá o servidor interno da Node.js. A Nuxt gerará a HTML e a enviará de volta ao navegador com os resultados das funções executadas, por exemplo, <code>asyncData</code>, <code>nuxtServerInit</code> ou <code>fetch</code>. As funções gatilhos também são executadas.</section><section class="level3"aria-labelledby="passo-2-servidor-ao-navegador"><h3 id="passo-2-servidor-ao-navegador">Passo 2: Servidor ao Navegador</h3><p>O navegador recebe a página desenhada a partir do servidor com o HTML gerado. O conteúdo é apresentado e a hidratação da Vue.js entra em ação, tornando-o reativo. Depois deste processo, a página é interativa.</section><section class="level3"aria-labelledby="passo-3-navegador-para-navegador"><h3 id="passo-3-navegador-para-navegador">Passo 3: Navegador para Navegador</h3><p>A navegação entre páginas com o <a href="./features/nuxt-components#o-componente-nuxtlink"><code>&#x3C;NuxtLink></code></a> é feita no lado do cliente, por esta razão não é necessário acessar o servidor novamente, exceto se atualizarmos o navegador manualmente.</section></section><section class="level2"aria-labelledby="advertências"><h2 id="advertências">Advertências</h2><section class="level3"aria-labelledby="window-ou-document-indefinido"><h3 id="window-ou-document-indefinido"><code>window</code> ou <code>document</code> indefinido</h3><p>Isto deve-se à interpretação do lado do servidor. Se precisarmos de especificar que queremos importar um recurso apenas no lado do cliente, precisamos de utilizar a variável <code>process.client</code>.<p>Por exemplo, no nosso ficheiro <code>.vue</code>:<pre class="language-js"><code class="language-js"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">client</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'external_library'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></section><section class="level3"aria-labelledby="ios-e-números-de-telefone"><h3 id="ios-e-números-de-telefone">iOS e números de telefone</h3><p>Algumas versões do Safari para telemóvel transformam automaticamente números de telefone em hiperligações. Isto acionará um aviso <code>NodeMismatch</code>, uma que o conteúdo da interpretação do lado do servidor já não corresponde ao conteúdo do sítio da Web. Isto pode tornar a nossa aplicação inutilizável nestas versões do Safari.<p>Se incluirmos números de telefone na nossa página de Nuxt, temos duas opções.</section></section><section class="level2"aria-labelledby="usar-um-metamarcador-para-impedir-a-transformação"><h2 id="usar-um-metamarcador-para-impedir-a-transformação">Usar um metamarcador para impedir a transformação</h2><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>format-detection<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>telephone=no<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre></section><section class="level2"aria-labelledby="embrulhar-os-nossos-números-de-telefone-em-hiperligações"><h2 id="embrulhar-os-nossos-números-de-telefone-em-hiperligações">Embrulhar os nossos números de telefone em hiperligações</h2><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!-- Exemplo de número de telefone: +7 (982) 536-50-77 --></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tel: +7 (982) 536-50-77<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>+7 (982) 536-50-77<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>template</span><span class="token punctuation">></span></span></code></pre><p><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>