<!doctype html>
<html lang="pt">
  <head>
    <meta charset="utf-8">
    <title>Modo de Pré-visualização</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Pré-visualização ao vivo para o um alvo estático com o modo de pré-visualização">
    <meta name="category" content="features">
    <link rel="stylesheet" href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css">
  </head>
  <body>
    <section id="modo-de-pré-visualização" class="level1">
      <h1>Modo de Pré-visualização</h1>
      <p>Pré-visualização ao vivo para alvo estático com o modo de pré-visualização</p>
      <hr>
      <p>Com o Nuxt e completamente estático você pode agora usar a pré-visualização ao vivo fora da caixa que chamará sua API ou CMS, assim você pode visualizar as mudanças ao vivo antes de desdobrar.</p>
      <section id="warning" class="level4">
        <h4>Warning</h4>
        <p>Disponível apenas quando estiver usando <a href="./features/deployment-targets#static-hosting"><code>target:static</code></a></p>
        <p>O modo de pré-visualização irá atualizar os dados da página automaticamente visto que ele usa <code>$nuxt.refresh</code> nos bastidores e portanto chama <code>nuxtServerInit</code>, <code>asyncDate</code> e <code>fetch</code> no lado do cliente.</p>
        <p>No sentido de ativar a pré-visualização ao vivo você precisará adicionar o seguinte plugin:</p>
        <pre class="language-js{}[plugins/preview.client.js]"><code class="language-js{}[plugins/preview.client.js]">export default function ({ query, enablePreview }) {
  if (query.preview) {
    enablePreview()
  }
}</code></pre>
      </section>
      <section id="warning-1" class="level4">
        <h4>Warning</h4>
        <p>O <code>enablePreview</code> está disponível apenas dentro do objeto de contexto dos plugins. Pré-visualizações são manipuladas no lado do cliente e desta maneira o plugin deve ser executado no cliente: <code>preview.client.js</code></p>
        <pre class="language-js{}[nuxt.config.js]"><code class="language-js{}[nuxt.config.js]">export default {
  plugins: ['~/plugins/preview.client.js']
}</code></pre>
        <p>Uma vez que você adicionou o plugin você pode agora gerar seu site e servir ele.</p>
        <pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> generate
<span class="token function">yarn</span> start</code></pre>
        <pre class="language-bash"><code class="language-bash">npx nuxt generate
npx nuxt start</code></pre>
        <p>Em seguida você pode visualizar sua página de pré-visualização ao adicionar o parâmetro de consulta no final da página que você queira visualizar imediatamente:</p>
        <pre class="language-js"><code class="language-js"><span class="token operator">?</span>preview<span class="token operator">=</span><span class="token boolean">true</span></code></pre>
      </section>
      <section id="warning-2" class="level4">
        <h4>Warning</h4>
        <p>O <code>enablePreview</code> deve ser testado localmente com o yarn start e não yarn dev</p>
      </section>
      <section id="pré-visualizando-páginas-que-ainda-não-foram-geradas" class="level3">
        <h3>Pré-visualizando Páginas Que Ainda Não Foram Geradas</h3>
        <p>Para páginas que ainda não foram geradas, mesmo na queda do SPA elas ainda continuarão a chamar a API antes de exibir a página 404 como se essas páginas existissem na API mas que ainda não foram geradas.</p>
        <p>Se você tiver definido um gatilho validate, você provavelmente precisará modificar ele, assim para que ele não redirecione para a página 404 no modo de pré-visualização.</p>
        <pre class="language-js"><code class="language-js"><span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params<span class="token punctuation">,</span> query <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token property-access">preview</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span></code></pre>
      </section>
      <section id="passando-dados-ao-enablepreview" class="level3">
        <h3>Passando Dados ao enablePreview</h3>
        <p>Você pode passar dados para função <code>enablePreview</code>. Esses dados irão depois estar disponíveis no auxiliar de contexto <code>$preview</code> e no <code>this.$preview</code>.</p>
      </section>
      <section id="o-que-se-segue" class="level3">
        <h3>O Que Se Segue</h3>
        <section id="next" class="level4">
          <h4>Next</h4>
          <p>Consulte o <a href="./directory-structure/nuxt">livro da Estrutura do Diretório</a></p>
          <p><span style="float: footnote;"><a href="../index.html#toc">Go to TOC</a></span></p>
        </section>
      </section>
    </section>
  </body>
</html>
