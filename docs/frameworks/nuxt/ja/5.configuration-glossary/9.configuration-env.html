<!doctype html><html lang="ja"><meta charset="utf-8"><title>env プロパティ</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="navigation.title"content="env"><meta name="description"content="クライアントサイドとサーバーサイドでる環境変数を共有できます。"><meta name="menu"content="env"><meta name="category"content="configuration-glossary"><link rel="stylesheet"href="../../../../../../../../../Vivliostyle/read-html-download-pdf/docs/themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="env-プロパティ"><h1 id="env-プロパティ">env プロパティ</h1><p>クライアントサイドとサーバーサイドでる環境変数を共有できます。<hr><ul><li>型: <code>Object</code></ul><blockquote><p>Nuxt ではクライアントサイドとサーバーサイドで共有される環境変数を作成できます。</blockquote><p>env プロパティはクライアントサイドで使用できる環境変数を定義します。これらはサーバーサイド環境変数や <a href="https://github.com/nuxt-community/dotenv-module">dotenv モジュール</a>などを使用して割り当てることができます。<p>alert nuxt のバージョン > 2.12+ では、（ビルド時ではなく）ランタイムに環境変数が必要な場合、<code>env</code> プロパティを<a href="./configuration-glossary/configuration-runtime-config">Runtime config プロパティ</a>の <code>publicRuntimeOptions</code> と <code>privateRuntimeOptions</code> で代替することが推奨されます。<br>詳細は、チュートリアルの [Moving from @nuxtjs/dotenv to runtime config] (/tutorials/moving-from-nuxtjs-dotenv-to-runtime-config/)をご覧ください。<p><strong>より良いトラブルシューティングのために、後述の <code>process.env</code> と <code>process.env == {}</code> を必ず読んでください。</strong><pre class="language-js{}[nuxt.config.js]"><code class="language-js{}[nuxt.config.js]">export default {
  env: {
    baseUrl: process.env.BASE_URL || 'http://localhost:3000'
  }
}</code></pre><p>これによりサーバーサイドの環境変数 <code>BASE_URL</code> が利用可能または定義されていれば、<code>BASE_URL</code> と等しい baseUrl プロパティを作成できます。 もし <code>BASE_URL</code> が利用不可であったり定義されていなれば、クライアントサイドの <code>baseUrl</code> は <code>'http://localhost:3000'</code> になります。サーバーサイドの環境変数 BASE_URL は <code>nuxt.config.js</code> の <code>env</code> プロパティを経由してクライアントサイドにコピーされます。または、他の値が定義されています。<p>そして <code>baseUrl</code> 変数にアクセスするには 2 つの方法があります：<ol><li><code>process.env.baseUrl</code> 経由でアクセスする。<li><code>context.env.baseUrl</code> 経由でアクセスする。詳細は <a href="./internals-glossary/context">context API</a> を参照してください。</ol><p>例えば <code>env</code> プロパティを使って公開トークンを付与できます。<p>上記の例として、env プロパティを使って <a href="https://github.com/mzabriskie/axios">axios</a> を設定できます。<pre class="language-js{}[plugins/axios.js]"><code class="language-js{}[plugins/axios.js]">import axios from 'axios'

export default axios.create({
  baseURL: process.env.baseUrl
})</code></pre><p>このように記述するとページ内で <code>import axios from '~/plugins/axios'</code> という具合に axios をインポートできます。<section class="level2"aria-labelledby="環境変数の自動注入"><h2 id="環境変数の自動注入">環境変数の自動注入</h2><p>ビルドフェーズで <code>NUXT_ENV_</code> で始まる環境変数を定義（例えば <code>NUXT_ENV_COOL_WORD=freezing nuxt build</code> または Windows の console に対して <code>SET NUXT_ENV_COOL_WORD=freezing &#x26; nuxt build</code>）した場合、この環境変数はプロセス環境に自動的に注入されます。<code>nuxt.config.js</code> 内に定義した同名変数よりも優先されるので注意してください。</section><section class="level2"aria-labelledby="processenv-"><h2 id="processenv-">process.env ==</h2><p>Nuxt は webpack の <code>definePlugin</code> を用いて環境変数を定義することに注意してください。つまり、Node.js の実際の <code>process</code> または <code>process.env</code> が利用可能でもなければ定義されてもいないことを意味します。nuxt.config.js で定義された <code>env</code> プロパティは <code>process.env.xxxx</code> へそれぞれ個別にマップされコンパイル時に変換されます。<p>つまり、<code>console.log(process.env)</code> は <code>{}</code> を出力しますが、<code>console.log(process.env.your_var)</code> は定義された値を出力します。コードが webpack でコンパイルされると、<code>process.env.your_var</code> と記述されたすべての箇所が定義した値に置き換えられます。例えば、<code>env.test = 'testing123'</code> と定義すると、コード中に <code>process.env.test</code> と記述してある箇所がすべて 'testing123' へ置き換えられます。<p>前<pre class="language-js"><code class="language-js"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token property-access">test</span> <span class="token operator">==</span> <span class="token string">'testing123'</span><span class="token punctuation">)</span></code></pre><p>後<pre class="language-js"><code class="language-js"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token string">'testing123'</span> <span class="token operator">==</span> <span class="token string">'testing123'</span><span class="token punctuation">)</span></code></pre></section><section class="level2"aria-labelledby="servermiddleware"><h2 id="servermiddleware">serverMiddleware</h2><p><a href="./configuration-glossary/configuration-servermiddleware">serverMiddleware</a> はメインの Nuxt ビルドから分離されているので、<code>nuxt.config.js</code> に定義された <code>env</code> 変数は使用できません。 <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>