<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>アセットディレクトリ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="navigation.title" content="assets">
    <meta name="description" content="The assets directory contains your un-compiled assets such as Stylus or Sass files, images, or fonts.">
    <meta name="category" content="directory-structure">
    <meta name="csb_link" content="https://codesandbox.io/embed/github/nuxt-academy/guides-examples/tree/master/04_directory_structure/02_assets?fontsize=14&#x26;hidenavigation=1&#x26;theme=dark">
    <meta name="videoScript" content="assets-video.md">
    <link rel="stylesheet" href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css">
  </head>
  <body>
    <section id="アセットディレクトリ" class="level1">
      <h1>アセットディレクトリ</h1>
      <p><code>assets</code> ディレクトリには、Stylus や Sass ファイル、画像、フォントなどコンパイルされていないアセットが含まれます。</p>
      <hr>
      <section id="画像" class="level2">
        <h2>画像</h2>
        <p><code>vue</code> テンプレートの中で <code>assets</code> ディレクトリにリンクする必要がある場合は、assets の前にスラッシュを付け <code>~/assets/your_image.png</code> と記述します。</p>
        <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>~/assets/your_image.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>template</span><span class="token punctuation">></span></span></code></pre>
        <p><code>css</code> ファイルの中で <code>assets</code> ディレクトリにリンクする必要がある場合は、スラッシュなしで <code>~assets/your_image.png</code> と記述します。</p>
        <pre class="language-css"><code class="language-css"><span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">'~assets/banner.svg'</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span></code></pre>
        <p>動的イメージを使う場合は、require を使う必要があります。</p>
        <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>require(`~/assets/img/${image}.jpg`)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre>
        <section id="next" class="level4">
          <h4>Next</h4>
          <p><a href="./directory-structure/assets#webpack-assets">webpack Assets</a> の詳細についてはこちらをご覧ください。</p>
        </section>
      </section>
      <section id="スタイル" class="level2">
        <h2>スタイル</h2>
        <p>Nuxt では、グローバル (すべてのページ）に設定したい CSS ファイルやモジュール、ライブラリを定義することができます。nuxt.config 内で CSS プロパティを使って簡単にスタイルを追加することができます。</p>
        <pre class="language-js{}[nuxt.config.js]"><code class="language-js{}[nuxt.config.js]">export default {
  css: [
    // 直接 Node.js モジュールをロード (ここは Sass ファイル)
    'bulma',
    // プロジェクト内の CSS ファイル
    '~/assets/css/main.css',
    // プロジェクト内の SCSS ファイル
    '~/assets/css/main.scss'
  ]
}</code></pre>
        <section id="sass" class="level3">
          <h3>Sass</h3>
          <p><code>sass</code> を使用したい場合、<code>sass</code> と <code>sass-loader</code> プラグインがインストールされているか確認してください。</p>
          <pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> --dev sass sass-loader@10</code></pre>
          <pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev sass sass-loader@10</code></pre>
          <p>Nuxt は拡張子からファイルの種類を自動的に推測して webpack に適したプリプロセッサローダーを使用します。それでも必要な場合は、必要なローダーをインストールする必要があります。</p>
        </section>
      </section>
      <section id="フォント" class="level2">
        <h2>フォント</h2>
        <p>ローカルフォントをアセットフォルダに追加することで使用できるようになります。追加したら @font-face を使用して css からアクセスすることができます。</p>
        <pre class="language-text"><code class="language-text">-| assets
----| fonts
| DMSans-Regular.ttf
| DMSans-Bold.ttf</code></pre>
        <pre class="language-css{}[assets/main.css]"><code class="language-css{}[assets/main.css]">@font-face {
  font-family: 'DM Sans';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url('~assets/fonts/DMSans-Regular.ttf') format('truetype');
}

@font-face {
  font-family: 'DM Sans';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url('~assets/fonts/DMSans-Bold.ttf') format('truetype');
}</code></pre>
        <section id="info" class="level4">
          <h4>Info</h4>
          <p>CSS ファイルは自動的にロードされません。それらを追加するには <a href="https://nuxtjs.org/docs/configuration-glossary/configuration-css/">CSS 設定プロパティ</a> を使用してください。</p>
        </section>
        <section id="next-1" class="level4">
          <h4>Next</h4>
          <p>Google フォントのような外部フォントを追加する場合は <a href="./features/meta-tags-seo#external-resources">Meta Tags and SEO chapter</a> を確認してください。</p>
        </section>
      </section>
      <section id="webpack-アセット" class="level2">
        <h2>Webpack アセット</h2>
        <p>デフォルトでは、Nuxt は webpack の vue-loader、file-loader、url-loader を使用してアセットを提供します。また webpack を通して実行されるべきではないアセットのために、静的ディレクトリを使用することもできます。</p>
      </section>
      <section id="webpack" class="level2">
        <h2>Webpack</h2>
        <p><a href="http://vue-loader.vuejs.org/">vue-loader</a> は、<code>css-loader</code> と Vue Template Compiler を用いて、スタイルやテンプレートファイルを自動的に処理します。このコンパイル処理の中で、<code>&#x3C;img src="..."></code> や <code>background: url(...)</code> や CSS <code>@import</code> などのすべてのアセット URL はモジュールの依存関係として解決されます。</p>
        <p>例えば、次のようなファイル構成があるとします：</p>
        <pre class="language-text"><code class="language-text">-| assets/
----| image.png
-| pages/
----| index.vue</code></pre>
        <p>CSS で <code>url('~assets/image.png')</code> と記述した場合、それは <code>require('~/assets/image.png')</code> に変換されます。</p>
        <section id="warning" class="level4">
          <h4>Warning</h4>
          <p><code>~/</code> エイリアスは CSS ファイルで正しく解決されないでしょう。CSS の <code>url</code> の参照には、<code>~assets</code> (<strong>スラッシュなし</strong>）を使わなければなりません。例: <code>background: url("~assets/banner.svg")</code></p>
          <p><code>pages/index.vue</code> で画像を参照する場合：</p>
          <pre class="language-html{}[pages/index.vue]"><code class="language-html{}[pages/index.vue]">&#x3C;template>
  &#x3C;img src="~/assets/image.png" />
&#x3C;/template></code></pre>
          <p>次のようにコンパイルされます：</p>
          <pre class="language-js"><code class="language-js"><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">attrs</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'~/assets/image.png'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
          <p><code>.png</code> は JavaScript ファイルではないため、Nuxt は file-loader](<a href="https://github.com/webpack/file-loader">https://github.com/webpack/file-loader</a>) と <a href="https://github.com/webpack/url-loader">url-loader</a> を使ってそれらを処理できるよう webpack を設定します。</p>
          <p>これらのローダーを利用する利点：</p>
          <p><code>file-loader</code> は、アセットファイルをコピー・配置する場所と、キャッシュ改善のためにバージョンハッシュを用いてファイル名を指定することができます。本番環境では、デフォルトで長期的なキャッシングの恩恵を受けることができます。</p>
          <p><code>url-loader</code> は、指定した閾値よりも小さい場合に、Base64 データ URL として条件付きでファイルに埋め込むことができます。これにより、小さなファイル取得のための HTTP リクエスト数を減らすことができます。もし閾値よりも大きい場合は、file-loader に自動的にフォールバックします。</p>
          <p>これら 2 つのローダーのデフォルトの設定は次の通りです：</p>
          <pre class="language-js"><code class="language-js"><span class="token comment">// https://github.com/nuxt/nuxt.js/blob/dev/packages/webpack/src/config/base.js#L382-L411</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|svg|webp|avif)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">esModule</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">// 1kB</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'img/[name].[contenthash:7].[ext]'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff2?|eot|ttf|otf)(\?.*)?$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token literal-property property">esModule</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
       <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">// 1kB</span>
       <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'fonts/[name].[contenthash:7].[ext]'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(webm|mp4|ogv)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">esModule</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'videos/[name].[contenthash:7].[ext]'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre>
          <p>つまり、1 KB 未満のすべてのファイルは Base64 データ URL としてインライン化されます。 それ以外の場合、画像やフォントは、対応するフォルダ（<code>.nuxt</code> ディレクトリの下）にコピーされ、より良いキャッシュのためにバージョンハッシュを含む名前が付けられます。</p>
          <p><code>nuxt</code> コマンドでアプリケーションを起動するときの <code>pages/index.vue</code> のテンプレートは以下の通りです：</p>
          <pre class="language-html{}[pages/index.vue]"><code class="language-html{}[pages/index.vue]">&#x3C;template>
  &#x3C;img src="~/assets/your_image.png" />
&#x3C;/template></code></pre>
          <p>次のように生成されます：</p>
          <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/_nuxt/img/your_image.0c61159.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre>
          <p>ローダの設定を変更したい場合は <a href="./configuration-glossary/configuration-build#extend">build.extend</a> を使用してください。</p>
        </section>
      </section>
      <section id="エイリアス" class="level2">
        <h2>エイリアス</h2>
        <p>デフォルトでは、ソースディレクトリ (srcDir) とルートディレクトリ (rootDir) は同じディレクトリを意味します。ソースディレクトリには <code>~</code> のエイリアスを使うことができます。<code>../assets/your_image.png</code> のような相対パスを記述する代わりに、<code>~/assets/your_image.png</code> と記述することができます。</p>
        <p>どちらも同じ結果になります。</p>
        <pre class="language-html{}[components/Avatar.vue]"><code class="language-html{}[components/Avatar.vue]">&#x3C;template>
  &#x3C;div>
    &#x3C;img src="../assets/your_image.png" />
    &#x3C;img src="~/assets/your_image.png" />
  &#x3C;/div>
&#x3C;/template></code></pre>
        <p>エイリアスとして <code>~</code> を使うことをお勧めします。<code>@</code> はまだサポートされていますが、CSS の background image などすべてのケースで機能するわけではありません。</p>
        <p>ルートディレクトリには、エイリアスの <code>~~</code> や <code>@@</code> を使用することができます。</p>
        <section id="info-1" class="level4">
          <h4>Info</h4>
          <p>Tip: スペイン語のキーボードでは、Mac OSでは（<code>Option</code> + <code>ñ</code>）、または Windows では（<code>Alt gr</code> + <code>4</code>）で <code>~</code> にアクセスできます。</p>
          <p><span style="float: footnote;"><a href="../index.html#toc">Go to TOC</a></span></p>
        </section>
      </section>
    </section>
  </body>
</html>
