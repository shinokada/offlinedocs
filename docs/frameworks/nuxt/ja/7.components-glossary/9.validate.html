<!doctype html><html lang="ja"><meta charset="utf-8"><title>validate メソッド</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="description"content="Nuxt では動的なルーティングを行うコンポーネント内でバリデーションメソッドを定義できます。"><meta name="navigation.title"content="Validate Method"><meta name="category"content="components-glossary"><link rel="stylesheet"href="../../../../../../../../../Vivliostyle/read-html-download-pdf/docs/themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="validate-メソッド"><h1 id="validate-メソッド">validate メソッド</h1><p>Nuxt では動的なルーティングを行うコンポーネント内でバリデーションメソッドを定義できます。<hr><ul><li><strong>型:</strong> <code>Function</code> または <code>Async Function</code></ul><p><code>validate</code> は新しいルートに移動する前に毎回呼び出されます。サーバーサイドでは（Nuxt アプリケーションへの最初のリクエストで）1 度、クライアントサイドでは別のルートに遷移する際に呼び出されます。このメソッドは <a href="./internals-glossary/context">context</a> オブジェクトを引数として受け取ります。<pre class="language-js"><code class="language-js"><span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params<span class="token punctuation">,</span> query<span class="token punctuation">,</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token boolean">true</span> <span class="token comment">// params が有効な場合</span>
  <span class="token keyword control-flow">return</span> <span class="token boolean">false</span> <span class="token comment">// Nuxt にルートをレンダリングさせるのを止め、エラーページを表示させます</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword">async</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params<span class="token punctuation">,</span> query<span class="token punctuation">,</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 非同期操作</span>
  <span class="token keyword control-flow">return</span> <span class="token boolean">true</span> <span class="token comment">// params が有効な場合</span>
  <span class="token keyword control-flow">return</span> <span class="token boolean">false</span> <span class="token comment">// Nuxt にルートをレンダリングさせるのを止め、エラーページを表示させます</span>
<span class="token punctuation">}</span></code></pre><p>プロミスを返すこともできます：<pre class="language-js"><code class="language-js"><span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params<span class="token punctuation">,</span> query<span class="token punctuation">,</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p>Nuxt では動的なルーティングを行うコンポーネント内でバリデーションメソッドを定義できます（以下の例では <code>pages/users/_id.vue</code> です）。<p>バリデーションメソッドが <code>true</code> を返さない場合 Nuxt は自動的に 404 エラーページをロードします。<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  <span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Must be a number</span>
    <span class="token keyword control-flow">return</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\d+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>例えば<a href="./directory-structure/store">ストア</a>内の一部のデータ（アクションの前に <a href="./directory-structure/store#the-nuxtserverinit-action"><code>nuxtServerInit</code></a> で格納されます）を確認することもできます：<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  <span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params<span class="token punctuation">,</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// `params.id` が存在しているカテゴリかどうかを確認します</span>
    <span class="token keyword control-flow">return</span> store<span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">categories</span><span class="token punctuation">.</span><span class="token method function property-access">some</span><span class="token punctuation">(</span><span class="token parameter">category</span> <span class="token arrow operator">=></span> category<span class="token punctuation">.</span><span class="token property-access">id</span> <span class="token operator">===</span> params<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>バリデーション関数を実行中に想定されるエラーや想定外のエラーを投げることもできます：<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params<span class="token punctuation">,</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// カスタムメッセージと共に 500 internal server error を投げます</span>
    <span class="token keyword control-flow">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Under Construction!'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section>