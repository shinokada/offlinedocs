<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <title>Cycles de vie de Nuxt</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Peu importe l&#x27;outil que nous utilisons, nous serons davantage en confiance lorsque nous serons capable de comprendre comment il marche dans les détails. Il en est de même pour Nuxt.">
    <meta name="category" content="concepts">
    <link rel="stylesheet" href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css">
  </head>
  <body>
    <section id="cycles-de-vie-de-nuxt" class="level1">
      <h1>Cycles de vie de Nuxt</h1>
      <p>Peu importe l'outil que nous utilisons, nous serons davantage en confiance lorsque nous serons capable de comprendre comment il marche dans les détails. Il en est de même pour Nuxt. Le but de ce chapitre est de nous donner une vue d'ensemble des différentes parties du framework, leur ordre d'exécution ainsi que la façon dont ils intéragissent entre eux.</p>
      <hr>
      <figure>
        <img src="../docs/nuxt-lifecycle.svg" alt="Les lifecycles de Nuxt 2.12">
        <figcaption aria-hidden="true">Les lifecycles de Nuxt 2.12</figcaption>
      </figure>
      <p>Le cycle de vie de Nuxt décrit les différentes étapes qui ont lieu après la phase de build, une fois que notre application a été bundlée, chunkée et minifiée. Ce qu'il se passe après cette phase dépend de si nous avons activé le rendu côté serveur ou pas. Si c'est le cas, il faut ensuite regarder le type de rendu serveur que nous avons choisi:</p>
      <p>Rendu dynamique côté serveur (SSR) (<code>nuxt start</code>)</p>
      <p>ou Génération statique de site (SSG) (<code>nuxt generate</code>).</p>
      <section id="cycle-de-vie" class="level2">
        <h2>Cycle de vie</h2>
        <section id="serveur" class="level3">
          <h3>Serveur</h3>
          <p>Pour le SSR, les étapes suivantes seront exécutées pour chaque requête sur notre app</p>
          <ul>
            <li>Le serveur démarre (<code>nuxt start</code>)</li>
          </ul>
          <p>Lorsque nous utilisons la génération statique de notre site, les étapes qui ont lieu sur le serveur ne seront exécutées que lors de la phase de build et une fois pour chaque page générée.</p>
          <ul>
            <li>
              <p>Le processus de génération commence (<code>nuxt generate</code>)</p>
            </li>
            <li>
              <p>Hooks Nuxt</p>
            </li>
            <li>
              <p>serverMiddleware</p>
            </li>
            <li>
              <p>Les plugins de Nuxt côté serveur</p>
              <ul>
                <li>en suivant l'ordre défini dans nuxt.config.js</li>
              </ul>
            </li>
            <li>
              <p>nuxtServerInit</p>
              <ul>
                <li>action Vuex qui est appelée seulement côté serveur pour pré-remplir le store</li>
                <li>le premier argument dans le <strong>context de Vuex</strong>, le second argument dans le <strong>context de Nuxt</strong>
                  <ul>
                    <li>on dispatch les autres actions d'ici → c'est seulement le "point d'entrée" pour des actions ultérieures du côté serveur</li>
                  </ul>
                </li>
                <li>peut seulement être défini dans le <code>store/index.js</code></li>
              </ul>
            </li>
            <li>
              <p>Middleware</p>
              <ul>
                <li>Global middleware</li>
                <li>Layout middleware</li>
                <li>Route middleware</li>
              </ul>
            </li>
            <li>
              <p>asyncData</p>
            </li>
            <li>
              <p>beforeCreate (cycle de vie de Vue)</p>
            </li>
            <li>
              <p>created (cycle de vie de Vue)</p>
            </li>
            <li>
              <p>Le nouveau fetch (du haut vers le bas, en parallèle si ce sont des voisins)</p>
            </li>
            <li>
              <p>Sérialisation du state (hook <code>render:routeContext</code> de Nuxt)</p>
            </li>
            <li>
              <p>le rendu HTML commence (hook <code>render:route</code> de Nuxt)</p>
            </li>
            <li>
              <p><code>render:routeDone</code> hook quand le HTML a été envoyé au navigateur</p>
            </li>
            <li>
              <p><code>generate:before</code> hook de Nuxt</p>
            </li>
            <li>
              <p>les fichiers HTML sont générés</p>
              <ul>
                <li><strong>génération intégralement statique</strong>
                  <ul>
                    <li>ex. les payloads statiques sont extraits</li>
                  </ul>
                </li>
                <li><code>generate:page</code> (HTML éditable)</li>
                <li><code>generate:routeCreated</code> (Route générée)</li>
              </ul>
            </li>
            <li>
              <p><code>generate:done</code> quand tous les fichiers HTML ont été générés</p>
            </li>
          </ul>
        </section>
        <section id="client" class="level3">
          <h3>Client</h3>
          <p>Cette partie du cycle est entièrement exécutée dans le navigateur, peu importe le mode que nous avons choisi pour Nuxt.</p>
          <ul>
            <li>Reçoit le HTML</li>
            <li>Charge les ressources (ex. Javascript)</li>
            <li>Hydratation de Vue</li>
            <li>Middleware
              <ul>
                <li>Global middleware</li>
                <li>Layout middleware</li>
                <li>Route middleware</li>
              </ul>
            </li>
            <li>asyncData (bloquant)</li>
            <li>plugins clients de Nuxt
              <ul>
                <li>en suivant l'ordre défini dans nuxt.config.js</li>
              </ul>
            </li>
            <li>beforeCreate (méthode du cycle de vie de Vue)</li>
            <li>created (méthode du cycle de vie de Vue)</li>
            <li>Le nouveau fetch (du haut vers le bas, en parallèle si ce sont des voisins)</li>
            <li>beforeMount (méthode du cycle de vie de Vue)</li>
            <li>mounted (méthode du cycle de vie de Vue)</li>
          </ul>
        </section>
        <section id="naviguer-en-utilisant-le-composant-nuxtlink" class="level3">
          <h3>Naviguer en utilisant le composant NuxtLink</h3>
          <p>De la même façon que pour la partie <em>client</em>, tout se passe dans le navigateur mais seulement lors d'une navigation avec <code>&#x3C;NuxtLink></code>. De plus, aucun contenu n'est affiché sur la page tant qu'il reste des tâches <em>bloquantes</em>.</p>
          <section id="info" class="level4">
            <h4>Info</h4>
            <p>Se référer au chapitre sur les composants pour plus d'informations sur <a href="./features/nuxt-components#the-nuxtlink-component"><code>&#x3C;NuxtLink></code></a>.</p>
            <ul>
              <li>middleware (bloquant)
                <ul>
                  <li>Global middleware</li>
                  <li>Layout middleware</li>
                  <li>Route middleware</li>
                </ul>
              </li>
              <li>asyncData (bloquant)</li>
              <li>asyncData (bloquant) [ou chargement entièrement statique du payload]</li>
              <li>beforeCreate &#x26; created (méthode du cycle de vie de Vue)</li>
              <li>fetch (non-bloquant)</li>
              <li>beforeMount &#x26; mounted</li>
            </ul>
          </section>
        </section>
        <section id="ensuite-" class="level3">
          <h3>Ensuite ?</h3>
          <section id="next" class="level4">
            <h4>Next</h4>
            <p>Plus d'informations dans le <a href="./features/rendering-modes">recueil sur les features</a>.</p>
            <p><span style="float: footnote;"><a href="../index.html#toc">Go to TOC</a></span></p>
          </section>
        </section>
      </section>
    </section>
  </body>
</html>
