<!doctype html><html lang="fr"><meta charset="utf-8"><title>La propriété env</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="navigation.title"content="env"><meta name="description"content="Permet de partager des variables d&#x27;environnement entre le client et le serveur."><meta name="menu"content="env"><meta name="category"content="configuration-glossary"><link rel="stylesheet"href="../../../../../../../../../Vivliostyle/read-html-download-pdf/docs/themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="la-propriété-env"><h1 id="la-propriété-env">La propriété env</h1><p>Permet de partager des variables d'environnement entre le client et le serveur.<hr><ul><li>Type: <code>Object</code></ul><blockquote><p>Nuxt nous permet de créer des variables d'environnement côté client et de les partager aussi côté serveur.</blockquote><p>La propriété <code>env</code> définit les variables d'environnement qui devraient être disponibles côté client. Elles peuvent être assignées en utilisant les variables d'environnement côté serveur. Pour plus d'informations, voir le <a href="https://github.com/nuxt-community/dotenv-module">module dotenv</a>.<p>alert For nuxt versions > 2.12+, in cases where environment variables are required at runtime (not build time) it is recommended to subsitute the <code>env</code> property with <a href="./configuration-glossary/configuration-runtime-config">runtimeConfig properties</a>: <code>publicRuntimeOptions</code> and <code>privateRuntimeOptions</code>.<br>Learn more with our tutorial about <a href="/tutorials/moving-from-nuxtjs-dotenv-to-runtime-config/">moving from @nuxtjs/dotenv to runtime config</a>.<p><strong>Faites attention de lire à propos de <code>process.env</code> et <code>process.env == {}</code> ci-dessous pour un meilleur débogage.</strong><pre class="language-js{}[nuxt.config.js]"><code class="language-js{}[nuxt.config.js]">export default {
  env: {
    baseUrl: process.env.BASE_URL || 'http://localhost:3000'
  }
}</code></pre><p>Cela nous permet de créer une propriété <code>baseUrl</code> qui sera égale à la variable d'environment côté serveur nommée <code>BASE_URL</code> si disponible/définie. Sinon, <code>baseUrl</code> côté client sera égale à <code>'http://localhost:3000'</code>. La variable <code>BASE_URL</code> côté serveur sera ainsi copiée côté client via la propriété <code>env</code> du fichier <code>nuxt.config.js</code>. En dernier recours, la valeur sera égale à <code>'http://localhost:3000'</code>.<p>Ensuite, on peut avoir accès à la variable <code>baseUrl</code> de 2 façons:<ol><li>Via <code>process.env.baseUrl</code>.<li>Via <code>context.env.baseUrl</code>, voir l'<a href="./internals-glossary/context">API context</a>.</ol><p>On peut par exemple, utiliser la propriété <code>env</code> pour donner un token public.<p>Pour l'exemple au dessus, on peut l'utiliser pour configurer <a href="https://github.com/mzabriskie/axios">axios</a>.<pre class="language-js{}[plugins/axios.js]"><code class="language-js{}[plugins/axios.js]">import axios from 'axios'

export default axios.create({
  baseURL: process.env.baseUrl
})</code></pre><p>Ensuite, dans nos pages, on peut import axios ainsi: <code>import axios from '~/plugins/axios'</code>.<section class="level2"aria-labelledby="injection-automatique-de-variables-denvironnement"><h2 id="injection-automatique-de-variables-denvironnement">Injection automatique de variables d'environnement</h2><p>Si on définit des variables d'environnement commençant par un <code>NUXT_ENV_</code> lors de la phase de build (ex: <code>NUXT_ENV_COOL_WORD=freezing nuxt build</code>), elles seront automatiquement injectées dans le processus de l'environnement. Attention cependant à ne pas oublier que ces variables peuvent écraser des variables du même nom précédemment définies dans le fichier <code>nuxt.config.js</code>.</section><section class="level2"aria-labelledby="processenv-"><h2 id="processenv-">process.env ==</h2><p>Il faut savoir que Nuxt utilise <code>definePlugin</code> de Webpack pour définir les variables d'environnement. Cela veut dire que les <code>process</code> ou <code>process.env</code> de Node.js ne sont ni disponibles ni définis. Chaque propriété d'<code>env</code> définie dans <code>nuxt.config.js</code> est individuellement mappée à un <code>process.env.xxxx</code> et convertie durant la compilation.<p>Cela veut dire que <code>console.log(process.env)</code> va renvoyer <code>{}</code> mais que <code>console.log(process.env.notre_variable)</code> va tout de même renvoyer notre valeur. Lorsque Webpack compile notre code, il remplace toutes les instances de <code>process.env.your_variable</code> par la valeur qui lui est attribuée.<p>Exemple: <code>env.test = 'testing123'</code>. Si on utilise <code>process.env.test</code> quelque part dans notre code, cela sera traduit en <code>'testing123'</code>.<p>avant<pre class="language-js"><code class="language-js"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token property-access">test</span> <span class="token operator">==</span> <span class="token string">'testing123'</span><span class="token punctuation">)</span></code></pre><p>après<pre class="language-js"><code class="language-js"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token string">'testing123'</span> <span class="token operator">==</span> <span class="token string">'testing123'</span><span class="token punctuation">)</span></code></pre></section><section class="level2"aria-labelledby="servermiddleware"><h2 id="servermiddleware">serverMiddleware</h2><p>Comme le <a href="./configuration-glossary/configuration-servermiddleware">serverMiddleware</a> est découplé du build principal de Nuxt, les variables <code>env</code> définies dans le fichier <code>nuxt.config.js</code> n'y seront pas disponibles. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>