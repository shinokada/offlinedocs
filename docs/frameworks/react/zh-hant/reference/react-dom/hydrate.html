<!doctype html><html lang="zh-hant"><meta charset="utf-8"><title>hydrate</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="hydrate"><h1 id="hydrate">hydrate</h1><deprecated><p>This API will be removed in a future major version of React.<p>In React 18, <code>hydrate</code> was replaced by <a href="/reference/react-dom/client/hydrateRoot"><code>hydrateRoot</code>.</a> Using <code>hydrate</code> in React 18 will warn that your app will behave as if it’s running React 17. Learn more <a href="/blog/2022/03/08/react-18-upgrade-guide#updates-to-client-rendering-apis">here.</a></p></deprecated><intro><p><code>hydrate</code> lets you display React components inside a browser DOM node whose HTML content was previously generated by <a href="/reference/react-dom/server"><code>react-dom/server</code></a> in React 17 and below.<pre class="language-js"><code class="language-js"><span class="token function">hydrate</span><span class="token punctuation">(</span>reactNode<span class="token punctuation">,</span> domNode<span class="token punctuation">,</span> callback<span class="token operator">?</span><span class="token punctuation">)</span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="reference-reference"><h2 id="reference-reference">Reference {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="hydratereactnode-domnode-callback-hydrate"><h3 id="hydratereactnode-domnode-callback-hydrate"><code>hydrate(reactNode, domNode, callback?)</code> {/<em>hydrate</em>/}</h3><p>Call <code>hydrate</code> in React 17 and below to “attach” React to existing HTML that was already rendered by React in a server environment.<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span>reactNode<span class="token punctuation">,</span> domNode<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>React will attach to the HTML that exists inside the <code>domNode</code>, and take over managing the DOM inside it. An app fully built with React will usually only have one <code>hydrate</code> call with its root component.<p><a href="#usage">See more examples below.</a><section class="level4"aria-labelledby="parameters-parameters"><h4 id="parameters-parameters">Parameters {/<em>parameters</em>/}</h4><ul><li><p><code>reactNode</code>: The "React node" used to render the existing HTML. This will usually be a piece of JSX like <code>&#x3C;App /></code> which was rendered with a <code>ReactDOM Server</code> method such as <code>renderToString(&#x3C;App />)</code> in React 17.<li><p><code>domNode</code>: A <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element">DOM element</a> that was rendered as the root element on the server.<li><p><strong>optional</strong>: <code>callback</code>: A function. If passed, React will call it after your component is hydrated.</ul></section><section class="level4"aria-labelledby="returns-returns"><h4 id="returns-returns">Returns {/<em>returns</em>/}</h4><p><code>hydrate</code> returns null.</section><section class="level4"aria-labelledby="caveats-caveats"><h4 id="caveats-caveats">Caveats {/<em>caveats</em>/}</h4><ul><li><code>hydrate</code> expects the rendered content to be identical with the server-rendered content. React can patch up differences in text content, but you should treat mismatches as bugs and fix them.<li>In development mode, React warns about mismatches during hydration. There are no guarantees that attribute differences will be patched up in case of mismatches. This is important for performance reasons because in most apps, mismatches are rare, and so validating all markup would be prohibitively expensive.<li>You'll likely have only one <code>hydrate</code> call in your app. If you use a framework, it might do this call for you.<li>If your app is client-rendered with no HTML rendered already, using <code>hydrate()</code> is not supported. Use <a href="/reference/react-dom/render">render()</a> (for React 17 and below) or <a href="/reference/react-dom/client/createRoot">createRoot()</a> (for React 18+) instead.</ul></section></section></section><section class="level2"aria-labelledby="usage-usage"><h2 id="usage-usage">Usage {/<em>usage</em>/}</h2><p>Call <code>hydrate</code> to attach a<codestep step="{1}">React component</codestep>into a server-rendered<codestep step="{2}">browser DOM node</codestep>.<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Using <code>hydrate()</code> to render a client-only app (an app without server-rendered HTML) is not supported. Use <a href="/reference/react-dom/render"><code>render()</code></a> (in React 17 and below) or <a href="/reference/react-dom/client/createRoot"><code>createRoot()</code></a> (in React 18+) instead.<section class="level3"aria-labelledby="hydrating-server-rendered-html-hydrating-server-rendered-html"><h3 id="hydrating-server-rendered-html-hydrating-server-rendered-html">Hydrating server-rendered HTML {/<em>hydrating-server-rendered-html</em>/}</h3><p>In React, "hydration" is how React "attaches" to existing HTML that was already rendered by React in a server environment. During hydration, React will attempt to attach event listeners to the existing markup and take over rendering the app on the client.<p>In apps fully built with React, <strong>you will usually only hydrate one "root", once at startup for your entire app</strong>.</p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  HTML content inside &#x3C;div id="root">...&#x3C;/div>
  was generated from App by react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Hello, world!<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Hello</span><span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>Usually you shouldn't need to call <code>hydrate</code> again or to call it in more places. From this point on, React will be managing the DOM of your application. To update the UI, your components will <a href="/reference/react/useState">use state.</a><p>For more information on hydration, see the docs for <a href="/reference/react-dom/client/hydrateRoot"><code>hydrateRoot</code>.</a></section><section class="level3"aria-labelledby="suppressing-unavoidable-hydration-mismatch-errors-suppressing-unavoidable-hydration-mismatch-errors"><h3 id="suppressing-unavoidable-hydration-mismatch-errors-suppressing-unavoidable-hydration-mismatch-errors">Suppressing unavoidable hydration mismatch errors {/<em>suppressing-unavoidable-hydration-mismatch-errors</em>/}</h3><p>If a single element’s attribute or text content is unavoidably different between the server and the client (for example, a timestamp), you may silence the hydration mismatch warning.<p>To silence hydration warnings on an element, add <code>suppressHydrationWarning={true}</code>:</p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  HTML content inside &#x3C;div id="root">...&#x3C;/div>
  was generated from App by react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Current Date: 01/01/2020<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>h1 suppressHydrationWarning<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token maybe-class-name">Current</span> <span class="token known-class-name class-name">Date</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toLocaleDateString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>This only works one level deep, and is intended to be an escape hatch. Don’t overuse it. Unless it’s text content, React still won’t attempt to patch it up, so it may remain inconsistent until future updates.</section><section class="level3"aria-labelledby="handling-different-client-and-server-content-handling-different-client-and-server-content"><h3 id="handling-different-client-and-server-content-handling-different-client-and-server-content">Handling different client and server content {/<em>handling-different-client-and-server-content</em>/}</h3><p>If you intentionally need to render something different on the server and the client, you can do a two-pass rendering. Components that render something different on the client can read a <a href="/reference/react/useState">state variable</a> like <code>isClient</code>, which you can set to <code>true</code> in an <a href="/reference/react/useEffect">effect</a>:</p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  HTML content inside &#x3C;div id="root">...&#x3C;/div>
  was generated from App by react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Is Server<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isClient<span class="token punctuation">,</span> setIsClient<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setIsClient</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>h1<span class="token operator">></span>
      <span class="token punctuation">{</span>isClient <span class="token operator">?</span> <span class="token string">'Is Client'</span> <span class="token operator">:</span> <span class="token string">'Is Server'</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>This way the initial render pass will render the same content as the server, avoiding mismatches, but an additional pass will happen synchronously right after hydration.</p><pitfall><p>This approach makes hydration slower because your components have to render twice. Be mindful of the user experience on slow connections. The JavaScript code may load significantly later than the initial HTML render, so rendering a different UI immediately after hydration may feel jarring to the user.</p></pitfall><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>