<!doctype html><html lang="de"><meta charset="utf-8"><title>"React 19 RC"</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="react-19-rc"><h1 id="react-19-rc">"React 19 RC"</h1><p>author: The React Team date: 2024/04/25 description: React 19 RC is now available on npm! In this post, we'll give an overview of the new features in React 19, and how you can adopt them.<p>April 25, 2024 by <a href="/community/team">The React Team</a></p><intro><p>React 19 RC is now available on npm!</p></intro><p>In our <a href="/blog/2024/04/25/react-19-upgrade-guide">React 19 RC Upgrade Guide</a>, we shared step-by-step instructions for upgrading your app to React 19. In this post, we'll give an overview of the new features in React 19, and how you can adopt them.<ul><li><a href="#whats-new-in-react-19">What's new in React 19</a><li><a href="#improvements-in-react-19">Improvements in React 19</a><li><a href="#how-to-upgrade">How to upgrade</a></ul><p>For a list of breaking changes, see the <a href="/blog/2024/04/25/react-19-upgrade-guide">Upgrade Guide</a>.<section class="level2"aria-labelledby="whats-new-in-react-19-whats-new-in-react-19"><h2 id="whats-new-in-react-19-whats-new-in-react-19">What's new in React 19 {/<em>whats-new-in-react-19</em>/}</h2><section class="level3"aria-labelledby="actions-actions"><h3 id="actions-actions">Actions {/<em>actions</em>/}</h3><p>A common use case in React apps is to perform a data mutation and then update state in response. For example, when a user submits a form to change their name, you will make an API request, and then handle the response. In the past, you would need to handle pending states, errors, optimistic updates, and sequential requests manually.<p>For example, you could handle the pending and error state in <code>useState</code>:<pre class="language-js"><code class="language-js"><span class="token comment">// Before Actions</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">UpdateName</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isPending<span class="token punctuation">,</span> setIsPending<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setIsPending</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">updateName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setIsPending</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 
    <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">"/path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setName</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>isPending<span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Update</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token punctuation">{</span>error <span class="token operator">&#x26;&#x26;</span> <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token punctuation">{</span>error<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>In React 19, we're adding support for using async functions in transitions to handle pending states, errors, forms, and optimistic updates automatically.<p>For example, you can use <code>useTransition</code> to handle the pending state for you:<pre class="language-js"><code class="language-js"><span class="token comment">// Using pending state from Actions</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">UpdateName</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isPending<span class="token punctuation">,</span> startTransition<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useTransition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">updateName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> 
      <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">"/path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setName</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>isPending<span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Update</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token punctuation">{</span>error <span class="token operator">&#x26;&#x26;</span> <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token punctuation">{</span>error<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>The async transition will immediately set the <code>isPending</code> state to true, make the async request(s), and switch <code>isPending</code> to false after any transitions. This allows you to keep the current UI responsive and interactive while the data is changing.</p><note><section class="level4"aria-labelledby="by-convention-functions-that-use-async-transitions-are-called-actions-by-convention-functions-that-use-async-transitions-are-called-actions"><h4 id="by-convention-functions-that-use-async-transitions-are-called-actions-by-convention-functions-that-use-async-transitions-are-called-actions">By convention, functions that use async transitions are called "Actions". {/<em>by-convention-functions-that-use-async-transitions-are-called-actions</em>/}</h4><p>Actions automatically manage submitting data for you:<ul><li><strong>Pending state</strong>: Actions provide a pending state that starts at the beginning of a request and automatically resets when the final state update is committed.<li><strong>Optimistic updates</strong>: Actions support the new <a href="#new-hook-optimistic-updates"><code>useOptimistic</code></a> hook so you can show users instant feedback while the requests are submitting.<li><strong>Error handling</strong>: Actions provide error handling so you can display Error Boundaries when a request fails, and revert optimistic updates to their original value automatically.<li><strong>Forms</strong>: <code>&#x3C;form></code> elements now support passing functions to the <code>action</code> and <code>formAction</code> props. Passing functions to the <code>action</code> props use Actions by default and reset the form automatically after submission.</ul></section></note><p>Building on top of Actions, React 19 introduces <a href="#new-hook-optimistic-updates"><code>useOptimistic</code></a> to manage optimistic updates, and a new hook <a href="#new-hook-useactionstate"><code>React.useActionState</code></a> to handle common cases for Actions. In <code>react-dom</code> we're adding <a href="#form-actions"><code>&#x3C;form></code> Actions</a> to manage forms automatically and <a href="#new-hook-useformstatus"><code>useFormStatus</code></a> to support the common cases for Actions in forms.<p>In React 19, the above example can be simplified to:<pre class="language-js"><code class="language-js"><span class="token comment">// Using &#x3C;form> Actions and useActionState</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChangeName</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> setName <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> submitAction<span class="token punctuation">,</span> isPending<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useActionState</span><span class="token punctuation">(</span>
    <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">previousState<span class="token punctuation">,</span> formData</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">updateName</span><span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> error<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">"/path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">return</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submitAction<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"name"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button type<span class="token operator">=</span><span class="token string">"submit"</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>isPending<span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Update</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token punctuation">{</span>error <span class="token operator">&#x26;&#x26;</span> <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token punctuation">{</span>error<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>In the next section, we'll break down each of the new Action features in React 19.</section><section class="level3"aria-labelledby="new-hook-useactionstate-new-hook-useactionstate"><h3 id="new-hook-useactionstate-new-hook-useactionstate">New hook: <code>useActionState</code> {/<em>new-hook-useactionstate</em>/}</h3><p>To make the common cases easier for Actions, we've added a new hook called <code>useActionState</code>:<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> submitAction<span class="token punctuation">,</span> isPending<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useActionState</span><span class="token punctuation">(</span>
  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">previousState<span class="token punctuation">,</span> newName</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">updateName</span><span class="token punctuation">(</span>newName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// You can return any result of the action.</span>
      <span class="token comment">// Here, we return only the error.</span>
      <span class="token keyword control-flow">return</span> error<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// handle success</span>
    <span class="token keyword control-flow">return</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>useActionState</code> accepts a function (the "Action"), and returns a wrapped Action to call. This works because Actions compose. When the wrapped Action is called, <code>useActionState</code> will return the last result of the Action as <code>data</code>, and the pending state of the Action as <code>pending</code>.</p><note><p><code>React.useActionState</code> was previously called <code>ReactDOM.useFormState</code> in the Canary releases, but we've renamed it and deprecated <code>useFormState</code>.<p>See <a href="https://github.com/facebook/react/pull/28491">#28491</a> for more info.</p></note><p>For more information, see the docs for <a href="/reference/react/useActionState"><code>useActionState</code></a>.</section><section class="level3"aria-labelledby="react-dom--actions-form-actions"><h3 id="react-dom--actions-form-actions">React DOM: <code>&#x3C;form></code> Actions {/<em>form-actions</em>/}</h3><p>Actions are also integrated with React 19's new <code>&#x3C;form></code> features for <code>react-dom</code>. We've added support for passing functions as the <code>action</code> and <code>formAction</code> props of <code>&#x3C;form></code>, <code>&#x3C;input></code>, and <code>&#x3C;button></code> elements to automatically submit forms with Actions:<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>actionFunction<span class="token punctuation">}</span><span class="token operator">></span></code></pre><p>When a <code>&#x3C;form></code> Action succeeds, React will automatically reset the form for uncontrolled components. If you need to reset the <code>&#x3C;form></code> manually, you can call the new <code>requestFormReset</code> React DOM API.<p>For more information, see the <code>react-dom</code> docs for <a href="/reference/react-dom/components/form"><code>&#x3C;form></code></a>, <a href="/reference/react-dom/components/input"><code>&#x3C;input></code></a>, and <code>&#x3C;button></code>.</section><section class="level3"aria-labelledby="react-dom-new-hook-useformstatus-new-hook-useformstatus"><h3 id="react-dom-new-hook-useformstatus-new-hook-useformstatus">React DOM: New hook: <code>useFormStatus</code> {/<em>new-hook-useformstatus</em>/}</h3><p>In design systems, it's common to write design components that need access to information about the <code>&#x3C;form></code> they're in, without drilling props down to the component. This can be done via Context, but to make the common case easier, we've added a new hook <code>useFormStatus</code>:<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>useFormStatus<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">DesignButton</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>pending<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button type<span class="token operator">=</span><span class="token string">"submit"</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>pending<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">}</span></code></pre><p><code>useFormStatus</code> reads the status of the parent <code>&#x3C;form></code> as if the form was a Context provider.<p>For more information, see the <code>react-dom</code> docs for <a href="/reference/react-dom/hooks/useFormStatus"><code>useFormStatus</code></a>.</section><section class="level3"aria-labelledby="new-hook-useoptimistic-new-hook-optimistic-updates"><h3 id="new-hook-useoptimistic-new-hook-optimistic-updates">New hook: <code>useOptimistic</code> {/<em>new-hook-optimistic-updates</em>/}</h3><p>Another common UI pattern when performing a data mutation is to show the final state optimistically while the async request is underway. In React 19, we're adding a new hook called <code>useOptimistic</code> to make this easier:<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChangeName</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>currentName<span class="token punctuation">,</span> onUpdateName<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>optimisticName<span class="token punctuation">,</span> setOptimisticName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useOptimistic</span><span class="token punctuation">(</span>currentName<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">submitAction</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token parameter">formData</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newName <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setOptimisticName</span><span class="token punctuation">(</span>newName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> updatedName <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">updateName</span><span class="token punctuation">(</span>newName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onUpdateName</span><span class="token punctuation">(</span>updatedName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submitAction<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">Your</span> name is<span class="token operator">:</span> <span class="token punctuation">{</span>optimisticName<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span><span class="token maybe-class-name">Change</span> <span class="token maybe-class-name">Name</span><span class="token operator">:</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input
          type<span class="token operator">=</span><span class="token string">"text"</span>
          name<span class="token operator">=</span><span class="token string">"name"</span>
          disabled<span class="token operator">=</span><span class="token punctuation">{</span>currentName <span class="token operator">!==</span> optimisticName<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>The <code>useOptimistic</code> hook will immediately render the <code>optimisticName</code> while the <code>updateName</code> request is in progress. When the update finishes or errors, React will automatically switch back to the <code>currentName</code> value.<p>For more information, see the docs for <a href="/reference/react/useOptimistic"><code>useOptimistic</code></a>.</section><section class="level3"aria-labelledby="new-api-use-new-feature-use"><h3 id="new-api-use-new-feature-use">New API: <code>use</code> {/<em>new-feature-use</em>/}</h3><p>In React 19 we're introducing a new API to read resources in render: <code>use</code>.<p>For example, you can read a promise with <code>use</code>, and React will Suspend until the promise resolves:<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>use<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Comments</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>commentsPromise<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// `use` will suspend until the promise resolves.</span>
  <span class="token keyword">const</span> comments <span class="token operator">=</span> <span class="token function">use</span><span class="token punctuation">(</span>commentsPromise<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> comments<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">comment</span> <span class="token arrow operator">=></span> <span class="token operator">&#x3C;</span>p key<span class="token operator">=</span><span class="token punctuation">{</span>comment<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>comment<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Page</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>commentsPromise<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// When `use` suspends in Comments,</span>
  <span class="token comment">// this Suspense boundary will be shown.</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Suspense</span> fallback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&#x3C;</span>div<span class="token operator">></span><span class="token maybe-class-name">Loading</span><span class="token spread operator">...</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Comments</span> commentsPromise<span class="token operator">=</span><span class="token punctuation">{</span>commentsPromise<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Suspense</span><span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><note><section class="level4"aria-labelledby="use-does-not-support-promises-created-in-render-use-does-not-support-promises-created-in-render"><h4 id="use-does-not-support-promises-created-in-render-use-does-not-support-promises-created-in-render"><code>use</code> does not support promises created in render. {/<em>use-does-not-support-promises-created-in-render</em>/}</h4><p>If you try to pass a promise created in render to <code>use</code>, React will warn:</p><consoleblockmulti><consolelogline level="error"><p>A component was suspended by an uncached promise. Creating promises inside a Client Component or hook is not yet supported, except via a Suspense-compatible library or framework.</p></consolelogline></consoleblockmulti><p>To fix, you need to pass a promise from a suspense powered library or framework that supports caching for promises. In the future we plan to ship features to make it easier to cache promises in render.</section></note><p>You can also read context with <code>use</code>, allowing you to read Context conditionally such as after early returns:<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>use<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ThemeContext</span></span> <span class="token keyword module">from</span> <span class="token string">'./ThemeContext'</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Heading</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>children<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>children <span class="token operator">==</span> <span class="token keyword null nil">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// This would not work with useContext</span>
  <span class="token comment">// because of the early return.</span>
  <span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token maybe-class-name">ThemeContext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>h1 style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">color</span><span class="token operator">:</span> theme<span class="token punctuation">.</span><span class="token property-access">color</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token punctuation">{</span>children<span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>The <code>use</code> API can only be called in render, similar to hooks. Unlike hooks, <code>use</code> can be called conditionally. In the future we plan to support more ways to consume resources in render with <code>use</code>.<p>For more information, see the docs for <a href="/reference/react/use"><code>use</code></a>.</section></section><section class="level2"aria-labelledby="react-server-components-react-server-components"><h2 id="react-server-components-react-server-components">React Server Components {/<em>react-server-components</em>/}</h2><section class="level3"aria-labelledby="server-components-server-components"><h3 id="server-components-server-components">Server Components {/<em>server-components</em>/}</h3><p>Server Components are a new option that allows rendering components ahead of time, before bundling, in an environment separate from your client application or SSR server. This separate environment is the "server" in React Server Components. Server Components can run once at build time on your CI server, or they can be run for each request using a web server.<p>React 19 includes all of the React Server Components features included from the Canary channel. This means libraries that ship with Server Components can now target React 19 as a peer dependency with a <code>react-server</code> <a href="https://github.com/reactjs/rfcs/blob/main/text/0227-server-module-conventions.md#react-server-conditional-exports">export condition</a> for use in frameworks that support the <a href="/learn/start-a-new-react-project#which-features-make-up-the-react-teams-full-stack-architecture-vision">Full-stack React Architecture</a>.</p><note><section class="level4"aria-labelledby="how-do-i-build-support-for-server-components-how-do-i-build-support-for-server-components"><h4 id="how-do-i-build-support-for-server-components-how-do-i-build-support-for-server-components">How do I build support for Server Components? {/<em>how-do-i-build-support-for-server-components</em>/}</h4><p>While React Server Components in React 19 are stable and will not break between major versions, the underlying APIs used to implement a React Server Components bundler or framework do not follow semver and may break between minors in React 19.x.<p>To support React Server Components as a bundler or framework, we recommend pinning to a specific React version, or using the Canary release. We will continue working with bundlers and frameworks to stabilize the APIs used to implement React Server Components in the future.</section></note><p>For more, see the docs for <a href="/reference/rsc/server-components">React Server Components</a>.</section><section class="level3"aria-labelledby="server-actions-server-actions"><h3 id="server-actions-server-actions">Server Actions {/<em>server-actions</em>/}</h3><p>Server Actions allow Client Components to call async functions executed on the server.<p>When a Server Action is defined with the <code>"use server"</code> directive, your framework will automatically create a reference to the server function, and pass that reference to the Client Component. When that function is called on the client, React will send a request to the server to execute the function, and return the result.</p><note><section class="level4"aria-labelledby="there-is-no-directive-for-server-components-there-is-no-directive-for-server-components"><h4 id="there-is-no-directive-for-server-components-there-is-no-directive-for-server-components">There is no directive for Server Components. {/<em>there-is-no-directive-for-server-components</em>/}</h4><p>A common misunderstanding is that Server Components are denoted by <code>"use server"</code>, but there is no directive for Server Components. The <code>"use server"</code> directive is used for Server Actions.<p>For more info, see the docs for <a href="/reference/rsc/directives">Directives</a>.</section></note><p>Server Actions can be created in Server Components and passed as props to Client Components, or they can be imported and used in Client Components.<p>For more, see the docs for <a href="/reference/rsc/server-actions">React Server Actions</a>.</section></section><section class="level2"aria-labelledby="improvements-in-react-19-improvements-in-react-19"><h2 id="improvements-in-react-19-improvements-in-react-19">Improvements in React 19 {/<em>improvements-in-react-19</em>/}</h2><section class="level3"aria-labelledby="ref-as-a-prop-ref-as-a-prop"><h3 id="ref-as-a-prop-ref-as-a-prop"><code>ref</code> as a prop {/<em>ref-as-a-prop</em>/}</h3><p>Starting in React 19, you can now access <code>ref</code> as a prop for function components:<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyInput</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>placeholder<span class="token punctuation">,</span> ref<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>input placeholder<span class="token operator">=</span><span class="token punctuation">{</span>placeholder<span class="token punctuation">}</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">}</span>

<span class="token comment">//...</span>
<span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyInput</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code></pre><p>New function components will no longer need <code>forwardRef</code>, and we will be publishing a codemod to automatically update your components to use the new <code>ref</code> prop. In future versions we will deprecate and remove <code>forwardRef</code>.</p><note><p><code>refs</code> passed to classes are not passed as props since they reference the component instance.</p></note></section><section class="level3"aria-labelledby="diffs-for-hydration-errors-diffs-for-hydration-errors"><h3 id="diffs-for-hydration-errors-diffs-for-hydration-errors">Diffs for hydration errors {/<em>diffs-for-hydration-errors</em>/}</h3><p>We also improved error reporting for hydration errors in <code>react-dom</code>. For example, instead of logging multiple errors in DEV without any information about the mismatch:</p><consoleblockmulti><consolelogline level="error"><p>Warning: Text content did not match. Server: "Server" Client: "Client" {' '}at span {' '}at App</p></consolelogline><consolelogline level="error"><p>Warning: An error occurred during hydration. The server HTML was replaced with client content in &#x3C;div>.</p></consolelogline><consolelogline level="error"><p>Warning: Text content did not match. Server: "Server" Client: "Client" {' '}at span {' '}at App</p></consolelogline><consolelogline level="error"><p>Warning: An error occurred during hydration. The server HTML was replaced with client content in &#x3C;div>.</p></consolelogline><consolelogline level="error"><p>Uncaught Error: Text content does not match server-rendered HTML. {' '}at checkForUnmatchedText {' '}...</p></consolelogline></consoleblockmulti><p>We now log a single message with a diff of the mismatch:</p><consoleblockmulti><consolelogline level="error"><p>Uncaught Error: Hydration failed because the server rendered HTML didn't match the client. As a result this tree will be regenerated on the client. This can happen if an SSR-ed Client Component used:{'\n'} - A server/client branch <code>if (typeof window !== 'undefined')</code>. - Variable input such as <code>Date.now()</code> or <code>Math.random()</code> which changes each time it's called. - Date formatting in a user's locale which doesn't match the server. - External changing data without sending a snapshot of it along with the HTML. - Invalid HTML tag nesting.{'\n'} It can also happen if the client has a browser extension installed which messes with the HTML before React loaded.{'\n'} <a href="https://react.dev/link/hydration-mismatch">https://react.dev/link/hydration-mismatch</a> {'\n'} {' '}&#x3C;App> {' '}&#x3C;span> {'+ '}Client {'- '}Server{'\n'} {' '}at throwOnHydrationMismatch {' '}...</p></consolelogline></consoleblockmulti></section><section class="level3"aria-labelledby="-as-a-provider-context-as-a-provider"><h3 id="-as-a-provider-context-as-a-provider"><code>&#x3C;Context></code> as a provider {/<em>context-as-a-provider</em>/}</h3><p>In React 19, you can render <code>&#x3C;Context></code> as a provider instead of <code>&#x3C;Context.Provider></code>:<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token maybe-class-name">ThemeContext</span> <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>children<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ThemeContext</span> value<span class="token operator">=</span><span class="token string">"dark"</span><span class="token operator">></span>
      <span class="token punctuation">{</span>children<span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">ThemeContext</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span></code></pre><p>New Context providers can use <code>&#x3C;Context></code> and we will be publishing a codemod to convert existing providers. In future versions we will deprecate <code>&#x3C;Context.Provider></code>.</section><section class="level3"aria-labelledby="cleanup-functions-for-refs-cleanup-functions-for-refs"><h3 id="cleanup-functions-for-refs-cleanup-functions-for-refs">Cleanup functions for refs {/<em>cleanup-functions-for-refs</em>/}</h3><p>We now support returning a cleanup function from <code>ref</code> callbacks:<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span>input
  ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">ref</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// ref created</span>

    <span class="token comment">// NEW: return a cleanup function to reset</span>
    <span class="token comment">// the ref when element is removed from DOM.</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// ref cleanup</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">/</span><span class="token operator">></span></code></pre><p>When the component unmounts, React will call the cleanup function returned from the <code>ref</code> callback. This works for DOM refs, refs to class components, and <code>useImperativeHandle</code>.</p><note><p>Previously, React would call <code>ref</code> functions with <code>null</code> when unmounting the component. If your <code>ref</code> returns a cleanup function, React will now skip this step.<p>In future versions, we will deprecate calling refs with <code>null</code> when unmounting components.</p></note><p>Due to the introduction of ref cleanup functions, returning anything else from a <code>ref</code> callback will now be rejected by TypeScript. The fix is usually to stop using implicit returns, for example:<pre class="language-diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> &#x3C;div ref={current => (instance = current)} />
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> &#x3C;div ref={current => {instance = current}} /></span></span></code></pre><p>The original code returned the instance of the <code>HTMLDivElement</code> and TypeScript wouldn't know if this was <em>supposed</em> to be a cleanup function or if you didn't want to return a cleanup function.<p>You can codemod this pattern with <a href="https://github.com/eps1lon/types-react-codemod/#no-implicit-ref-callback-return"><code>no-implicit-ref-callback-return</code></a>.</section><section class="level3"aria-labelledby="usedeferredvalue-initial-value-use-deferred-value-initial-value"><h3 id="usedeferredvalue-initial-value-use-deferred-value-initial-value"><code>useDeferredValue</code> initial value {/<em>use-deferred-value-initial-value</em>/}</h3><p>We've added an <code>initialValue</code> option to <code>useDeferredValue</code>:<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Search</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>deferredValue<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// On initial render the value is ''.</span>
  <span class="token comment">// Then a re-render is scheduled with the deferredValue.</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">useDeferredValue</span><span class="token punctuation">(</span>deferredValue<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Results</span> query<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>When<codestep step="{2}">initialValue</codestep>is provided, <code>useDeferredValue</code> will return it as <code>value</code> for the initial render of the component, and schedules a re-render in the background with the<codestep step="{1}">deferredValue</codestep>returned.<p>For more, see <a href="/reference/react/useDeferredValue"><code>useDeferredValue</code></a>.</section><section class="level3"aria-labelledby="support-for-document-metadata-support-for-metadata-tags"><h3 id="support-for-document-metadata-support-for-metadata-tags">Support for Document Metadata {/<em>support-for-metadata-tags</em>/}</h3><p>In HTML, document metadata tags like <code>&#x3C;title></code>, <code>&#x3C;link></code>, and <code>&#x3C;meta></code> are reserved for placement in the <code>&#x3C;head></code> section of the document. In React, the component that decides what metadata is appropriate for the app may be very far from the place where you render the <code>&#x3C;head></code> or React does not render the <code>&#x3C;head></code> at all. In the past, these elements would need to be inserted manually in an effect, or by libraries like <a href="https://github.com/nfl/react-helmet"><code>react-helmet</code></a>, and required careful handling when server rendering a React application.<p>In React 19, we're adding support for rendering document metadata tags in components natively:<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">BlogPost</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>post<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>article<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>title<span class="token operator">></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>title<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>meta name<span class="token operator">=</span><span class="token string">"author"</span> content<span class="token operator">=</span><span class="token string">"Josh"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>link rel<span class="token operator">=</span><span class="token string">"author"</span> href<span class="token operator">=</span><span class="token string">"https://twitter.com/joshcstory/"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>meta name<span class="token operator">=</span><span class="token string">"keywords"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>post<span class="token punctuation">.</span><span class="token property-access">keywords</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span>
        <span class="token maybe-class-name">Eee</span> equals em<span class="token operator">-</span>see<span class="token operator">-</span>squared<span class="token spread operator">...</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>article<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>When React renders this component, it will see the <code>&#x3C;title></code> <code>&#x3C;link></code> and <code>&#x3C;meta></code> tags, and automatically hoist them to the <code>&#x3C;head></code> section of document. By supporting these metadata tags natively, we're able to ensure they work with client-only apps, streaming SSR, and Server Components.</p><note><section class="level4"aria-labelledby="you-may-still-want-a-metadata-library-you-may-still-want-a-metadata-library"><h4 id="you-may-still-want-a-metadata-library-you-may-still-want-a-metadata-library">You may still want a Metadata library {/<em>you-may-still-want-a-metadata-library</em>/}</h4><p>For simple use cases, rendering Document Metadata as tags may be suitable, but libraries can offer more powerful features like overriding generic metadata with specific metadata based on the current route. These features make it easier for frameworks and libraries like <a href="https://github.com/nfl/react-helmet"><code>react-helmet</code></a> to support metadata tags, rather than replace them.</section></note><p>For more info, see the docs for <a href="/reference/react-dom/components/title"><code>&#x3C;title></code></a>, <a href="/reference/react-dom/components/link"><code>&#x3C;link></code></a>, and <a href="/reference/react-dom/components/meta"><code>&#x3C;meta></code></a>.</section><section class="level3"aria-labelledby="support-for-stylesheets-support-for-stylesheets"><h3 id="support-for-stylesheets-support-for-stylesheets">Support for stylesheets {/<em>support-for-stylesheets</em>/}</h3><p>Stylesheets, both externally linked (<code>&#x3C;link rel="stylesheet" href="..."></code>) and inline (<code>&#x3C;style>...&#x3C;/style></code>), require careful positioning in the DOM due to style precedence rules. Building a stylesheet capability that allows for composability within components is hard, so users often end up either loading all of their styles far from the components that may depend on them, or they use a style library which encapsulates this complexity.<p>In React 19, we're addressing this complexity and providing even deeper integration into Concurrent Rendering on the Client and Streaming Rendering on the Server with built in support for stylesheets. If you tell React the <code>precedence</code> of your stylesheet it will manage the insertion order of the stylesheet in the DOM and ensure that the stylesheet (if external) is loaded before revealing content that depends on those style rules.<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ComponentOne</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Suspense</span> fallback<span class="token operator">=</span><span class="token string">"loading..."</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"foo"</span> precedence<span class="token operator">=</span><span class="token string">"default"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"bar"</span> precedence<span class="token operator">=</span><span class="token string">"high"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>article <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"foo-class bar-class"</span><span class="token operator">></span>
        <span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>article<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Suspense</span><span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ComponentTwo</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"baz"</span> precedence<span class="token operator">=</span><span class="token string">"default"</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&#x3C;</span><span class="token operator">--</span> will be inserted between foo <span class="token operator">&#x26;</span> bar
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p>During Server Side Rendering React will include the stylesheet in the <code>&#x3C;head></code>, which ensures that the browser will not paint until it has loaded. If the stylesheet is discovered late after we've already started streaming, React will ensure that the stylesheet is inserted into the <code>&#x3C;head></code> on the client before revealing the content of a Suspense boundary that depends on that stylesheet.<p>During Client Side Rendering React will wait for newly rendered stylesheets to load before committing the render. If you render this component from multiple places within your application React will only include the stylesheet once in the document:<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ComponentOne</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token spread operator">...</span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ComponentOne</span> <span class="token operator">/</span><span class="token operator">></span> <span class="token comment">// won't lead to a duplicate stylesheet link in the DOM</span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">}</span></code></pre><p>For users accustomed to loading stylesheets manually this is an opportunity to locate those stylesheets alongside the components that depend on them allowing for better local reasoning and an easier time ensuring you only load the stylesheets that you actually depend on.<p>Style libraries and style integrations with bundlers can also adopt this new capability so even if you don't directly render your own stylesheets, you can still benefit as your tools are upgraded to use this feature.<p>For more details, read the docs for <a href="/reference/react-dom/components/link"><code>&#x3C;link></code></a> and <a href="/reference/react-dom/components/style"><code>&#x3C;style></code></a>.</section><section class="level3"aria-labelledby="support-for-async-scripts-support-for-async-scripts"><h3 id="support-for-async-scripts-support-for-async-scripts">Support for async scripts {/<em>support-for-async-scripts</em>/}</h3><p>In HTML normal scripts (<code>&#x3C;script src="..."></code>) and deferred scripts (<code>&#x3C;script defer="" src="..."></code>) load in document order which makes rendering these kinds of scripts deep within your component tree challenging. Async scripts (<code>&#x3C;script async="" src="..."></code>) however will load in arbitrary order.<p>In React 19 we've included better support for async scripts by allowing you to render them anywhere in your component tree, inside the components that actually depend on the script, without having to manage relocating and deduplicating script instances.<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>script async<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> src<span class="token operator">=</span><span class="token string">"..."</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token maybe-class-name">Hello</span> <span class="token maybe-class-name">World</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">&#x3C;</span>html<span class="token operator">></span>
    <span class="token operator">&#x3C;</span>body<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyComponent</span><span class="token operator">></span>
      <span class="token spread operator">...</span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyComponent</span><span class="token operator">></span> <span class="token comment">// won't lead to duplicate script in the DOM</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>body<span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span>html<span class="token operator">></span>
<span class="token punctuation">}</span></code></pre><p>In all rendering environments, async scripts will be deduplicated so that React will only load and execute the script once even if it is rendered by multiple different components.<p>In Server Side Rendering, async scripts will be included in the <code>&#x3C;head></code> and prioritized behind more critical resources that block paint such as stylesheets, fonts, and image preloads.<p>For more details, read the docs for <a href="/reference/react-dom/components/script"><code>&#x3C;script></code></a>.</section><section class="level3"aria-labelledby="support-for-preloading-resources-support-for-preloading-resources"><h3 id="support-for-preloading-resources-support-for-preloading-resources">Support for preloading resources {/<em>support-for-preloading-resources</em>/}</h3><p>During initial document load and on client side updates, telling the Browser about resources that it will likely need to load as early as possible can have a dramatic effect on page performance.<p>React 19 includes a number of new APIs for loading and preloading Browser resources to make it as easy as possible to build great experiences that aren't held back by inefficient resource loading.<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> prefetchDNS<span class="token punctuation">,</span> preconnect<span class="token punctuation">,</span> preload<span class="token punctuation">,</span> preinit <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">preinit</span><span class="token punctuation">(</span><span class="token string">'https://.../path/to/some/script.js'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token keyword module">as</span><span class="token operator">:</span> <span class="token string">'script'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// loads and executes this script eagerly</span>
  <span class="token function">preload</span><span class="token punctuation">(</span><span class="token string">'https://.../path/to/font.woff'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword module">as</span><span class="token operator">:</span> <span class="token string">'font'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// preloads this font</span>
  <span class="token function">preload</span><span class="token punctuation">(</span><span class="token string">'https://.../path/to/stylesheet.css'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword module">as</span><span class="token operator">:</span> <span class="token string">'style'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// preloads this stylesheet</span>
  <span class="token function">prefetchDNS</span><span class="token punctuation">(</span><span class="token string">'https://...'</span><span class="token punctuation">)</span> <span class="token comment">// when you may not actually request anything from this host</span>
  <span class="token function">preconnect</span><span class="token punctuation">(</span><span class="token string">'https://...'</span><span class="token punctuation">)</span> <span class="token comment">// when you will request something but aren't sure what</span>
<span class="token punctuation">}</span></code></pre><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!-- the above would result in the following DOM/HTML --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
    <span class="token comment">&#x3C;!-- links/scripts are prioritized by their utility to early loading, not call order --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prefetch-dns<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://...<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>preconnect<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://...<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>preload<span class="token punctuation">"</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>font<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://.../path/to/font.woff<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>preload<span class="token punctuation">"</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>style<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://.../path/to/stylesheet.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">async</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://.../path/to/some/script.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    ...
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>These APIs can be used to optimize initial page loads by moving discovery of additional resources like fonts out of stylesheet loading. They can also make client updates faster by prefetching a list of resources used by an anticipated navigation and then eagerly preloading those resources on click or even on hover.<p>For more details see <a href="/reference/react-dom#resource-preloading-apis">Resource Preloading APIs</a>.</section><section class="level3"aria-labelledby="compatibility-with-third-party-scripts-and-extensions-compatibility-with-third-party-scripts-and-extensions"><h3 id="compatibility-with-third-party-scripts-and-extensions-compatibility-with-third-party-scripts-and-extensions">Compatibility with third-party scripts and extensions {/<em>compatibility-with-third-party-scripts-and-extensions</em>/}</h3><p>We've improved hydration to account for third-party scripts and browser extensions.<p>When hydrating, if an element that renders on the client doesn't match the element found in the HTML from the server, React will force a client re-render to fix up the content. Previously, if an element was inserted by third-party scripts or browser extensions, it would trigger a mismatch error and client render.<p>In React 19, unexpected tags in the <code>&#x3C;head></code> and <code>&#x3C;body></code> will be skipped over, avoiding the mismatch errors. If React needs to re-render the entire document due to an unrelated hydration mismatch, it will leave in place stylesheets inserted by third-party scripts and browser extensions.</section><section class="level3"aria-labelledby="better-error-reporting-error-handling"><h3 id="better-error-reporting-error-handling">Better error reporting {/<em>error-handling</em>/}</h3><p>We improved error handling in React 19 to remove duplication and provide options for handling caught and uncaught errors. For example, when there's an error in render caught by an Error Boundary, previously React would throw the error twice (once for the original error, then again after failing to automatically recover), and then call <code>console.error</code> with info about where the error occurred.<p>This resulted in three errors for every caught error:</p><consoleblockmulti><consolelogline level="error"><p>Uncaught Error: hit {' '}at Throws {' '}at renderWithHooks {' '}...</p></consolelogline><consolelogline level="error"><p>Uncaught Error: hit<span class="ms-2 text-gray-30">{' &#x3C;--'} Duplicate</span> {' '}at Throws {' '}at renderWithHooks {' '}...</p></consolelogline><consolelogline level="error"><p>The above error occurred in the Throws component: {' '}at Throws {' '}at ErrorBoundary {' '}at App{'\n'} React will try to recreate this component tree from scratch using the error boundary you provided, ErrorBoundary.</p></consolelogline></consoleblockmulti><p>In React 19, we log a single error with all the error information included:</p><consoleblockmulti><consolelogline level="error"><p>Error: hit {' '}at Throws {' '}at renderWithHooks {' '}...{'\n'} The above error occurred in the Throws component: {' '}at Throws {' '}at ErrorBoundary {' '}at App{'\n'} React will try to recreate this component tree from scratch using the error boundary you provided, ErrorBoundary. {' '}at ErrorBoundary {' '}at App</p></consolelogline></consoleblockmulti><p>Additionally, we've added two new root options to complement <code>onRecoverableError</code>:<ul><li><code>onCaughtError</code>: called when React catches an error in an Error Boundary.<li><code>onUncaughtError</code>: called when an error is thrown and not caught by an Error Boundary.<li><code>onRecoverableError</code>: called when an error is thrown and automatically recovered.</ul><p>For more info and examples, see the docs for <a href="/reference/react-dom/client/createRoot"><code>createRoot</code></a> and <a href="/reference/react-dom/client/hydrateRoot"><code>hydrateRoot</code></a>.</section><section class="level3"aria-labelledby="support-for-custom-elements-support-for-custom-elements"><h3 id="support-for-custom-elements-support-for-custom-elements">Support for Custom Elements {/<em>support-for-custom-elements</em>/}</h3><p>React 19 adds full support for custom elements and passes all tests on <a href="https://custom-elements-everywhere.com/">Custom Elements Everywhere</a>.<p>In past versions, using Custom Elements in React has been difficult because React treated unrecognized props as attributes rather than properties. In React 19, we've added support for properties that works on the client and during SSR with the following strategy:<ul><li><strong>Server Side Rendering</strong>: props passed to a custom element will render as attributes if their type is a primitive value like <code>string</code>, <code>number</code>, or the value is <code>true</code>. Props with non-primitive types like <code>object</code>, <code>symbol</code>, <code>function</code>, or value <code>false</code> will be omitted.<li><strong>Client Side Rendering</strong>: props that match a property on the Custom Element instance will be assigned as properties, otherwise they will be assigned as attributes.</ul><p>Thanks to <a href="https://github.com/josepharhar">Joey Arhar</a> for driving the design and implementation of Custom Element support in React.<section class="level4"aria-labelledby="how-to-upgrade-how-to-upgrade"><h4 id="how-to-upgrade-how-to-upgrade">How to upgrade {/<em>how-to-upgrade</em>/}</h4><p>See the <a href="/blog/2024/04/25/react-19-upgrade-guide">React 19 Upgrade Guide</a> for step-by-step instructions and a full list of breaking and notable changes.<p><span style="float:footnote"><a href="../../../../index.html#toc">Go to TOC</a></span></section></section></section></section>