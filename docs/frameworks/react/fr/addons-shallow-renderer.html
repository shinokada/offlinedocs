<!doctypehtml><html lang="fr"><meta charset="utf-8"><title>Moteur de rendu superficiel</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="moteur-de-rendu-superficiel"class="level1"><h1>Moteur de rendu superficiel</h1><p><strong>Importation</strong><pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ShallowRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer/shallow'</span><span class="token punctuation">;</span> <span class="token comment">// ES6</span>
<span class="token keyword">var</span> <span class="token maybe-class-name">ShallowRenderer</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react-test-renderer/shallow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ES5 avec npm</span></code></pre><section id="overview"class="level2"><h2>Aperçu</h2><p>Quand on écrit des tests unitaires pour React, le rendu superficiel peut être utile. Le rendu superficiel vous permet de réaliser le rendu d'un composant « à un seul niveau de profondeur » afin de pouvoir vérifier ce que renvoie sa fonction de rendu, sans vous préoccuper des composants enfants, qui ne sont pas sollicités. Ça ne nécessite donc pas de DOM.<p>Par exemple, si vous avez le composant suivant :<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>span className<span class="token operator">=</span><span class="token string">"heading"</span><span class="token operator">></span><span class="token maybe-class-name">Titre</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Subcomponent</span> foo<span class="token operator">=</span><span class="token string">"bar"</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Vous pouvez alors faire les vérifications suivantes :<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ShallowRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer/shallow'</span><span class="token punctuation">;</span>

<span class="token comment">// dans votre test :</span>
<span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ShallowRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyComponent</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> renderer<span class="token punctuation">.</span><span class="token method function property-access">getRenderOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token property-access">type</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token operator">&#x3C;</span>span className<span class="token operator">=</span><span class="token string">"heading"</span><span class="token operator">></span><span class="token maybe-class-name">Titre</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">,</span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Subcomponent</span> foo<span class="token operator">=</span><span class="token string">"bar"</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Le rendu superficiel a pour le moment quelques limites, notamment l'absence de prise en charge des refs.<blockquote><p>Note:<p>Nous vous conseillons par ailleurs de regarder <a href="http://airbnb.io/enzyme/docs/api/shallow.html">l'API de rendu superficiel</a> (en anglais) d'Enzyme. Elle propose une meilleure API de haut niveau pour ce type de fonctionnalité.</blockquote></section><section id="reference"class="level2"><h2>Référence de l'API</h2><section id="shallowrendererrender-shallowrendererrender"class="level3"><h3><code>shallowRenderer.render()</code> {#shallowrendererrender}</h3><p>Vous pouvez voir le <code>shallowRenderer</code> comme un « endroit » dans lequel faire le rendu du composant que vous testez, et depuis lequel vous pouvez extraire la sortie que ce composant produit.<p><code>shallowRenderer.render()</code> est similaire à <a href="./react-dom.html#render"><code>ReactDOM.render()</code></a>, à ceci près qu'elle n'a pas besoin du DOM et n’effectue le rendu qu’à un seul niveau de profondeur. Ça signifie que vous pouvez tester des composants indépendamment de l'implémentation de leurs enfants.</section><section id="shallowrenderergetrenderoutput-shallowrenderergetrenderoutput"class="level3"><h3><code>shallowRenderer.getRenderOutput()</code> {#shallowrenderergetrenderoutput}</h3><p>Après avoir appelé <code>shallowRenderer.render()</code>, vous pouvez utiliser <code>shallowRenderer.getRenderOutput()</code> pour récupérer le rendu superficiel obtenu.<p>Vous pouvez alors vérifier ce que vous souhaitez sur le résultat attendu. <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section></section>