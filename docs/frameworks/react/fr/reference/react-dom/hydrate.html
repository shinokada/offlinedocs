<!doctype html><html lang="fr"><meta charset="utf-8"><title>hydrate</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="hydrate"><h1 id="hydrate">hydrate</h1><deprecated><p>Cette API sera retirée d'une future version majeure de React.<p>React 18 a remplacé <code>hydrate</code> par <a href="/reference/react-dom/client/hydrateRoot"><code>hydrateRoot</code></a>. Utiliser <code>hydrate</code> avec React 18 vous avertira que votre appli se comportera comme dans React 17. <a href="/blog/2022/03/08/react-18-upgrade-guide#updates-to-client-rendering-apis">Apprenez-en davantage ici</a>.</p></deprecated><intro><p><code>hydrate</code> vous permet d'afficher des composants React au sein d'un nœud DOM dont le contenu HTML a été préalablement généré par <a href="/reference/react-dom/server"><code>react-dom/server</code></a> dans React 17 et antérieur.<pre class="language-js"><code class="language-js"><span class="token function">hydrate</span><span class="token punctuation">(</span>reactNode<span class="token punctuation">,</span> domNode<span class="token punctuation">,</span> callback<span class="token operator">?</span><span class="token punctuation">)</span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="référence-reference"><h2 id="référence-reference">Référence {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="hydratereactnode-domnode-callback-hydrate"><h3 id="hydratereactnode-domnode-callback-hydrate"><code>hydrate(reactNode, domNode, callback?)</code> {/<em>hydrate</em>/}</h3><p>Appelez <code>hydrate</code> dans React 17 et antérieur pour « attacher » React à du HTML existant produit par React dans un environnement serveur.<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span>reactNode<span class="token punctuation">,</span> domNode<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>React s'attachera au HTML existant au sein de <code>domNode</code>, et prendra en main la gestion du fragment DOM concerné. Une appli intégralement construite avec React n'aura généralement besoin que d'un appel à <code>hydrate</code>, pour son composant racine.<p><a href="#usage">Voir d'autres exemples ci-dessous</a>.<section class="level4"aria-labelledby="paramètres-parameters"><h4 id="paramètres-parameters">Paramètres {/<em>parameters</em>/}</h4><ul><li><p><code>reactNode</code> : le « nœud React » utilisé pour afficher le HTML existant. Ce sera généralement un bout de JSX du genre <code>&#x3C;App /></code>, qui a été rendu côté serveur par une méthode de <code>ReactDOM Server</code> du style <code>renderToString(&#x3C;App />)</code> dans React 17.<li><p><code>domNode</code> : un <a href="https://developer.mozilla.org/docs/Web/API/Element">élément DOM</a> que le serveur a utilisé comme élément racine dans son rendu.<li><p><code>callback</code> <strong>optionnel</strong> : une fonction. Si elle est passée, React l'appellera immédiatement après que le composant aura été hydraté.</ul></section><section class="level4"aria-labelledby="valeur-renvoyée-returns"><h4 id="valeur-renvoyée-returns">Valeur renvoyée {/<em>returns</em>/}</h4><p><code>hydrate</code> renvoie <code>null</code>.</section><section class="level4"aria-labelledby="limitations-caveats"><h4 id="limitations-caveats">Limitations {/<em>caveats</em>/}</h4><ul><li><code>hydrate</code> s'attend à ce que le contenu produit soit identique à celui du rendu côté serveur. React peut colmater les différences de contenu textuel, mais tout écart doit être vu comme un bug et corrigé.<li>En mode développement, React vous avertira de tout écart de correspondance durant l'hydratation. Vous n'avez aucune garantie que les différences d'attributs seront résolues. C'est important pour des raisons de performances parce que dans la plupart des applis, les écarts sont rares, aussi valider tout le balisage serait d'une lourdeur prohibitive.<li>Vous n'aurez sans doute besoin que d'un appel à <code>hydrate</code> dans votre appli. Si vous utilisez un framework, il le fera peut-être pour vous.<li>Si votre appli est entièrement côté client, sans HTML déjà généré par le serveur, appeler <code>hydrate()</code> n'est pas autorisé. Utilisez plutôt <a href="/reference/react-dom/render"><code>render()</code></a> (pour React 17 et antérieur) ou <a href="/reference/react-dom/client/createRoot"><code>createRoot()</code></a> (pour React 18+).</ul></section></section></section><section class="level2"aria-labelledby="utilisation-usage"><h2 id="utilisation-usage">Utilisation {/<em>usage</em>/}</h2><p>Appelez <code>hydrate</code> pour attacher un<codestep step="{1}">composant React</codestep>à un<codestep step="{2}">nœud du DOM navigateur</codestep>dont le HTML était généré côté serveur.<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>N'utilisez pas <code>hydrate()</code> pour afficher une appli entièrement côté client (une appli sans HTML généré côté serveur). Utilisez plutôt<a href="/reference/react-dom/render"><code>render()</code></a> (pour React 17 et antérieur) ou <a href="/reference/react-dom/client/createRoot"><code>createRoot()</code></a> (pour React 18+).<section class="level3"aria-labelledby="hydrater-du-html-produit-par-le-serveur-hydrating-server-rendered-html"><h3 id="hydrater-du-html-produit-par-le-serveur-hydrating-server-rendered-html">Hydrater du HTML produit par le serveur {/<em>hydrating-server-rendered-html</em>/}</h3><p>Dans React, « l'hydratation » est le mécanisme par lequel React « s'attache » à du HTML existant, déjà produit par React dans un environnement serveur. Durant l'hydratation, React tentera d'associer les gestionnaires d'événements au balisage existant et de prendre la main sur l'affichage de l'application côté client.<p>Dans des applis entièrement construites avec React, <strong>vous n'aurez généralement besoin d'hydrater qu'une « racine », une seule fois au démarrage de votre appli.</strong></p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  Le contenu HTML au sein de &#x3C;div id="root">...&#x3C;/div>
  a été généré à partir de App par react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Salut tout le monde !<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Salut</span> tout le monde <span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>En temps normal, vous ne devriez pas avoir besoin de rappeler <code>hydrate</code> ou de l'appeler à plusieurs endroits. À partir de ce moment-là, c'est React qui gèrera le DOM de votre application. Pour mettre à jour l'UI, vos composants utiliseront <a href="/reference/react/useState">l'état local</a>.<p>Pour en savoir plus sur l'hydratation, consultez la documentation d'<a href="/reference/react-dom/client/hydrateRoot"><code>hydrateRoot</code></a>.</section><section class="level3"aria-labelledby="ignorer-les-incohérences-dhydratation-incontournables-suppressing-unavoidable-hydration-mismatch-errors"><h3 id="ignorer-les-incohérences-dhydratation-incontournables-suppressing-unavoidable-hydration-mismatch-errors">Ignorer les incohérences d'hydratation incontournables {/<em>suppressing-unavoidable-hydration-mismatch-errors</em>/}</h3><p>Si un attribut ou contenu textuel d'un seul élément est forcément différent entre le serveur et le client (par exemple, un horodatage), vous pouvez réduire au silence l'avertissement d'écart à l'hydratation.<p>Pour éviter les avertissements d'hydratation sur un élément, ajoutez-lui <code>suppressHydrationWarning={true}</code>:</p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  Le contenu HTML au sein de &#x3C;div id="root">...&#x3C;/div>
  a été généré à partir de App par react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Nous sommes le 01/01/2020<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>h1 suppressHydrationWarning<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token maybe-class-name">Nous</span> sommes le <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toLocaleDateString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>Ça ne marche qu'à un niveau de profondeur, et c'est vraiment à voir comme une échappatoire. N'en abusez pas. À moins qu'il ne s'agisse de contenu textuel, React n'essaiera toujours pas de corriger le tir, ça peut donc rester incohérent jusqu'à des mises à jour ultérieures.</section><section class="level3"aria-labelledby="gérer-des-contenus-client-et-serveur-différents-handling-different-client-and-server-content"><h3 id="gérer-des-contenus-client-et-serveur-différents-handling-different-client-and-server-content">Gérer des contenus client et serveur différents {/<em>handling-different-client-and-server-content</em>/}</h3><p>Si vous cherchez explicitement à produire un contenu différent sur le serveur et sur le client, vous pouvez faire un rendu en deux temps. Les composants qui ont un rendu différent côté client peuvent consulter une <a href="/reference/react/useState">variable d'état</a> telle que <code>isClient</code>, que vous définirez à <code>true</code> dans un <a href="/reference/react/useEffect">Effet</a> :</p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  Le contenu HTML au sein de &#x3C;div id="root">...&#x3C;/div>
  a été généré à partir de App par react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Côté serveur<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrate <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrate</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isClient<span class="token punctuation">,</span> setIsClient<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setIsClient</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>h1<span class="token operator">></span>
      <span class="token punctuation">{</span>isClient <span class="token operator">?</span> <span class="token string">'Côté client'</span> <span class="token operator">:</span> <span class="token string">'Côté serveur'</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>Ainsi la passe de rendu initiale a le même contenu que le serveur, ce qui évite les écarts, mais une passe complémentaire survient de façon synchrone juste après l'hydratation.</p><pitfall><p>Cette approche ralentit l'hydratation parce que vos composants doivent effectuer deux rendus. Pensez à l'expérience utilisateur sur des connexions lentes. Le code JavaScript peut n'arriver que bien après le rendu HTML initial, de sorte que changer l'UI immédiatement après l'hydratation peut être déstabilisant pour l'utilisateur.</p></pitfall><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>