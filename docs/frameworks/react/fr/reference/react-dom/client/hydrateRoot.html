<!doctype html><html lang="fr"><meta charset="utf-8"><title>hydrateRoot</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="hydrateroot"><h1 id="hydrateroot">hydrateRoot</h1><intro><p><code>hydrateRoot</code> vous permet d'afficher des composants React dans un nœud DOM du navigateur dont le HTML a été préalablement généré par <a href="/reference/react-dom/server"><code>react-dom/server</code>.</a><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">hydrateRoot</span><span class="token punctuation">(</span>domNode<span class="token punctuation">,</span> reactNode<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token punctuation">)</span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="référence-reference"><h2 id="référence-reference">Référence {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="hydraterootdomnode-reactnode-options-hydrateroot"><h3 id="hydraterootdomnode-reactnode-options-hydrateroot"><code>hydrateRoot(domNode, reactNode, options?)</code> {/<em>hydrateroot</em>/}</h3><p>Appelez <code>hydrateRoot</code> pour « attacher » React à du HTML existant préalablement généré par React dans un environnement serveur.<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrateRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> domNode <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">hydrateRoot</span><span class="token punctuation">(</span>domNode<span class="token punctuation">,</span> reactNode<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>React s'attachera au HTML existant à l'intérieur de <code>domNode</code>, et prendra la main sur la gestion du DOM à l'intérieur. Une appli entièrement construite avec React n'aura généralement qu'un seul appel à <code>hydrateRoot</code>, pour le composant racine.<p><a href="#usage">Voir d'autres exemples ci-dessous</a>.<section class="level4"aria-labelledby="paramètres-parameters"><h4 id="paramètres-parameters">Paramètres {/<em>parameters</em>/}</h4><ul><li><p><code>domNode</code> : un <a href="https://developer.mozilla.org/fr/docs/Web/API/Element">élément DOM</a> généré comme élément racine côté serveur.<li><p><code>reactNode</code> : un <em>nœud React</em> utilisé pour afficher le HTML existant. Ce sera généralement un bout de JSX du genre <code>&#x3C;App /></code>, généré <em>via</em> une méthode <a href="/reference/react-dom/server"><code>react-dom/server</code></a> telle que <code>renderToPipeableStream(&#x3C;App />)</code>.<li><p><code>options</code> <strong>optionnelles</strong> : un objet avec des options pour la racine React.<ul><li><code>onRecoverableError</code> <strong>optionnel</strong> : fonction de rappel appelée lorsque React retombe automatiquement sur ses pieds suite à une erreur.<li><code>identifierPrefix</code> <strong>optionnel</strong> : un préfixe textuel utilisé pour les ID générés par <a href="/reference/react/useId"><code>useId</code></a>. Pratique pour éviter les conflits entre les ID au sein de racines multiples sur une même page. Doit être le même préfixe que celui utilisé côté serveur.</ul></ul></section><section class="level4"aria-labelledby="valeur-renvoyée-returns"><h4 id="valeur-renvoyée-returns">Valeur renvoyée {/<em>returns</em>/}</h4><p><code>hydrateRoot</code> renvoie un objet avec deux méthodes : <a href="#root-render"><code>render</code></a> et <a href="#root-unmount"><code>unmount</code></a>.</section><section class="level4"aria-labelledby="limitations-caveats"><h4 id="limitations-caveats">Limitations {/<em>caveats</em>/}</h4><ul><li><code>hydrateRoot()</code> s'attend à ce que le contenu affiché soit identique au contenu généré côté serveur. Vous devriez considérer tout écart comme un bug et le corriger.<li>En mode développement, React vous avertira de tout écart de correspondance durant l'hydratation. Vous n'avez aucune garantie que les différences d'attributs seront résolues. C'est important pour des raisons de performances parce que dans la plupart des applis, les écarts sont rares, aussi valider tout le balisage serait d'une lourdeur prohibitive.<li>Vous n'aurez probablement qu'un seul appel à <code>hydrateRoot</code> dans votre appli. Si vous utilisez un framework, il le fait peut-être pour vous.<li>Si votre appli est entièrement côté client, sans HTML déjà généré par le serveur, appeler <code>hydrateRoot()</code> n'est pas autorisé. Utilisez plutôt <a href="/reference/react-dom/client/createRoot"><code>createRoot()</code></a>.</ul></section></section><section class="level3"aria-labelledby="rootrenderreactnode-root-render"><h3 id="rootrenderreactnode-root-render"><code>root.render(reactNode)</code> {/<em>root-render</em>/}</h3><p>Appelez <code>root.render</code> pour mettre à jour un composant React au sein d'une racine React hydratée associée à un élément DOM du navigateur.<pre class="language-js"><code class="language-js">root<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>React mettra à jour <code>&#x3C;App /></code> dans le <code>root</code> hydraté.<p><a href="#usage">Voir d'autres exemples ci-dessous</a>.<section class="level4"aria-labelledby="paramètres-root-render-parameters"><h4 id="paramètres-root-render-parameters">Paramètres {/<em>root-render-parameters</em>/}</h4><ul><li><code>reactNode</code> : un <em>nœud React</em> que vous souhaitez mettre à jour. Ce sera généralement un bout de JSX du genre <code>&#x3C;App /></code>, mais vous pouvez aussi passer un élément React créé avec <a href="/reference/react/createElement"><code>createElement()</code></a>, une chaîne de caractères, un nombre, <code>null</code> ou <code>undefined</code>.</ul></section><section class="level4"aria-labelledby="valeur-renvoyée-root-render-returns"><h4 id="valeur-renvoyée-root-render-returns">Valeur renvoyée {/<em>root-render-returns</em>/}</h4><p><code>root.render</code> renvoie <code>undefined</code>.</section><section class="level4"aria-labelledby="limitations-root-render-caveats"><h4 id="limitations-root-render-caveats">Limitations {/<em>root-render-caveats</em>/}</h4><ul><li>Si vous appelez <code>root.render</code> avant que la racine n'ait terminé son hydratation, React effacera tout le HTML produit par le serveur et basculera la racine entière vers un rendu côté client.</ul></section></section><section class="level3"aria-labelledby="rootunmount-root-unmount"><h3 id="rootunmount-root-unmount"><code>root.unmount()</code> {/<em>root-unmount</em>/}</h3><p>Appelez <code>root.unmount</code> pour détruire l'arborescence de rendu au sein d'une racine React.<pre class="language-js"><code class="language-js">root<span class="token punctuation">.</span><span class="token method function property-access">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Une appli entièrement construite avec React n'appellera généralement pas <code>root.unmount</code>.<p>C'est principalement utile si le nœud DOM de votre racine React (ou un de ses ancêtres) est susceptible d'être retiré du DOM par du code tiers. Imaginez par exemple une gestion d'onglet basée sur jQuery qui retire les onglets inactifs du DOM. Si un onglet est retiré, tout ce qu'il contient (y compris d'éventuelles racines React) sera également retiré du DOM. Dans un tel cas, vous devez dire à React de « cesser » de gérer le contenu de la racine retirée en appelant <code>root.unmount</code>. Si vous ne le faisiez pas, les composants au sein de la racine retirée ne pourraient pas être nettoyés et libérer leurs ressources globales, telles que des abonnements.<p>Un appel à <code>root.unmount</code> démontera tous les composants dans cette racine et « détachera » React du nœud DOM racine, y compris pour la gestion événementielle et les états de l'arbre.<section class="level4"aria-labelledby="paramètres-root-unmount-parameters"><h4 id="paramètres-root-unmount-parameters">Paramètres {/<em>root-unmount-parameters</em>/}</h4><p><code>root.unmount</code> ne prend aucun paramètre.</section><section class="level4"aria-labelledby="returns-root-unmount-returns"><h4 id="returns-root-unmount-returns">Returns {/<em>root-unmount-returns</em>/}</h4><p><code>root.unmount</code> renvoie <code>undefined</code>.</section><section class="level4"aria-labelledby="limitations-root-unmount-caveats"><h4 id="limitations-root-unmount-caveats">Limitations {/<em>root-unmount-caveats</em>/}</h4><ul><li><p>Appeler <code>root.unmount</code> démontera tous les composants dans cette racine et « détachera » React du nœud DOM racine.<li><p>Une fois que vous avez appelé <code>root.unmount</code>, vous ne pouvez plus rappeler <code>root.render</code> sur cette même racine. Tenter d'appeler <code>root.render</code> sur une racine démontée lèvera une erreur <em>"Cannot update an unmounted root"</em> <em>(« Impossible de mettre à jour une racine démontée », NdT)</em>.</ul></section></section></section><section class="level2"aria-labelledby="utilisation-usage"><h2 id="utilisation-usage">Utilisation {/<em>usage</em>/}</h2><section class="level3"aria-labelledby="hydrater-du-html-généré-côté-serveur-hydrating-server-rendered-html"><h3 id="hydrater-du-html-généré-côté-serveur-hydrating-server-rendered-html">Hydrater du HTML généré côté serveur {/<em>hydrating-server-rendered-html</em>/}</h3><p>Si le HTML de votre appli est généré par <a href="/reference/react-dom/client/createRoot"><code>react-dom/server</code></a>, vous devez <em>l'hydrater</em> côté client.<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrateRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>

<span class="token function">hydrateRoot</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Ça hydratera le HTML issu du serveur au sein du<codestep step="{1}">nœud DOM du navigateur</codestep>en utilisant le<codestep step="{2}">composant React</codestep>de votre appli. En général, vous ne le ferez qu'une fois au démarrage. Si vous utilisez un framework, il le fait peut-être pour vous sous le capot.<p>Pour hydrater votre appli, React « attachera » la logique de vos composants au HTML initial généré par le serveur. L'hydratation transforme cet instantané initial du HTML, issu du serveur, en une appli pleinement interactive s'exécutant dans le navigateur.</p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  Le contenu HTML au sein du &#x3C;div id="root">...&#x3C;/div>
  est généré à partir de App par react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Salut tout le monde !<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span><span class="token punctuation">></span></span>Vous avez cliqué <span class="token comment">&#x3C;!-- --></span>0<span class="token comment">&#x3C;!-- --></span> fois<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrateRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrateRoot</span><span class="token punctuation">(</span>
  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Salut</span> tout le monde <span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Counter</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Counter</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token maybe-class-name">Vous</span> avez cliqué <span class="token punctuation">{</span>count<span class="token punctuation">}</span> fois
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>Vous ne devriez pas avoir besoin de rappeler <code>hydrateRoot</code> ou de l'appeler ailleurs. À partir de ce moment, React prendra la main sur le DOM de votre application. Pour mettre à jour l'interface utilisateur (UI), vos composants <a href="/reference/react/useState">mettront plutôt à jour l'état</a>.</p><pitfall><p>L'arbre React que vous passez à <code>hydrateRoot</code> doit produire <strong>le même résultat</strong> que celui issu du HTML généré côté serveur.<p>C'est important pour l'expérience utilisateur. L'utilisateur passera un peu de temps à regarder le HTML produit par le serveur avant que votre code JavaScript n'ait fini de charger. Le rendu côté serveur donne l'impression que l'appli se charge plus vite, en produisant un instantané du HTML. Afficher soudainement un contenu différent casse cette perception. C'est pourquoi le rendu côté serveur doit correspondre au résultat du rendu initial côté client.<p>Les causes les plus fréquentes d'erreurs d'hydratation sont notamment :<ul><li>Des espacements supplémentaires (tels que des sauts de lignes) autour du HTML généré par React au sein du nœud racine.<li>L'utilisation de tests du style <code>typeof window !== 'undefined'</code> dans votre code de rendu.<li>Le recours à des API strictement navigateur, comme par exemple <a href="https://developer.mozilla.org/fr/docs/Web/API/Window/matchMedia"><code>window.matchMedia</code></a>, dans votre code de rendu.<li>L'affichage de données différentes coté serveur et côté client.</ul><p>React peut se remettre de certaines erreurs d'hydratation, mais <strong>vous devez les corriger comme si c'étaient des bugs</strong>. Dans le meilleur des cas, elles ralentiront simplement l'hydratation ; mais elles pourraient aussi entraîner l'association de gestionnaires d'événements aux mauvais éléments.</p></pitfall></section><section class="level3"aria-labelledby="hydrater-un-document-entier-hydrating-an-entire-document"><h3 id="hydrater-un-document-entier-hydrating-an-entire-document">Hydrater un document entier {/<em>hydrating-an-entire-document</em>/}</h3><p>Les applis entièrement construites avec React peuvent produire le document entier <em>via</em> leur JSX, y compris la balise <a href="https://developer.mozilla.org/fr/docs/Web/HTML/Element/html"><code>&#x3C;html></code></a> :<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>html<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>head<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>meta charSet<span class="token operator">=</span><span class="token string">"utf-8"</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1"</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"/styles.css"</span><span class="token operator">></span><span class="token operator">&#x3C;</span><span class="token operator">/</span>link<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>title<span class="token operator">></span><span class="token maybe-class-name">Mon</span> appli<span class="token operator">&#x3C;</span><span class="token operator">/</span>title<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>head<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>body<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Router</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>body<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>html<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Pour hydrater le document entier, passez la variable globale <a href="https://developer.mozilla.org/fr/docs/Web/API/Window/document"><code>document</code></a> comme premier argument dans votre appel à <code>hydrateRoot</code> :<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrateRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrateRoot</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">,</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></section><section class="level3"aria-labelledby="réduire-au-silence-les-erreurs-dhydratation-incontournables-suppressing-unavoidable-hydration-mismatch-errors"><h3 id="réduire-au-silence-les-erreurs-dhydratation-incontournables-suppressing-unavoidable-hydration-mismatch-errors">Réduire au silence les erreurs d'hydratation incontournables {/<em>suppressing-unavoidable-hydration-mismatch-errors</em>/}</h3><p>Si pour un élément spécifique, un attribut ou le contenu textuel s'avère inévitablement différent entre le serveur et le client (un horodatage, par exemple), vous pouvez choisir de réduire au silence l'avertissement d'écart d'hydratation.<p>Pour éviter les avertissements d'hydratation sur un élément spécifique, ajoutez-lui la prop <code>suppressHydrationWarning={true}</code> :</p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  Le contenu HTML au sein du &#x3C;div id="root">...&#x3C;/div>
  est généré à partir de App par react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Date actuelle : <span class="token comment">&#x3C;!-- --></span>01/01/2020<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrateRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrateRoot</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>h1 suppressHydrationWarning<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token known-class-name class-name">Date</span> <span class="token literal-property property">actuelle</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toLocaleDateString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>Ça ne fonctionne qu'à un niveau de profondeur, et c'est vraiment une échappatoire. N'en abusez pas. React ne rattrapera le coup que pour les contenus textuels, il risque donc de rester quelques incohérences jusqu'au prochain rendu.</section><section class="level3"aria-labelledby="différencier-les-contenus-côté-client-et-côté-serveur-handling-different-client-and-server-content"><h3 id="différencier-les-contenus-côté-client-et-côté-serveur-handling-different-client-and-server-content">Différencier les contenus côté client et côté serveur {/<em>handling-different-client-and-server-content</em>/}</h3><p>Si vous différenciez volontairement l'affichage entre le côté serveur et le côté client, vous pouvez faire un rendu en deux temps. Les composants qui affichent un contenu différent côté client peuvent lire une <a href="/reference/react/useState">variable d'état</a> telle que <code>isClient</code>, que vous pouvez mettre à <code>true</code> dans un <a href="/reference/react/useEffect">Effet</a> :</p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  Le contenu HTML au sein du &#x3C;div id="root">...&#x3C;/div>
  est généré à partir de App par react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Côté serveur<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrateRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token function">hydrateRoot</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isClient<span class="token punctuation">,</span> setIsClient<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setIsClient</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>h1<span class="token operator">></span>
      <span class="token punctuation">{</span>isClient <span class="token operator">?</span> <span class="token string">'Côté client'</span> <span class="token operator">:</span> <span class="token string">'Côté serveur'</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>De cette façon, la passe initiale de rendu afficher le même contenu que côté serveur, évitant toute incohérence ; mais une passe supplémentaire surviendra de façon synchrone juste après l'hydratation.</p><pitfall><p>Cette approche ralentit l'hydratation parce que vos composants doivent effectuer deux rendus. Pensez à l'expérience utilisateur sur des connexions lentes. Le code JavaScript risque de n'être chargé que bien après le rendu HTML initial, de sorte qu'afficher une UI différente juste après l'hydratation peut perturber l'utilisateur.</p></pitfall></section><section class="level3"aria-labelledby="mettre-à-jour-un-composant-racine-hydraté-updating-a-hydrated-root-component"><h3 id="mettre-à-jour-un-composant-racine-hydraté-updating-a-hydrated-root-component">Mettre à jour un composant racine hydraté {/<em>updating-a-hydrated-root-component</em>/}</h3><p>Après que la racine a terminé l'hydratation, vous pouvez appeler <a href="#root-render"><code>root.render</code></a> pour mettre à jour le composant React racine. <strong>Contrairement à <a href="/reference/react-dom/client/createRoot"><code>createRoot</code></a>, vous n'avez pas besoin de faire ça car le contenu initial était déjà présent dans le HTML.</strong><p>Si vous appelez <code>root.render</code> après l'hydratation, et que la structure de l'arbre de composants correspond à celle déjà en place, React <a href="/learn/preserving-and-resetting-state">préservera l'état</a>. Voyez comme vous pouvez taper quelque chose dans le champ, ce qui montre bien que les mises à jour issues d'appels répétés à <code>render</code> ne sont pas destructrices :</p><sandpack><pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!--
  Le contenu HTML au sein du &#x3C;div id="root">...&#x3C;/div>
  est généré à partir de App par react-dom/server.
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Salut tout le monde ! <span class="token comment">&#x3C;!-- --></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Tapez quelque chose ici<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> hydrateRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token string">'./styles.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">hydrateRoot</span><span class="token punctuation">(</span>
  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> counter<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  root<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> counter<span class="token operator">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  i<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>counter<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Salut</span> tout le monde <span class="token operator">!</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input placeholder<span class="token operator">=</span><span class="token string">"Tapez quelque chose ici"</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>Il est toutefois rare d'appeler <a href="#root-render"><code>root.render</code></a> sur une racine hydratée. En général, vos composants <a href="/reference/react/useState">mettront plutôt à jour l'état</a>. <span style="float:footnote"><a href="../../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>