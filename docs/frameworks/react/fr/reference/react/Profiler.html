<!doctype html><html lang="fr"><meta charset="utf-8"><title>&#x3C;Profiler></title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="profiler"><h1 id="profiler"><profiler></profiler></h1><intro><p><code>&#x3C;Profiler></code> vous permet de mesurer au sein de votre code les performances de rendu d’un arbre de composants React.<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Profiler</span> id<span class="token operator">=</span><span class="token string">"App"</span> onRender<span class="token operator">=</span><span class="token punctuation">{</span>onRender<span class="token punctuation">}</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Profiler</span><span class="token operator">></span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="reference-reference"><h2 id="reference-reference">Reference {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="profiler-profiler"><h3 id="profiler-profiler"><code>&#x3C;Profiler></code> {/<em>profiler</em>/}</h3><p>Enrobez un arbre de composants dans un <code>&#x3C;Profiler></code> afin de mesurer ses performances de rendu.<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Profiler</span> id<span class="token operator">=</span><span class="token string">"App"</span> onRender<span class="token operator">=</span><span class="token punctuation">{</span>onRender<span class="token punctuation">}</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Profiler</span><span class="token operator">></span></code></pre><section class="level4"aria-labelledby="props-props"><h4 id="props-props">Props {/<em>props</em>/}</h4><ul><li><code>id</code> : une chaîne de caractères identifiant la portion de l’UI que vous souhaitez mesurer.<li><code>onRender</code> : une <a href="#onrender-callback">fonction de rappel <code>onRender</code></a> appelée à chaque nouveau rendu d’un composant situé dans l’arbre profilé. Elle reçoit des informations indiquant ce qui a fait l’objet ɗ un rendu et quel temps ça a pris.</ul></section><section class="level4"aria-labelledby="limitations-caveats"><h4 id="limitations-caveats">Limitations {/<em>caveats</em>/}</h4><ul><li>Le profilage alourdit un peu le moteur, il est donc <strong>désactivé par défaut dans les <em>builds</em> de production</strong>. Pour activer le profilage en production, vous devez utiliser un <a href="https://fb.me/react-profiling"><em>build</em> spécifique avec profilage activé</a>.</ul></section></section><section class="level3"aria-labelledby="fonction-de-rappel-onrender-onrender-callback"><h3 id="fonction-de-rappel-onrender-onrender-callback">Fonction de rappel <code>onRender</code> {/<em>onrender-callback</em>/}</h3><p>React appellera votre fonction de rappel <code>onRender</code> avec des informations de rendu.<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onRender</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> phase<span class="token punctuation">,</span> actualDuration<span class="token punctuation">,</span> baseDuration<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> commitTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Agréger ou afficher les durées de rendu...</span>
<span class="token punctuation">}</span></code></pre><section class="level4"aria-labelledby="paramètres-onrender-parameters"><h4 id="paramètres-onrender-parameters">Paramètres {/<em>onrender-parameters</em>/}</h4><ul><li><code>id</code> : la prop textuelle <code>id</code> du <code>&#x3C;Profiler></code> qui vient de boucler son rendu. Elle vous permet d’identifier quelle partie de l’arbre est finalisée lorsque vous utilisez plusieurs profileurs.<li><code>phase</code> : <code>"mount"</code>, <code>"update"</code> ou <code>"nested-update"</code>. Ça vous permet de savoir si l’arbre vient d’être monté pour la première fois ou a fait un nouveau rendu suite à un changement dans les props, l’état ou les hooks.<li><code>actualDuration</code> : la durée en millisecondes du rendu du <code>&#x3C;Profiler></code> et de ses enfants pour la mise à jour concernée. Ça indique à quel point vos descendants profitent de la mémoïsation (notamment <a href="/reference/react/memo"><code>memo</code></a> et <a href="/reference/react/useMemo"><code>useMemo</code></a>). Idéalement, cette valeur devrait décroître de façon significative après le montage initial car la plupart des descendants ne referont un rendu que si leurs props changent.<li><code>baseDuration</code> : une estimation de la durée en millisecondes que prendrait un rendu complet du <code>&#x3C;Profiler></code> et de ses descendants, sans aucune optimisation. Elle est calculée en ajoutant les durées de rendu les plus récentes de chaque composant concerné. Cette valeur représente le coût maximal de rendu (c’est-à-dire le temps initial de montage sans mémoïsation). Comparez-la avec <code>actualDuration</code> pour déterminer si la mémoïsation fonctionne.<li><code>startTime</code> : un horodatage numérique du début de la mise à jour par React.<li><code>endTime</code> : un horodatage numérique de la fin de la mise à jour par React. Cette valeur est partagée par tous les profileurs d’une même phase de commit, ce qui permet si besoin de les grouper.</ul></section></section></section><section class="level2"aria-labelledby="utilisation-usage"><h2 id="utilisation-usage">Utilisation {/<em>usage</em>/}</h2><section class="level3"aria-labelledby="mesurer-les-performances-depuis-votre-code-measuring-rendering-performance-programmatically"><h3 id="mesurer-les-performances-depuis-votre-code-measuring-rendering-performance-programmatically">Mesurer les performances depuis votre code {/<em>measuring-rendering-performance-programmatically</em>/}</h3><p>Enrobez un arbre React avec <code>&#x3C;Profiler></code> pour mesurer ses performances des rendu.<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Profiler</span> id<span class="token operator">=</span><span class="token string">"Sidebar"</span> onRender<span class="token operator">=</span><span class="token punctuation">{</span>onRender<span class="token punctuation">}</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Sidebar</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Profiler</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">PageContent</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">App</span><span class="token operator">></span></code></pre><p>Deux props sont nécessaires : une chaîne de caractères <code>id</code> et une fonction de rappel <code>onRender</code> que React appellera à chaque fois qu’un composant dans l’arbre finalisera une mise à jour (phase de “commit”).</p><pitfall><p>Le profilage alourdit un peu le moteur, il est donc <strong>désactivé par défaut dans les <em>builds</em> de production</strong>. Pour activer le profilage en production, vous devez utiliser un <a href="https://fb.me/react-profiling"><em>build</em> spécifique avec profilage activé</a>.</p></pitfall><note><p><code>&#x3C;Profiler></code> vous permet de mesurer les performances depuis votre propre code. Si vous cherchez un outil interactif, essayez l’onglet Profiler des <a href="/learn/react-developer-tools">outils de développement</a>. Cette extension de votre navigateur propose des fonctionnalités similaires.</p></note></section><section class="level3"aria-labelledby="mesurer-différentes-parties-de-votre-application-measuring-different-parts-of-the-application"><h3 id="mesurer-différentes-parties-de-votre-application-measuring-different-parts-of-the-application">Mesurer différentes parties de votre application {/<em>measuring-different-parts-of-the-application</em>/}</h3><p>Vous pouvez utiliser plusieurs composants <code>&#x3C;Profiler></code> pour mesurer différentes parties de votre application :<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Profiler</span> id<span class="token operator">=</span><span class="token string">"Sidebar"</span> onRender<span class="token operator">=</span><span class="token punctuation">{</span>onRender<span class="token punctuation">}</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Sidebar</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Profiler</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Profiler</span> id<span class="token operator">=</span><span class="token string">"Content"</span> onRender<span class="token operator">=</span><span class="token punctuation">{</span>onRender<span class="token punctuation">}</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Content</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Profiler</span><span class="token operator">></span>
<span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">App</span><span class="token operator">></span></code></pre><p>Vous pouvez aussi imbriquer des <code>&#x3C;Profiler></code> :<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Profiler</span> id<span class="token operator">=</span><span class="token string">"Sidebar"</span> onRender<span class="token operator">=</span><span class="token punctuation">{</span>onRender<span class="token punctuation">}</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Sidebar</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Profiler</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Profiler</span> id<span class="token operator">=</span><span class="token string">"Content"</span> onRender<span class="token operator">=</span><span class="token punctuation">{</span>onRender<span class="token punctuation">}</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Content</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Profiler</span> id<span class="token operator">=</span><span class="token string">"Editor"</span> onRender<span class="token operator">=</span><span class="token punctuation">{</span>onRender<span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Editor</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Profiler</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Preview</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Content</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Profiler</span><span class="token operator">></span>
<span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">App</span><span class="token operator">></span></code></pre><p>Bien que le composant <code>&#x3C;Profiler></code> soit léger, il ne devrait être utilisé que lorsque c’est nécessaire. Chaque utilisation ajoute de la charge CPU et de la consommation mémoire à une application.<p><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>