<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <title>Introduction à JSX</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css">
  </head>
  <body>
    <section id="introduction-à-jsx" class="level1">
      <h1>Introduction à JSX</h1>
      <p>Observez cette déclaration de variable :</p>
      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Bonjour</span><span class="token punctuation">,</span> monde <span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span></code></pre>
      <p>Cette drôle de syntaxe n'est ni une chaîne de caractères ni du HTML.</p>
      <p>Ça s'appelle du JSX, et c'est une extension syntaxique de JavaScript. Nous recommandons de l'utiliser avec React afin de décrire à quoi devrait ressembler l'interface utilisateur (UI). JSX vous fait sûrement penser à un langage de balisage, mais il recèle toute la puissance de JavaScript.</p>
      <p>JSX produit des « éléments » React. Nous verrons comment les retranscrire dans le DOM dans la <a href="./rendering-elements.html">prochaine section</a>. Dans la suite de ce document, nous verrons les bases de JSX dont vous aurez besoin pour bien démarrer.</p>
      <section id="why-jsx" class="level3">
        <h3>Pourquoi JSX ?</h3>
        <p>Le fonctionnement d’une UI conditionnera toujours les logiques de rendu, de la gestion des événements à la préparation des données pour l'affichage, en passant par l'évolution de l'état au fil du temps. React a choisi d'assumer pleinement cet état de fait.</p>
        <p>Au lieu de séparer artificiellement les <em>technologies</em> en mettant le balisage et la logique dans des fichiers séparés, React <a href="https://fr.wikipedia.org/wiki/S%C3%A9paration_des_pr%C3%A9occupations">sépare les <em>préoccupations</em></a> via des unités faiblement couplées appelées « composants », qui contiennent les deux. Nous reviendrons sur les composants dans une <a href="./components-and-props.html">prochaine section</a>, mais si l'idée d’injecter des balises dans du JS vous met mal à l’aise, <a href="https://www.youtube.com/watch?v=x7cQ3mrcKaY">cette présentation</a> vous fera peut-être changer d'avis.</p>
        <p>React <a href="./react-without-jsx.html">ne vous oblige pas</a> à utiliser JSX, mais la plupart des gens y trouvent une aide visuelle quand ils manipulent l'interface utilisateur dans le code JavaScript. Ça permet aussi à React de produire des messages d'erreurs et d'avertissements plus utiles.</p>
        <p>Ceci étant posé, commençons !</p>
      </section>
      <section id="embedding-expressions-in-jsx" class="level3">
        <h3>Utiliser des expressions dans JSX</h3>
        <p>Dans l'exemple suivant, nous déclarons une variable appelée <code>name</code> et nous l'utilisons ensuite dans JSX en l'encadrant avec des accolades :</p>
        <pre class="language-js{1,2}"><code class="language-js{1,2}">const name = 'Clarisse Agbegnenou';
const element = &#x3C;h1>Bonjour, {name}&#x3C;/h1>;

ReactDOM.render(
  element,
  document.getElementById('root')
);</code></pre>
        <p>Vous pouvez utiliser n'importe quelle <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Guide/Expressions_et_Op%C3%A9rateurs#Expressions">expression JavaScript</a> valide dans des accolades en JSX. Par exemple, <code>2 + 2</code>, <code>user.firstName</code>, ou <code>formatName(user)</code> sont toutes des expressions JavaScript valides.</p>
        <p>Dans l'exemple suivant, on intègre le résultat de l'appel d'une fonction JavaScript, <code>formatName(user)</code>, dans un élément <code>&#x3C;h1></code>.</p>
        <pre class="language-js{12}"><code class="language-js{12}">function formatName(user) {
  return user.firstName + ' ' + user.lastName;
}

const user = {
  firstName: 'Kylian',
  lastName: 'Mbappé'
};

const element = (
  &#x3C;h1>
    Bonjour, {formatName(user)} !
  &#x3C;/h1>
);

ReactDOM.render(
  element,
  document.getElementById('root')
);</code></pre>
        <p><strong><a href="codepen://introducing-jsx">Essayer sur CodePen</a></strong></p>
        <p>On découple le JSX en plusieurs lignes pour une meilleure lisibilité. Par la même occasion, nous recommandons également de le mettre entre parenthèses afin d'éviter les pièges <a href="https://stackoverflow.com/q/2846283">d'insertion de point-virgule automatique</a>, même si cette pratique n'est pas obligatoire.</p>
      </section>
      <section id="jsx-is-an-expression-too" class="level3">
        <h3>JSX n’est rien d’autre qu’une expression</h3>
        <p>Après la compilation, les expressions JSX deviennent de simples appels de fonctions JavaScript, dont l'évaluation renvoie des objets JavaScript.</p>
        <p>Ça signifie que vous pouvez utiliser JSX à l'intérieur d'instructions <code>if</code> ou de boucles <code>for</code>, l'affecter à des variables, l'accepter en tant qu'argument, et le renvoyer depuis des fonctions :</p>
        <pre class="language-js{3,5}"><code class="language-js{3,5}">function getGreeting(user) {
  if (user) {
    return &#x3C;h1>Bonjour, {formatName(user)} !&#x3C;/h1>;
  }
  return &#x3C;h1>Bonjour, Belle Inconnue.&#x3C;/h1>;
}</code></pre>
      </section>
      <section id="specifying-attributes-with-jsx" class="level3">
        <h3>Spécifier des attributs en JSX</h3>
        <p>Vous pouvez utiliser des guillemets pour spécifier des littéraux chaînes de caractères dans les attributs :</p>
        <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>div tabIndex<span class="token operator">=</span><span class="token string">"0"</span><span class="token operator">></span><span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span></code></pre>
        <p>Vous pouvez aussi utiliser des accolades pour utiliser une expression JavaScript dans un attribut :</p>
        <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>user<span class="token punctuation">.</span><span class="token property-access">avatarUrl</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&#x3C;</span><span class="token operator">/</span>img<span class="token operator">></span><span class="token punctuation">;</span></code></pre>
        <p>Ne mettez pas de guillemets autour des accolades quand vous utilisez une expression JavaScript dans un attribut. Vous pouvez utiliser soit des guillemets (pour des valeurs textuelles) soit des accolades (pour des expressions), mais pas les deux à la fois pour un même attribut.</p>
        <blockquote>
          <p><strong>Attention :</strong></p>
          <p>Dans la mesure où JSX est plus proche de JavaScript que de HTML, React DOM utilise la casse <code>camelCase</code> comme convention de nommage des propriétés, au lieu des noms d’attributs HTML.</p>
          <p>Par exemple, <code>class</code> devient <a href="https://developer.mozilla.org/fr/docs/Web/API/Element/className"><code>className</code></a> en JSX, et <code>tabindex</code> devient <a href="https://developer.mozilla.org/fr/docs/Web/API/HTMLElement/tabIndex"><code>tabIndex</code></a>.</p>
        </blockquote>
      </section>
      <section id="specifying-children-with-jsx" class="level3">
        <h3>Spécifier des éléments enfants en JSX</h3>
        <p>Si une balise est vide, vous pouvez la fermer immédiatement avec <code>/></code>, comme en XML :</p>
        <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>user<span class="token punctuation">.</span><span class="token property-access">avatarUrl</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span></code></pre>
        <p>Les balises JSX peuvent contenir des enfants :</p>
        <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
    <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Bonjour </span><span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
    <span class="token operator">&#x3C;</span>h2<span class="token operator">></span><span class="token maybe-class-name">Content</span> de te voir ici<span class="token punctuation">.</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h2<span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </section>
      <section id="jsx-prevents-injection-attacks" class="level3">
        <h3>JSX empêche les attaques d’injection</h3>
        <p>Vous ne risquez rien en utilisant une saisie utilisateur dans JSX :</p>
        <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> title <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token property-access">potentiallyMaliciousInput</span><span class="token punctuation">;</span>
<span class="token comment">// Ceci est sans risque :</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span></code></pre>
        <p>Par défaut, React DOM <a href="https://stackoverflow.com/questions/7381974/which-characters-need-to-be-escaped-on-html">échappe</a> toutes les valeurs intégrées avec JSX avant d’en faire le rendu. Il garantit ainsi que vous ne risquez jamais d’injecter quoi que ce soit d'autre que ce vous avez explicitement écrit dans votre application. Tout est converti en chaîne de caractères avant de produire le rendu. Ça aide à éviter les attaques <a href="https://fr.wikipedia.org/wiki/Cross-site_scripting">XSS (cross-site-scripting)</a>.</p>
      </section>
      <section id="jsx-represents-objects" class="level3">
        <h3>JSX représente des objets</h3>
        <p>Babel compile JSX vers des appels à <code>React.createElement()</code>.</p>
        <p>Ces deux exemples sont identiques :</p>
        <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token operator">&#x3C;</span>h1 className<span class="token operator">=</span><span class="token string">"greeting"</span><span class="token operator">></span>
    <span class="token maybe-class-name">Bonjour</span><span class="token punctuation">,</span> monde <span class="token operator">!</span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span>
  <span class="token string">'h1'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">'greeting'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">'Bonjour, monde !'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
        <p><code>React.createElement()</code> effectue quelques vérifications pour vous aider à écrire un code sans bug, mais pour l'essentiel il crée un objet qui ressemble à ceci :</p>
        <pre class="language-js"><code class="language-js"><span class="token comment">// Remarque : cette structure est simplifiée</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'h1'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">'greeting'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">'Bonjour, monde !'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
        <p>Ces objets sont appelés des « éléments React ». Vous pouvez les considérer comme des descriptions de ce que vous voulez voir sur l'écran. React lit ces objets et les utilise pour construire le DOM et le tenir à jour.</p>
        <p>Nous explorerons la retranscription des éléments React dans le DOM dans la <a href="./rendering-elements.html">prochaine section</a>.</p>
        <blockquote>
          <p><strong>Astuce :</strong></p>
          <p>
            Nous recommandons d'utiliser la <a href="https://babeljs.io/docs/editors">définition de langage « Babel »</a> dans votre éditeur préféré, afin que les codes ES6 et JSX soient correctement colorisés.
            <span style="float: footnote;"><a href="./index.html#toc">Go to TOC</a></span>
          </p>
        </blockquote>
      </section>
    </section>
  </body>
</html>
