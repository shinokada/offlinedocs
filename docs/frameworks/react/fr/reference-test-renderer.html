<!doctypehtml><html lang="fr"><meta charset="utf-8"><title>Moteur de rendu de test</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css"><section id="moteur-de-rendu-de-test"class="level1"><h1>Moteur de rendu de test</h1><p><strong>Importation</strong><pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">TestRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span> <span class="token comment">// ES6</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">TestRenderer</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react-test-renderer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ES5 avec npm</span></code></pre><section id="overview"class="level2"><h2>Aperçu</h2><p>Ce paquet fournit un moteur de rendu <em>(dans la suite de cet article, pour des raisons de concision, nous emploierons le terme générique anglais renderer sans italiques, NdT)</em> capable de produire un rendu de composants React sous forme d'objets JavaScript nus, sans dépendre du DOM ou d'un environnement mobile natif.<p>Fondamentalement, ce paquet facilite la création d'un instantané de la hiérarchie produite par un renderer React DOM ou React Native (similaire à un arbre DOM) sans recourir à un navigateur ou à <a href="https://github.com/tmpvar/jsdom">jsdom</a>.<p>Exemple :<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">TestRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Link</span></span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token property-access">page</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> testRenderer <span class="token operator">=</span> <span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Link</span> page<span class="token operator">=</span><span class="token string">"https://www.facebook.com/"</span><span class="token operator">></span><span class="token maybe-class-name">Facebook</span><span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Link</span><span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>testRenderer<span class="token punctuation">.</span><span class="token method function property-access">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { type: 'a',</span>
<span class="token comment">//   props: { href: 'https://www.facebook.com/' },</span>
<span class="token comment">//   children: [ 'Facebook' ] }</span></code></pre><p>Vous pouvez utiliser la fonctionnalité de test par instantanés <em>(snapshot testing, NdT)</em> de Jest pour sauvegarder automatiquement une copie de l'arbre JSON obtenu dans un fichier, puis vérifier dans vos tests qu'il n'a pas changé : <a href="https://jestjs.io/docs/en/snapshot-testing">vous trouverez plus de détails ici</a>.<p>Vous pouvez également explorer le résultat pour trouver des nœuds spécifiques et vérifier vos attentes les concernant.<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">TestRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">SubComponent</span> foo<span class="token operator">=</span><span class="token string">"bar"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p className<span class="token operator">=</span><span class="token string">"my"</span><span class="token operator">></span><span class="token maybe-class-name">Salut</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">SubComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>p className<span class="token operator">=</span><span class="token string">"sub"</span><span class="token operator">></span><span class="token maybe-class-name">Sous</span><span class="token operator">-</span><span class="token maybe-class-name">Composant</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> testRenderer <span class="token operator">=</span> <span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyComponent</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> testInstance <span class="token operator">=</span> testRenderer<span class="token punctuation">.</span><span class="token property-access">root</span><span class="token punctuation">;</span>

<span class="token function">expect</span><span class="token punctuation">(</span>testInstance<span class="token punctuation">.</span><span class="token method function property-access">findByType</span><span class="token punctuation">(</span><span class="token maybe-class-name">SubComponent</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">.</span><span class="token property-access">foo</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>testInstance<span class="token punctuation">.</span><span class="token method function property-access">findByProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">"sub"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Sous-Composant'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><section id="testrenderer"class="level3"><h3>TestRenderer</h3><ul><li><a href="#testrenderercreate"><code>TestRenderer.create()</code></a><li><a href="#testrendereract"><code>TestRenderer.act()</code></a></ul></section><section id="instance-de-testrenderer-testrenderer-instance"class="level3"><h3>Instance de <code>TestRenderer</code> {#testrenderer-instance}</h3><ul><li><a href="#testrenderertojson"><code>testRenderer.toJSON()</code></a><li><a href="#testrenderertotree"><code>testRenderer.toTree()</code></a><li><a href="#testrendererupdate"><code>testRenderer.update()</code></a><li><a href="#testrendererunmount"><code>testRenderer.unmount()</code></a><li><a href="#testrenderergetinstance"><code>testRenderer.getInstance()</code></a><li><a href="#testrendererroot"><code>testRenderer.root</code></a></ul></section><section id="testinstance"class="level3"><h3>TestInstance</h3><ul><li><a href="#testinstancefind"><code>testInstance.find()</code></a><li><a href="#testinstancefindbytype"><code>testInstance.findByType()</code></a><li><a href="#testinstancefindbyprops"><code>testInstance.findByProps()</code></a><li><a href="#testinstancefindall"><code>testInstance.findAll()</code></a><li><a href="#testinstancefindallbytype"><code>testInstance.findAllByType()</code></a><li><a href="#testinstancefindallbyprops"><code>testInstance.findAllByProps()</code></a><li><a href="#testinstanceinstance"><code>testInstance.instance</code></a><li><a href="#testinstancetype"><code>testInstance.type</code></a><li><a href="#testinstanceprops"><code>testInstance.props</code></a><li><a href="#testinstanceparent"><code>testInstance.parent</code></a><li><a href="#testinstancechildren"><code>testInstance.children</code></a></ul></section></section><section id="reference"class="level2"><h2>Référence de l'API</h2><section id="testrenderercreate-testrenderercreate"class="level3"><h3><code>TestRenderer.create()</code> {#testrenderercreate}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Crée une instance de <code>TestRenderer</code> avec l'élément React passé en argument. Ça n’utilise pas un véritable DOM, mais ça ne l’empêche pas de produire l'arbre intégral des composants en mémoire pour pouvoir vérifier vos attentes dessus. Renvoie une <a href="#testrenderer-instance">instance de TestRenderer</a>.</section><section id="testrendereract-testrendereract"class="level3"><h3><code>TestRenderer.act()</code> {#testrendereract}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">act</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>De la même manière que l'<a href="./test-utils.html#act">utilitaire <code>act()</code> de <code>react-dom/test-utils</code></a>, <code>TestRenderer.act</code> prépare un composant permettant la vérification d'attentes. Utilisez cette version de <code>act()</code> pour englober les appels à <code>TestRenderer.create</code> et <code>testRenderer.update</code>.<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>create<span class="token punctuation">,</span> act<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./app.js'</span><span class="token punctuation">;</span> <span class="token comment">// Le composant testé</span>

<span class="token comment">// Fait le rendu du component</span>
<span class="token keyword">let</span> root<span class="token punctuation">;</span> 
<span class="token function">act</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  root <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Exprime des attentes sur la racine</span>
<span class="token function">expect</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token method function property-access">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Met à jour avec des props différentes</span>
<span class="token function">act</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  root<span class="token punctuation">.</span><span class="token method function property-access">update</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// Exprime des attentes sur la racine</span>
<span class="token function">expect</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token method function property-access">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></section><section id="testrenderertojson-testrenderertojson"class="level3"><h3><code>testRenderer.toJSON()</code> {#testrenderertojson}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>Renvoie un objet représentant l'arbre obtenu. Cet arbre contient uniquement les nœuds spécifiques à la plateforme comme <code>&#x3C;div></code> ou <code>&#x3C;View></code> avec leur props mais ne contient aucun composant écrit par l'utilisateur. C’est pratique pour le <a href="http://facebook.github.io/jest/docs/en/snapshot-testing.html#snapshot-testing-with-jest">test par instantanés</a>.</section><section id="testrenderertotree-testrenderertotree"class="level3"><h3><code>testRenderer.toTree()</code> {#testrenderertotree}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">toTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>Renvoie un objet représentant l'arbre obtenu. Contrairement à <code>toJSON()</code>, la représentation y est plus détaillée et contient les composants écrits par l'utilisateur. Vous n'aurez probablement pas besoin de cette méthode à moins que vous n’écriviez votre propre bibliothèque de vérification d'attentes construite au-dessus du renderer de test.</section><section id="testrendererupdate-testrendererupdate"class="level3"><h3><code>testRenderer.update()</code> {#testrendererupdate}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">update</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span></code></pre><p>Effectue à nouveau le rendu de l'arbre en mémoire, avec un nouvel élément racine. Ça simule une mise à jour de l'arbre React à la racine. Si le nouvel élément a le même type et la même clé que l'élément précédent, l'arbre sera mis à jour ; dans le cas contraire, un nouvel arbre sera re-monté.</section><section id="testrendererunmount-testrendererunmount"class="level3"><h3><code>testRenderer.unmount()</code> {#testrendererunmount}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>Démonte l'arbre en mémoire, en déclenchant les événements de cycle de vie appropriés.</section><section id="testrenderergetinstance-testrenderergetinstance"class="level3"><h3><code>testRenderer.getInstance()</code> {#testrenderergetinstance}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>Renvoie l'instance correspondant à l'élément racine, s’il est disponible. Ça ne marchera pas si l'élément racine est une fonction composant car celles-ci n'ont pas d'instance.</section><section id="testrendererroot-testrendererroot"class="level3"><h3><code>testRenderer.root</code> {#testrendererroot}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token property-access">root</span></code></pre><p>Renvoie l'objet « instance de test » racine, qui est utile pour faire des vérifications d'attentes à propos de nœuds spécifiques dans l'arbre. Vous pouvez l'utiliser pour trouver d'autres « instances de test » présentes plus profond dans l'arbre.</section><section id="testinstancefind-testinstancefind"class="level3"><h3><code>testInstance.find()</code> {#testinstancefind}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span></code></pre><p>Trouve une unique « instance de test » descendante pour laquelle <code>test(testInstance)</code> renvoie <code>true</code>. Si <code>test(testInstance)</code> ne renvoie pas <code>true</code> pour exactement une « instance de test », une erreur est levée.</section><section id="testinstancefindbytype-testinstancefindbytype"class="level3"><h3><code>testInstance.findByType()</code> {#testinstancefindbytype}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findByType</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span></code></pre><p>Trouve une unique « instance de test » avec le <code>type</code> donné. Si il n'y a pas exactement une « instance de test » avec le <code>type</code> donné, une erreur est levée.</section><section id="testinstancefindbyprops-testinstancefindbyprops"class="level3"><h3><code>testInstance.findByProps()</code> {#testinstancefindbyprops}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findByProps</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span></code></pre><p>Trouve une unique « instance de test » avec les <code>props</code> données. Si il n'y a pas exactement une « instance de test » avec les <code>props</code> données, une erreur est levée.</section><section id="testinstancefindall-testinstancefindall"class="level3"><h3><code>testInstance.findAll()</code> {#testinstancefindall}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findAll</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span></code></pre><p>Trouve toutes les « instances de test » descendantes pour lesquelles <code>test(testInstance)</code> renvoie <code>true</code>.</section><section id="testinstancefindallbytype-testinstancefindallbytype"class="level3"><h3><code>testInstance.findAllByType()</code> {#testinstancefindallbytype}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findAllByType</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span></code></pre><p>Trouve toutes les « instances de test » descendantes avec le <code>type</code> donné.</section><section id="testinstancefindallbyprops-testinstancefindallbyprops"class="level3"><h3><code>testInstance.findAllByProps()</code> {#testinstancefindallbyprops}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findAllByProps</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span></code></pre><p>Trouve toutes les « instances de test » descendantes avec les <code>props</code> données.</section><section id="testinstanceinstance-testinstanceinstance"class="level3"><h3><code>testInstance.instance</code> {#testinstanceinstance}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">instance</span></code></pre><p>L'instance de composant correspondant à cette « instance de test ». Ça n'est disponible que pour les composants à base de classe, vu que les fonctions composants n'ont pas d'instances. Ça correspond à la valeur de <code>this</code> au sein du composant donné.</section><section id="testinstancetype-testinstancetype"class="level3"><h3><code>testInstance.type</code> {#testinstancetype}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">type</span></code></pre><p>Le type de composant correspondant à cette « instance de test ». Par exemple, un composant <code>&#x3C;Button /></code> a pour type <code>Button</code>.</section><section id="testinstanceprops-testinstanceprops"class="level3"><h3><code>testInstance.props</code> {#testinstanceprops}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">props</span></code></pre><p>Les props correspondant à cette « instance de test ». Par exemple, un composant <code>&#x3C;Button size="small" /></code> a comme props <code>{size: 'small'}</code>.</section><section id="testinstanceparent-testinstanceparent"class="level3"><h3><code>testInstance.parent</code> {#testinstanceparent}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">parent</span></code></pre><p>L'« instance de test » parente de cette « instance de test ».</section><section id="testinstancechildren-testinstancechildren"class="level3"><h3><code>testInstance.children</code> {#testinstancechildren}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">children</span></code></pre><p>Les « instances de test » enfants de cette « instance de test ».</section></section><section id="ideas"class="level2"><h2>Idées</h2><p>Vous pouvez passer la fonction <code>createNodeMock</code> à <code>TestRenderer.create</code> comme option pour créer des simulations personnalisées de refs. <code>createNodeMock</code> accepte l'élément courant et doit retourner une imitation de ref. C'est utile quand vous testez un composant qui utilise des refs.<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">TestRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">input</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">input</span><span class="token punctuation">.</span><span class="token method function property-access">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">el</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">input</span> <span class="token operator">=</span> el<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> focused <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyComponent</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token function-variable function">createNodeMock</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span><span class="token property-access">type</span> <span class="token operator">===</span> <span class="token string">'input'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// simule une fonction focus</span>
        <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
          <span class="token function-variable function">focus</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
            focused <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword control-flow">return</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>focused<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section>