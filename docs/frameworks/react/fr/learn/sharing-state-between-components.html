<!doctype html><html lang="fr"><meta charset="utf-8"><title>Partager l’état entre des composants</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="partager-létat-entre-des-composants"><h1 id="partager-létat-entre-des-composants">Partager l’état entre des composants</h1><intro><p>Vous souhaitez parfois que les états de deux composants changent toujours ensemble. Pour ça, retirez leurs états et fusionnez-les dans leur plus proche parent commun, puis passez-leur ces données <em>via</em> les props. C'est ce qu'on appelle <em>faire remonter l'état</em>, et c'est l'une des choses les plus communes que vous ferez en écrivant du code React.</p></intro><youwilllearn><ul><li>Comment partager l'état entre composants en le faisant remonter<li>Ce que sont les composants contrôlés et non contrôlés</ul></youwilllearn><section class="level2"aria-labelledby="faire-remonter-létat-par-lexemple-lifting-state-up-by-example"><h2 id="faire-remonter-létat-par-lexemple-lifting-state-up-by-example">Faire remonter l'état par l'exemple {/<em>lifting-state-up-by-example</em>/}</h2><p>Dans cet exemple, un composant parent <code>Accordion</code> affiche deux <code>Panel</code> distincts :<ul><li><code>Accordion</code><ul><li><code>Panel</code><li><code>Panel</code></ul></ul><p>Chaque composant <code>Panel</code> a une variable d'état booléenne <code>isActive</code> qui définit si le contenu du panneau est visible ou non.<p>Appuyez sur le bouton Afficher pour les deux panneaux :</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Panel</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> title<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isActive<span class="token punctuation">,</span> setIsActive<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>section className<span class="token operator">=</span><span class="token string">"panel"</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h3<span class="token operator">></span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h3<span class="token operator">></span>
      <span class="token punctuation">{</span>isActive <span class="token operator">?</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setIsActive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token maybe-class-name">Afficher</span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>section<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Accordion</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h2<span class="token operator">></span><span class="token maybe-class-name">Almaty</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Kazakhstan</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h2<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Panel</span> title<span class="token operator">=</span><span class="token string">"À propos"</span><span class="token operator">></span>
        <span class="token maybe-class-name">Avec</span> une population d<span class="token string">'environ 2 millions d'</span>habitants<span class="token punctuation">,</span> <span class="token maybe-class-name">Almaty</span> est la plus grande ville du <span class="token maybe-class-name">Kazakhstan</span><span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">Elle</span></span> en était la capitale <span class="token number">1929</span> à <span class="token number">1997.</span>
        <span class="token maybe-class-name">With</span> a population <span class="token keyword">of</span> about <span class="token number">2</span> million<span class="token punctuation">,</span> <span class="token maybe-class-name">Almaty</span> is <span class="token maybe-class-name">Kazakhstan</span>'s largest city<span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">From</span></span> <span class="token number">1929</span> to <span class="token number">1997</span><span class="token punctuation">,</span> it was its capital city<span class="token punctuation">.</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Panel</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Panel</span> title<span class="token operator">=</span><span class="token string">"Étymologie"</span><span class="token operator">></span>
        <span class="token maybe-class-name">Le</span> nom vient de <span class="token operator">&#x3C;</span>span lang<span class="token operator">=</span><span class="token string">"kk-KZ"</span><span class="token operator">></span>алма<span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">,</span> le mot kazakh pour « pomme » <span class="token punctuation">;</span> il est souvent traduit par « pleine de pommes »<span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">En</span></span> fait<span class="token punctuation">,</span> la région entourant <span class="token maybe-class-name">Almaty</span> est considérée comme le berceau ancestral de la pomme<span class="token punctuation">,</span> et la <span class="token operator">&#x3C;</span>i lang<span class="token operator">=</span><span class="token string">"la"</span><span class="token operator">></span><span class="token maybe-class-name">Malus</span> sieversii<span class="token operator">&#x3C;</span><span class="token operator">/</span>i<span class="token operator">></span> sauvage est considérée comme une probable candidate pour être l'ancêtre de la pomme domestique moderne<span class="token punctuation">.</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Panel</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">h3<span class="token punctuation">,</span> p</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span> <span class="token number">0</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector"><span class="token class">.panel</span></span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">px</span> solid <span class="token hexcode color">#aaa</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>Constatez que le fait d'appuyer sur le bouton d'un des panneaux n'affecte pas l'affichage de l'autre panneau : ils sont indépendants.</p><diagramgroup><diagram name="sharing_state_child"height="{367}"width="{477}"alt="Un diagramme montrant un arbre de trois composants, avec un parent appelé Accordion et deux enfants appelés Panel. Les deux composants Panel contiennent une valeur isActive valant false."><p>Initialement, l'état <code>isActive</code> de chaque <code>Panel</code> vaut <code>false</code>, ils apparaissent donc repliés.</p></diagram><diagram name="sharing_state_child_clicked"height="{367}"width="{480}"alt="Le même diagramme que le précédent, avec le isActive du premier enfant Panel surligné indiquant un clic, et dont la valeur est à true. Le second composant Panel contient toujours une valeur à false."><p>Le fait de cliquer sur le bouton d'un <code>Panel</code> ne met à jour que l'état <code>isActive</code> de ce <code>Panel</code>.</p></diagram></diagramgroup><p><strong>Supposons maintenant que vous souhaitiez le modifier afin qu'un seul panneau soit déplié à la fois.</strong> Avec cette conception, étendre le second panneau devrait replier le premier. Comment feriez-vous ça ?<p>Afin de coordonner ces deux panneaux, vous devez « faire remonter leur état » jusqu'à un composant parent en trois étapes :<ol><li><strong>Retirez</strong> les états des composants enfants.<li><strong>Passez</strong> des valeurs codées en dur depuis le parent commun.<li><strong>Ajoutez</strong> l'état au parent commun et passez-le aux enfants avec les gestionnaires d'événements.</ol><p>Ça permettra au composant <code>Accordion</code> de coordonner les deux <code>Panel</code> et ainsi n'en déplier qu'un seul à la fois.<section class="level3"aria-labelledby="étape-1-retirez-létat-des-composants-enfants-step-1-remove-state-from-the-child-components"><h3 id="étape-1-retirez-létat-des-composants-enfants-step-1-remove-state-from-the-child-components">Étape 1 : retirez l'état des composants enfants {/<em>step-1-remove-state-from-the-child-components</em>/}</h3><p>Vous donnerez le contrôle du <code>isActive</code> des <code>Panel</code> au composant parent. Ça signifie que le composant parent passera <code>isActive</code> aux <code>Panel</code> <em>via</em> les props. Commencez par <strong>supprimer cette ligne</strong> du composant <code>Panel</code> :<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>isActive<span class="token punctuation">,</span> setIsActive<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>À la place, ajoutez <code>isActive</code> à la liste des props de <code>Panel</code> :<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Panel</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> title<span class="token punctuation">,</span> children<span class="token punctuation">,</span> isActive <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code></pre><p>Désormais, le composant parent du <code>Panel</code> peut <em>contrôler</em> <code>isActive</code> en <a href="/learn/passing-props-to-a-component">le passant en tant que prop</a>. À l'inverse, le composant <code>Panel</code> <em>n'a plus le contrôle</em> sur la valeur de <code>isActive</code> — elle est désormais entre les mains du composant parent !</section><section class="level3"aria-labelledby="étape-2-passez-la-valeur-codée-en-dur-depuis-le-parent-commun-step-2-pass-hardcoded-data-from-the-common-parent"><h3 id="étape-2-passez-la-valeur-codée-en-dur-depuis-le-parent-commun-step-2-pass-hardcoded-data-from-the-common-parent">Étape 2 : passez la valeur codée en dur depuis le parent commun {/<em>step-2-pass-hardcoded-data-from-the-common-parent</em>/}</h3><p>Pour faire remonter l'état, vous devez identifier le parent commun le plus proche des <em>deux</em> composants enfants que vous souhaitez coordonner :<ul><li><code>Accordion</code> <em>(parent commun le plus proche)</em><ul><li><code>Panel</code><li><code>Panel</code></ul></ul><p>Dans cet exemple, il s'agit du composant <code>Accordion</code>. Puisqu'il se situe au-dessus des deux panneaux et qu'il peut contrôler leurs props, il devient la « source de vérité » pour savoir quel panneau est actuellement actif. Faites en sorte que le composant <code>Accordion</code> passe la valeur codée en dur de <code>isActive</code> (par exemple <code>true</code>) aux deux panneaux :</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Accordion</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h2<span class="token operator">></span><span class="token maybe-class-name">Almaty</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Kazakhstan</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h2<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Panel</span> title<span class="token operator">=</span><span class="token string">"À propos"</span> isActive<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Avec</span> une population d<span class="token string">'environ 2 millions d'</span>habitants<span class="token punctuation">,</span> <span class="token maybe-class-name">Almaty</span> est la plus grande ville du <span class="token maybe-class-name">Kazakhstan</span><span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">De</span></span> <span class="token number">1929</span> à <span class="token number">1997</span><span class="token punctuation">,</span> elle en a été la capitale<span class="token punctuation">.</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Panel</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Panel</span> title<span class="token operator">=</span><span class="token string">"Étymologie"</span> isActive<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Le</span> nom vient de <span class="token operator">&#x3C;</span>span lang<span class="token operator">=</span><span class="token string">"kk-KZ"</span><span class="token operator">></span>алма<span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">,</span> le mot kazakh pour « pomme » <span class="token punctuation">;</span> il est souvent traduit par « pleine de pommes »<span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">En</span></span> fait<span class="token punctuation">,</span> la région entourant <span class="token maybe-class-name">Almaty</span> est considérée comme le berceau ancestral de la pomme<span class="token punctuation">,</span> et la <span class="token operator">&#x3C;</span>i lang<span class="token operator">=</span><span class="token string">"la"</span><span class="token operator">></span><span class="token maybe-class-name">Malus</span> sieversii<span class="token operator">&#x3C;</span><span class="token operator">/</span>i<span class="token operator">></span> sauvage est considérée comme une probable candidate pour être l'ancêtre de la pomme domestique moderne<span class="token punctuation">.</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Panel</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Panel</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> title<span class="token punctuation">,</span> children<span class="token punctuation">,</span> isActive <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>section className<span class="token operator">=</span><span class="token string">"panel"</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h3<span class="token operator">></span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h3<span class="token operator">></span>
      <span class="token punctuation">{</span>isActive <span class="token operator">?</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setIsActive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token maybe-class-name">Afficher</span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>section<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">h3<span class="token punctuation">,</span> p</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span> <span class="token number">0</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector"><span class="token class">.panel</span></span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">px</span> solid <span class="token hexcode color">#aaa</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>Modifiez les valeurs de <code>isActive</code> codées en dur dans le composant <code>Accordion</code> et voyez le résultat à l'écran.</section><section class="level3"aria-labelledby="étape-3-ajoutez-létat-au-parent-commun-step-3-add-state-to-the-common-parent"><h3 id="étape-3-ajoutez-létat-au-parent-commun-step-3-add-state-to-the-common-parent">Étape 3 : ajoutez l'état au parent commun {/<em>step-3-add-state-to-the-common-parent</em>/}</h3><p>Faire remonter l'état change souvent la nature de ce que vous y stockez.<p>Dans cet exemple, un seul panneau doit être actif à un instant donné. Ça signifie que le parent commun <code>Accordion</code> doit garder trace de <em>quel</em> panneau est actif. Pour la variable d'état, il pourrait utiliser un nombre représentant l'index du <code>Panel</code> actif plutôt qu'un <code>boolean</code> :<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>activeIndex<span class="token punctuation">,</span> setActiveIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Quand <code>activeIndex</code> vaut <code>0</code>, le premier panneau est actif, et quand il vaut <code>1</code>, alors c'est le second.<p>Le fait d'appuyer sur le bouton « Afficher » dans l'un ou l'autre des <code>Panel</code> doit modifier l'index actif dans <code>Accordion</code>. Un <code>Panel</code> ne peut définir l'état <code>activeIndex</code> directement puisqu'il est défini à l'intérieur d'<code>Accordion</code>. Ce dernier doit <em>explicitement autoriser</em> le composant <code>Panel</code> à changer son état en <a href="/learn/responding-to-events#passing-event-handlers-as-props">lui transmettant un gestionnaire d'événement en tant que prop</a> :<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Panel</span>
    isActive<span class="token operator">=</span><span class="token punctuation">{</span>activeIndex <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">}</span>
    onShow<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setActiveIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
  <span class="token operator">></span>
    <span class="token spread operator">...</span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Panel</span><span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Panel</span>
    isActive<span class="token operator">=</span><span class="token punctuation">{</span>activeIndex <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">}</span>
    onShow<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setActiveIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
  <span class="token operator">></span>
    <span class="token spread operator">...</span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Panel</span><span class="token operator">></span>
<span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span></code></pre><p>Le <code>&#x3C;button></code> à l'intérieur du <code>Panel</code> va maintenant utiliser la prop <code>onShow</code> comme gestionnaire d'événement pour le clic :</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Accordion</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>activeIndex<span class="token punctuation">,</span> setActiveIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h2<span class="token operator">></span><span class="token maybe-class-name">Almaty</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Kazakhstan</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h2<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Panel</span>
        title<span class="token operator">=</span><span class="token string">"À propos"</span>
        isActive<span class="token operator">=</span><span class="token punctuation">{</span>activeIndex <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">}</span>
        onShow<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setActiveIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">></span>
        <span class="token maybe-class-name">Avec</span> une population d<span class="token string">'environ 2 millions d'</span>habitants<span class="token punctuation">,</span> <span class="token maybe-class-name">Almaty</span> est la plus grande ville du <span class="token maybe-class-name">Kazakhstan</span><span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">De</span></span> <span class="token number">1929</span> à <span class="token number">1997</span><span class="token punctuation">,</span> elle en a été la capitale<span class="token punctuation">.</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Panel</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Panel</span>
        title<span class="token operator">=</span><span class="token string">"Étymologie"</span>
        isActive<span class="token operator">=</span><span class="token punctuation">{</span>activeIndex <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">}</span>
        onShow<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setActiveIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">></span>
        <span class="token maybe-class-name">Le</span> nom vient de <span class="token operator">&#x3C;</span>span lang<span class="token operator">=</span><span class="token string">"kk-KZ"</span><span class="token operator">></span>алма<span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">,</span> le mot kazakh pour « pomme » <span class="token punctuation">;</span> il est souvent traduit par « pleine de pommes »<span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">En</span></span> fait<span class="token punctuation">,</span> la région entourant <span class="token maybe-class-name">Almaty</span> est considérée comme le berceau ancestral de la pomme<span class="token punctuation">,</span> et la <span class="token operator">&#x3C;</span>i lang<span class="token operator">=</span><span class="token string">"la"</span><span class="token operator">></span><span class="token maybe-class-name">Malus</span> sieversii<span class="token operator">&#x3C;</span><span class="token operator">/</span>i<span class="token operator">></span> sauvage est considérée comme une probable candidate pour être l'ancêtre de la pomme domestique moderne<span class="token punctuation">.</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Panel</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Panel</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>
  title<span class="token punctuation">,</span>
  children<span class="token punctuation">,</span>
  isActive<span class="token punctuation">,</span>
  onShow
<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>section className<span class="token operator">=</span><span class="token string">"panel"</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h3<span class="token operator">></span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h3<span class="token operator">></span>
      <span class="token punctuation">{</span>isActive <span class="token operator">?</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>onShow<span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token maybe-class-name">Afficher</span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>section<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">h3<span class="token punctuation">,</span> p</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span> <span class="token number">0</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector"><span class="token class">.panel</span></span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">px</span> solid <span class="token hexcode color">#aaa</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><p>Ainsi s'achève la partie pour faire remonter l'état ! Déplacer l'état dans le composant parent commun vous permet de coordonner les deux panneaux. L'utilisation d'un index actif à la place de deux indicateurs « est affiché » garantit qu'un seul panneau est actif à la fois. Enfin, passer le gestionnaire d'événement à l'enfant permet à ce dernier de changer l'état du parent.</p><diagramgroup><diagram name="sharing_state_parent"height="{385}"width="{487}"alt="Un diagramme montrant un arbre de trois composants, un parent appelé Accordion et deux enfants appelés Panel. Accordion contient une valeur activeIndex à 0 qui se transforme en une valeur isActive à true passée au premier Panel et une autre à false passée au second Panel."><p>Au départ, la valeur du <code>activeIndex</code> de l'<code>Accordion</code> vaut <code>0</code>, le premier <code>Panel</code> reçoit donc <code>isActive = true</code>.</p></diagram><diagram name="sharing_state_parent_clicked"height="{385}"width="{521}"alt="Le même diagramme que le précédent, avec la valeur de activeIndex du parent Accordion en surbrillance, indiquant un clic et dont la valeur a été changée en 1. Le flux en direction des deux composants enfants Panel est également en surbrillance, la valeur isActive passée à chacun des enfants étant définie par opposition : false pour le premier Panel et true pour le second."><p>Quant l'état <code>activeIndex</code> de l'<code>Accordion</code> change à <code>1</code>, le second <code>Panel</code> reçoit désormais <code>isActive = true</code>.</p></diagram></diagramgroup><deepdive><section class="level4"aria-labelledby="composants-contrôlés-et-non-contrôlés-controlled-and-uncontrolled-components"><h4 id="composants-contrôlés-et-non-contrôlés-controlled-and-uncontrolled-components">Composants contrôlés et non contrôlés {/<em>controlled-and-uncontrolled-components</em>/}</h4><p>Il est courant d'appeler « non contrôlé » un composant ayant un état local. Par exemple, le composant <code>Panel</code> d'origine avec une variable d'état <code>isActive</code> est non contrôlé parce que son parent ne peut pas influencer le fait que le panneau soit actif ou non.<p>À l'inverse, vous pouvez dire qu'un composant est « contrôlé » quand les informations importantes qu'il contient sont pilotées par les props plutôt que par son propre état local. Ça permet au parent de spécifier entièrement son comportement. Le composant final <code>Panel</code> avec la prop <code>isActive</code> est contrôlé par le composant <code>Accordion</code>.<p>Les composants non contrôlés sont plus simples d'utilisation au sein de leurs parents puisqu'ils nécessitent moins de configuration. Cependant, ils sont moins flexibles lorsque vous souhaitez les coordonner . Les composants contrôlés sont extrêmement flexibles, mais leurs composants parents doivent les configurer complètement avec des props.<p>Dans la pratique, « contrôlé » et « non contrôlé » ne sont pas des termes techniques stricts — chaque composant dispose généralement d'un mélange entre état local et props. Ça reste une façon pratique de décrire comment les composants sont conçus et les capacités qu'ils offrent.<p>En écrivant un composant, déterminez quelles informations doivent être contrôlées (<em>via</em> les props) ou non contrôlées (<em>via</em> l'état). De toutes façons, vous pouvez toujours changer d'avis par la suite et remanier le composant.</section></deepdive></section></section><section class="level2"aria-labelledby="une-source-de-vérité-unique-pour-chaque-état-a-single-source-of-truth-for-each-state"><h2 id="une-source-de-vérité-unique-pour-chaque-état-a-single-source-of-truth-for-each-state">Une source de vérité unique pour chaque état {/<em>a-single-source-of-truth-for-each-state</em>/}</h2><p>Dans une application React, de nombreux composants auront leur propre état. Ces derniers peuvent « vivre » à proximité des composants feuilles (les composants en bas de l'arbre) tels que les champs de saisie. D'autres peuvent « vivre » plus proches de la racine de l'appli. Ainsi, même les bibliothèques de routage côté client sont généralement implémentées en stockant la route actuelle dans un état React, puis en la transmettant au travers des props !<p><strong>Pour chaque élément unique de l'état, vous devrez choisir le composant auquel il va « appartenir ».</strong> Ce principe est également connu comme une <a href="https://en.wikipedia.org/wiki/Single_source_of_truth">« source de vérité unique »</a> <em>(lien en anglais, NdT)</em>. Ça ne signifie pas que tout l'état se situe à un seul endroit mais plutôt que pour <em>chaque</em> élément d'état, il y a un composant <em>spécifique</em> qui détient cet élément. Au lieu de dupliquer un état partagé entre des composants, il faut le <em>faire remonter</em> jusqu'à leur parent commun, puis le <em>passer vers le bas</em> aux composants qui en ont besoin.<p>Votre appli évoluera au fur et à mesure que vous y travaillerez. Il est fréquent que vous déplaciez un état vers le bas ou vers le haut alors que vous êtes en train de déterminer où chaque élément de l'état doit « vivre ». Ça fait partie du processus !<p>Pour voir ce que ça donne en pratique avec quelques composants supplémentaires, lisez <a href="/learn/thinking-in-react">Penser en React</a>.</p><recap><ul><li>Lorsque vous souhaitez coordonner deux composants, déplacez leur état vers leur parent commun.<li>Ensuite, passez l'information vers le bas <em>via</em> les props provenant de leur parent commun.<li>Enfin, transmettez des gestionnaires d'événements afin que les enfants puissent changer l'état du parent.<li>Il est utile de considérer les composants comme étant « contrôlés » (pilotés par les props) ou « non contrôlés » (pilotés par l'état).</ul></recap><challenges><section class="level4"aria-labelledby="saisies-synchronisées-synced-inputs"><h4 id="saisies-synchronisées-synced-inputs">Saisies synchronisées {/<em>synced-inputs</em>/}</h4><p>Ces deux champs de saisie sont indépendants. Faites en sorte qu'ils soient synchronisés : modifier l'un des champs doit également mettre à jour l'autre champ avec le même texte, et vice-versa.</p><hint><p>Vous aurez besoin de faire remonter l'état au composant parent.</p></hint><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">SyncedInputs</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Input</span> label<span class="token operator">=</span><span class="token string">"Premier champ"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Input</span> label<span class="token operator">=</span><span class="token string">"Deuxième champ"</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Input</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> label <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setText</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
      <span class="token punctuation">{</span>label<span class="token punctuation">}</span>
      <span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span>input
        value<span class="token operator">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">label</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution><p>Déplacez la variable d'état <code>text</code> dans le parent commun ainsi que le gestionnaire <code>handleChange</code>. Ensuite, passez-les vers le bas aux deux composants <code>Input</code>. Ils resteront ainsi synchronisés.</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">SyncedInputs</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setText</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Input</span>
        label<span class="token operator">=</span><span class="token string">"Premier champ"</span>
        value<span class="token operator">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Input</span>
        label<span class="token operator">=</span><span class="token string">"Deuxième champ"</span>
        value<span class="token operator">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Input</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> label<span class="token punctuation">,</span> value<span class="token punctuation">,</span> onChange <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
      <span class="token punctuation">{</span>label<span class="token punctuation">}</span>
      <span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span>input
        value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span>onChange<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">label</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack></solution></section><section class="level4"aria-labelledby="filtrer-une-liste-filtering-a-list"><h4 id="filtrer-une-liste-filtering-a-list">Filtrer une liste {/<em>filtering-a-list</em>/}</h4><p>Dans cet exemple, la <code>SearchBar</code> dispose de son propre état <code>query</code> qui contrôle le champ de saisie. Son composant parent <code>FilterableList</code> affiche une <code>List</code> d'éléments, mais ne tient pas compte de la recherche.<p>Utilisez la fonction <code>filterItems(foods, query)</code> pour filtrer la liste selon la requête de recherche. Pour tester vos modifications, vérifiez que le fait de taper « s » dans le champ de filtre réduit la liste aux éléments « Sushi », « Shish kebab » et « Dim sum ».<p>Remarquez que <code>filterItems</code> est déjà implémentée et importée afin que vous n'ayez pas à l'écrire vous-même !</p><hint><p>Vous devrez retirer l'état <code>query</code> et le gestionnaire <code>handleChange</code> de la <code>SearchBar</code> puis les déplacer dans <code>FilterableList</code>. Transmettez-les ensuite à <code>SearchBar</code> en tant que props <code>query</code> et <code>onChange</code>.</p></hint><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> foods<span class="token punctuation">,</span> filterItems <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./data.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">FilterableList</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">SearchBar</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">List</span> items<span class="token operator">=</span><span class="token punctuation">{</span>foods<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">SearchBar</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>query<span class="token punctuation">,</span> setQuery<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setQuery</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
      <span class="token literal-property property">Recherche</span> <span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span>input
        value<span class="token operator">=</span><span class="token punctuation">{</span>query<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">List</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> items <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>table<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>tbody<span class="token operator">></span>
        <span class="token punctuation">{</span>items<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">food</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
          <span class="token operator">&#x3C;</span>tr key<span class="token operator">=</span><span class="token punctuation">{</span>food<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token operator">></span>
            <span class="token operator">&#x3C;</span>td<span class="token operator">></span><span class="token punctuation">{</span>food<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>td<span class="token operator">></span>
            <span class="token operator">&#x3C;</span>td<span class="token operator">></span><span class="token punctuation">{</span>food<span class="token punctuation">.</span><span class="token property-access">description</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>td<span class="token operator">></span>
          <span class="token operator">&#x3C;</span><span class="token operator">/</span>tr<span class="token operator">></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>tbody<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>table<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">filterItems</span><span class="token punctuation">(</span><span class="token parameter">items<span class="token punctuation">,</span> query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token method function property-access">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> items<span class="token punctuation">.</span><span class="token method function property-access">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token arrow operator">=></span>
    item<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">some</span><span class="token punctuation">(</span><span class="token parameter">word</span> <span class="token arrow operator">=></span>
      word<span class="token punctuation">.</span><span class="token method function property-access">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">startsWith</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">const</span> foods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Sushi'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'Le sushi est un plat traditionnel japonais préparé à base de riz vinaigré.'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Dal'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">"Le dal est généralement préparé sous forme d'une soupe à laquelle on peut ajouter des oignons, des tomates et diverses épices."</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Pierogi'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">"Les pierogi sont des boulettes fourrées fabriquées en enroulant une pâte non levée autour d'une farce salée ou sucrée et en la faisant cuire dans de l'eau bouillante."</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Shish kebab'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'Le shish kebab est un plat populaire composé de cubes de viande embrochés et grillés.'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Dim sum'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'Le dim sum est un large éventail de petits plats que les Cantonais dégustent traditionnellement dans les restaurants pour le petit-déjeuner et le déjeuner.'</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></sandpack><solution><p>Il faut faire remonter l'état <code>query</code> dans le composant <code>FilterableList</code>. Il faut ensuite appeler <code>filterItems(foods, query)</code> pour obtenir la liste filtrée et la passer à la <code>List</code>. Les modifications du champ de requête se reflètent désormais dans la liste :</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> foods<span class="token punctuation">,</span> filterItems <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./data.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">FilterableList</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>query<span class="token punctuation">,</span> setQuery<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token function">filterItems</span><span class="token punctuation">(</span>foods<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setQuery</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">SearchBar</span>
        query<span class="token operator">=</span><span class="token punctuation">{</span>query<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">List</span> items<span class="token operator">=</span><span class="token punctuation">{</span>results<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">SearchBar</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> query<span class="token punctuation">,</span> onChange <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
      <span class="token literal-property property">Recherche</span> <span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span>input
        value<span class="token operator">=</span><span class="token punctuation">{</span>query<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span>onChange<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">List</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> items <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>table<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>tbody<span class="token operator">></span>
        <span class="token punctuation">{</span>items<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">food</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
          <span class="token operator">&#x3C;</span>tr key<span class="token operator">=</span><span class="token punctuation">{</span>food<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token operator">></span>
            <span class="token operator">&#x3C;</span>td<span class="token operator">></span><span class="token punctuation">{</span>food<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>td<span class="token operator">></span>
            <span class="token operator">&#x3C;</span>td<span class="token operator">></span><span class="token punctuation">{</span>food<span class="token punctuation">.</span><span class="token property-access">description</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>td<span class="token operator">></span>
          <span class="token operator">&#x3C;</span><span class="token operator">/</span>tr<span class="token operator">></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>tbody<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>table<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">filterItems</span><span class="token punctuation">(</span><span class="token parameter">items<span class="token punctuation">,</span> query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token method function property-access">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> items<span class="token punctuation">.</span><span class="token method function property-access">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token arrow operator">=></span>
    item<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">some</span><span class="token punctuation">(</span><span class="token parameter">word</span> <span class="token arrow operator">=></span>
      word<span class="token punctuation">.</span><span class="token method function property-access">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">startsWith</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">const</span> foods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Sushi'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'Le sushi est un plat traditionnel japonais préparé à base de riz vinaigré.'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Dal'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">"Le dal est généralement préparé sous forme d'une soupe à laquelle on peut ajouter des oignons, des tomates et diverses épices."</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Pierogi'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">"Les pierogi sont des boulettes fourrées fabriquées en enroulant une pâte non levée autour d'une farce salée ou sucrée et en la faisant cuire dans de l'eau bouillante."</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Shish kebab'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'Le shish kebab est un plat populaire composé de cubes de viande embrochés et grillés.'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Dim sum'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'Le dim sum est un large éventail de petits plats que les Cantonais dégustent traditionnellement dans les restaurants pour le petit-déjeuner et le déjeuner.'</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></sandpack></solution><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></challenges></section></section>