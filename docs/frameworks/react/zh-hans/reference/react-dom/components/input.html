<!doctype html><html lang="zh-hans"><meta charset="utf-8"><title>"&#x3C;input>"</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="input"><h1 id="input">"<input>"</h1><intro><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/input">浏览器内置的 <code>&#x3C;input></code> 组件</a> 允许你渲染不同类型的表单输入框。<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span>input <span class="token operator">/</span><span class="token operator">></span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="参考-reference"><h2 id="参考-reference">参考 {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="input-input"><h3 id="input-input"><code>&#x3C;input></code> {/<em>input</em>/}</h3><p>渲染 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/input">浏览器内置的 <code>&#x3C;input></code></a> 组件以展示输入框。<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span>input name<span class="token operator">=</span><span class="token string">"myInput"</span> <span class="token operator">/</span><span class="token operator">></span></code></pre><p><a href="#usage">参见下面更多示例</a>。<section class="level4"aria-labelledby="属性-props"><h4 id="属性-props">属性 {/<em>props</em>/}</h4><p><code>&#x3C;input></code> 支持所有 <a href="/reference/react-dom/components/common#props">常见的元素属性</a>。<p>你可以传递以下属性中的任意一个，以将其变为 <a href="#controlling-an-input-with-a-state-variable">受控输入框</a>：<ul><li><code>checked</code>：布尔值，控制复选框或单选按钮是否被选中。<li><code>value</code>：字符串，控制文本框的输入文本（如果是单选按钮，则为其表单数据）。</ul><p>当你传递它们之一时，你必须同时传递 <code>onChange</code> 处理函数，用于更新传递的值。<p>以下 <code>&#x3C;input></code> 属性仅在非受控输入框中有效：<ul><li><code>defaultChecked</code>：布尔值，指定 <code>type="checkbox"</code> 和 <code>type="radio"</code> 输入的 <a href="#providing-an-initial-value-for-an-input">初始值</a>。<li><code>defaultValue</code>：字符串，指定文本框的 <a href="#providing-an-initial-value-for-an-input">初始值</a>。</ul><p>以下 <code>&#x3C;input></code> 属性均可用于受控与非受控输入框：<ul><li><code>accept</code>：字符串，指定 <code>type="file"</code> 输入框所接受的文件类型。<li><code>alt</code>：字符串，指定 <code>type="image"</code> 输入框的替代图像文本。<li><code>capture</code>：字符串，指定 <code>type="file"</code> 输入框所捕获的媒体（麦克风、视频或摄像头）。<li><code>autoComplete</code>：字符串，指定可能的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Attributes/autocomplete#values">自动填充行为</a> 之一。<li><code>autoFocus</code>：布尔值。如果为 <code>true</code>，React 将在挂载时聚焦于此元素。<li><code>dirname</code>：字符串，指定元素的方向性的表单字段名称。<li><code>disabled</code>：布尔值。如果为<code>true</code>，输入框将无法交互并显示为不可用（dimmed）。<li><code>children</code>：<code>&#x3C;input></code> 不接受子元素。<li><code>form</code>：字符串，指定此输入框所属的 <code>&#x3C;form></code> 的 <code>id</code>。如果未指定，则为最近的父表单。<li><code>formAction</code>：字符串。输入框指定此值并指定 <code>type="submit"</code> 或 <code>type="image"</code> 后将覆盖父表单对应属性 <code>&#x3C;form action></code>。<li><code>formEnctype</code>：字符串。输入框指定此值并指定 <code>type="submit"</code> 或 <code>type="image"</code> 后将覆盖父表单对应属性 <code>&#x3C;form enctype></code>。<li><code>formMethod</code>：字符串。输入框指定此值并指定 <code>type="submit"</code> 或 <code>type="image"</code> 后将覆盖父表单对应属性 <code>&#x3C;form method></code>。<li><code>formNoValidate</code>：字符串。输入框指定此值并指定 <code>type="submit"</code> 或 <code>type="image"</code> 后将覆盖父表单对应属性 <code>&#x3C;form noValidate></code>。<li><code>formTarget</code>：字符串。输入框指定此值并指定 <code>type="submit"</code> 或 <code>type="image"</code> 后将覆盖父表单对应属性 <code>&#x3C;form target></code>。<li><code>height</code>：字符串，指定 <code>type="image"</code> 的图像高度。<li><code>list</code>：字符串，指定带有自动完成选项的 <code>&#x3C;datalist></code> 的 <code>id</code>。<li><code>max</code>：数字，指定数值和日期时间输入的最大值。<li><code>maxLength</code>：数字，指定文本和其他输入的最大长度。<li><code>min</code>：数字，指定数值和日期时间输入的最小值。<li><code>minLength</code>：数字，指定文本和其他输入的最小长度。<li><code>multiple</code>：布尔值，指定是否允许 <code>&#x3C;type="file"</code> 和 <code>type="email"</code> 指定多个值。<li><code>name</code>：字符串，指定此输入框的名称，它将 <a href="#reading-the-input-values-when-submitting-a-form">随表单一起提交</a>。<li><code>onChange</code>：一个 <a href="/reference/react-dom/components/common#event-handler"><code>Event</code></a> 处理函数。如果这是 <a href="#controlling-an-input-with-a-state-variable">受控输入框</a>，则必须提供。在用户更改输入框的值时立即触发（例如，每次按键时触发）。行为类似于浏览器的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/input_event"><code>input</code></a> 事件。<li><code>onChangeCapture</code>：与 <code>onChange</code> 类似，但是是在 <a href="/learn/responding-to-events#capture-phase-events">捕获阶段</a> 触发。<li><code>onInput</code>：一个 <a href="/reference/react-dom/components/common#event-handler"><code>Event</code></a> 处理函数。在用户更改值时立即触发。由于历史原因，在 React 中习惯于使用 <code>onChange</code>，工作方式类似。<li><code>onInputCapture</code>：与 <code>onInput</code> 类似，但是是在 <a href="/learn/responding-to-events#capture-phase-events">捕获阶段</a> 触发。<li><code>onInvalid</code>：一个 <a href="/reference/react-dom/components/common#event-handler"><code>Event</code></a> 处理函数。在表单提交时，如果输入框未通过验证将触发。与内置的 <code>invalid</code> 事件不同，React 的 <code>onInvalid</code> 事件可以进行冒泡。<li><code>onInvalidCapture</code>：与 <code>onInvalid</code> 类似，但是是在 <a href="/learn/responding-to-events#capture-phase-events">捕获阶段</a> 触发。<li><code>onSelect</code>：一个 <a href="/reference/react-dom/components/common#event-handler"><code>Event</code></a> 处理函数。在 <code>&#x3C;input></code> 内的选择更改后触发。React 扩展了 <code>onSelect</code> 事件，使其也能在选择为空和编辑时触发（可能会影响选择）。<li><code>onSelectCapture</code>：与 <code>onSelect</code> 类似，但是是在 <a href="/learn/responding-to-events#capture-phase-events">捕获阶段</a> 触发。<li><code>pattern</code>：字符串，指定 <code>value</code> 必须匹配的模式。<li><code>placeholder</code>：字符串，当输入值为空时，以暗淡的颜色显示的内容。<li><code>readOnly</code>：布尔值。如果为 <code>true</code>，用户无法编辑输入。<li><code>required</code>：布尔值。如果为 <code>true</code>，提交表单时必须提供此输入框的值。<li><code>size</code>：数字，类似于设置宽度，但单位取决于控件。<li><code>src</code>：字符串，指定 <code>type="image"</code> 输入框的图像源。<li><code>step</code>：正数或 <code>'any'</code> 字符串，指定有效值之间的距离。<li><code>type</code>：字符串，<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/input#input_types">输入框类型</a> 中的一个。<li><code>width</code>：字符串，指定 <code>type="image"</code> 输入框的图像宽度。</ul></section><section class="level4"aria-labelledby="注意-caveats"><h4 id="注意-caveats">注意 {/<em>caveats</em>/}</h4><ul><li>复选框需要使用 <code>checked</code> 或 <code>defaultChecked</code>，而不是 <code>value</code> 或 <code>defaultValue</code>。<li>如果文本框接收到字符串类型的 <code>value</code> 属性，则会被 <a href="#controlling-an-input-with-a-state-variable">视为受控组件</a>。<li>如果复选框或单选按钮接收到布尔类型的 <code>checked</code> 属性，则会被 <a href="#controlling-an-input-with-a-state-variable">视为受控组件</a>。<li>一个输入框不能同时既是受控组件又是非受控组件。<li>一个输入框在其生命周期中不能在受控和非受控之间切换。<li>每个受控组件都需要一个 <code>onChange</code> 事件处理函数，用于同步更新其值。</ul></section></section></section><section class="level2"aria-labelledby="用法-usage"><h2 id="用法-usage">用法 {/<em>usage</em>/}</h2><section class="level3"aria-labelledby="展示不同类型的输入框-displaying-inputs-of-different-types"><h3 id="展示不同类型的输入框-displaying-inputs-of-different-types">展示不同类型的输入框 {/<em>displaying-inputs-of-different-types</em>/}</h3><p>渲染 <code>input</code> 组件展示输入框。默认情况下，这是一个文本框。你可以传递 <code>type="checkbox"</code> 将其指定为多选框；或者传递 <code>type="radio"</code> 将其指定为单选按钮；<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/input#input_types">你也可以将其指定为其他类型</a>。</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyForm</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        文本框：<span class="token operator">&#x3C;</span>input name<span class="token operator">=</span><span class="token string">"myInput"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        多选框<span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> name<span class="token operator">=</span><span class="token string">"myCheckbox"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span>
        单选按钮：
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> name<span class="token operator">=</span><span class="token string">"myRadio"</span> value<span class="token operator">=</span><span class="token string">"option1"</span> <span class="token operator">/</span><span class="token operator">></span>
          选项一
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> name<span class="token operator">=</span><span class="token string">"myRadio"</span> value<span class="token operator">=</span><span class="token string">"option2"</span> <span class="token operator">/</span><span class="token operator">></span>
          选项二
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> name<span class="token operator">=</span><span class="token string">"myRadio"</span> value<span class="token operator">=</span><span class="token string">"option3"</span> <span class="token operator">/</span><span class="token operator">></span>
          选项三
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack></section><section class="level3"aria-labelledby="为输入框提供-label-属性-providing-a-label-for-an-input"><h3 id="为输入框提供-label-属性-providing-a-label-for-an-input">为输入框提供 label 属性 {/<em>providing-a-label-for-an-input</em>/}</h3><p>一般而言，应该将每个 <code>&#x3C;input></code> 都放置在 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/label"><code>&#x3C;label></code></a> 内，表示此标签与该选择框相关联。当用户单击标签时，浏览器将自动聚焦选择框。这对于可访问性也非常重要：当用户聚焦选择框时，屏幕阅读器将宣布标签标题。<p>如果无法将 <code>&#x3C;input></code> 放置在 <code>&#x3C;label></code> 内，请通过将相同的 ID 传递给 <code>&#x3C;input id></code> 与 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLLabelElement/htmlFor"><code>&#x3C;label htmlFor></code></a> 来将它们关联起来。为了避免一个组件的多实例之间的冲突，使用 <a href="/reference/react/useId">useId</a> 生成这样的 ID。</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useId <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ageInputId <span class="token operator">=</span> <span class="token function">useId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        你的名称：
        <span class="token operator">&#x3C;</span>input name<span class="token operator">=</span><span class="token string">"firstName"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label htmlFor<span class="token operator">=</span><span class="token punctuation">{</span>ageInputId<span class="token punctuation">}</span><span class="token operator">></span>你的年龄：<span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input id<span class="token operator">=</span><span class="token punctuation">{</span>ageInputId<span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token string">"age"</span> type<span class="token operator">=</span><span class="token string">"number"</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack></section><section class="level3"aria-labelledby="为输入框提供初始值-providing-an-initial-value-for-an-input"><h3 id="为输入框提供初始值-providing-an-initial-value-for-an-input">为输入框提供初始值 {/<em>providing-an-initial-value-for-an-input</em>/}</h3><p>你可以为任何输入框指定初始值。如果要为文本框指定初始值，传递字符串 <code>defaultValue</code>；如果要为复选框和单选按钮指定初始值，传递布尔值 <code>defaultChecked</code>。</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyForm</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        文本框：<span class="token operator">&#x3C;</span>input name<span class="token operator">=</span><span class="token string">"myInput"</span> defaultValue<span class="token operator">=</span><span class="token string">"Some initial value"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        多选框：<span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> name<span class="token operator">=</span><span class="token string">"myCheckbox"</span> defaultChecked<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span>
        单选按钮：
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> name<span class="token operator">=</span><span class="token string">"myRadio"</span> value<span class="token operator">=</span><span class="token string">"option1"</span> <span class="token operator">/</span><span class="token operator">></span>
          选项一
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>input
            type<span class="token operator">=</span><span class="token string">"radio"</span>
            name<span class="token operator">=</span><span class="token string">"myRadio"</span>
            value<span class="token operator">=</span><span class="token string">"option2"</span>
            defaultChecked<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> 
          <span class="token operator">/</span><span class="token operator">></span>
          选项二
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> name<span class="token operator">=</span><span class="token string">"myRadio"</span> value<span class="token operator">=</span><span class="token string">"option3"</span> <span class="token operator">/</span><span class="token operator">></span>
          选项三
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack></section><section class="level3"aria-labelledby="提交表单时读取输入框的值-reading-the-input-values-when-submitting-a-form"><h3 id="提交表单时读取输入框的值-reading-the-input-values-when-submitting-a-form">提交表单时读取输入框的值 {/<em>reading-the-input-values-when-submitting-a-form</em>/}</h3><p>在输入框周围添加一个包含 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/button"><code>&#x3C;button type="submit"></code></a> 按钮的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/form"><code>&#x3C;form></code></a> 组件。这将调用 <code>&#x3C;form onSubmit></code> 事件处理程序。默认情况下，浏览器将向当前 URL 发送表单数据并刷新页面。你可以通过调用 <code>e.preventDefault()</code> 取消此默认行为，并使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FormData"><code>new FormData(e.target)</code></a> 读取表单数据。<sandpack></sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyForm</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">handleSubmit</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 阻止浏览器重新加载页面</span>
    e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 读取表单数据</span>
    <span class="token keyword">const</span> form <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 你可以直接将 formData 作为 fetch 的请求 body：</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/some-api'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">method</span><span class="token operator">:</span> form<span class="token punctuation">.</span><span class="token property-access">method</span><span class="token punctuation">,</span> <span class="token literal-property property">body</span><span class="token operator">:</span> formData <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 也可以使用普通的对象：</span>
    <span class="token keyword">const</span> formJson <span class="token operator">=</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token method function property-access">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>formJson<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form method<span class="token operator">=</span><span class="token string">"post"</span> onSubmit<span class="token operator">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        文本框：<span class="token operator">&#x3C;</span>input name<span class="token operator">=</span><span class="token string">"myInput"</span> defaultValue<span class="token operator">=</span><span class="token string">"Some initial value"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        多选框： <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> name<span class="token operator">=</span><span class="token string">"myCheckbox"</span> defaultChecked<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span>
        单选按钮：
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span><span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> name<span class="token operator">=</span><span class="token string">"myRadio"</span> value<span class="token operator">=</span><span class="token string">"option1"</span> <span class="token operator">/</span><span class="token operator">></span> 选项一<span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span><span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> name<span class="token operator">=</span><span class="token string">"myRadio"</span> value<span class="token operator">=</span><span class="token string">"option2"</span> defaultChecked<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span> 选项二<span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>label<span class="token operator">></span><span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> name<span class="token operator">=</span><span class="token string">"myRadio"</span> value<span class="token operator">=</span><span class="token string">"option3"</span> <span class="token operator">/</span><span class="token operator">></span> 选项三<span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button type<span class="token operator">=</span><span class="token string">"reset"</span><span class="token operator">></span>重置表单<span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button type<span class="token operator">=</span><span class="token string">"submit"</span><span class="token operator">></span>提交表单<span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre><note><p>给 <code>&#x3C;input></code> 添加 <code>name</code> 属性，例如 <code>&#x3C;input name="firstName" defaultValue="Taylor" /></code>。指定的 <code>name</code> 将作为表单数据中的一个键，例如 <code>{ firstName: "Taylor" }</code>。</p></note><pitfall><p>默认情况下，<code>&#x3C;form></code> 内的任何 <code>&#x3C;button></code> 都可以提交表单。这可能会让人感到惊讶！如果你有自定义 <code>Button</code> 组件，请考虑使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/input/button"><code>&#x3C;button type="button"></code></a> 而不是 <code>&#x3C;button></code>。如果你想要明确指定提交表单的按钮，请使用 <code>&#x3C;button type="submit"></code>。</p></pitfall></section><section class="level3"aria-labelledby="使用-state-控制输入框-controlling-an-input-with-a-state-variable"><h3 id="使用-state-控制输入框-controlling-an-input-with-a-state-variable">使用 state 控制输入框 {/<em>controlling-an-input-with-a-state-variable</em>/}</h3><p>像 <code>&#x3C;input /></code> 这样的输入框是非受控的。即使你像 <code>&#x3C;input defaultValue="Initial text" /></code> 一样 <a href="#providing-an-initial-value-for-an-input">传递了初始值</a>，你的 JSX 也只是指定了初始值，而非当前时刻的值。<p><strong>如果要渲染一个受控输入框，请传递 <code>value</code> 属性（或者向多选框和单选按钮传递 <code>checked</code></strong>。React 将强制传递 <code>value</code> 属性给输入框。通常，你可以通过声明一个 <a href="/reference/react/useState">state</a> 来控制输入框。<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>firstName<span class="token punctuation">,</span> setFirstName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 声明一个 state 变量...</span>
  <span class="token comment">// ...</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>input
      value<span class="token operator">=</span><span class="token punctuation">{</span>firstName<span class="token punctuation">}</span> <span class="token comment">// ...强制输入框的值与 state 相匹配...</span>
      onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setFirstName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token comment">// ... 并在每次改变（change）时更新 state！</span>
    <span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>当你需要 state 时，受控输入框都将非常有用——比如，每次编辑时都重新渲染 UI：<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>firstName<span class="token punctuation">,</span> setFirstName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        你的名称：
        <span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>firstName<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setFirstName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token punctuation">{</span>firstName <span class="token operator">!==</span> <span class="token string">''</span> <span class="token operator">&#x26;&#x26;</span> <span class="token operator">&#x3C;</span>p<span class="token operator">></span>你的名称是 <span class="token punctuation">{</span>firstName<span class="token punctuation">}</span>。<span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">}</span>
      <span class="token spread operator">...</span></code></pre><p>如果你想提供多种方式来调整输入框 state（例如，通过单击按钮），它也会很有用：<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ageAsNumber <span class="token operator">=</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        年龄：
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setAge</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
          type<span class="token operator">=</span><span class="token string">"number"</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setAge</span><span class="token punctuation">(</span>ageAsNumber <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
          增加 <span class="token number">10</span> 年
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span></code></pre><p>传递给受控组件的 <code>value</code> 属性不能是 <code>undefined</code> 或 <code>null</code>。如果你需要初始值为空（例如，下面的 <code>firstName</code> 字段），请将你的 state 变量初始化为空字符串（<code>''</code>）。</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>firstName<span class="token punctuation">,</span> setFirstName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ageAsNumber <span class="token operator">=</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        名：
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>firstName<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setFirstName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        年龄：
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setAge</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
          type<span class="token operator">=</span><span class="token string">"number"</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setAge</span><span class="token punctuation">(</span>ageAsNumber <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
          增加 <span class="token number">10</span> 年
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token punctuation">{</span>firstName <span class="token operator">!==</span> <span class="token string">''</span> <span class="token operator">&#x26;&#x26;</span>
        <span class="token operator">&#x3C;</span>p<span class="token operator">></span>你的名称是 <span class="token punctuation">{</span>firstName<span class="token punctuation">}</span>。<span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token punctuation">}</span>
      <span class="token punctuation">{</span>ageAsNumber <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&#x26;&#x26;</span>
        <span class="token operator">&#x3C;</span>p<span class="token operator">></span>你的年龄是 <span class="token punctuation">{</span>ageAsNumber<span class="token punctuation">}</span>。<span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">p</span> <span class="token punctuation">{</span> <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><pitfall><p>如果传递了 <code>value</code> 但没有传递 <code>onChange</code>，那么将无法输入内容。当你通过传递 <code>value</code> 来控制输入框时，你需要保证输入框始终具有你传递的值。因此，如果你将一个 state 作为 <code>value</code> 传递，但在 <code>onChange</code> 事件处理程序中忘记同步更新该状态变量，React 将在每次输入后将输入框恢复到指定的 <code>value</code>。</p></pitfall></section><section class="level3"aria-labelledby="优化每次按键时的重新渲染-optimizing-re-rendering-on-every-keystroke"><h3 id="优化每次按键时的重新渲染-optimizing-re-rendering-on-every-keystroke">优化每次按键时的重新渲染 {/<em>optimizing-re-rendering-on-every-keystroke</em>/}</h3><p>当你使用受控输入框时，每次按键都会设置 state。如果包含 state 的组件重新渲染了大型树形结构，这可能会变得很慢。有几种方法可以优化重新渲染的性能。<p>例如，假设表单在每次按键时会重新渲染所有页面内容：<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>firstName<span class="token punctuation">,</span> setFirstName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>form<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>firstName<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setFirstName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">PageContent</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>由于 <code>&#x3C;PageContent /></code> 不依赖于输入框 state，因此可以将输入框 state 移入其自己的组件中：<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">SignupForm</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">PageContent</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">SignupForm</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>firstName<span class="token punctuation">,</span> setFirstName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>firstName<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setFirstName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>这样可以显著提高性能，因为每次按键时只有 <code>SignupForm</code> 会重新渲染。<p>如果无法避免重新渲染（例如，如果 <code>PageContent</code> 依赖于搜索输入框的值），<a href="/reference/react/useDeferredValue#deferring-re-rendering-for-a-part-of-the-ui"><code>useDeferredValue</code></a> 可以帮助你在大型重新渲染过程中保持受控输入框的响应性（responsive）。</section></section><section class="level2"aria-labelledby="故障排除-troubleshooting"><h2 id="故障排除-troubleshooting">故障排除 {/<em>troubleshooting</em>/}</h2><section class="level3"aria-labelledby="输入时文本框未更新-my-text-input-doesnt-update-when-i-type-into-it"><h3 id="输入时文本框未更新-my-text-input-doesnt-update-when-i-type-into-it">输入时文本框未更新 {/<em>my-text-input-doesnt-update-when-i-type-into-it</em>/}</h3><p>如果传递了 <code>value</code> 属性给输入框，而没有传递 <code>onChange</code> 属性，那么你将在控制台看到错误信息：<pre class="language-js"><code class="language-js"><span class="token comment">// 🔴 Bug：没有 onChange 事件处理程序的受控文本框</span>
<span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>something<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code></pre><consoleblock level="error"><p>你传递了 <code>value</code> 属性给表单，但是没有传递 <code>onChange</code> 事件处理程序。这将使其变为只读。如果该字段应该是可变的，请使用 <code>defaultValue</code>。否则，设置 <code>onChange</code> 或 <code>readOnly</code>。</p></consoleblock><p>正如错误信息所提示的，如果你仅仅是想要 <a href="#providing-an-initial-value-for-an-input">指定初始值</a>，请传递 <code>defaultValue</code>：<pre class="language-js"><code class="language-js"><span class="token comment">// ✅ Good：有初始值的非受控输入框</span>
<span class="token operator">&#x3C;</span>input defaultValue<span class="token operator">=</span><span class="token punctuation">{</span>something<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code></pre><p>如果你想要 <a href="#controlling-an-input-with-a-state-variable">使用 state 变量控制输入框</a>，指定 <code>onChange</code> 事件处理程序：<pre class="language-js"><code class="language-js"><span class="token comment">// ✅ Good：具有 onChange 事件处理程序的受控输入框</span>
<span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>something<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setSomething</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code></pre><p>如果输入框是只读的，额外传递 <code>readOnly</code> 属性：<pre class="language-js"><code class="language-js"><span class="token comment">// ✅ Good：没有 onChange 事件处理程序的受控只读输入框</span>
<span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>something<span class="token punctuation">}</span> readOnly<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code></pre></section><section class="level3"aria-labelledby="点击时多选框未更新-my-checkbox-doesnt-update-when-i-click-on-it"><h3 id="点击时多选框未更新-my-checkbox-doesnt-update-when-i-click-on-it">点击时多选框未更新 {/<em>my-checkbox-doesnt-update-when-i-click-on-it</em>/}</h3><p>如果传递了 <code>checked</code> 属性给多选框，而没有传递 <code>onChange</code> 属性，那么你将在控制台看到错误信息：<pre class="language-js"><code class="language-js"><span class="token comment">// 🔴 Bug：没有 onChange 事件处理程序的受控多选框</span>
<span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> checked<span class="token operator">=</span><span class="token punctuation">{</span>something<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code></pre><consoleblock level="error"><p>你传递了 <code>checked</code> 属性给表单，但是没有传递 <code>onChange</code> 事件处理程序。这将使其变为只读。如果该字段应该是可变的，请使用 <code>defaultValue</code>。否则，设置 <code>onChange</code> 或 <code>readOnly</code>。</p></consoleblock><p>正如错误信息所提示的，如果你仅仅是想要 <a href="#providing-an-initial-value-for-an-input">指定初始值</a>，请传递 <code>defaultValue</code>：<pre class="language-js"><code class="language-js"><span class="token comment">// ✅ Good：有初始值的非受控多选框</span>
<span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> defaultChecked<span class="token operator">=</span><span class="token punctuation">{</span>something<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code></pre><p>If you want <a href="#controlling-an-input-with-a-state-variable">to control this checkbox with a state variable,</a> specify an <code>onChange</code> handler:<pre class="language-js"><code class="language-js"><span class="token comment">// ✅ Good：具有 onChange 事件处理程序的受控多选框</span>
<span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> checked<span class="token operator">=</span><span class="token punctuation">{</span>something<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setSomething</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">checked</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code></pre><pitfall><p>如果你想要读取多选框中选中的值，应该使用 <code>e.target.checked</code> 而不是 <code>e.target.value</code>。</p></pitfall><p>如果多选框是只读的，额外传递 <code>readOnly</code> 属性：<pre class="language-js"><code class="language-js"><span class="token comment">// ✅ Good：没有 onChange 事件处理程序的受控只读输入框</span>
<span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> checked<span class="token operator">=</span><span class="token punctuation">{</span>something<span class="token punctuation">}</span> readOnly<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code></pre></section><section class="level3"aria-labelledby="当我输入时输入框光标会跳到开头-my-input-caret-jumps-to-the-beginning-on-every-keystroke"><h3 id="当我输入时输入框光标会跳到开头-my-input-caret-jumps-to-the-beginning-on-every-keystroke">当我输入时，输入框光标会跳到开头 {/<em>my-input-caret-jumps-to-the-beginning-on-every-keystroke</em>/}</h3><p>如果你想要 <a href="#controlling-an-input-with-a-state-variable">控制输入框</a>，你应该在 <code>onChange</code> 期间将对应的 state 变量更新为来自 DOM 的输入框的值。<p>你不应该将它更新为 <code>e.target.value</code>（对于多选框应该是 <code>e.target.checked</code>）以外的值：<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 🔴 Bug：将输入框更新为 e.target.value 以外的值</span>
  <span class="token function">setFirstName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">.</span><span class="token method function property-access">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>你也不应该异步更新：<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 🔴 Bug：异步更新输入框</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setFirstName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>将 state 同步更新为 <code>e.target.value</code> 以解决此问题：<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ✅ 将受控输入框的值同步更新为 e.target.value</span>
  <span class="token function">setFirstName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>如果这不能解决问题，有可能是因为每次输入时输入框都从 DOM 中删除并重新添加。同样，如果在每次重新渲染时不小心 <a href="/learn/preserving-and-resetting-state">重置了 state</a>，就会发生这种情况。例如，如果输入框或其祖先组件总是接收不同的 <code>key</code>，或者嵌套使用组件（这在 React 中是不允许的，并且会导致“内部”组件在每次渲染时重新挂载），就会发生这种情况。</section><section class="level3"aria-labelledby="收到错误a-component-is-changing-an-uncontrolled-input-to-be-controlled-im-getting-an-error-a-component-is-changing-an-uncontrolled-input-to-be-controlled"><h3 id="收到错误a-component-is-changing-an-uncontrolled-input-to-be-controlled-im-getting-an-error-a-component-is-changing-an-uncontrolled-input-to-be-controlled">收到错误：“A component is changing an uncontrolled input to be controlled” {/<em>im-getting-an-error-a-component-is-changing-an-uncontrolled-input-to-be-controlled</em>/}</h3><p>提供的 <code>value</code> 属性必须在整个生命周期中都为字符串。<p>你不能一会传递 <code>value={undefined}</code> 一会传递 <code>value="some string"</code>，这会导致 React 不清楚你是想指定受控组件还是非受控组件。受控组件的 <code>value</code> 属性应该始终接收字符串，而不是 <code>null</code> 或 <code>undefined</code>。<p>如果 <code>value</code> 来自 API 或 state，它可能会被初始化为 <code>null</code> 或 <code>undefined</code>。在这种情况下，要么最初将其设置为空字符串（<code>''</code>），要么传递 <code>value={someValue ?? ''}</code> 以确保 <code>value</code> 是一个字符串。<p>类似的，如果传递 <code>checked</code> 属性给多选框，请确保它始终是布尔值。 <span style="float:footnote"><a href="../../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>