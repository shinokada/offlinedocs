<!doctype html><html lang="zh-hans"><meta charset="utf-8"><title>startTransition</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="starttransition"><h1 id="starttransition">startTransition</h1><p>translators:<ul><li>Davont</ul><intro><p><code>startTransition</code> 可以让你在不阻塞 UI 的情况下更新 state。<pre class="language-js"><code class="language-js"><span class="token function">startTransition</span><span class="token punctuation">(</span>scope<span class="token punctuation">)</span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="参考-reference"><h2 id="参考-reference">参考 {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="starttransitionscope-starttransitionscope"><h3 id="starttransitionscope-starttransitionscope"><code>startTransition(scope)</code> {/<em>starttransitionscope</em>/}</h3><p><code>startTransition</code> 函数可以将 state 更新标记为 transition。<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> startTransition <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TabContainer</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>tab<span class="token punctuation">,</span> setTab<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'about'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">selectTab</span><span class="token punctuation">(</span><span class="token parameter">nextTab</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setTab</span><span class="token punctuation">(</span>nextTab<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p><a href="#usage">请看下面的更多例子</a>。<section class="level4"aria-labelledby="参数-parameters"><h4 id="参数-parameters">参数 {/<em>parameters</em>/}</h4><ul><li><code>scope</code>：调用一个或多个 <a href="/reference/react/useState#setstate"><code>set</code> 函数</a> 来更新 state 的函数。React 会立即调用没有参数的 <code>scope</code>，并将在 <code>scope</code> 函数调用期间，调度所有的 state，并将同步更新标记为 transition。它们是 <a href="/reference/react/useTransition#marking-a-state-update-as-a-non-blocking-transition">非阻塞的</a>，并且 <a href="/reference/react/useTransition#preventing-unwanted-loading-indicators">不会显示不想要的加载提示</a>。</ul></section><section class="level4"aria-labelledby="返回值-returns"><h4 id="返回值-returns">返回值 {/<em>returns</em>/}</h4><p><code>startTransition</code> 不返回任何内容。</section><section class="level4"aria-labelledby="注意事项-caveats"><h4 id="注意事项-caveats">注意事项 {/<em>caveats</em>/}</h4><ul><li><p><code>startTransition</code> 没有提供一种跟踪 Transition 是否处于待定状态的方法。为了在 Transition 进行时显示一个待定状态的指示器，你需要使用 <a href="/reference/react/useTransition"><code>useTransition</code></a>。<li><p>只有当你能访问某个 state 的 <code>set</code> 函数时，你才能将它的更新包裹到 Transition 中。如果你想根据 props 或自定义 Hook 的返回值来启动一个 transition，请尝试使用 <a href="/reference/react/useDeferredValue"><code>useDeferredValue</code></a>。<li><p>你传递给 <code>startTransition</code> 的函数必须是同步的。React 会立即执行此函数，将其执行期间发生的所有 state 更新标记为 transition。如果你想试着稍后执行更多的 state 更新（例如，在 timeout 中），它们不会被标记为转换。<li><p>一个被标记为 Transition 的 state 更新时将会被其他 state 更新打断。例如，如果你在 Transition 内部更新图表组件，但在图表重新渲染时在输入框中打字，则 React 将先处理输入 state 更新，之后才会重新启动对图表组件的渲染工作。<li><p>Transition 更新不能用于控制文本输入。<li><p>如果有多个正在进行的 transition，当前 React 会将它们集中在一起处理。这是一个限制，在未来的版本中可能会被移除。</ul></section></section></section><section class="level2"aria-labelledby="使用方法-usage"><h2 id="使用方法-usage">使用方法 {/<em>usage</em>/}</h2><section class="level3"aria-labelledby="将-state-更新标记为非阻塞-transition-marking-a-state-update-as-a-non-blocking-transition"><h3 id="将-state-更新标记为非阻塞-transition-marking-a-state-update-as-a-non-blocking-transition">将 state 更新标记为非阻塞 Transition {/<em>marking-a-state-update-as-a-non-blocking-transition</em>/}</h3><p>你可以通过将一个 state 包裹在 <code>startTransition</code> 回调中，将其更新标记为一个 <strong>transition</strong>：<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> startTransition <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TabContainer</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>tab<span class="token punctuation">,</span> setTab<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'about'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">selectTab</span><span class="token punctuation">(</span><span class="token parameter">nextTab</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setTab</span><span class="token punctuation">(</span>nextTab<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>transition 可以让用户界面在慢速设备上保持更新响应。<p>通过 transition，你的 UI 在重新渲染过程中保持响应。例如，如果用户单击一个选项卡后又改变主意并单击另一个选项卡，则可以在第一次重新渲染完成之前执行此操作而无需等待。</p><note><p><code>startTransition</code> 与 <a href="/reference/react/useTransition"><code>useTransition</code></a> 非常相似，但它不提供 <code>isPending</code> 标志来跟踪一个 Transition 是否正在进行。你可以在 <code>useTransition</code> 不可用时调用 <code>startTransition</code>。例如，在组件外部（如从数据库中）使用 <code>startTransition</code>。<p><a href="/reference/react/useTransition">在 <code>useTransition</code> 页面上了解 Transition 并查看示例</a>。</p></note><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>