<!doctype html><html lang="zh-hans"><meta charset="utf-8"><title>"React 内置 Hook"</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="react-内置-hook"><h1 id="react-内置-hook">"React 内置 Hook"</h1><intro><p><strong>Hook</strong> 可以帮助在组件中使用不同的 React 功能。你可以使用内置的 Hook 或使用自定义 Hook。本页列出了 React 中所有内置 Hook。</p></intro><section class="level2"aria-labelledby="state-hook-state-hooks"><h2 id="state-hook-state-hooks">State Hook {/<em>state-hooks</em>/}</h2><p>状态帮助组件 <a href="/learn/state-a-components-memory">“记住”用户输入的信息</a>。例如，一个表单组件可以使用状态存储输入值，而一个图像库组件可以使用状态存储所选的图像索引。<p>使用以下 Hook 以向组件添加状态：<ul><li>使用 <a href="/reference/react/useState"><code>useState</code></a> 声明可以直接更新的状态变量。<li>使用 <a href="/reference/react/useReducer"><code>useReducer</code></a> 在 <a href="/learn/extracting-state-logic-into-a-reducer">reducer 函数</a> 中声明带有更新逻辑的 state 变量。</ul><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ImageGallery</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>index<span class="token punctuation">,</span> setIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre></section><section class="level2"aria-labelledby="context-hook-context-hooks"><h2 id="context-hook-context-hooks">Context Hook {/<em>context-hooks</em>/}</h2><p>上下文帮助组件 <a href="/learn/passing-props-to-a-component">从祖先组件接收信息，而无需将其作为 props 传递</a>。例如，应用程序的顶层组件可以借助上下文将 UI 主题传递给所有下方的组件，无论这些组件层级有多深。<ul><li>使用 <a href="/reference/react/useContext"><code>useContext</code></a> 读取订阅上下文。</ul><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Button</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span><span class="token maybe-class-name">ThemeContext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre></section><section class="level2"aria-labelledby="ref-hook-ref-hooks"><h2 id="ref-hook-ref-hooks">Ref Hook {/<em>ref-hooks</em>/}</h2><p>ref 允许组件 <a href="/learn/referencing-values-with-refs">保存一些不用于渲染的信息</a>，比如 DOM 节点或 timeout ID。与状态不同，更新 ref 不会重新渲染组件。ref 是从 React 范例中的“脱围机制”。当需要与非 React 系统如浏览器内置 API 一同工作时，ref 将会非常有用。<ul><li>使用 <a href="/reference/react/useRef"><code>useRef</code></a> 声明 ref。你可以在其中保存任何值，但最常用于保存 DOM 节点。<li>使用 <a href="/reference/react/useImperativeHandle"><code>useImperativeHandle</code></a> 自定义从组件中暴露的 ref，但是很少使用。</ul><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> inputRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre></section><section class="level2"aria-labelledby="effect-hook-effect-hooks"><h2 id="effect-hook-effect-hooks">Effect Hook {/<em>effect-hooks</em>/}</h2><p>Effect 允许组件 <a href="/learn/synchronizing-with-effects">连接到外部系统并与之同步</a>。这包括处理网络、浏览器、DOM、动画、使用不同 UI 库编写的小部件以及其他非 React 代码。<ul><li>使用 <a href="/reference/react/useEffect"><code>useEffect</code></a> 将组件连接到外部系统。</ul><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre><p>Effect 是从 React 范式中的“脱围机制”。避免使用 Effect 协调应用程序的数据流。如果不需要与外部系统交互，那么 <a href="/learn/you-might-not-need-an-effect">可能不需要 Effect</a>。<p><code>useEffect</code> 有两个很少使用的变换形式，它们在执行时机有所不同：<ul><li><a href="/reference/react/useLayoutEffect"><code>useLayoutEffect</code></a> 在浏览器重新绘制屏幕前执行，可以在此处测量布局。<li><a href="/reference/react/useInsertionEffect"><code>useInsertionEffect</code></a> 在 React 对 DOM 进行更改之前触发，库可以在此处插入动态 CSS。</ul></section><section class="level2"aria-labelledby="性能-hook-performance-hooks"><h2 id="性能-hook-performance-hooks">性能 Hook {/<em>performance-hooks</em>/}</h2><p>优化重新渲染性能的一种常见方法是跳过不必要的工作。例如，可以告诉 React 重用缓存的计算结果，或者如果数据自上次渲染以来没有更改，则跳过重新渲染。<p>可以使用以下 Hook 跳过计算和不必要的重新渲染：<ul><li>使用 <a href="/reference/react/useMemo"><code>useMemo</code></a> 缓存计算代价昂贵的计算结果。<li>使用 <a href="/reference/react/useCallback"><code>useCallback</code></a> 将函数传递给优化组件之前缓存函数定义。</ul><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TodoList</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> todos<span class="token punctuation">,</span> tab<span class="token punctuation">,</span> theme <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> visibleTodos <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">filterTodos</span><span class="token punctuation">(</span>todos<span class="token punctuation">,</span> tab<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> tab<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>有时由于屏幕确实需要更新，无法跳过重新渲染。在这种情况下，可以通过将必须同步的阻塞更新（比如使用输入法输入内容）与不需要阻塞用户界面的非阻塞更新（比如更新图表）分离以提高性能。<p>使用以下 Hook 处理渲染优先级：<ul><li><a href="/reference/react/useTransition"><code>useTransition</code></a> 允许将状态转换标记为非阻塞，并允许其他更新中断它。<li><a href="/reference/react/useDeferredValue"><code>useDeferredValue</code></a> 允许延迟更新 UI 的非关键部分，以让其他部分先更新。</ul></section><section class="level2"aria-labelledby="其他-hook-other-hooks"><h2 id="其他-hook-other-hooks">其他 Hook {/<em>other-hooks</em>/}</h2><p>这些 Hook 主要适用于库作者，不常在应用程序代码中使用。<ul><li>使用 <a href="/reference/react/useDebugValue"><code>useDebugValue</code></a> 自定义 React 开发者工具为自定义 Hook 添加的标签。<li>使用 <a href="/reference/react/useId"><code>useId</code></a> 将唯一的 ID 与组件相关联，其通常与可访问性 API 一起使用。<li>使用 <a href="/reference/react/useSyncExternalStore"><code>useSyncExternalStore</code></a> 订阅外部 store。</ul><ul><li>使用 <a href="/reference/react/useActionState"><code>useActionState</code></a> 允许你管理动作的状态.</ul></section><section class="level2"aria-labelledby="自定义-hook-your-own-hooks"><h2 id="自定义-hook-your-own-hooks">自定义 Hook {/<em>your-own-hooks</em>/}</h2><p>开发者可以 <a href="/learn/reusing-logic-with-custom-hooks#extracting-your-own-custom-hook-from-a-component">自定义 Hook</a> 作为 JavaScript 函数。 <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section>