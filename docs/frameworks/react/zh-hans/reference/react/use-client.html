<!doctype html><html lang="zh-hans"><meta charset="utf-8"><title>"'use client'"</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="use-client"><h1 id="use-client">"'use client'"</h1><p>canary: true</p><canary><p><code>'use client'</code> 仅在你 <a href="/learn/start-a-new-react-project#bleeding-edge-react-frameworks">使用 React 服务端组件</a> 或构建可适配库时需要。</p></canary><intro><p><code>'use client'</code> 标记组件在客户端上执行的源文件。</p></intro><inlinetoc><section class="level2"aria-labelledby="参考-reference"><h2 id="参考-reference">参考 {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="use-client-use-client"><h3 id="use-client-use-client"><code>'use client'</code> {/<em>use-client</em>/}</h3><p>在文件的最顶部添加 <code>'use client'</code> 以标记该文件（包括它使用的任何子组件）在客户端上执行，而无论其导入位置如何。<pre class="language-js"><code class="language-js"><span class="token string">'use client'</span><span class="token punctuation">;</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">RichTextEditor</span></span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span></code></pre><p>当从服务端组件导入标记为 <code>'use client'</code> 的文件时，<a href="/learn/start-a-new-react-project#bleeding-edge-react-frameworks">兼容的捆绑器（bundler）</a> 会将导入视为服务器代码与客户端代码之间的“分界点”。模块图中该点或以下的组件可以使用如 <a href="/reference/react/useState"><code>useState</code></a> 的仅限客户端的 React 功能。<section class="level4"aria-labelledby="注意-caveats"><h4 id="注意-caveats">注意 {/<em>caveats</em>/}</h4><ul><li>不必在每个使用仅客户端 React 功能的文件中都添加<code>'use client'</code>，只需在从服务端组件文件中导入的文件中添加。<code>'use client'</code> 表示服务器代码和客户端代码之间的边界；树中更深层次的任何组件将自动在客户端上执行。为了从服务端组件渲染，从<code>'use client'</code> 文件导出的组件必须具有可序列化的 props。<li>当从服务器文件导入 <code>'use client'</code> 文件时，导入的值可以渲染为 React 组件或通过 props 传递到客户端组件。任何其他使用都会引发异常。<li>当从另一个客户端文件导入 <code>'use client'</code> 文件时，该指令无效。这允许你编写可同时在服务器和客户端组件中使用的仅客户端组件。<li><code>'use client'</code> 文件中的所有代码以及它直接或间接导入的任何模块都将成为客户端模块图的一部分，并且必须发送到客户端并由客户端执行，以便由客户端渲染至浏览器。为了减少客户端包的大小并充分利用服务器，请尽可能将状态 state（和 <code>'use client'</code> 指令）移动到组件树的较低位置，并将渲染的服务端组件 [作为客户端组件的子组件](/learn/passing-props- to-a-component#passing-jsx-as-children)。<li>由于 props 是跨服务器客户端边界进行序列化的，因此这些指令的放置位置可能会影响发送到客户端的数据量；尽量仅使用必要的数据结构。<li>像 <code>&#x3C;MarkdownRenderer></code> 这样既不使用服务器功能也不使用客户端功能的组件通常不应标记为 <code>'use client'</code>。这样当在服务端组件中使用时，它们可以专门在服务器上渲染；但当在客户端组件中使用时，它们将被添加到客户端包中。<li>发布到 npm 的库应该在导出的 React 组件上包含 <code>'use client'</code>，这些组件可以仅使用客户端 React 功能的可序列化 props 进行渲染，以允许服务端组件导入和渲染这些组件。否则，用户将需要将库组件包装在自己的 <code>'use client'</code> 文件中，这可能很麻烦，并且会阻止库稍后将逻辑移动到服务器。将预捆绑文件发布到 npm 时，请确保 <code>'use client'</code> 源文件最终位于标有 <code>'use client'</code> 的捆绑包中，与包含可直接在服务器上使用的导出的任何捆绑包分开。<li>客户端组件仍将作为服务器渲染 (SSR) 或构建时（build-time）静态站点生成 (SSG) 的一部分运行，它们充当客户端，将 React 组件的初始渲染输出转换为可在下载 JavaScript 包之前渲染的 HTML。但他们无法使用服务器功能，例如直接从数据库读取数据。<li>像 <code>'use client'</code> 这样的指令必须位于文件的最开头，位于任何导入或其他代码之上（指令上方可以存在注释）。它们必须用单引号或双引号编写，而不是反引号。<code>'use xyz'</code> 指令格式类似于 <code>'useXyz'</code> Hook 命名约定，但相似之处纯属巧合。</ul></section></section></section><section class="level2"aria-labelledby="用法-usage"><h2 id="用法-usage">用法 {/<em>usage</em>/}</h2><wip>This section is a work in progress.<p>This API can be used in any framework that supports React Server Components. You may find additional documentation from them.<ul><li><a href="https://nextjs.org/docs/getting-started/react-essentials">Next.js documentation</a><li>More coming soon <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></ul></wip></section></inlinetoc></section>