<!doctype html><html lang="zh-hans"><meta charset="utf-8"><title>Server Actions</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="server-actions"><h1 id="server-actions">Server Actions</h1><p>canary: true</p><intro><p>Server Actions allow Client Components to call async functions executed on the server.</p></intro><inlinetoc><note><section class="level4"aria-labelledby="how-do-i-build-support-for-server-actions-how-do-i-build-support-for-server-actions"><h4 id="how-do-i-build-support-for-server-actions-how-do-i-build-support-for-server-actions">How do I build support for Server Actions? {/<em>how-do-i-build-support-for-server-actions</em>/}</h4><p>While Server Actions in React 19 are stable and will not break between major versions, the underlying APIs used to implement Server Actions in a React Server Components bundler or framework do not follow semver and may break between minors in React 19.x.<p>To support Server Actions as a bundler or framework, we recommend pinning to a specific React version, or using the Canary release. We will continue working with bundlers and frameworks to stabilize the APIs used to implement Server Actions in the future.</section></note><p>When a Server Action is defined with the <code>"use server"</code> directive, your framework will automatically create a reference to the server function, and pass that reference to the Client Component. When that function is called on the client, React will send a request to the server to execute the function, and return the result.<p>Server Actions can be created in Server Components and passed as props to Client Components, or they can be imported and used in Client Components.<section class="level3"aria-labelledby="creating-a-server-action-from-a-server-component-creating-a-server-action-from-a-server-component"><h3 id="creating-a-server-action-from-a-server-component-creating-a-server-action-from-a-server-component">Creating a Server Action from a Server Component {/<em>creating-a-server-action-from-a-server-component</em>/}</h3><p>Server Components can define Server Actions with the <code>"use server"</code> directive:<pre class="language-js"><code class="language-js"><span class="token comment">// Server Component</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">Button</span></span> <span class="token keyword module">from</span> <span class="token string">'./Button'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">EmptyNote</span></span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createNoteAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Server Action</span>
    <span class="token string">'use server'</span><span class="token punctuation">;</span>
    
    <span class="token keyword control-flow">await</span> db<span class="token punctuation">.</span><span class="token property-access">notes</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Button</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>createNoteAction<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>When React renders the <code>EmptyNote</code> Server Component, it will create a reference to the <code>createNoteAction</code> function, and pass that reference to the <code>Button</code> Client Component. When the button is clicked, React will send a request to the server to execute the <code>createNoteAction</code> function with the reference provided:<pre class="language-js"><code class="language-js"><span class="token string">"use client"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Button</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>onClick<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>onClick<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Create</span> <span class="token maybe-class-name">Empty</span> <span class="token maybe-class-name">Note</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
<span class="token punctuation">}</span></code></pre><p>For more, see the docs for <a href="/reference/rsc/use-server"><code>"use server"</code></a>.</section><section class="level3"aria-labelledby="importing-server-actions-from-client-components-importing-server-actions-from-client-components"><h3 id="importing-server-actions-from-client-components-importing-server-actions-from-client-components">Importing Server Actions from Client Components {/<em>importing-server-actions-from-client-components</em>/}</h3><p>Client Components can import Server Actions from files that use the <code>"use server"</code> directive:<pre class="language-js"><code class="language-js"><span class="token string">"use server"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createNoteAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> db<span class="token punctuation">.</span><span class="token property-access">notes</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>When the bundler builds the <code>EmptyNote</code> Client Component, it will create a reference to the <code>createNoteAction</code> function in the bundle. When the <code>button</code> is clicked, React will send a request to the server to execute the <code>createNoteAction</code> function using the reference provided:<pre class="language-js"><code class="language-js"><span class="token string">"use client"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>createNoteAction<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./actions'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">EmptyNote</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>createNoteAction<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>createNoteAction<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">}</span></code></pre><p>For more, see the docs for <a href="/reference/rsc/use-server"><code>"use server"</code></a>.</section><section class="level3"aria-labelledby="composing-server-actions-with-actions-composing-server-actions-with-actions"><h3 id="composing-server-actions-with-actions-composing-server-actions-with-actions">Composing Server Actions with Actions {/<em>composing-server-actions-with-actions</em>/}</h3><p>Server Actions can be composed with Actions on the client:<pre class="language-js"><code class="language-js"><span class="token string">"use server"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updateName</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span><span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'Name is required'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">await</span> db<span class="token punctuation">.</span><span class="token property-access">users</span><span class="token punctuation">.</span><span class="token method function property-access">updateName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token string">"use client"</span><span class="token punctuation">;</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>updateName<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./actions'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">UpdateName</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>isPending<span class="token punctuation">,</span> startTransition<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useTransition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">submitAction</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span>error<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">updateName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
        <span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submitAction<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"name"</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>isPending<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">{</span>state<span class="token punctuation">.</span><span class="token property-access">error</span> <span class="token operator">&#x26;&#x26;</span> <span class="token operator">&#x3C;</span>span<span class="token operator">></span><span class="token maybe-class-name">Failed</span><span class="token operator">:</span> <span class="token punctuation">{</span>state<span class="token punctuation">.</span><span class="token property-access">error</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p>This allows you to access the <code>isPending</code> state of the Server Action by wrapping it in an Action on the client.<p>For more, see the docs for <a href="/reference/rsc/use-server#calling-a-server-action-outside-of-form">Calling a Server Action outside of <code>&#x3C;form></code></a></section><section class="level3"aria-labelledby="form-actions-with-server-actions-form-actions-with-server-actions"><h3 id="form-actions-with-server-actions-form-actions-with-server-actions">Form Actions with Server Actions {/<em>form-actions-with-server-actions</em>/}</h3><p>Server Actions work with the new Form features in React 19.<p>You can pass a Server Action to a Form to automatically submit the form to the server:<pre class="language-js"><code class="language-js"><span class="token string">"use client"</span><span class="token punctuation">;</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>updateName<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./actions'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">UpdateName</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>updateName<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"name"</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p>When the Form submission succeeds, React will automatically reset the form. You can add <code>useActionState</code> to access the pending state, last response, or to support progressive enhancement.<p>For more, see the docs for <a href="/reference/rsc/use-server#server-actions-in-forms">Server Actions in Forms</a>.</section><section class="level3"aria-labelledby="server-actions-with-useactionstate-server-actions-with-use-action-state"><h3 id="server-actions-with-useactionstate-server-actions-with-use-action-state">Server Actions with <code>useActionState</code> {/<em>server-actions-with-use-action-state</em>/}</h3><p>You can compose Server Actions with <code>useActionState</code> for the common case where you just need access to the action pending state and last returned response:<pre class="language-js"><code class="language-js"><span class="token string">"use client"</span><span class="token punctuation">;</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>updateName<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./actions'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">UpdateName</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> submitAction<span class="token punctuation">,</span> isPending<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useActionState</span><span class="token punctuation">(</span>updateName<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submitAction<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"name"</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>isPending<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">{</span>state<span class="token punctuation">.</span><span class="token property-access">error</span> <span class="token operator">&#x26;&#x26;</span> <span class="token operator">&#x3C;</span>span<span class="token operator">></span><span class="token maybe-class-name">Failed</span><span class="token operator">:</span> <span class="token punctuation">{</span>state<span class="token punctuation">.</span><span class="token property-access">error</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>When using <code>useActionState</code> with Server Actions, React will also automatically replay form submissions entered before hydration finishes. This means users can interact with your app even before the app has hydrated.<p>For more, see the docs for <a href="/reference/react/useActionState"><code>useActionState</code></a>.</section><section class="level3"aria-labelledby="progressive-enhancement-with-useactionstate-progressive-enhancement-with-useactionstate"><h3 id="progressive-enhancement-with-useactionstate-progressive-enhancement-with-useactionstate">Progressive enhancement with <code>useActionState</code> {/<em>progressive-enhancement-with-useactionstate</em>/}</h3><p>Server Actions also support progressive enhancement with the third argument of <code>useActionState</code>.<pre class="language-js"><code class="language-js"><span class="token string">"use client"</span><span class="token punctuation">;</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>updateName<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./actions'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">UpdateName</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> submitAction<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useActionState</span><span class="token punctuation">(</span>updateName<span class="token punctuation">,</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/name/update</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submitAction<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token spread operator">...</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>When the<codestep step="{2}">permalink</codestep>is provided to <code>useActionState</code>, React will redirect to the provided URL if the form is submitted before the JavaScript bundle loads.<p>For more, see the docs for <a href="/reference/react/useActionState"><code>useActionState</code></a>. <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></inlinetoc></section>