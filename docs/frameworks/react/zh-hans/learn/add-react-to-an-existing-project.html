<!doctype html><html lang="zh-hans"><meta charset="utf-8"><title>将 React 添加到现有项目中</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="将-react-添加到现有项目中"><h1 id="将-react-添加到现有项目中">将 React 添加到现有项目中</h1><intro><p>如果想对现有项目添加一些交互，不必使用 React 将其整个重写。只需将 React 添加到已有技术栈中，就可以在任何位置渲染交互式的 React 组件。</p></intro><note><p><strong>你需要安装 <a href="https://nodejs.org/zh-cn/">Node.js</a> 以进行本地开发</strong>。尽管可以使用 <a href="/learn/installation#try-react">在线演练场</a> 或简单的 HTML 页面来尝试 React，但实际上大多数用于开发的 JavaScript 工具都需要 Node.js。</p></note><section class="level2"aria-labelledby="在现有网站的子路由中使用-react-using-react-for-an-entire-subroute-of-your-existing-website"><h2 id="在现有网站的子路由中使用-react-using-react-for-an-entire-subroute-of-your-existing-website">在现有网站的子路由中使用 React {/<em>using-react-for-an-entire-subroute-of-your-existing-website</em>/}</h2><p>假设你在 <code>example.com</code> 部署了一个其他服务端技术（例如 Rails）构建的 Web 应用，但是你又想在 <code>example.com/some-app/</code> 部署一个 React 项目。<p>以下是推荐的配置方式：<ol><li>使用一个 <a href="/learn/start-a-new-react-project">基于 React 的框架</a> 构建 <strong>应用的 React 部分</strong>。<li><strong>在框架配置中将 <code>/some-app</code> 指定为基本路径</strong>（这里有 <a href="https://nextjs.org/docs/api-reference/next.config.js/basepath">Next.js</a> 与 <a href="https://www.gatsbyjs.com/docs/how-to/previews-deploys-hosting/path-prefix/">Gatsby</a> 的配置样例）。<li><strong>配置服务器或代理</strong>，以便所有位于 <code>/some-app/</code> 下的请求都由 React 应用处理。</ol><p>这可以确保应用的 React 部分可以受益于这些框架中内置的 <a href="/learn/start-a-new-react-project#can-i-use-react-without-a-framework">最佳实践</a>。<p>许多基于 React 的框架都是全栈的，从而可以让你的 React 应用充分利用服务器。但是，即使无法或不想在服务器上运行 JavaScript，也可以使用相同的方法。在这种情况下，将 HTML/CSS/JS 导出（Next.js 的 <a href="https://nextjs.org/docs/advanced-features/static-html-export"><code>next export</code> output</a>，Gatsby 的 default）替换为 <code>/some-app/</code>。</section><section class="level2"aria-labelledby="在现有页面的一部分中使用-react-using-react-for-a-part-of-your-existing-page"><h2 id="在现有页面的一部分中使用-react-using-react-for-a-part-of-your-existing-page">在现有页面的一部分中使用 React {/<em>using-react-for-a-part-of-your-existing-page</em>/}</h2><p>假设有一个其他技术栈（无论是 Rails 这样的服务端技术，还是 Backbone 那样的客户端技术）构建的现有页面，并且想要在该页面的某个位置渲染交互式的 React 组件。这是集成 React 的常见方式——实际上，这也正是多年来大多数情况下 Meta 使用 React 的方式！<p>你可以分两步进行：<ol><li><strong>配置 JavaScript 环境</strong>，以便使用 <a href="/learn/writing-markup-with-jsx">JSX 语法</a>、<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/import"><code>import</code></a> 和 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/export"><code>export</code></a> 语法将代码拆分为模块，以及从 <a href="https://www.npmjs.com/">npm</a> 包注册表中使用包（例如 React）。<li><strong>在需要的位置渲染 React 组件</strong>。</ol><p>确切的方法取决于现有的页面配置，因此让我们对一些细节进行说明。<section class="level3"aria-labelledby="步骤-1配置模块化的-javascript-环境-step-1-set-up-a-modular-javascript-environment"><h3 id="步骤-1配置模块化的-javascript-环境-step-1-set-up-a-modular-javascript-environment">步骤 1：配置模块化的 JavaScript 环境 {/<em>step-1-set-up-a-modular-javascript-environment</em>/}</h3><p>模块化的 JavaScript 环境可以让你在单一的文件中编写 React 组件，而不是在一个文件中编写所有的代码。它还可以让你使用其他开发人员在 <a href="https://www.npmjs.com/">npm</a> 注册表上发布的一些特别好用的包，包括 React！如何实现这一点取决于你现有的配置：<ul><li><p><strong>如果你的应用已经使用 <code>import</code> 语句来分割成不同的文件，请尝试利用已有的配置</strong>。检查在你的 JavaScript 代码中编写 <code>&#x3C;div /></code>是否会导致语法错误。如果有语法错误，你可能需要使用 <a href="https://babeljs.io/setup">Babel</a> 转换你的 JavaScript 代码，并启用 <a href="https://babeljs.io/docs/babel-preset-react">Babel React preset</a> 来使用 JSX。<li><p><strong>如果你的应用没有用于编译 JavaScript 模块的配置，请使用 <a href="https://cn.vitejs.dev/">Vite</a> 进行配置</strong>。Vite 社区维护了与后端框架（包括 Rails、Django 和 Laravel）的 <a href="https://github.com/vitejs/awesome-vite#integrations-with-backends">许多集成项目</a>。如果你的后端框架没有列出，请 <a href="https://cn.vitejs.dev/guide/backend-integration.html">按照此指南</a> 手动将 Vite 构建集成到你的后端。</ul><p>如果想要检查你的配置是否有效，可以在项目文件夹中运行以下命令：</p><terminalblock>npm install react react-dom</terminalblock><p>然后在你的 JavaScript 主文件（它可能被称为 <code>index.js</code> 或 <code>main.js</code>）的顶部添加以下代码：</p><sandpack><pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>title</span><span class="token punctuation">></span></span>My app<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token comment">&#x3C;!-- 你现有的页面内容（在这个例子中，它将被替换） --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>

<span class="token comment">// 清除现有的 HTML 内容</span>
<span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">=</span> <span class="token string">'&#x3C;div id="app">&#x3C;/div>'</span><span class="token punctuation">;</span>

<span class="token comment">// 渲染你的 React 组件</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
root<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Hello</span><span class="token punctuation">,</span> world<span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></sandpack><p>如果页面的全部内容都被替换为“Hello, world!”，则一切正常！那么继续阅读。</p><note><p>第一次将模块化 JavaScript 环境集成到现有项目中可能会让人感到害怕，但这是值得的！如果遇到困难，请尝试我们的 <a href="/community">社区资源</a> 或 <a href="https://chat.vitejs.dev/">Vite Chat</a>。</p></note></section><section class="level3"aria-labelledby="步骤-2在页面的任何位置渲染-react-组件-step-2-render-react-components-anywhere-on-the-page"><h3 id="步骤-2在页面的任何位置渲染-react-组件-step-2-render-react-components-anywhere-on-the-page">步骤 2：在页面的任何位置渲染 React 组件 {/<em>step-2-render-react-components-anywhere-on-the-page</em>/}</h3><p>在上一步中，此代码将被放在主文件的顶部：<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>

<span class="token comment">// 清除现有的 HTML 内容</span>
<span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">=</span> <span class="token string">'&#x3C;div id="app">&#x3C;/div>'</span><span class="token punctuation">;</span>

<span class="token comment">// 渲染你的 React 组件</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
root<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Hello</span><span class="token punctuation">,</span> world<span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>当然，你实际上并不想清除现有的 HTML 内容！<p>那么请删除此代码。<p>相反，你可能想要在 HTML 中特定的位置渲染 React 组件。打开 HTML 页面（或用于生成它的服务端模板），并向任意一个标签添加一个唯一的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Global_attributes/id"><code>id</code></a> 属性，例如：<pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!-- ... 你的 HTML 代码某处 ... --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>nav</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navigation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>nav</span><span class="token punctuation">></span></span>
<span class="token comment">&#x3C;!-- ... 其他 HTML 代码 ... --></span></code></pre><p>这样可以使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document/getElementById"><code>document.getElementById</code></a> 查找到该 HTML 元素，并将其传递给 <a href="/reference/react-dom/client/createRoot"><code>createRoot</code></a>，以便可以在其中渲染自己的 React 组件：</p><sandpack><pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>title</span><span class="token punctuation">></span></span>My app<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>This paragraph is a part of HTML.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>nav</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navigation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>nav</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>This paragraph is also a part of HTML.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">NavigationBar</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: 实际实现一个导航栏</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Hello</span> <span class="token keyword module">from</span> <span class="token maybe-class-name">React</span><span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> domNode <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span>domNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
root<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">NavigationBar</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></sandpack><p>请注意 <code>index.html</code> 中的原始 HTML 内容是如何保留的，但现在你自己的 <code>NavigationBar</code> React 组件出现在 HTML 的 <code>&#x3C;nav id="navigation"></code> 中。阅读 <a href="/reference/react-dom/client/createRoot#rendering-a-page-partially-built-with-react"><code>createRoot</code> 用法文档</a> 以了解如何在现有 HTML 页面中渲染 React 组件。<p>当在现有项目中采用 React 时，通常会从小型交互式组件（例如按钮）开始，然后逐渐“向上移动”，直到最终整个页面都由 React 构建。到那个时候，我们建议立即迁移到 <a href="/learn/start-a-new-react-project">一个 React 框架</a>，以充分利用 React 的优势。</section></section><section class="level2"aria-labelledby="在现有的原生移动应用中使用-react-native-using-react-native-in-an-existing-native-mobile-app"><h2 id="在现有的原生移动应用中使用-react-native-using-react-native-in-an-existing-native-mobile-app">在现有的原生移动应用中使用 React Native {/<em>using-react-native-in-an-existing-native-mobile-app</em>/}</h2><p><a href="https://reactnative.dev/">React Native</a> 也可以逐步集成到现有的原生应用中。如果已经有一个现有的 Android（Java 或 Kotlin）或 iOS（Objective-C 或 Swift）原生应用，请 <a href="https://reactnative.dev/docs/integration-with-existing-apps">按照本指南</a> 将 React Native 添加到其中。 <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>