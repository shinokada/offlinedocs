<!doctypehtml><html lang="zh-hans"><meta charset="utf-8"><title>跨源资源共享错误</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="跨源资源共享错误"class="level1"><h1>跨源资源共享错误</h1><blockquote><p>注意:<p>以下部分仅适应于开发模式下的 React。生产模式下的异常处理由常规的 try/catch 语句完成。</blockquote><p>在<a href="./optimizing-performance.html">开发模式</a>下,React 使用全局事件 <code>错误</code> 处理来保留在浏览器开发者工具的 "异常时暂停" 行为。它还会将错误记录到开发者控制台.<p>如果错误由一个<a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">不同的源</a>抛出, 浏览器将会掩盖它的细节,React也不能记录原始的错误信息。这是一个由浏览器采取的安全预防措施来避免敏感信息的泄露。<p>你可以抛出一个同源策略的错误来简化开发/调试模式过程。以下是一些常见的引起跨源资源共享的原因以及处理他们的方法。<section id="cdn"class="level3"><h3>CDN</h3><p>当从一个 CDN 加载 React （或者其他可能抛出错误的库）,在你的 <code>&#x3C;script></code> 标签中添加 <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_settings_attributes"><code>crossorigin</code></a>属性：<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>...<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>并且确保 CDN 以 <code>Access-Control-Allow-Origin: *</code> HTTP 请求头应答：<figure><img src="./docs/cdn-cors-header.png"alt="Access-Control-Allow-Origin: *"><figcaption aria-hidden="true">Access-Control-Allow-Origin: *</figcaption></figure></section><section id="webpack"class="level3"><h3>Webpack</h3><section id="source-maps"class="level4"><h4>源码映射</h4><p>一些 JavaScript 打包器可能在开发过程中以 <code>eval</code> 包装应用代码。（例如，Webpack 会用这个如果设置 <a href="https://webpack.js.org/configuration/devtool/"><code>devtool</code></a> 的值任意包含"eval"）。这个可能会引起被视为跨源错误。<p>如果你使用 Webpack,我们推荐在开发中使用 <code>cheap-module-source-map</code> 设置来避免这个问题。</section><section id="code-splitting"class="level4"><h4>代码拆分</h4><p>如果你的应用被拆分成多个包，这些包可能会使用 JSONP被加载。这些包会被视为跨源资源，从而可能会引发错误。<p>为了处理这个错误, 在标签 <code>&#x3C;script></code> 中为 <code>crossorigin</code> 属性添加 <a href="https://webpack.js.org/configuration/output/#output-crossoriginloading"><code>crossOriginLoading</code></a> 设置，从而为 JSONP 生成请求。 <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section></section>