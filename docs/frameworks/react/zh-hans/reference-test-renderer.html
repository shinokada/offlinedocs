<!doctype html><html lang="zh-hans"><meta charset="utf-8"><title>Test Renderer</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="test-renderer"class="level1"><h1>Test Renderer</h1><p><strong>如何引入</strong><pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">TestRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span> <span class="token comment">// ES6</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">TestRenderer</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react-test-renderer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ES5 with npm</span></code></pre><section id="overview"class="level2"><h2>概览</h2><p>这个 package 提供了一个 React 渲染器，用于将 React 组件渲染成纯 JavaScript 对象，无需依赖 DOM 或原生移动环境。<p>这个 package 提供的主要功能是在不依赖浏览器或 <a href="https://github.com/tmpvar/jsdom">jsdom</a> 的情况下，返回某个时间点由 React DOM 或者 React Native 平台渲染出的视图结构（类似与 DOM 树）快照。<p>示例:<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">TestRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Link</span></span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token property-access">page</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> testRenderer <span class="token operator">=</span> <span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Link</span> page<span class="token operator">=</span><span class="token string">"https://www.facebook.com/"</span><span class="token operator">></span><span class="token maybe-class-name">Facebook</span><span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">Link</span><span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>testRenderer<span class="token punctuation">.</span><span class="token method function property-access">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { type: 'a',</span>
<span class="token comment">//   props: { href: 'https://www.facebook.com/' },</span>
<span class="token comment">//   children: [ 'Facebook' ] }</span></code></pre><p>你可以使用 Jest 的快照测试功能来自动保存当前 <code>JSON</code> 树结构到一个文件中，并在测试中检查它是否被修改：<a href="https://jestjs.io/docs/en/snapshot-testing">了解更多</a>。<p>你也可以通过遍历输出来查找特定节点，并对它们进行断言。<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">TestRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">SubComponent</span> foo<span class="token operator">=</span><span class="token string">"bar"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p className<span class="token operator">=</span><span class="token string">"my"</span><span class="token operator">></span><span class="token maybe-class-name">Hello</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">SubComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>p className<span class="token operator">=</span><span class="token string">"sub"</span><span class="token operator">></span><span class="token maybe-class-name">Sub</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> testRenderer <span class="token operator">=</span> <span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyComponent</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> testInstance <span class="token operator">=</span> testRenderer<span class="token punctuation">.</span><span class="token property-access">root</span><span class="token punctuation">;</span>

<span class="token function">expect</span><span class="token punctuation">(</span>testInstance<span class="token punctuation">.</span><span class="token method function property-access">findByType</span><span class="token punctuation">(</span><span class="token maybe-class-name">SubComponent</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">.</span><span class="token property-access">foo</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>testInstance<span class="token punctuation">.</span><span class="token method function property-access">findByProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">"sub"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Sub'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><section id="testrenderer"class="level3"><h3>TestRenderer</h3><ul><li><a href="#testrenderercreate"><code>TestRenderer.create()</code></a><li><a href="#testrendereract"><code>TestRenderer.act()</code></a></ul></section><section id="testrenderer-instance"class="level3"><h3>TestRenderer instance</h3><ul><li><a href="#testrenderertojson"><code>testRenderer.toJSON()</code></a><li><a href="#testrenderertotree"><code>testRenderer.toTree()</code></a><li><a href="#testrendererupdate"><code>testRenderer.update()</code></a><li><a href="#testrendererunmount"><code>testRenderer.unmount()</code></a><li><a href="#testrenderergetinstance"><code>testRenderer.getInstance()</code></a><li><a href="#testrendererroot"><code>testRenderer.root</code></a></ul></section><section id="testinstance"class="level3"><h3>TestInstance</h3><ul><li><a href="#testinstancefind"><code>testInstance.find()</code></a><li><a href="#testinstancefindbytype"><code>testInstance.findByType()</code></a><li><a href="#testinstancefindbyprops"><code>testInstance.findByProps()</code></a><li><a href="#testinstancefindall"><code>testInstance.findAll()</code></a><li><a href="#testinstancefindallbytype"><code>testInstance.findAllByType()</code></a><li><a href="#testinstancefindallbyprops"><code>testInstance.findAllByProps()</code></a><li><a href="#testinstanceinstance"><code>testInstance.instance</code></a><li><a href="#testinstancetype"><code>testInstance.type</code></a><li><a href="#testinstanceprops"><code>testInstance.props</code></a><li><a href="#testinstanceparent"><code>testInstance.parent</code></a><li><a href="#testinstancechildren"><code>testInstance.children</code></a></ul></section></section><section id="reference"class="level2"><h2>参考</h2><section id="testrenderercreate-testrenderercreate"class="level3"><h3><code>TestRenderer.create()</code> {#testrenderercreate}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>通过传来的 React 元素创建一个 <code>TestRenderer</code> 实例。它并不使用真实的 DOM，但是它依然将组件树完整地渲染到内存，以便于你对它进行断言。此时将返回一个 <a href="#testrenderer-instance">TestRenderer 实例</a>。</section><section id="testrendereract-testrendereract"class="level3"><h3><code>TestRenderer.act()</code> {#testrendereract}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">act</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>与 <a href="./test-utils.html#act"><code>react-dom/test-utils</code> 中的 <code>act()</code></a> 相似，<code>TestRender.act</code> 为断言准备一个组件。可以使用 <code>act()</code> 来包装 <code>TestRenderer.create</code> 和 <code>testRenderer.update</code>。<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>create<span class="token punctuation">,</span> act<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./app.js'</span><span class="token punctuation">;</span> <span class="token comment">// The component being tested</span>

<span class="token comment">// 渲染组件</span>
<span class="token keyword">let</span> root<span class="token punctuation">;</span> 
<span class="token function">act</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  root <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 对根元素进行断言</span>
<span class="token function">expect</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token method function property-access">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 更新 props</span>
<span class="token function">act</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  root<span class="token punctuation">.</span><span class="token method function property-access">update</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 对根元素进行断言</span>
<span class="token function">expect</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token method function property-access">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></section><section id="testrenderertojson-testrenderertojson"class="level3"><h3><code>testRenderer.toJSON()</code> {#testrenderertojson}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>返回一个已渲染的的树对象。该树仅包含特定平台的节点，例如 <code>&#x3C;div></code> 或 <code>&#x3C;View></code> 和它们的 props，但并不包含任何用户编写的组件。这对于<a href="http://facebook.github.io/jest/docs/en/snapshot-testing.html#snapshot-testing-with-jest">快照测试</a>非常方便。</section><section id="testrenderertotree-testrenderertotree"class="level3"><h3><code>testRenderer.toTree()</code> {#testrenderertotree}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">toTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>返回一个已渲染的的树对象。它所表示的内容比 <code>toJSON()</code> 提供的内容要更加详细，并且包含用户编写的组件。除非你要在测试渲染器（test renderer）之上编写自己的断言库，否则你可能并不需要这个方法。</section><section id="testrendererupdate-testrendererupdate"class="level3"><h3><code>testRenderer.update()</code> {#testrendererupdate}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">update</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span></code></pre><p>使用新的根元素重新渲染内存中的树。它模拟根元素的一次 React 更新。如果新的元素和之前的元素有相同的 type 和 key，该树将会被更新；否则，它将重挂载一个新树。</section><section id="testrendererunmount-testrendererunmount"class="level3"><h3><code>testRenderer.unmount()</code> {#testrendererunmount}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>卸载内存中的树，会触发相应的生命周期事件。</section><section id="testrenderergetinstance-testrenderergetinstance"class="level3"><h3><code>testRenderer.getInstance()</code> {#testrenderergetinstance}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token method function property-access">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>如果可用的话，返回与根元素相对应的实例。如果根元素是函数定义组件，该方法无效，因为函数定义组件没有实例。</section><section id="testrendererroot-testrendererroot"class="level3"><h3><code>testRenderer.root</code> {#testrendererroot}</h3><pre class="language-javascript"><code class="language-javascript">testRenderer<span class="token punctuation">.</span><span class="token property-access">root</span></code></pre><p>返回根元素“测试实例”对象，它对于断言树中的特定节点十分有用。你可以利用它来查找其他更深层的“测试实例”。</section><section id="testinstancefind-testinstancefind"class="level3"><h3><code>testInstance.find()</code> {#testinstancefind}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span></code></pre><p>找到一个 <code>test(testInstance)</code> 返回 <code>true</code> 的后代测试实例。如果不只有一个测试实例匹配，将会报错。</section><section id="testinstancefindbytype-testinstancefindbytype"class="level3"><h3><code>testInstance.findByType()</code> {#testinstancefindbytype}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findByType</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span></code></pre><p>找到匹配指定 <code>type</code> 的后代测试实例，如果不是只有一个测试实例匹配指定的 <code>type</code>，将会报错。</section><section id="testinstancefindbyprops-testinstancefindbyprops"class="level3"><h3><code>testInstance.findByProps()</code> {#testinstancefindbyprops}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findByProps</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span></code></pre><p>找到匹配指定 <code>props</code>的后代测试实例，如果不是正好只有一个测试实例匹配指定的 <code>props</code>，将会报错。</section><section id="testinstancefindall-testinstancefindall"class="level3"><h3><code>testInstance.findAll()</code> {#testinstancefindall}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findAll</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span></code></pre><p>找到所有 <code>test(testInstance)</code> 返回 <code>true</code> 的后代测试实例。</section><section id="testinstancefindallbytype-testinstancefindallbytype"class="level3"><h3><code>testInstance.findAllByType()</code> {#testinstancefindallbytype}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findAllByType</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span></code></pre><p>找到所有匹配指定 <code>type</code> 的后代测试实例。</section><section id="testinstancefindallbyprops-testinstancefindallbyprops"class="level3"><h3><code>testInstance.findAllByProps()</code> {#testinstancefindallbyprops}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token method function property-access">findAllByProps</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span></code></pre><p>找到所有匹配指定 <code>props</code> 的后代测试实例。</section><section id="testinstanceinstance-testinstanceinstance"class="level3"><h3><code>testInstance.instance</code> {#testinstanceinstance}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">instance</span></code></pre><p>该测试实例相对应的组件实例。它只能用于类定义组件，因为函数定义组件没有实例。它匹配给定的组件内部的 <code>this</code> 的值。</section><section id="testinstancetype-testinstancetype"class="level3"><h3><code>testInstance.type</code> {#testinstancetype}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">type</span></code></pre><p>该测试实例相对应的组件的类型。例如，一个 <code>&#x3C;Button /></code> 组件有一个 <code>Button</code> 类型。</section><section id="testinstanceprops-testinstanceprops"class="level3"><h3><code>testInstance.props</code> {#testinstanceprops}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">props</span></code></pre><p>该测试实例相对应的组件的 props。例如，一个 <code>&#x3C;Button size="small" /></code> 组件的 props 为 <code>{size: 'small'}</code>。</section><section id="testinstanceparent-testinstanceparent"class="level3"><h3><code>testInstance.parent</code> {#testinstanceparent}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">parent</span></code></pre><p>该测试实例的父测试实例。</section><section id="testinstancechildren-testinstancechildren"class="level3"><h3><code>testInstance.children</code> {#testinstancechildren}</h3><pre class="language-javascript"><code class="language-javascript">testInstance<span class="token punctuation">.</span><span class="token property-access">children</span></code></pre><p>该测试实例的子测试实例。</section></section><section id="ideas"class="level2"><h2>想法</h2><p>你可以把 <code>createNodeMock</code> 函数作为选项（option）传递给 <code>TestRenderer.create</code>，进行自定义 refs 模拟。<code>createNodeMock</code> 接受当前元素作为参数，并且返回一个模拟 ref 对象的。这十分有利于依赖 refs 组件的测试。<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">TestRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">input</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">input</span><span class="token punctuation">.</span><span class="token method function property-access">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">el</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">input</span> <span class="token operator">=</span> el<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> focused <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token maybe-class-name">TestRenderer</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyComponent</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token function-variable function">createNodeMock</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span><span class="token property-access">type</span> <span class="token operator">===</span> <span class="token string">'input'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 模拟 focus 函数</span>
        <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
          <span class="token function-variable function">focus</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
            focused <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword control-flow">return</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>focused<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section>