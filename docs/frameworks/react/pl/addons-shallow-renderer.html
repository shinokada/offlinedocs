<!doctype html><html lang="pl"><meta charset="utf-8"><title>Shallow Renderer</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="shallow-renderer"class="level1"><h1>Shallow Renderer</h1><p><strong>Importowanie</strong><pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ShallowRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer/shallow'</span><span class="token punctuation">;</span> <span class="token comment">// ES6</span>
<span class="token keyword">var</span> <span class="token maybe-class-name">ShallowRenderer</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react-test-renderer/shallow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ES5 z zainstalowanym npm</span></code></pre><section id="overview"class="level2"><h2>Ogólne informacje</h2><p>Podczas pisania testów jednostkowych dla kodu reactowego przydatne może okazać się renderowanie płytkie (ang. <em>shallow rendering</em>). Pozwala ono na wyrenderowanie komponentu "jeden poziom w głąb" i wykonanie asercji na zwróconym drzewie, bez obaw o efekty uboczne komponentów potomnych, które wcale nie są tworzone i renderowane. Proces ten nie wymaga obecności drzewa DOM.<p>Załóżmy, że mamy do czynienia z następującym komponentem:<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>span className<span class="token operator">=</span><span class="token string">"heading"</span><span class="token operator">></span><span class="token maybe-class-name">Tytuł</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Subcomponent</span> foo<span class="token operator">=</span><span class="token string">"bar"</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Można dla niego napisać taki oto test:<pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ShallowRenderer</span></span> <span class="token keyword module">from</span> <span class="token string">'react-test-renderer/shallow'</span><span class="token punctuation">;</span>

<span class="token comment">// w teście:</span>
<span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ShallowRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyComponent</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> renderer<span class="token punctuation">.</span><span class="token method function property-access">getRenderOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token property-access">type</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token operator">&#x3C;</span>span className<span class="token operator">=</span><span class="token string">"heading"</span><span class="token operator">></span><span class="token maybe-class-name">Tytuł</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">,</span>
  <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Subcomponent</span> foo<span class="token operator">=</span><span class="token string">"bar"</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Testowanie płytkie posiada obecnie pewne ograniczenia, jak choćby brak wsparcia dla referencji (ang. <em>refs</em>) komponentów.<blockquote><p>Uwaga:<p>Zalecamy również zapoznanie się z <a href="https://airbnb.io/enzyme/docs/api/shallow.html">interefejsem API do płytkiego renderowania</a> biblioteki Enzyme. Dostarcza ona tę samą funkcjonalność, jednak ma wygodniejszy i bardziej wysokopoziomowy interfejs.</blockquote></section><section id="reference"class="level2"><h2>Dokumentacja</h2><section id="shallowrendererrender-shallowrendererrender"class="level3"><h3><code>shallowRenderer.render()</code> {#shallowrendererrender}</h3><p><code>shallowRenderer</code> jest "miejscem", w którym można wyrenderować testowany komponent i otrzymać zwracaną przez niego strukturę.<p><code>shallowRenderer.render()</code> w działaniu przypomina <a href="./react-dom-client.html#createroot"><code>root.render()</code></a>, jednak nie wymaga obecności drzewa DOM, a ponadto renderuje tylko jeden poziom struktury. Oznacza to, iż doskonale nadaje się do testowania komponentów w izolacji, bez brania pod uwagę implementacji komponentów potomnych.</section><section id="shallowrenderergetrenderoutput-shallowrenderergetrenderoutput"class="level3"><h3><code>shallowRenderer.getRenderOutput()</code> {#shallowrenderergetrenderoutput}</h3><p>Po wywołaniu <code>shallowRenderer.render()</code> należy użyć <code>shallowRenderer.getRenderOutput()</code>, aby otrzymać płasko wyrenderowaną strukturę.<p>Można na niej wykonywać dowolne asercje. <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section></section>