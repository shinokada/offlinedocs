<!doctypehtml><html lang="pl"><meta charset="utf-8"><title>Używanie hooka stanu</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="używanie-hooka-stanu"class="level1"><h1>Używanie hooka stanu</h1><p><em>Hooki</em> są nowym dodatkiem w Reakcie 16.8. Pozwalają one na wykorzystanie stanu i innych funkcjonalności Reacta, bez użycia klas.<p>We <a href="./hooks-intro.html">wstępie</a> przedstawiliśmy hooki za pomocą następującego przykładu:<pre class="language-js{4-5}"><code class="language-js{4-5}">import React, { useState } from 'react';

function Example() {
  // Zadeklaruj nową zmienną stanu, którą nazwiemy „count”
  const [count, setCount] = useState(0);

  return (
    &#x3C;div>
      &#x3C;p>Kliknięto {count} razy&#x3C;/p>
      &#x3C;button onClick={() => setCount(count + 1)}>
        Kliknij mnie
      &#x3C;/button>
    &#x3C;/div>
  );
}</code></pre><p>Naszą naukę o hookach rozpoczniemy, porównując ten kod z jego przykładowym odpowiednikiem w klasie.<section id="equivalent-class-example"class="level2"><h2>Odpowiednik w klasie</h2><p>Jeżeli używałeś już klas w Reakcie, ten kod powinien wyglądać znajomo:<pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">Kliknięto</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">count</span><span class="token punctuation">}</span> razy<span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">count</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token maybe-class-name">Kliknij</span> mnie
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Stan inicjalizowany jest wartością <code>{ count: 0 }</code>, a następnie, kiedy użytkownik naciska przycisk, inkrementujemy właściwość <code>state.count</code>, wywołując metodę <code>this.setState()</code>. W dalszej części tego rozdziału będziemy posiłkować się fragmentami kodu z tego przykładu.<blockquote><p>Uwaga<p>Być może zastanawiasz się, dlaczego pokazujemy tutaj licznik zamiast bardziej „życiowego” przykładu. Pozwoli nam to skupić się na samym interfejsie API, póki stawiamy nasze pierwsze kroki z hookami.</blockquote></section><section id="hooks-and-function-components"class="level2"><h2>Hooki i komponenty funkcyjne</h2><p>Przypomnijmy, reactowe komponenty funkcyjne wyglądają następująco:<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">Example</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Tutaj możesz korzystać z hooków!</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>div <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>albo tak:<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Example</span></span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Tutaj możesz korzystać z hooków!</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>div <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Być może spotkałeś się z nazwą „komponenty bezstanowe”. Jako że właśnie przedstawiamy sposób na korzystanie ze stanu wewnątrz takich komponentów, wolimy nazywać je „komponentami funkcyjnymi”.<p>Hooki <strong>nie</strong> działają w klasach. Ale możesz używać ich zamiast klas.</section><section id="whats-a-hook"class="level2"><h2>Czym jest hook?</h2><p>Nasz nowy przykład rozpoczniemy importując hook <code>useState</code> z Reacta:<pre class="language-js{1}"><code class="language-js{1}">import React, { useState } from 'react';

function Example() {
  // ...
}</code></pre><p><strong>Czym jest hook?</strong> Hook jest specjalną funkcją, która pozwala „zahaczyć się” w wewnętrzne mechanizmy Reacta. Na przykład <code>useState</code> jest hookiem, który pozwala korzystać ze stanu w komponencie funkcyjnym. W kolejnych rozdziałach poznamy inne hooki.<p><strong>Kiedy powinno się korzystać z hooków?</strong> Jeśli po stworzeniu komponentu funkcyjnego zorientujesz się, że potrzebujesz przechować kilka wartości w stanie, dotychczas musiałeś zamienić taki komponent na klasę. Teraz możesz skorzystać z hooka z wewnątrz istniejącego komponentu funkcyjnego. Zobaczmy jak to działa!<blockquote><p>Uwaga<p>Istnieje kilka specjalnych zasad, które mówią o tym kiedy możesz, a kiedy nie możesz używać hooków w komponencie. Więcej szczegółów poznamy w rozdziale pt. <a href="./hooks-rules.html">„Zasady korzystania z hooków”</a>.</blockquote></section><section id="declaring-a-state-variable"class="level2"><h2>Zadeklarowanie zmiennej stanu</h2><p>W klasie inicjalizujemy stan <code>count</code> z wartością <code>0</code>, poprzez ustawienie właściwości <code>this.state</code> na <code>{ count: 0 }</code> w konstruktorze.<pre class="language-js{4-6}"><code class="language-js{4-6}">class Example extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      count: 0
    };
  }</code></pre><p>W komponencie funkcyjnym nie mamy dostępu do <code>this</code>, więc nie możemy przypisywać, ani odczytać wartości właściwości <code>this.state</code>. Zamiast tego wywołamy hook <code>useState</code> bezpośrednio z wewnątrz naszego komponentu:<pre class="language-js{4,5}"><code class="language-js{4,5}">import React, { useState } from 'react';

function Example() {
  // Zadeklaruj nową zmienną stanu, którą nazwiemy „count”
  const [count, setCount] = useState(0);</code></pre><p><strong>Co w zasadzie robi wywołanie <code>useState</code>?</strong> Deklaruje ono „zmienną stanu”. Nasza zmienna nazywa się <code>count</code>, ale możemy nazwać ją, jak tylko chcemy, na przykład <code>banan</code>. Jest to sposób na „przechowanie” wartości pomiędzy wywołaniami funkcji -- <code>useState</code> jest nowym sposobem, na wykorzystanie dokładnie tych samych możliwości, jakie daje <code>this.state</code> w klasach. Zwykle zmienne „znikają” kiedy funkcja kończy działanie, ale zmienne stanu są przechowywane przez Reacta.<p><strong>Co przekazujemy do <code>useState</code> jako argumenty?</strong> Jedynym argumentem, jaki przyjmuje hook <code>useState()</code> jest początkowa wartość stanu. W przeciwieństwie do klas stan nie musi być obiektem. Możemy przechowywać liczbę lub ciąg znaków, jeżeli to wszystko, czego potrzebujemy. W naszym przykładzie chcemy przechować jedynie wartość liczbową, ile razy użytkownik nacisnął przycisk. Dlatego też przekazujemy <code>0</code> jako stan początkowy naszej zmiennej. (Jeżeli chcielibyśmy przechować kolejną wartość w stanie, wywołalibyśmy <code>useState()</code> po raz drugi.)<p><strong>Co zwraca wywołanie <code>useState</code>?</strong> Zwraca ono parę wartości: aktualną wartość stanu i funkcję, która pozwala go aktualizować. Dlatego stosujemy zapis <code>const [count, setCount] = useState()</code>. Jest to podobne do właściwości <code>this.state.count</code> i metody <code>this.setState</code> w klasie, z tą różnicą, że tutaj dostajesz je w parze. Jeżeli nie znasz składni, której użyliśmy, wrócimy do tego <a href="./hooks-state.html#tip-what-do-square-brackets-mean">przy końcu tego rozdziału</a>.<p>Teraz, kiedy wiemy już, co robi hook <code>useState</code>, nasz przykład powinien nabrać większego sensu:<pre class="language-js{4,5}"><code class="language-js{4,5}">import React, { useState } from 'react';

function Example() {
  // Zadeklaruj nową zmienną stanu, którą nazwiemy „count”
  const [count, setCount] = useState(0);</code></pre><p>Deklarujemy zmienną stanu, którą nazwaliśmy <code>count</code> i ustawiamy jej wartość na <code>0</code>. React będzie pamiętał jej aktualną wartość pomiędzy kolejnymi renderowaniami i dostarczy najnowszą wartość do naszej funkcji. Jeżeli chcemy zaktualizować obecną wartość <code>count</code>, możemy wywołać funkcję <code>setCount</code>.<blockquote><p>Uwaga<p>Być może zastanawiasz się -- dlaczego funkcja <code>useState</code> (pol. <em>używaj stanu</em>) nie nazywa się <code>createState</code> (pol. <em>stwórz stan</em>)?<p>Nazwa „Create” (pol. <em>tworzyć</em>) nie byłaby zbyt trafna, ponieważ stan tworzony jest tylko wtedy, gdy komponent renderowany jest za pierwszym razem. Podczas kolejnych renderowań <code>useState</code> zwraca aktualny stan. Gdyby nie to, nie mogłoby być mowy o żadnym „stanie” (ang. <em>state</em>)! Istnieje też powód, dla którego nazwa hooka <em>zawsze</em> rozpoczyna się od <code>use</code>. Więcej na ten temat dowiemy się w rozdziale pt. <a href="./hooks-rules.html">„Zasady korzystania z hooków”</a>.</blockquote></section><section id="reading-state"class="level2"><h2>Odczytywanie wartości stanu</h2><p>Jeśli chcemy wyświetlić aktualną wartość stanu licznika w klasie, odczytamy wartość właściwości <code>this.state.count</code>:<pre class="language-js"><code class="language-js">  <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">Kliknięto</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">count</span><span class="token punctuation">}</span> razy<span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span></code></pre><p>Wewnątrz funkcji, możemy użyć bezpośrednio zmiennej <code>count</code>:<pre class="language-js"><code class="language-js">  <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">Kliknięto</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span> razy<span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span></code></pre></section><section id="updating-state"class="level2"><h2>Aktualizowanie wartości stanu</h2><p>Aby zaktualizować wartość stanu <code>count</code> w klasie, musimy wywołać metodę <code>this.setState()</code>:<pre class="language-js{1}"><code class="language-js{1}">  &#x3C;button onClick={() => this.setState({ count: this.state.count + 1 })}>
    Kliknij mnie
  &#x3C;/button></code></pre><p>Wewnątrz funkcji mamy już zadeklarowane zmienne <code>setCount</code> i <code>count</code>, więc nie potrzebujemy <code>this</code>:<pre class="language-js{1}"><code class="language-js{1}">  &#x3C;button onClick={() => setCount(count + 1)}>
    Kliknij mnie
  &#x3C;/button></code></pre></section><section id="recap"class="level2"><h2>Podsumowanie</h2><p>Teraz <strong>podsumujmy linijka po linijce to, czego się nauczyliśmy</strong> i sprawdźmy naszą wiedzę.<pre class="language-js{1,4,9}"><code class="language-js{1,4,9}"> 1:  import React, { useState } from 'react';
 2:
 3:  function Example() {
 4:    const [count, setCount] = useState(0);
 5:
 6:    return (
 7:      &#x3C;div>
 8:        &#x3C;p>Kliknięto {count} razy&#x3C;/p>
 9:        &#x3C;button onClick={() => setCount(count + 1)}>
10:         Kliknij mnie
11:        &#x3C;/button>
12:      &#x3C;/div>
13:    );
14:  }</code></pre><ul><li><strong>Linia 1:</strong> Importujemy hooka <code>useState</code> z biblioteki React. Pozwala nam to na używanie lokalnego stanu w komponencie funkcyjnym.<li><strong>Linia 4:</strong> Wewnątrz komponentu <code>Example</code>, poprzez wywołanie hooka <code>useState</code>, deklarujemy nową zmienną stanu. Wywołanie zwraca parę wartości, którym nadajemy nazwy. Naszą zmienną nazywamy <code>count</code> (pol. <em>licznik</em>), ponieważ przechowuje ona liczbę naciśnięć przycisku. Inicjalizujemy ją z domyślną wartością, poprzez przekazanie <code>0</code> jako jedynego argumentu do funkcji <code>useState</code>. Jako druga zwrócona jest funkcja, która pozwala aktualizować wartość <code>count</code>, więc nazwiemy ją <code>setCount</code> (pol. <em>ustawić licznik</em>).<li><strong>Linia 9:</strong> Kiedy użytkownik naciska przycisk wywołujemy funkcję <code>setCount</code> z nową wartością. React wyrenderuje ponownie komponent <code>Example</code>, przekazując do niego nową wartość zmiennej <code>count</code>.</ul><p>Z początku wszystkie te informacje mogą wydawać się trudne do „przetrawienia”. Nie spiesz się! Jeżeli zgubisz się gdzieś czytając wyjaśnienie, spójrz na kod jeszcze raz i spróbuj go przeczytać ponownie od góry do dołu. Obiecujemy, kiedy spróbujesz „zapomnieć”, jak działa stan w klasach i spojrzysz na kod świeżym okiem, nabierze to sensu.<section id="tip-what-do-square-brackets-mean"class="level3"><h3>Wskazówka: Co oznaczają nawiasy kwadratowe?</h3><p>Być może zauważyłeś nawiasy kwadratowe, kiedy deklarowaliśmy zmienną stanu:<pre class="language-js"><code class="language-js">  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Nazwy po lewej nie są częścią interfejsu API Reacta. Możesz nadać własne nazwy zmiennym stanu:<pre class="language-js"><code class="language-js">  <span class="token keyword">const</span> <span class="token punctuation">[</span>fruit<span class="token punctuation">,</span> setFruit<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'banan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Ta składnia JavaScriptu nazwana jest <a href="https://developer.mozilla.org/pl/docs/Web/JavaScript/Referencje/Operatory/Destructuring_assignment#Destrukturyzacja_tablic">przypisaniem destrukturyzującym tablic</a>. Oznacza to, że tworzymy dwie zmienne <code>fruit</code> i <code>setFruit</code> -- gdzie <code>fruit</code> jest pierwszą wartością zwróconą przez <code>useState</code>, a <code>setFruit</code> drugą. Jest to odpowiednik następującego kodu:<pre class="language-js"><code class="language-js">  <span class="token keyword">var</span> fruitStateVariable <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'banan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Zwraca parę</span>
  <span class="token keyword">var</span> fruit <span class="token operator">=</span> fruitStateVariable<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Pierwszy element pary</span>
  <span class="token keyword">var</span> setFruit <span class="token operator">=</span> fruitStateVariable<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Drugi element pary</span></code></pre><p>Kiedy deklarujemy zmienną stanu, korzystając z funkcji <code>useState</code>, zwraca ona parę -- dwuelementową tablicę. Pierwszym elementem jest aktualna wartość, a drugim funkcja, która pozwala go aktualizować. Używanie zapisu <code>[0]</code> i <code>[1]</code> do uzyskiwania dostępu do nich jest nieco mylące, ponieważ mają one określone znaczenie. Dlatego używamy składni przypisania destrukturyzującego.<blockquote><p>Uwaga<p>Być może zastanawiasz się, skąd React wie, któremu konkretnie komponentowi odpowiada każde wywołanie <code>useState</code>, jeśli nie przekazujemy Reactowi obiektu <code>this</code> ani nic podobnego. Na <a href="./hooks-faq.html#how-does-react-associate-hook-calls-with-components">to pytanie</a> (i wiele innych) odpowiemy w rozdziale pt. „Hooki - FAQ”.</blockquote></section><section id="tip-using-multiple-state-variables"class="level3"><h3>Wskazówka: Używanie kilku zmiennych stanu</h3><p>Deklarowanie zmiennych stanu jako pary <code>[something, setSomething]</code> jest przydatne także dlatego, że pozwala ci na używanie <em>różnych</em> nazw, dla różnych zmiennych stanu, jeśli chcemy korzystać z więcej niż jednej:<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ExampleWithManyStates</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Declare multiple state variables!</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>fruit<span class="token punctuation">,</span> setFruit<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'banan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'Nauczyć się hooków'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>W powyższym komponencie, mamy lokalne zmienne <code>age</code>, <code>fruit</code> i <code>todos</code> i możemy każdą z nich zaktualizować z osobna.<pre class="language-js"><code class="language-js">  <span class="token keyword">function</span> <span class="token function">handleOrangeClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Similar to this.setState({ fruit: 'orange' })</span>
    <span class="token function">setFruit</span><span class="token punctuation">(</span><span class="token string">'orange'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span></code></pre><p><strong>Nie musisz</strong> używać kilku zmiennych stanu. Zmienne stanu mogą równie dobrze przechowywać obiekty i tablice, więc wciąż możesz grupować powiązane dane. Jednakże, w przeciwieństwie do metody <code>this.setState</code> w klasie, aktualizowanie zmiennej stanu zawsze <em>nadpisuje</em> jej wartość, zamiast scalać stare i nowe wartości.<p>W rozdziale pt. <a href="./hooks-faq.html#should-i-use-one-or-many-state-variables">„Hooki - FAQ”</a> wypisaliśmy zalecenia dotyczące podziału niezależnych zmiennych stanu.</section></section><section id="next-steps"class="level2"><h2>Kolejne kroki</h2><p>Ten rozdział poświęciliśmy jednemu z hooków dostarczanych przez Reacta -- <code>useState</code>. Czasami będziemy też nazywać go „hookiem stanu”. Pozwala on nam dodać lokalny stan do reactowych komponentów funkcyjnych, co zrobiliśmy po raz pierwszy w historii!<p>Dowiedzieliśmy się też troszeczkę o tym, czym w zasadzie są hooki. Hooki to funkcje, które pozwalają „zahaczyć się” w wewnętrzne mechanizmy Reacta z wewnątrz komponentów funkcyjnych. Ich nazwy muszą zaczynać się od <code>use</code> i istnieje szereg innych hooków, których jeszcze nie poznaliśmy.<p><strong>Zapoznajmy się więc z <a href="./hooks-effect.html">kolejnym hookiem: <code>useEffect</code>.</a></strong> Pozwala on na przeprowadzanie „efektów ubocznych” (ang. <em>side effects</em>) w komponentach i jest podobony do metod cyklu życia w klasach. <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section>