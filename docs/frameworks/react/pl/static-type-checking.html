<!doctype html><html lang="pl"><meta charset="utf-8"><title>Statyczne sprawdzanie typów</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="statyczne-sprawdzanie-typów"class="level1"><h1>Statyczne sprawdzanie typów</h1><p>Narzędzia statycznie sprawdzające typy, jak <a href="https://flow.org/">Flow</a> i <a href="https://www.typescriptlang.org/">TypeScript</a>, identyfikują określone rodzaje problemów jeszcze zanim uruchomisz kod. Usprawniają one również pracę programisty poprzez dodanie przydatnych funkcjonalności, jak np. autouzupełniania. Z tego powodu w większych aplikacjach sugerujemy zastąpienie <code>PropTypes</code> narzędziami Flow lub TypeScript.<section id="flow"class="level2"><h2>Flow</h2><p><a href="https://flow.org/">Flow</a> jest narzędziem statycznie sprawdzającym typy w kodzie javascriptowym. Jest rozwijany przez Facebooka i często używany w połączeniu z Reactem. Pozwala opisać zmienne, funkcje i komponenty reactowe za pomocą specjalnej składni, a także wyłapuje zawczasu potencjalne problemy. Aby zapoznać się z jego podstawami, przeczytaj <a href="https://flow.org/en/docs/getting-started/">wstęp do Flow</a>.<p>Aby móc używać Flow, musisz:<ul><li>Dodać Flow do projektu jako zależność.<li>Upewnić się, że składnia Flow jest usuwana podczas kompilacji.<li>Dodać adnotacje typów i uruchomić Flow w celu ich sprawdzenia.</ul><p>Wszystkie te kroki opisaliśmy szczegółowo poniżej.<section id="adding-flow-to-a-project"class="level3"><h3>Dodawanie Flow do projektu</h3><p>Najpierw, będąc w terminalu, przejdź do folderu z projektem, a następnie uruchom następujące polecenie:<p>Jeśli używasz <a href="https://yarnpkg.com/">Yarna</a>, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> --dev flow-bin</code></pre><p>Jeśli używasz <a href="https://www.npmjs.com/">npma</a>, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev flow-bin</code></pre><p>Powyższa komenda zainstaluje w twoim projekcie najnowszą wersję narzędzia Flow.<p>Teraz dodaj <code>flow</code> do sekcji <code>"scripts"</code> wewnątrz pliku <code>package.json</code>, aby móc skorzystać z tego skryptu w terminalu:<pre class="language-js{4}"><code class="language-js{4}">{
  // ...
  "scripts": {
    "flow": "flow",
    // ...
  },
  // ...
}</code></pre><p>Na koniec uruchom jedno z następujących poleceń:<p>Jeśli używasz <a href="https://yarnpkg.com/">Yarna</a>, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> run flow init</code></pre><p>Jeśli używasz <a href="https://www.npmjs.com/">npma</a>, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run flow init</code></pre><p>Powyższe komendy stworzą plik konfiguracyjny dla Flow, który należy umieścić w repozytorium.</section><section id="stripping-flow-syntax-from-the-compiled-code"class="level3"><h3>Usuwanie składni Flow podczas kompilacji</h3><p>Flow rozszerza język JavaScript poprzez dodanie specjalnej składni, służącej do deklaracji typów. Niestety przeglądarki nie rozumieją tej składni, dlatego musimy się upewnić, że nie trafi ona do skompilowanego kodu javascriptowego wysyłanego do przeglądarki.<p>Dokładny zestaw kroków opisujący sposób skonfigurowania tego zależy od narzędzi, którymi kompilujesz swój kod javascriptowy.<section id="create-react-app"class="level4"><h4>Create React App</h4><p>Jeśli twój projekt został stworzony przy pomocy <a href="https://github.com/facebookincubator/create-react-app">Create React App</a> - gratulujemy! Adnotacje dla Flow są już domyślnie usuwane podczas kompilacji, więc nie musisz niczego więcej konfigurować.</section><section id="babel"class="level4"><h4>Babel</h4><blockquote><p>Uwaga:<p>Poniższe instrukcje <em>nie</em> dotyczą użytkowników Create React App. Pomimo iż Create React App używa "pod maską" Babela, jest on w tym przypadku już skonfigurowany tak, aby rozumieć Flow. Wykonaj poniższe kroki, jeśli <em>nie</em> używasz Create React App.</blockquote><p>Jeśli Babel w twoim projekcie został skonfigurowany ręcznie, musisz zainstalować specjalny zestaw narzędzi (ang. <em>preset</em>) dla Flow.<p>Jeśli używasz Yarna, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> --dev @babel/preset-flow</code></pre><p>Jeśli używasz npma, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev @babel/preset-flow</code></pre><p>Następnie dodaj zestaw <code>flow</code> do swojej <a href="https://babeljs.io/docs/usage/babelrc/">konfiguracji Babela</a>. Na przykład, jeśli konfiguracja w twoim projekcie jest trzymana w pliku <code>.babelrc</code>, mógłby on wyglądać następująco:<pre class="language-js{3}"><code class="language-js{3}">{
  "presets": [
    "@babel/preset-flow",
    "react"
  ]
}</code></pre><p>Pozwoli ci to używać w kodzie składni Flow.<blockquote><p>Uwaga:<p>Flow nie wymaga użycia zestawu <code>react</code>, jednak często są one używane w parze. Flow sam w sobie rozumie składnię JSX.</blockquote></section><section id="other-build-setups"class="level4"><h4>Inne sposoby konfiguracji etapu budowania</h4><p>Jeśli nie korzystasz ani z Create React App, ani z Babela, możesz użyć paczki <a href="https://github.com/flowtype/flow-remove-types">flow-remove-types</a>, która usunie deklaracje typów.</section></section><section id="running-flow"class="level3"><h3>Korzystanie z Flow</h3><p>Jeśli udało ci się skonfigurować wszystko, co opisaliśmy powyżej, możesz śmiało uruchomić Flow po raz pierwszy.<pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> flow</code></pre><p>Jeśli używasz npma, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run flow</code></pre><p>Powinien pojawić się następujący komunikat ("Brak błędów!"):<pre class="language-text"><code class="language-text">No errors!
✨  Done in 0.17s.</code></pre></section><section id="adding-flow-type-annotations"class="level3"><h3>Dodawanie adnotacji w Flow</h3><p>Domyślnie Flow sprawdza tylko te pliki, które zawierają następującą linię:<pre class="language-js"><code class="language-js"><span class="token comment">// @flow</span></code></pre><p>Zwykle umieszcza się ją na początku pliku. Spróbuj dodać ją do kilku plików i uruchom <code>yarn flow</code> lub <code>npm run flow</code>, aby sprawdzić, czy Flow znalazł jakieś błędy.<p>Istnieje również <a href="https://flow.org/en/docs/config/options/#toc-all-boolean">pewien sposób</a>, by wymusić na Flow sprawdzanie <em>wszystkich</em> plików, bez względu na to, czy zawierają powyższą adnotację. W istniejących projektach może to wprowadzić niemałe zamieszanie, jednak sensowne jest ustawienie tej opcji w nowych projektach, w których od początku chcemy mieć zapewnione sprawdzanie typów przez Flow.<p>Masz już wszystko! Jeśli chcesz dowiedzieć się więcej na temat Flow, przeczytaj:<ul><li><a href="https://flow.org/en/docs/types/">Dokumentacja Flow: Adnotacje typów</a><li><a href="https://flow.org/en/docs/editors/">Dokumentacja Flow: Edytory</a><li><a href="https://flow.org/en/docs/react/">Dokumentacja Flow: React</a><li><a href="https://medium.com/flow-type/linting-in-flow-7709d7a7e969">Linting w Flow</a></ul></section></section><section id="typescript"class="level2"><h2>TypeScript</h2><p><a href="https://www.typescriptlang.org/">TypeScript</a> jest językiem programowania rozwijanym przez Microsoft. Jest typowanym nadzbiorem języka JavaScript i posiada własny kompilator. Jako język typowany, TypeScript może wyłapywać błędy na etapie budowania, długo zanim aplikacja "ujrzy światło dzienne". <a href="https://github.com/Microsoft/TypeScript-React-Starter#typescript-react-starter">Dowiedz się więcej na temat użycia TypeScriptu w parze z Reactem</a>.<p>Aby móc używać TypeScriptu, musisz:<ul><li>Dodać TypeScript jako zależność twojego projektu<li>Skonfigurować opcje kompilatora typescriptowego<li>Użyć odpowiednich rozszerzeń nazw plików<li>Dodać definicje dla używanych w projekcie bibliotek</ul><p>Zacznijmy po kolei.<section id="using-typescript-with-create-react-app"class="level3"><h3>Używanie TypeScriptu w Create React App</h3><p>Create React App domyślnie obsługuje TypeScript.<p>Aby stworzyć <strong>nowy projekt</strong> mający wsparcie dla TypeScriptu, uruchom:<pre class="language-bash"><code class="language-bash">npx create-react-app my-app --template typescript</code></pre><p>Możesz go również <a href="https://facebook.github.io/create-react-app/docs/adding-typescript"><strong>dodać do istniejącego projektu stworzonego z Create React App</strong></a>.<blockquote><p>Uwaga:<p>Jeśli używasz Create React App, możesz <strong>pominąć resztę instrukcji</strong>, ponieważ opisują one ręczną konfigurację, której nie muszą przeprowadzać użytkownicy Create React App.</blockquote></section><section id="adding-typescript-to-a-project"class="level3"><h3>Dodawanie TypeScriptu do projektu</h3><p>Wszystko zaczyna się od uruchomienia jednego polecenia w terminalu.<p>Jeśli używasz <a href="https://yarnpkg.com/">Yarna</a>, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> --dev typescript</code></pre><p>Jeśli używasz <a href="https://www.npmjs.com/">npma</a>, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev typescript</code></pre><p>Gratulacje! Udało ci się zainstalować w projekcie najnowszą wersję TypeScriptu. Dało nam to dostęp do komendy <code>tsc</code>. Zanim zaczniesz konfigurowanie, dodaj <code>tsc</code> do sekcji <code>"scripts"</code> w pliku <code>package.json</code>:<pre class="language-js{4}"><code class="language-js{4}">{
  // ...
  "scripts": {
    "build": "tsc",
    // ...
  },
  // ...
}</code></pre></section><section id="configuring-the-typescript-compiler"class="level3"><h3>Konfigurowanie kompilatora TypeScriptu</h3><p>Kompilator na nic się nie zda, jeśli nie powiemy mu, co ma robić. W TypeScripcie reguły dla kompilatora definiuje się w specjalnym pliku <code>tsconfig.json</code>. Aby wygenerować taki plik:<p>Jeśli używasz <a href="https://yarnpkg.com/">Yarna</a>, uruchom:<pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> run tsc --init</code></pre><p>Jeśli używasz <a href="https://www.npmjs.com/">npma</a>, uruchom:<pre class="language-bash"><code class="language-bash">npx tsc --init</code></pre><p>Kiedy zajrzysz do nowo wygenerowanego pliku <code>tsconfig.json</code>, zobaczysz, jak wiele jest opcji konfiguracji kompilatora. Szczegółowy <a href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html">opis wszystkich opcji znajdziesz tutaj</a>.<p>Spośród licznych opcji interesować nas będzie <code>rootDir</code> i <code>outDir</code>. Jak można się domyślić, kompilator odczyta pliki typescriptowe i wygeneruje z nich pliki javascriptowe. Jednak chcemy jasno określić, które z nich są plikami źródłowymi, a które wygenerowanym automatycznie kodem.<p>Zajmiemy się tym w dwóch krokach:<ul><li>Najpierw dostosujmy strukturę naszego projektu do poniższego schematu. Umieśćmy wszystkie pliki źródłowe w folderze <code>src</code>.</ul><pre class="language-text"><code class="language-text">├── package.json
├── src
│   └── index.ts
└── tsconfig.json</code></pre><ul><li>Następnie skonfigurujmy kompilator tak, by wiedział, gdzie są pliki źródłowe, a gdzie folder docelowy na wygenerowane pliki.</ul><pre class="language-js{6,7}"><code class="language-js{6,7}">// tsconfig.json

{
  "compilerOptions": {
    // ...
    "rootDir": "src",
    "outDir": "build"
    // ...
  },
}</code></pre><p>Świetnie! Teraz, gdy tylko uruchomimy skrypt budujący, kompilator wygeneruje pliki z kodem javascriptowym do folderu <code>build</code>. Projekt <a href="https://github.com/Microsoft/TypeScript-React-Starter/blob/master/tsconfig.json">TypeScript React Starter</a> zawiera plik <code>tsconfig.json</code> z rozsądną konfiguracją początkową dla nowych projektów.<p>Zwykle nie trzyma się wygenerowanych plików javascriptowych w repozytorium, więc upewnij się, że folder ten dodany jest do listy <code>.gitignore</code>.</section><section id="file-extensions"class="level3"><h3>Rozszerzenia plików</h3><p>W Reakcie kod komponentów zwykle umieszcza się w plikach <code>.js</code>. W TypeScripcie mamy do wyboru dwa rozszerzenia:<p><code>.ts</code> jest domyślnym rozszerzeniem plików, natomiast <code>.tsx</code> służy do oznaczania plików, które zawierają składnię <code>JSX</code>.</section><section id="running-typescript"class="level3"><h3>Uruchamianie TypeScriptu</h3><p>Jeśli udało ci się wykonać powyższe instrukcje, możesz śmiało uruchomić TypeScript po raz pierwszy.<pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> build</code></pre><p>Lub jeśli używasz npma:<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run build</code></pre><p>Jeśli nie wyświetlił się żaden komunikat, to znaczy, że kompilacja przebiegła pomyślnie.</section><section id="type-definitions"class="level3"><h3>Definicje typów</h3><p>Aby móc wyświetlać błędy i sugestie dla innych paczek, kompilator polega na plikach z deklaracjami. Plik z deklaracjami dostarcza wszystkie informacje na temat typów w danej bibliotece. Pozwala to na używanie w naszym projekcie bibliotek javascriptowych z rejestru npm.<p>Istnieją dwa główne miejsca, z których odczytamy typy dla biblioteki:<p><strong>Dołączone</strong> - Niektóre biblioteki dołączają własne typy z deklaracjami. Jest to korzystne dla nas, ponieważ będziemy mogli zacząć korzystać z paczki zaraz po jej zainstalowaniu. Aby upewnić się, że biblioteka posiada dołączone typy, poszukaj w niej pliku <code>index.d.ts</code>. Niektóre biblioteki wyszczególniają ten plik w <code>package.json</code> pod kluczem <code>typings</code> lub <code>types</code>.<p><strong><a href="https://github.com/DefinitelyTyped/DefinitelyTyped">DefinitelyTyped</a></strong> - DefinitelyTyped to ogromne repozytorium deklaracji typów dla bibliotek, które nie dołączają swoich własnych typów. Deklaracje te są crowd-source'owane i zarządzane przez firmę Microsoft oraz przez kontrybutorów open source'owych. Dla przykładu, React nie posiada własnego pliku z deklaracjami typów. Zamiast tego możemy pobrać go z DefinitelyTyped. Aby to zrobić, wpisz w terminalu następujące polecenie.<pre class="language-bash"><code class="language-bash"><span class="token comment"># yarn</span>
<span class="token function">yarn</span> <span class="token function">add</span> --dev @types/react

<span class="token comment"># npm</span>
<span class="token function">npm</span> i --save-dev @types/react</code></pre><p><strong>Deklaracje lokalne</strong> Czasami paczka, której chcesz użyć, nie posiada własnych typów ani nie ma ich w repozytorium DefinitelyTyped. W takim przypadku możesz stworzyć własny, lokalny plik z deklaracjami <code>declarations.d.ts</code> w głównym katalogu projektu. Przykładowa deklaracja może wyglądać tak:<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'querystring'</span> <span class="token punctuation">{</span>
  <span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">stringify</span><span class="token punctuation">(</span>val<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> object
<span class="token punctuation">}</span></code></pre><p>Możesz już zacząć programować! Po więcej informacji o TypeScripcie zajrzyj do poniższych źródeł:<ul><li><a href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html">Dokumentacja TypeScripta: Typy podstawowe</a><li><a href="https://www.typescriptlang.org/docs/handbook/migrating-from-javascript.html">Dokumentacja TypeScripta: Migracja z JavaScriptu</a><li><a href="https://www.typescriptlang.org/docs/handbook/react-&#x26;-webpack.html">Dokumentacja TypeScripta: React i Webpack</a></ul></section></section><section id="rescript"class="level2"><h2>ReScript</h2><p><a href="https://rescript-lang.org/">ReScript</a> jest typowanym językiem, który kompiluje się do JavaScriptu. Jego głównymi właściwościami są: gwarancja 100% pokrycia typami, <a href="https://pl.wikipedia.org/wiki/Typ_pierwszoklasowy">pierwszoklasowe</a> (<em>ang. first-class</em>) wsparcie dla JSX oraz dedykowane <a href="https://rescript-lang.org/docs/react/latest/introduction">wiązania dla Reacta</a>, które pozwalają na zintegrowanie z istniejącymi projektami napisanymi w JS/TS.<p>Aby dowiedzieć się więcej na temat integrowania ReScriptu z istniejącym projektem w JS/React, <a href="https://rescript-lang.org/docs/manual/latest/installation#integrate-into-an-existing-js-project">przeczytaj dokumentację</a>.</section><section id="kotlin"class="level2"><h2>Kotlin</h2><p><a href="https://kotlinlang.org/">Kotlin</a> jest statycznie typowanym językiem rozwijanym przez JetBrains. Docelowe platformy dla niego to JVM, Android, LLVM i <a href="https://kotlinlang.org/docs/reference/js-overview.html">JavaScript</a>.<p>JetBrains rozwija i utrzymuje kilka narzędzi dedykowanych dla społeczności Reacta: <a href="https://github.com/JetBrains/kotlin-wrappers">API dla React</a>, jak również <a href="https://github.com/JetBrains/create-react-kotlin-app">Create React Kotlin App</a>. To ostatnie narzędzie pozwala na wystartowanie aplikacji reactowej z Kotlinem bez żadnego konfigurowania projektu.</section><section id="other-languages"class="level2"><h2>Inne języki</h2><p>Zauważ, że istnieją jeszcze inne statycznie typowane języki, kompilowane do JavaScriptu i przez to kompatybilne z Reactem. Na przykład <a href="https://fable.io/">F#/Fable</a> z <a href="https://elmish.github.io/react">elmish-react</a>. Zajrzyj na ich strony internetowe po więcej informacji. Jeśli znasz jeszcze jakieś inne statycznie typowane języki, które współgrają z Reactem, nie wahaj się dodać ich do tej strony! <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section>