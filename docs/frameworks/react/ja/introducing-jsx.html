<!doctypehtml><html lang="ja"><meta charset="utf-8"><title>JSX の導入</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="jsx-の導入"class="level1"><h1>JSX の導入</h1><p>以下の変数宣言を考えてみましょう：<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Hello</span><span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span></code></pre><p>このおかしなタグ構文は文字列でも HTML でもありません。<p>これは JSX と呼ばれる JavaScript の構文の拡張です。UI がどのような見た目かを記述するために、React とともに JSX を使用することを私たちはお勧めしています。JSX はテンプレート言語を連想させるでしょうが、JavaScript の機能を全て備えたものです。<p>JSX は React "要素" を生成します。<a href="./rendering-elements.html">次の章</a>で React 要素を DOM に変換する方法について見ていきます。以下では、JSX を使い始めるのに必要な基礎を学ぶことができます。<section id="why-jsx"class="level3"><h3>JSXを使う理由</h3><p>表示のためのロジックは、イベントへの応答や経時的な状態の変化、画面表示のためのデータを準備する方法といった、他の UI ロジックと本質的に結合したものであり、React はその事実を受け入れます。<p>マークアップとロジックを別々のファイルに書いて人為的に<em>技術</em>を分離するのではなく、React はマークアップとロジックを両方含む疎結合の「コンポーネント」という単位を用いて<a href="https://en.wikipedia.org/wiki/Separation_of_concerns"><em>関心</em>を分離</a>します。<a href="./components-and-props.html">後のセクション</a>でコンポーネントについては改めて詳しく紹介しますが、現時点で JavaScript にマークアップを書くことが気にくわない場合、<a href="https://www.youtube.com/watch?v=x7cQ3mrcKaY">こちらの議論</a>で考えが改まるかもしれません。<p>React で JSX を使うことは<a href="./react-without-jsx.html">必須ではありません</a>が、ほとんどの人は JavaScript コード中で UI を扱う際に、JSX を見た目に有用なものだと感じています。また、JSX があるために React は有用なエラーや警告をより多く表示することができます。<p>前置きはこのくらいにして、早速始めましょう。</section><section id="embedding-expressions-in-jsx"class="level3"><h3>JSX に式を埋め込む</h3><p>以下の例では、<code>name</code> という変数を宣言して、それを中括弧に囲んで JSX 内で使用しています。<pre class="language-js{1,2}"><code class="language-js{1,2}">const name = 'Josh Perez';
const element = &#x3C;h1>Hello, {name}&#x3C;/h1>;</code></pre><p>あらゆる有効な <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#Expressions">JavaScript の式</a>を JSX 内で中括弧に囲んで使用できます。例えば、<code>2 + 2</code> や <code>user.firstName</code> や <code>formatName(user)</code> はすべて有効な JavaScript の式です。<p>以下の例では、<code>formatName(user)</code> という JavaScript 関数の結果を <code>&#x3C;h1></code> 要素内に埋め込んでいます。<pre class="language-js{12}"><code class="language-js{12}">function formatName(user) {
  return user.firstName + ' ' + user.lastName;
}

const user = {
  firstName: 'Harper',
  lastName: 'Perez'
};

const element = (
  &#x3C;h1>
    Hello, {formatName(user)}!
  &#x3C;/h1>
);</code></pre><p><strong><a href="https://codepen.io/gaearon/pen/PGEjdG?editors=1010">Try it on CodePen</a></strong><p>読みやすさのため JSX を複数行に分けています。必須ではありませんが、複数行に分割する場合には、<a href="https://stackoverflow.com/q/2846283">自動セミコロン挿入</a>の落とし穴にはまらないように括弧で囲むことをおすすめします</section><section id="jsx-is-an-expression-too"class="level3"><h3>JSX もまた式である</h3><p>コンパイルの後、JSX の式は普通の JavaScript の関数呼び出しに変換され、JavaScript オブジェクトへと評価されます。<p>これは JSX を <code>if</code> 文や <code>for</code> ループの中で使用したり、変数に代入したり、引数として受け取ったり、関数から返したりすることができるということです。<pre class="language-js{3,5}"><code class="language-js{3,5}">function getGreeting(user) {
  if (user) {
    return &#x3C;h1>Hello, {formatName(user)}!&#x3C;/h1>;
  }
  return &#x3C;h1>Hello, Stranger.&#x3C;/h1>;
}</code></pre></section><section id="specifying-attributes-with-jsx"class="level3"><h3>JSX で属性を指定する</h3><p>文字列リテラルを属性として指定するために引用符を使用できます。<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>a href<span class="token operator">=</span><span class="token string">"https://www.reactjs.org"</span><span class="token operator">></span> link <span class="token operator">&#x3C;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token punctuation">;</span></code></pre><p>属性に JavaScript 式を埋め込むために中括弧を使用することもできます。<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>user<span class="token punctuation">.</span><span class="token property-access">avatarUrl</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&#x3C;</span><span class="token operator">/</span>img<span class="token operator">></span><span class="token punctuation">;</span></code></pre><p>属性に JavaScript 式を埋め込む時に中括弧を囲む引用符を書かないでください。（文字列の場合は）引用符、もしくは（式の場合は）中括弧のどちらか一方を使用するようにし、同じ属性に対して両方を使用するべきではありません。<blockquote><p><strong>警告:</strong><p>JSX は HTML よりも JavaScript に近いものですので、React DOM は HTML の属性ではなくキャメルケース (camelCase) のプロパティ命名規則を使用します。<p>JSX では例えば、<code>class</code> は <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/className"><code>className</code></a> となり、<code>tabindex</code> は <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/tabIndex"><code>tabIndex</code></a> となります。</blockquote></section><section id="specifying-children-with-jsx"class="level3"><h3>JSX で子要素を指定する</h3><p>タグが空の場合、XML のように <code>/></code>でタグを閉じる事ができます：<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>user<span class="token punctuation">.</span><span class="token property-access">avatarUrl</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span></code></pre><p>JSX のタグは子要素を持つことができます：<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
    <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Hello</span><span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
    <span class="token operator">&#x3C;</span>h2<span class="token operator">></span><span class="token maybe-class-name">Good</span> to see you here<span class="token punctuation">.</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h2<span class="token operator">></span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></section><section id="jsx-prevents-injection-attacks"class="level3"><h3>JSX はインジェクション攻撃を防ぐ</h3><p>JSX にユーザの入力を埋め込むことは安全です：<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> title <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token property-access">potentiallyMaliciousInput</span><span class="token punctuation">;</span>
<span class="token comment">// This is safe:</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span></code></pre><p>デフォルトでは、React DOM は JSX に埋め込まれた値をレンダー前に<a href="https://stackoverflow.com/questions/7381974/which-characters-need-to-be-escaped-on-html">エスケープ</a>します。このため、自分のアプリケーションで明示的に書かれたものではないあらゆるコードは、注入できないことが保証されます。レンダーの前に全てが文字列に変換されます。これは <a href="https://en.wikipedia.org/wiki/Cross-site_scripting">XSS (cross-site-scripting)</a> 攻撃の防止に役立ちます。</section><section id="jsx-represents-objects"class="level3"><h3>JSX はオブジェクトの表現である</h3><p>Babel は JSX を <code>React.createElement()</code> の呼び出しへとコンパイルします。<p>以下の 2 つの例は等価です：<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token operator">&#x3C;</span>h1 className<span class="token operator">=</span><span class="token string">"greeting"</span><span class="token operator">></span>
    <span class="token maybe-class-name">Hello</span><span class="token punctuation">,</span> world<span class="token operator">!</span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span>
  <span class="token string">'h1'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">'greeting'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">'Hello, world!'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>React.createElement()</code> はバグの混入を防止するためにいくつかのチェックも行いますが、本質的には以下のようなオブジェクトを生成します：<pre class="language-js"><code class="language-js"><span class="token comment">// Note: this structure is simplified</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'h1'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">'greeting'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">'Hello, world!'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>このようなオブジェクトは "React 要素" と呼ばれます。これらは画面に表示したいものの説明書きとして考えることができます。React はこれらのオブジェクトを読み取り、DOM を構築して最新に保ちます。<p><a href="./rendering-elements.html">次の章</a>では React 要素を DOM に変換することについて見ていきましょう。<blockquote><p><strong>ヒント:</strong><p>利用したいエディタで <a href="https://babeljs.io/docs/en/next/editors">"Babel" 言語定義</a>を使用して、ES6 と JSX が適切にハイライトされるようにしておくことをお勧めします。 <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></blockquote></section></section>