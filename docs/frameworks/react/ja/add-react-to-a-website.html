<!doctypehtml><html lang="ja"><meta charset="utf-8"><title>既存のウェブサイトに React を追加する</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css"><section id="既存のウェブサイトに-react-を追加する"class="level1"><h1>既存のウェブサイトに React を追加する</h1><p>まずは必要なぶんだけ使ってみましょう。<p>React は当初から、段階的に導入することができるようにデザインされています。つまり<strong>最小限の部分で React を利用することも、あるいは大規模に React を利用することも可能です</strong>。既存のページにちょっとしたインタラクティブ性をもたせたいだけでも構いません。React コンポーネントを使えばお手の物です。<p>多くのウェブサイトはシングルページアプリケーションではありませんし、そうする必要もありません。まずは<strong>たった数行のコード</strong>から、あなたのウェブサイトに React を取り入れてみましょう。<strong>ビルドツールは必要ありません</strong>。そこから徐々に React の使用範囲を広げていくのもいいですし、あるいは少しの動的なウィジェットだけにとどめておくのもいいでしょう。<ul><li><a href="#add-react-in-one-minute">1 分で React を追加する</a><li><a href="#optional-try-react-with-jsx">オプション：React で JSX を使う</a>（バンドルツールは不要です！）</ul><section id="add-react-in-one-minute"class="level2"><h2>1分で React を導入する</h2><p>このセクションでは、既存の HTML ページに React コンポーネントを導入する方法を説明します。以下の部分では自分のウェブサイトを利用して進めてもいいですし、練習用に空の HTML ファイルを用意するのもいいでしょう。<p>複雑なツール類や事前にインストールしておかなければいけないものはありません。<strong>インターネットへの接続さえあれば、1 分間でこのセクションを終わらせることができます。</strong><p>オプション：<a href="https://gist.github.com/gaearon/6668a1f6986742109c00a581ce704605/archive/87f0b6f34238595b44308acfb86df6ea43669c08.zip">サンプルをダウンロードする (2KB ZIP 圧縮)</a><section id="step-1-add-a-dom-container-to-the-html"class="level3"><h3>ステップ 1：HTML に DOM コンテナを追加する</h3><p>まずは編集したい HTML ファイルを開きましょう。React で描画したい箇所を決めて、空の <code>&#x3C;div></code> 要素を追加しましょう。例えばこんな感じです。<pre class="language-html{3}"><code class="language-html{3}">&#x3C;!-- ... 既存の HTML ... -->

&#x3C;div id="like_button_container">&#x3C;/div>

&#x3C;!-- ... 既存の HTML ... --></code></pre><p>ここでは <code>&#x3C;div></code> 要素にユニークな <code>id</code> 属性を指定しています。こうしておけば、後から JavaScript のコードでこの <code>&#x3C;div></code> 要素を探し出し、この中に React コンポーネントを表示できます。<blockquote><p>ヒント<p>「コンテナ」としての <code>&#x3C;div></code> 要素は <code>&#x3C;body></code> タグの中であれば<strong>どこにでも</strong>置くことができます。また空の <code>&#x3C;div></code> はひとつのページにひとつだけでも、あるいは必要なだけたくさんあっても大丈夫です。<code>&#x3C;div></code> 要素は空のことが多いですが、それはたとえ <code>&#x3C;div></code> の中に他の要素があったとしても、React が結局その中身を置き換えてしまうからです。</blockquote></section><section id="step-2-add-the-script-tags"class="level3"><h3>ステップ 2：script タグを追加する</h3><p>次に、同じ HTML ファイルの <code>&#x3C;/body></code> タグの直前に、3 つの <code>&#x3C;script></code> タグを追加しましょう。<pre class="language-html{5,6,9}"><code class="language-html{5,6,9}">  &#x3C;!-- ... other HTML ... -->

  &#x3C;!-- Load React. -->
  &#x3C;!-- Note: when deploying, replace "development.js" with "production.min.js". -->
  &#x3C;script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin>&#x3C;/script>
  &#x3C;script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin>&#x3C;/script>

  &#x3C;!-- Load our React component. -->
  &#x3C;script src="like_button.js">&#x3C;/script>

&#x3C;/body></code></pre><p>最初のふたつのタグは React を読み込んでおり、最後のタグはこれから書くコンポーネントのコードを読み込んでいます。</section><section id="step-3-create-a-react-component"class="level3"><h3>ステップ 3：React コンポーネントを作成する</h3><p><code>like_button.js</code> という名前の新しいファイルを作成し、HTML ファイルのすぐ隣に置きましょう。<p><strong><a href="https://gist.github.com/gaearon/0b180827c190fe4fd98b4c7f570ea4a8/raw/b9157ce933c79a4559d2aa9ff3372668cce48de7/LikeButton.js">サンプルコード</a></strong>を開いて、自分のファイルにコピーアンドペーストしてください。<blockquote><p>ヒント<p>このコードは <code>LikeButton</code> という React コンポーネントを定義しています。まだわからなくても心配しなくて大丈夫です。こういった React の構成要素については、<a href="/tutorial/tutorial.html">チュートリアル</a> と <a href="./hello-world.html">Hello World</a> のページで後ほど見ていくことにして、まずはサンプルコードを画面に表示させてみましょう！</blockquote><p><strong><a href="https://gist.github.com/gaearon/0b180827c190fe4fd98b4c7f570ea4a8/raw/b9157ce933c79a4559d2aa9ff3372668cce48de7/LikeButton.js">サンプルコード</a></strong>の末尾に次の 3 行を追加してみましょう。<pre class="language-js{3,4,5}"><code class="language-js{3,4,5}">// ... コピーアンドペーストしたサンプルコード ...

const domContainer = document.querySelector('#like_button_container');
const root = ReactDOM.createRoot(domContainer);
root.render(e(LikeButton));</code></pre><p>この 3 行のコードは、ステップ 1 で追加した空の <code>&#x3C;div></code> 要素を見つけてきて、そこに React アプリを作成し、その中に React コンポーネントの「いいね」ボタンを表示します。</section><section id="thats-it"class="level3"><h3>これだけです！</h3><p>ステップ 4 はありません。<strong>これであなたは自分のウェブサイトにはじめての React コンポーネントを導入できました</strong>。<p>React の導入についてもっと知るには、次のセクションも見てみてください。<p><strong><a href="https://gist.github.com/gaearon/6668a1f6986742109c00a581ce704605">完成したソースコードをみる</a></strong><p><strong><a href="https://gist.github.com/gaearon/6668a1f6986742109c00a581ce704605/archive/87f0b6f34238595b44308acfb86df6ea43669c08.zip">完成したソースコードをダウンロードする (2KB ZIP 圧縮)</a></strong></section><section id="tip-reuse-a-component"class="level3"><h3>ヒント：コンポーネントを再利用する</h3><p>React コンポーネントを HTML ページの一箇所だけではなくいろいろな箇所で使いたくなることがあるかもしれません。そこで「いいね」ボタンを 3 回繰り返し表示し、さらにそこにちょっとしたデータを渡すプログラムを用意しました。<p><a href="https://gist.github.com/gaearon/faa67b76a6c47adbab04f739cba7ceda">ソースコードをみる</a><p><a href="https://gist.github.com/gaearon/faa67b76a6c47adbab04f739cba7ceda/archive/279839cb9891bd41802ebebc5365e9dec08eeb9f.zip">ソースコードをダウンロードする (2KB ZIP 圧縮)</a><blockquote><p>補足<p>このようなやり方は、主に React を利用する DOM コンテナがページ内でお互いに干渉していない場合において便利な手段です。React 単体のコードとしては、<a href="./components-and-props.html#composing-components">コンポーネントを組み合わせる</a> やり方のほうが手軽です。</blockquote></section><section id="tip-minify-javascript-for-production"class="level3"><h3>ヒント：本番環境用に JavaScript を圧縮する</h3><p>ウェブサイトを本番環境にデプロイするにあたって、圧縮していない JavaScript はページの速度を著しく落としてしまうということに配慮してください。<p>自分のスクリプトの圧縮が完了していて、デプロイ後の HTML が <code>production.min.js</code> で終わる React スクリプトを読み込んでいることが検証できていれば、<strong>あなたのウェブサイトは本番環境にリリースする準備ができています</strong>。<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span>script src<span class="token operator">=</span><span class="token string">"https://unpkg.com/react@18/umd/react.production.min.js"</span> crossorigin<span class="token operator">></span><span class="token operator">&#x3C;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&#x3C;</span>script src<span class="token operator">=</span><span class="token string">"https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"</span> crossorigin<span class="token operator">></span><span class="token operator">&#x3C;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>自分のスクリプトを圧縮することがまだできていないのであれば、<a href="https://gist.github.com/gaearon/42a2ffa41b8319948f9be4076286e1f3">例えばこんなやり方があります</a>。</section></section><section id="optional-try-react-with-jsx"class="level2"><h2>オプション：React で JSX を使う</h2><p>今までの例では、ブラウザにもともと備わっている機能のみ使ってきました。React コンポーネントを表示するために次のような JavaScript の関数を呼び出していたのはそのためです。<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> e <span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token property-access">createElement</span><span class="token punctuation">;</span>

<span class="token comment">// Display a "Like" &#x3C;button></span>
<span class="token keyword control-flow">return</span> <span class="token function">e</span><span class="token punctuation">(</span>
  <span class="token string">'button'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">liked</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">'Like'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ただし、React においては <a href="./introducing-jsx.html">JSX</a> を利用することもできます。<pre class="language-js"><code class="language-js"><span class="token comment">// Display a "Like" &#x3C;button></span>
<span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
  <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">liked</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
    <span class="token maybe-class-name">Like</span>
  <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>これらふたつのスニペットはまったく同じ内容です。<strong>JSX の使用は<a href="./react-without-jsx.html">完全にオプションです</a></strong>が、React はもちろん他のライブラリで UI を記述する際にも、JSX は多くの人に支持されています。<p><a href="https://babeljs.io/en/repl#?babili=false&#x26;browsers=&#x26;build=&#x26;builtIns=false&#x26;spec=false&#x26;loose=false&#x26;code_lz=DwIwrgLhD2B2AEcDCAbAlgYwNYF4DeAFAJTw4B88EAFmgM4B0tAphAMoQCGETBe86WJgBMAXJQBOYJvAC-RGWQBQ8FfAAyaQYuAB6cFDhkgA&#x26;debug=false&#x26;forceAllTransforms=false&#x26;shippedProposals=false&#x26;circleciRepo=&#x26;evaluate=false&#x26;fileSize=false&#x26;timeTravel=false&#x26;sourceType=module&#x26;lineWrap=true&#x26;presets=es2015%2Creact%2Cstage-2&#x26;prettier=false&#x26;targets=&#x26;version=7.15.7">このコンバータ</a>上で JSX を使って遊んでみてください。<section id="quickly-try-jsx"class="level3"><h3>JSX を手軽に試してみる</h3><p>手っ取り早く JSX を自分のプロジェクトで試してみるには、次の <code>&#x3C;script></code> タグを追加してみてください。<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/babel-standalone@6/babel.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>この状態で、任意の <code>&#x3C;script></code> タグに <code>type="text/babel"</code> 属性を持たせることで、その <code>&#x3C;script></code> タグの中では JSX が使えるようになります。<a href="https://raw.githubusercontent.com/reactjs/reactjs.org/main/static/html/single-file-example.html">サンプル用 HTML ファイル</a>をダウンロードして遊んでみてください。<p>この方法は学習やシンプルなデモの作成にはいいですが、これをそのまま使うとウェブサイトは重くなってしまい、<strong>本番環境には向きません</strong>。次のレベルに進む準備ができたら、先ほど追加した <code>&#x3C;script></code> タグと <code>type="text/babel"</code> 属性は削除してしまいましょう。そして次のセクションに進み、JSX プリプロセッサを設定して <code>&#x3C;script></code> タグを自動変換するようにしましょう。</section><section id="add-jsx-to-a-project"class="level3"><h3>JSX をプロジェクトに追加する</h3><p>JSX をプロジェクトに追加するためには、バンドルツールや開発用サーバといった複雑なツールは必要ありません。つまるところ、JSX を追加することは <strong>CSS プリプロセッサを追加することにとてもよく似ています</strong>。唯一必要となるのは、コンピューターに <a href="https://nodejs.org/">Node.js</a> がインストールされていることだけです。<p>ターミナルを開き、プロジェクトのディレクトリに移動した上で、次のふたつのコマンドを実行してください。<ol><li><strong>ステップ 1：</strong> <code>npm init -y</code> (うまくいかなければ<a href="https://gist.github.com/gaearon/246f6380610e262f8a648e3e51cad40d">こうやってみてください</a>)<li><strong>ステップ 2：</strong> <code>npm install babel-cli@6 babel-preset-react-app@3</code></ol><blockquote><p>ヒント<p>ここでは <strong>JSX プリプロセッサをインストールするためだけに npm を使っています</strong>。それ以外の用途では必要ありません。React のソースコードもアプリケーションコードも引き続き <code>&#x3C;script></code> タグの中にそのまま書くことができます。</blockquote><p>お疲れ様です！ これで<strong>本番環境用の JSX の設定</strong>をプロジェクトに追加することができました。</section><section id="run-jsx-preprocessor"class="level3"><h3>JSX プリプロセッサを実行する</h3><p><code>src</code> というディレクトリを作成したうえで、次のコマンドをターミナルから実行してみてください。<pre class="language-console"><code class="language-console">npx babel --watch src --out-dir . --presets react-app/prod</code></pre><blockquote><p>補足<p><code>npx</code> はタイプミスではありません。<a href="https://medium.com/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b">npm 5.2 以上で利用可能なパッケージ実行ツール</a>です。<p>万が一 "You have mistakenly installed the <code>babel</code> package" というエラーが表示されたのであれば、<a href="#add-jsx-to-a-project">JSX をプロジェクトに追加する</a>のステップがうまく実行できていなかったのかもしれません。今いるディレクトリと同じディレクトリで改めて実行してみてください。</blockquote><p>このコマンドは JSX を継続的に監視するため、実行が完了するのを待つ必要はありません。<p><strong><a href="https://gist.github.com/gaearon/c8e112dc74ac44aac4f673f2c39d19d1/raw/09b951c86c1bf1116af741fa4664511f2f179f0a/like_button.js">このお手本の JSX コード</a></strong>を参考に <code>src/like_button.js</code> というファイルを作成すると、先ほど起動したコマンドがブラウザでの実行に適した <code>like_button.js</code> に変換してくれます。JSX ファイルを編集したら、自動的に再変換してくれます。<p>さらにこの変換コマンドのおかげで、古いブラウザの互換性を気にすることなく、クラス構文といったモダンな JavaScript の構文を使うこともできるようになります。このツールは Babel というもので、もっと詳しく知りたければ<a href="https://babeljs.io/docs/en/babel-cli/">公式ドキュメント</a>をご覧になってみてください。<p>ビルドツールの便利さを体感して、もっとたくさんのことをツールに任せたいと思っていただけたなら、<a href="./create-a-new-react-app.html">次のセクション</a>ではさらにいくつかの人気で扱いやすいツールチェーンを紹介しています。そうでもない場合は… <code>&#x3C;script></code> タグだけでも十分な機能を果たせます！ <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section></section>