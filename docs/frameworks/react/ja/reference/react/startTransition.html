<!doctype html><html lang="ja"><meta charset="utf-8"><title>startTransition</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="starttransition"><h1 id="starttransition">startTransition</h1><intro><p><code>startTransition</code> を使うことで、UI をブロックせずに state を更新することができます。<pre class="language-js"><code class="language-js"><span class="token function">startTransition</span><span class="token punctuation">(</span>scope<span class="token punctuation">)</span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="リファレンス-reference"><h2 id="リファレンス-reference">リファレンス {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="starttransitionscope-starttransitionscope"><h3 id="starttransitionscope-starttransitionscope"><code>startTransition(scope)</code> {/<em>starttransitionscope</em>/}</h3><p><code>startTransition</code> 関数を使用すると、state の更新をトランジションとしてマークすることができます。<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> startTransition <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TabContainer</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>tab<span class="token punctuation">,</span> setTab<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'about'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">selectTab</span><span class="token punctuation">(</span><span class="token parameter">nextTab</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setTab</span><span class="token punctuation">(</span>nextTab<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p><a href="#usage">さらに例を見る</a><section class="level4"aria-labelledby="引数-parameters"><h4 id="引数-parameters">引数 {/<em>parameters</em>/}</h4><ul><li><code>scope</code>: 1 つ以上の <a href="/reference/react/useState#setstate"><code>set</code> 関数</a>を呼び出して state を更新する関数。React は引数なしで直ちに <code>scope</code> を呼び出し、<code>scope</code> 関数呼び出し中に同期的にスケジュールされたすべての state 更新をトランジションとしてマークします。このような更新は<a href="/reference/react/useTransition#marking-a-state-update-as-a-non-blocking-transition">ノンブロッキング</a>になり、<a href="/reference/react/useTransition#preventing-unwanted-loading-indicators">不要なローディングインジケータを表示しない</a>ようになります。</ul></section><section class="level4"aria-labelledby="返り値-returns"><h4 id="返り値-returns">返り値 {/<em>returns</em>/}</h4><p><code>startTransition</code> は何も返しません。</section><section class="level4"aria-labelledby="注意点-caveats"><h4 id="注意点-caveats">注意点 {/<em>caveats</em>/}</h4><ul><li><p><code>startTransition</code> は、トランジションが保留中 (pending) であるかどうかを知るための方法を提供しません。トランジションの進行中にインジケータを表示するには、代わりに <a href="/reference/react/useTransition"><code>useTransition</code></a> が必要です。<li><p>state の <code>set</code> 関数にアクセスできる場合にのみ、state 更新をトランジションにラップできます。ある props やカスタムフックの値に反応してトランジションを開始したい場合は、代わりに <a href="/reference/react/useDeferredValue"><code>useDeferredValue</code></a> を試してみてください。<li><p><code>startTransition</code> に渡す関数は同期的でなければなりません。React はこの関数を直ちに実行し、その実行中に行われるすべての state 更新をトランジションとしてマークします。後になって（例えばタイムアウト内で）さらに state 更新をしようとすると、それらはトランジションとしてマークされません。<li><p>トランジションとしてマークされた state 更新は、他の state 更新によって中断されます。例えば、トランジション内でチャートコンポーネントを更新した後、チャートの再レンダーの途中で入力フィールドに入力を始めた場合、React は入力欄の更新の処理後にチャートコンポーネントのレンダー作業を再開します。<li><p>トランジションによる更新はテキスト入力欄の制御には使用できません。<li><p>進行中のトランジションが複数ある場合、React は現在それらをひとつに束ねる処理を行います。この制限は将来のリリースではおそらく削除されます。</ul></section></section></section><section class="level2"aria-labelledby="使用法-usage"><h2 id="使用法-usage">使用法 {/<em>usage</em>/}</h2><section class="level3"aria-labelledby="state-更新をノンブロッキングのトランジションとしてマークする-marking-a-state-update-as-a-non-blocking-transition"><h3 id="state-更新をノンブロッキングのトランジションとしてマークする-marking-a-state-update-as-a-non-blocking-transition">state 更新をノンブロッキングのトランジションとしてマークする {/<em>marking-a-state-update-as-a-non-blocking-transition</em>/}</h3><p>state 更新を<em>トランジション</em>としてマークするには、それを <code>startTransition</code> の呼び出しでラップします。<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> startTransition <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TabContainer</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>tab<span class="token punctuation">,</span> setTab<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'about'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">selectTab</span><span class="token punctuation">(</span><span class="token parameter">nextTab</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setTab</span><span class="token punctuation">(</span>nextTab<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>トランジションを使用することで、遅いデバイスでもユーザインターフェースの更新をレスポンシブに保つことができます。<p>トランジションを使用すると、再レンダーの途中でも UI がレスポンシブに保たれます。例えば、ユーザがタブをクリックしたが、その後気が変わって別のタブをクリックする場合、最初の再レンダーが終了するのを待つことなくそれを行うことができます。</p><note><p><code>startTransition</code> は <a href="/reference/react/useTransition"><code>useTransition</code></a> と非常に似ていますが、トランジションが進行中かどうかを追跡する <code>isPending</code> フラグを提供しない点が異なります。<code>useTransition</code> が利用できない場合でも <code>startTransition</code> を呼び出すことができます。例えば、<code>startTransition</code> はコンポーネントの外部、たとえばデータライブラリ内でも動作します。<p><a href="/reference/react/useTransition"><code>useTransition</code> ページでトランジションについて学び、例を見ることができます</a>。</p></note><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>