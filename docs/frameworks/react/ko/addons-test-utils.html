<!doctypehtml><html lang="ko"><meta charset="utf-8"><title>테스팅 도구</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css"><section id="테스팅-도구"class="level1"><h1>테스팅 도구</h1><p><strong>Importing</strong><pre class="language-javascript"><code class="language-javascript"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ReactTestUtils</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/test-utils'</span><span class="token punctuation">;</span> <span class="token comment">// ES6</span>
<span class="token keyword">var</span> <span class="token maybe-class-name">ReactTestUtils</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react-dom/test-utils'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// npm과 ES5</span></code></pre><section id="overview"class="level2"><h2>개요</h2><p><code>ReactTestUtils</code>는 여러분이 선택한 테스팅 프레임워크에서 테스트를 쉽게 진행할 수 있도록 해 줍니다. Facebook에서는 <a href="https://facebook.github.io/jest/">Jest</a>를 이용해 더욱 쉽게 JavaScript 테스트를 하고 있습니다. Jest 웹사이트의 <a href="https://jestjs.io/docs/tutorial-react">React 자습서</a> 문서를 통해 Jest를 시작하는 방법에 대해서 알아보세요.<blockquote><p>주의<p>Facebook에서는 <a href="https://testing-library.com/react">React Testing Library</a> 사용을 권장합니다. 이 라이브러리는 사용자가 컴포넌트를 사용하는 것처럼 테스트를 작성할 수 있도록 설계되었습니다.<p>React v16 이하에서는 <a href="https://airbnb.io/enzyme/">Enzyme</a>을 통해 React 컴포넌트의 출력을 쉽게 검증하고 조작하고 탐색할 수 있습니다.</blockquote><ul><li><a href="#act"><code>act()</code></a><li><a href="#mockcomponent"><code>mockComponent()</code></a><li><a href="#iselement"><code>isElement()</code></a><li><a href="#iselementoftype"><code>isElementOfType()</code></a><li><a href="#isdomcomponent"><code>isDOMComponent()</code></a><li><a href="#iscompositecomponent"><code>isCompositeComponent()</code></a><li><a href="#iscompositecomponentwithtype"><code>isCompositeComponentWithType()</code></a><li><a href="#findallinrenderedtree"><code>findAllInRenderedTree()</code></a><li><a href="#scryrendereddomcomponentswithclass"><code>scryRenderedDOMComponentsWithClass()</code></a><li><a href="#findrendereddomcomponentwithclass"><code>findRenderedDOMComponentWithClass()</code></a><li><a href="#scryrendereddomcomponentswithtag"><code>scryRenderedDOMComponentsWithTag()</code></a><li><a href="#findrendereddomcomponentwithtag"><code>findRenderedDOMComponentWithTag()</code></a><li><a href="#scryrenderedcomponentswithtype"><code>scryRenderedComponentsWithType()</code></a><li><a href="#findrenderedcomponentwithtype"><code>findRenderedComponentWithType()</code></a><li><a href="#renderintodocument"><code>renderIntoDocument()</code></a><li><a href="#simulate"><code>Simulate</code></a></ul></section><section id="reference"class="level2"><h2>참조사항</h2><section id="act-act"class="level3"><h3><code>act()</code> {#act}</h3><p>컴포넌트의 진단을 준비하기 위해서는 컴포넌트를 렌더링하고 갱신해주는 코드를 <code>act()</code>를 호출한 것의 안에 넣어줘야 합니다. 이를 통해 React를 브라우저 내에서 동작하는 것과 비슷한 환경에서 테스트할 수 있습니다.<blockquote><p>주의<p><code>react-test-renderer</code>를 사용한다면, 똑같이 작동하는 <code>act</code> export가 제공됩니다.</blockquote><p>예를 들어, 다음과 같은 <code>Counter</code> 컴포넌트가 있다고 해봅시다.<pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">handleClick</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">handleClick</span><span class="token punctuation">.</span><span class="token method function property-access">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You clicked </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">count</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> times</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You clicked </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">count</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> times</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">count</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&#x3C;</span>div<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">You</span> clicked <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">count</span><span class="token punctuation">}</span> times<span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">handleClick</span><span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token maybe-class-name">Click</span> me
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>이런 방식으로 테스트 할 수 있습니다.<pre class="language-js{3,20-22,29-31}"><code class="language-js{3,20-22,29-31}">import React from 'react';
import ReactDOM from 'react-dom/client';
import { act } from 'react-dom/test-utils';
import Counter from './Counter';

let container;

beforeEach(() => {
  container = document.createElement('div');
  document.body.appendChild(container);
});

afterEach(() => {
  document.body.removeChild(container);
  container = null;
});

it('can render and update a counter', () => {
  // 첫 render와 componentDidMount를 테스트
  act(() => {
    ReactDOM.createRoot(container).render(&#x3C;Counter />);
  });
  const button = container.querySelector('button');
  const label = container.querySelector('p');
  expect(label.textContent).toBe('You clicked 0 times');
  expect(document.title).toBe('You clicked 0 times');

  // 두 번째 render와 componentDidUpdate를 테스트
  act(() => {
    button.dispatchEvent(new MouseEvent('click', {bubbles: true}));
  });
  expect(label.textContent).toBe('You clicked 1 times');
  expect(document.title).toBe('You clicked 1 times');
});</code></pre><ul><li><p>DOM 이벤트 발행은 DOM 컨테이너가 <code>document</code> 객체에 추가되었을 때만 작동한다는 점을 잊지마세요. 불필요하게 반복 되는 코드를 줄이기 위해서 <a href="https://testing-library.com/react"><code>react-testing-library</code></a>와 같은 라이브러리를 사용할 수 있습니다.<li><p><a href="./testing-recipes.html">테스트 방법</a> 문서에 <code>act()</code>의 동작 방식에 대한 자세한 내용이 예시와 사용법과 함께 포함되어 있습니다.</ul><hr></section><section id="mockcomponent-mockcomponent"class="level3"><h3><code>mockComponent()</code> {#mockcomponent}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">mockComponent</span><span class="token punctuation">(</span>
  componentClass<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>mockTagName<span class="token punctuation">]</span>
<span class="token punctuation">)</span></code></pre><p>모의 컴포넌트 모듈을 이 메서드에 넘겨 유용한 메서드들을 붙여 증강해 더미 React 컴포넌트로 사용할 수 있습니다. 보통의 경우처럼 렌더링 하지 않고 그 대신 컴포넌트는 간단하게 <code>&#x3C;div></code> 태그가 됩니다. <code>mockTagName</code>값을 넘겨준다면 <code>&#x3C;div></code>대신 다른 태그로 만들어 줄 수 있습니다.<blockquote><p>주의<p><code>mockComponent()</code>는 더 이상 쓰이지 않는 API입니다. <a href="https://jestjs.io/docs/tutorial-react-native#mock-native-modules-using-jestmock"><code>jest.mock()</code></a> 사용을 추천합니다.</blockquote><hr></section><section id="iselement-iselement"class="level3"><h3><code>isElement()</code> {#iselement}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">isElement</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span></code></pre><p><code>element</code>가 React의 element라면 <code>true</code>를 반환합니다.<hr></section><section id="iselementoftype-iselementoftype"class="level3"><h3><code>isElementOfType()</code> {#iselementoftype}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">isElementOfType</span><span class="token punctuation">(</span>
  element<span class="token punctuation">,</span>
  componentClass
<span class="token punctuation">)</span></code></pre><p><code>element</code>가 <code>componentClass</code> 타입의 React element라면 <code>true</code>를 반환합니다.<hr></section><section id="isdomcomponent-isdomcomponent"class="level3"><h3><code>isDOMComponent()</code> {#isdomcomponent}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">isDOMComponent</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span></code></pre><p><code>instance</code>가 <code>&#x3C;div></code>나 <code>&#x3C;span></code>같은 DOM 컴포넌트라면 <code>true</code>를 반환합니다.<hr></section><section id="iscompositecomponent-iscompositecomponent"class="level3"><h3><code>isCompositeComponent()</code> {#iscompositecomponent}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">isCompositeComponent</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span></code></pre><p><code>instance</code>가 클래스나 함수 같이 사용자가 정의한 컴포넌트라면 <code>true</code>를 반환합니다.<hr></section><section id="iscompositecomponentwithtype-iscompositecomponentwithtype"class="level3"><h3><code>isCompositeComponentWithType()</code> {#iscompositecomponentwithtype}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">isCompositeComponentWithType</span><span class="token punctuation">(</span>
  instance<span class="token punctuation">,</span>
  componentClass
<span class="token punctuation">)</span></code></pre><p><code>instance</code>가 <code>componentClass</code> 타입을 가진 컴포넌트라면 <code>true</code>를 반환합니다.<hr></section><section id="findallinrenderedtree-findallinrenderedtree"class="level3"><h3><code>findAllInRenderedTree()</code> {#findallinrenderedtree}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">findAllInRenderedTree</span><span class="token punctuation">(</span>
  tree<span class="token punctuation">,</span>
  test
<span class="token punctuation">)</span></code></pre><p><code>tree</code>의 모든 컴포넌트를 탐색하여 <code>test(component)</code>가 <code>true</code>일 때 모든 컴포넌트를 축적합니다. 이 함수는 그 자체만으로는 유용하지 않지만, 다른 테스트 도구의 기반이 됩니다.<hr></section><section id="scryrendereddomcomponentswithclass-scryrendereddomcomponentswithclass"class="level3"><h3><code>scryRenderedDOMComponentsWithClass()</code> {#scryrendereddomcomponentswithclass}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">scryRenderedDOMComponentsWithClass</span><span class="token punctuation">(</span>
  tree<span class="token punctuation">,</span>
  className
<span class="token punctuation">)</span></code></pre><p>렌더링 된 트리에서 조건 <code>className</code>에 만족하는 class명을 가지고 있는 DOM 컴포넌트의 DOM 엘리먼트를 모두 검색합니다.<hr></section><section id="findrendereddomcomponentwithclass-findrendereddomcomponentwithclass"class="level3"><h3><code>findRenderedDOMComponentWithClass()</code> {#findrendereddomcomponentwithclass}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">findRenderedDOMComponentWithClass</span><span class="token punctuation">(</span>
  tree<span class="token punctuation">,</span>
  className
<span class="token punctuation">)</span></code></pre><p><a href="#scryrendereddomcomponentswithclass"><code>scryRenderedDOMComponentsWithClass()</code></a>와 기능이 유사하나 결과값이 하나라고 가정하고 그 결과값만을 반환합니다. 두 개 이상의 결과값이 있다면 예외를 반환합니다.<hr></section><section id="scryrendereddomcomponentswithtag-scryrendereddomcomponentswithtag"class="level3"><h3><code>scryRenderedDOMComponentsWithTag()</code> {#scryrendereddomcomponentswithtag}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">scryRenderedDOMComponentsWithTag</span><span class="token punctuation">(</span>
  tree<span class="token punctuation">,</span>
  tagName
<span class="token punctuation">)</span></code></pre><p>렌더링 된 트리 내에서 조건 <code>tagName</code>에 만족하는 tag명을 가진 DOM 컴포넌트의 DOM 엘리먼트를 모두 검색합니다.<hr></section><section id="findrendereddomcomponentwithtag-findrendereddomcomponentwithtag"class="level3"><h3><code>findRenderedDOMComponentWithTag()</code> {#findrendereddomcomponentwithtag}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">findRenderedDOMComponentWithTag</span><span class="token punctuation">(</span>
  tree<span class="token punctuation">,</span>
  tagName
<span class="token punctuation">)</span></code></pre><p><a href="#scryrendereddomcomponentswithtag"><code>scryRenderedDOMComponentsWithTag()</code></a>와 기능이 유사하나 결과값이 하나라고 가정하고 그 결과값만을 반환합니다. 두 개 이상의 결과값이 있다면 예외를 뱉습니다.<hr></section><section id="scryrenderedcomponentswithtype-scryrenderedcomponentswithtype"class="level3"><h3><code>scryRenderedComponentsWithType()</code> {#scryrenderedcomponentswithtype}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">scryRenderedComponentsWithType</span><span class="token punctuation">(</span>
  tree<span class="token punctuation">,</span>
  componentClass
<span class="token punctuation">)</span></code></pre><p><code>componentClass</code> 타입을 가진 모든 인스턴스를 검색합니다.<hr></section><section id="findrenderedcomponentwithtype-findrenderedcomponentwithtype"class="level3"><h3><code>findRenderedComponentWithType()</code> {#findrenderedcomponentwithtype}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">findRenderedComponentWithType</span><span class="token punctuation">(</span>
  tree<span class="token punctuation">,</span>
  componentClass
<span class="token punctuation">)</span></code></pre><p><a href="#scryrenderedcomponentswithtype"><code>scryRenderedComponentsWithType()</code></a>와 기능이 유사하나 결과값이 하나라고 가정하고 그 결과값만을 반환합니다. 두 개 이상의 결과값이 있다면 예외를 뱉습니다.<hr></section><section id="renderintodocument-renderintodocument"class="level3"><h3><code>renderIntoDocument()</code> {#renderintodocument}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token function">renderIntoDocument</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span></code></pre><p>React 엘리먼트를 document내의 떨어져 있는 DOM 노드에 렌더링합니다. <strong>이 함수를 쓰려면 DOM이 필요합니다.</strong> 이 함수는 다음 코드와 같은 기능을 합니다.<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> domContainer <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token method function property-access">createRoot</span><span class="token punctuation">(</span>domContainer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><blockquote><p>주의<p><code>window</code>, <code>window.document</code>와 <code>window.document.createElement</code>는 <code>React</code>를 <strong>가져와서 사용하기 전에도</strong> 전역적으로 사용할 수 있습니다. 그렇지 않다면 React는 DOM에 접근할 수 없다고 간주할 것이며 <code>setState</code>와 같은 메서드들이 작동하지 않을 것 입니다.</blockquote><hr></section></section><section id="other-utilities"class="level2"><h2>다른 테스팅 도구들</h2><section id="simulate-simulate"class="level3"><h3><code>Simulate</code> {#simulate}</h3><pre class="language-javascript"><code class="language-javascript"><span class="token maybe-class-name">Simulate</span><span class="token punctuation">.</span><span class="token punctuation">{</span>eventName<span class="token punctuation">}</span><span class="token punctuation">(</span>
  element<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>eventData<span class="token punctuation">]</span>
<span class="token punctuation">)</span></code></pre><p>이벤트 데이터인 <code>eventData</code>를 옵션으로 준 DOM 노드에 붙이는 이벤트를 시뮬레이팅합니다.<p><code>Simulate</code>는 <a href="./events.html#supported-events">React가 이해하는 모든 이벤트</a>를 위한 메서드를 가집니다.<p><strong>엘리먼트 클릭</strong><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// &#x3C;button ref={(node) => this.button = node}>...&#x3C;/button></span>
<span class="token keyword">const</span> node <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">button</span><span class="token punctuation">;</span>
<span class="token maybe-class-name">ReactTestUtils</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Simulate</span></span><span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>입력 필드의 값을 바꾼 뒤 ENTER키 누르기</strong><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// &#x3C;input ref={(node) => this.textInput = node} /></span>
<span class="token keyword">const</span> node <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">textInput</span><span class="token punctuation">;</span>
node<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">=</span> <span class="token string">'giraffe'</span><span class="token punctuation">;</span>
<span class="token maybe-class-name">ReactTestUtils</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Simulate</span></span><span class="token punctuation">.</span><span class="token method function property-access">change</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token maybe-class-name">ReactTestUtils</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Simulate</span></span><span class="token punctuation">.</span><span class="token method function property-access">keyDown</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"Enter"</span><span class="token punctuation">,</span> <span class="token literal-property property">keyCode</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token literal-property property">which</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><blockquote><p>주의<p>컴포넌트 내에서 사용하고 있는 keyCode, which와 같은 이벤트 프로퍼티는 별도로 제공해주어야 합니다. React에서는 이러한 이벤트 프로퍼티를 자동으로 만들어 주지 않습니다.</blockquote><hr><p><span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section></section>