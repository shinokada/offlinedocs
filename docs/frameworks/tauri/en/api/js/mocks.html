<!doctypehtml><html lang="en"><meta charset="utf-8"><title>mocks</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="mocks"class="level1"><h1>mocks</h1><section id="functions"class="level2"><h2>Functions</h2><section id="clearmocks"class="level3"><h3><code>clearMocks</code></h3><blockquote><p><strong>clearMocks</strong>(): <code>void</code></blockquote><p>Clears mocked functions/data injected by the other functions in this module. When using a test runner that doesn't provide a fresh window object for each test, calling this function will reset tauri specific properties.</section></section></section><section id="example"class="level1"><h1>Example</h1><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> mockWindows<span class="token punctuation">,</span> clearMocks <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> @tauri<span class="token operator">-</span>apps<span class="token operator">/</span>api<span class="token operator">/</span>mocks

<span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
   <span class="token function">clearMocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">test</span><span class="token punctuation">(</span>mocked windows<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
   <span class="token function">mockWindows</span><span class="token punctuation">(</span>main<span class="token punctuation">,</span> second<span class="token punctuation">,</span> third<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token dom variable">window</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveProperty</span><span class="token punctuation">(</span>__TAURI_METADATA__<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">test</span><span class="token punctuation">(</span>no mocked windows<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
   <span class="token function">expect</span><span class="token punctuation">(</span><span class="token dom variable">window</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveProperty</span><span class="token punctuation">(</span>__TAURI_METADATA__<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p><strong>Since</strong>: 1.0.0<p><strong>Returns: </strong><code>void</code><section id="mockipc"class="level3"><h3><code>mockIPC</code></h3><blockquote><p><strong>mockIPC</strong>(<code>cb</code>: <code>fn</code>): <code>void</code></blockquote><p>Intercepts all IPC requests with the given mock handler.<p>This function can be used when testing tauri frontend applications or when running the frontend in a Node.js context during static site generation.</section></section><section id="examples"class="level1"><h1>Examples</h1><p>Testing setup using vitest:<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> mockIPC<span class="token punctuation">,</span> clearMocks <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> @tauri<span class="token operator">-</span>apps<span class="token operator">/</span>api<span class="token operator">/</span>mocks
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> invoke <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> @tauri<span class="token operator">-</span>apps<span class="token operator">/</span>api<span class="token operator">/</span>tauri

<span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
   <span class="token function">clearMocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">test</span><span class="token punctuation">(</span>mocked command<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
 <span class="token function">mockIPC</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cmd<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">switch</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token property-access">html</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token literal-property property">add</span><span class="token operator">:</span>
      <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token property-access">a</span> <span class="token keyword module">as</span> number<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token property-access">b</span> <span class="token keyword module">as</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword module">default</span><span class="token operator">:</span>
      <span class="token keyword control-flow">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">resolves</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>The callback function can also return a Promise:<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> mockIPC<span class="token punctuation">,</span> clearMocks <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> @tauri<span class="token operator">-</span>apps<span class="token operator">/</span>api<span class="token operator">/</span>mocks
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> invoke <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> @tauri<span class="token operator">-</span>apps<span class="token operator">/</span>api<span class="token operator">/</span>tauri

<span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
   <span class="token function">clearMocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">test</span><span class="token punctuation">(</span>mocked command<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
 <span class="token function">mockIPC</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cmd<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>cmd <span class="token operator">===</span> get_data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword control-flow">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>example<span class="token punctuation">.</span><span class="token property-access">com</span><span class="token operator">/</span>data<span class="token punctuation">.</span><span class="token property-access">json</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> response<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'get_data'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">resolves</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p><strong>Since</strong>: 1.0.0<p><strong>Parameters</strong><table><thead><tr><th align="left">Name<th align="left">Type<tbody><tr><td align="left"><code>cb</code><td align="left">(<code>cmd</code>: <code>string</code>, <code>args</code>: <code>Record</code>&#x3C;<code>string</code>, <code>unknown</code>>) => <code>any</code></table><p><strong>Returns: </strong><code>void</code><section id="mockwindows"class="level3"><h3><code>mockWindows</code></h3><blockquote><p><strong>mockWindows</strong>(<code>current</code>: <code>string</code>, ...<code>additionalWindows</code>: <code>string</code>[]): <code>void</code></blockquote><p>Mocks one or many window labels. In non-tauri context it is required to call this function <em>before</em> using the <code>@tauri-apps/api/window</code> module.<p>This function only mocks the <em>presence</em> of windows, window properties (e.g. width and height) can be mocked like regular IPC calls using the <code>mockIPC</code> function.</section></section><section id="examples-1"class="level1"><h1>Examples</h1><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> mockWindows <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> @tauri<span class="token operator">-</span>apps<span class="token operator">/</span>api<span class="token operator">/</span>mocks<span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> getCurrent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> @tauri<span class="token operator">-</span>apps<span class="token operator">/</span>api<span class="token operator">/</span><span class="token dom variable">window</span><span class="token punctuation">;</span>

<span class="token function">mockWindows</span><span class="token punctuation">(</span>main<span class="token punctuation">,</span> second<span class="token punctuation">,</span> third<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> win <span class="token operator">=</span> <span class="token function">getCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

win<span class="token punctuation">.</span><span class="token property-access">label</span> <span class="token comment">// main</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> mockWindows <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> @tauri<span class="token operator">-</span>apps<span class="token operator">/</span>api<span class="token operator">/</span>mocks<span class="token punctuation">;</span>

<span class="token function">mockWindows</span><span class="token punctuation">(</span>main<span class="token punctuation">,</span> second<span class="token punctuation">,</span> third<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">mockIPC</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cmd<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
 <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>cmd <span class="token operator">===</span> tauri<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>
     args<span class="token operator">?.</span>__tauriModule <span class="token operator">===</span> <span class="token maybe-class-name">Window</span> <span class="token operator">&#x26;&#x26;</span>
     args<span class="token operator">?.</span>message<span class="token operator">?.</span>cmd <span class="token operator">===</span> manage <span class="token operator">&#x26;&#x26;</span>
     args<span class="token operator">?.</span>message<span class="token operator">?.</span>data<span class="token operator">?.</span>cmd<span class="token operator">?.</span>type <span class="token operator">===</span> close
   <span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'closing window!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> getCurrent <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token keyword module">import</span><span class="token punctuation">(</span>@tauri<span class="token operator">-</span>apps<span class="token operator">/</span>api<span class="token operator">/</span><span class="token dom variable">window</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> win <span class="token operator">=</span> <span class="token function">getCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword control-flow">await</span> win<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// this will cause the mocked IPC handler to log to the console.</span></code></pre><p><strong>Since</strong>: 1.0.0<p><strong>Parameters</strong><table><thead><tr><th align="left">Name<th align="left">Type<th align="left">Description<tbody><tr><td align="left"><code>current</code><td align="left"><code>string</code><td align="left">Label of window this JavaScript context is running in.<tr><td align="left"><code>...additionalWindows</code><td align="left"><code>string</code>[]<td align="left">Label of additional windows the app has.</table><p><strong>Returns: </strong><code>void</code> <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section>