<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cross-Platform Compilation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="sidebar_position" content="5">
    <link rel="stylesheet" href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css">
  </head>
  <body>
    <section id="cross-platform-compilation" class="level1">
      <h1>Cross-Platform Compilation</h1>
      <p>Tauri relies heavily on native libraries and toolchains, so meaningful cross-compilation is <strong>not possible</strong> at the current moment. The next best option is to compile utilizing a CI/CD pipeline hosted on something like <a href="https://docs.github.com/en/actions">GitHub Actions</a>, Azure Pipelines, GitLab, or other options. The pipeline can run the compilation for each platform simultaneously making the compilation and release process much easier.</p>
      <p>For an easy setup, we currently provide <a href="https://github.com/tauri-apps/tauri-action">Tauri Action</a>, a GitHub Action that runs on all the supported platforms, compiles your software, generates the necessary artifacts, and uploads them to a new GitHub release.</p>
      <section id="tauri-github-action" class="level2">
        <h2>Tauri GitHub Action</h2>
        <p>Tauri Action leverages GitHub Actions to simultaneously build your application as a Tauri native binary for macOS, Linux, and Windows, and automates creating a GitHub release.</p>
        <p>This GitHub Action may also be used as a testing pipeline for your Tauri app, guaranteeing compilation runs fine on all platforms for each pull request sent, even if you don't wish to create a new release.</p>info Code Signing
        <p>To setup code signing for both Windows and macOS on your workflow, follow the specific guide for each platform:</p>
        <ul>
          <li><a href="../distribution/sign-windows.md#bonus-sign-your-application-with-github-actions">Windows Code Signing with GitHub Actions</a></li>
          <li><a href="../distribution/sign-macos.md#example">macOS Code Signing with GitHub Actions</a></li>
        </ul>
        <section id="getting-started" class="level3">
          <h3>Getting Started</h3>
          <p>To set up Tauri Action you must first set up a GitHub repository. You can use this action on a repo that doesn't have Tauri configured since it automatically initializes Tauri before building and configuring it to use your artifacts.</p>
          <p>Go to the Actions tab on your GitHub project and choose New workflow, then choose Set up a workflow yourself. Replace the file with the <a href="https://github.com/tauri-apps/tauri-action#creating-a-release-and-uploading-the-tauri-bundles">Tauri Action production build workflow example</a>. Alternatively, you may set up the workflow based on the <a href="#example-workflow">example lower on this page</a></p>
        </section>
        <section id="configuration" class="level3">
          <h3>Configuration</h3>
          <p>You can configure Tauri with the <code>configPath</code>, <code>distPath</code> and <code>iconPath</code> options. See the actions Readme for details.</p>
          <p>Custom Tauri CLI scripts can be run with the <code>tauriScript</code> option. So instead of running <code>yarn tauri build</code> or <code>npx tauri build</code>, <code>${tauriScript}</code> will be executed. This can be useful when you need custom build functionality such as when creating Tauri apps e.g. a <code>desktop:build</code> script.</p>
          <p>
            When your app isn't on the root of the repo, use the <code>projectPath</code> input.
            You may modify the workflow name, change the triggers, and add more steps such as <code>npm run lint</code> or <code>npm run test</code>. The important part is that you keep the below line at the end of the workflow, since this runs the build script and releases the artifacts:
          </p>
          <pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> tauri<span class="token punctuation">-</span>apps/tauri<span class="token punctuation">-</span>action@v0</code></pre>
        </section>
        <section id="how-to-trigger" class="level3">
          <h3>How to Trigger</h3>
          <p>The release workflow by default is triggered by pushes on the release branch. The action automatically creates a tag and title for the GitHub release using the application version specified in <code>tauri.config.json</code>.</p>
          <p>You can also trigger the workflow on the push of a version tag such as app-v0.7.0. For this you can change the start of the release workflow:</p>
          <pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> publish
<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">tags</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'app-v*'</span>
  workflow_dispatch<span class="token punctuation">:</span></code></pre>
        </section>
        <section id="example-workflow" class="level3">
          <h3>Example Workflow</h3>
          <p>Below is an example workflow that has been setup to run every time a new version is created on git.</p>
          <p>This workflow sets up the environment on Windows, Ubuntu, and macOS latest versions. Note under <code>jobs.release.strategy.matrix</code> the platform array which contains <code>macos-latest</code>, <code>ubuntu-latest</code>, and <code>windows-latest</code>.</p>
          <p>The steps this workflow takes are:</p>
          <ol>
            <li>Checkout the repository using <code>actions/checkout@v2</code></li>
            <li>Set up Node 16 using <code>actions/setup-node@v1</code></li>
            <li>Set up Rust using <code>actions-rs/toolchain@v1</code></li>
            <li>Installs all the dependencies and run the build script (for the web app)</li>
            <li>Finally, it uses <code>tauri-apps/tauri-action@v0</code> to run <code>tauri build</code>, generate the artifacts, and create the GitHub release</li>
          </ol>
          <pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Release
<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">tags</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'v*'</span>
  <span class="token key atrule">workflow_dispatch</span><span class="token punctuation">:</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">release</span><span class="token punctuation">:</span>
    <span class="token key atrule">strategy</span><span class="token punctuation">:</span>
      <span class="token key atrule">fail-fast</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">matrix</span><span class="token punctuation">:</span>
        <span class="token key atrule">platform</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>macos<span class="token punctuation">-</span>latest<span class="token punctuation">,</span> ubuntu<span class="token punctuation">-</span>latest<span class="token punctuation">,</span> windows<span class="token punctuation">-</span>latest<span class="token punctuation">]</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.platform <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout repository
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Node.js setup
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">node-version</span><span class="token punctuation">:</span> <span class="token number">16</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Rust setup
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions<span class="token punctuation">-</span>rs/toolchain@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">toolchain</span><span class="token punctuation">:</span> stable

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install dependencies (ubuntu only)
        <span class="token key atrule">if</span><span class="token punctuation">:</span> matrix.platform == 'ubuntu<span class="token punctuation">-</span>latest'
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          sudo apt-get update
          sudo apt-get install -y libgtk-3-dev webkit2gtk-4.0 libappindicator3-dev librsvg2-dev patchelf</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install app dependencies and build web
        <span class="token key atrule">run</span><span class="token punctuation">:</span> yarn <span class="token important">&#x26;&#x26;</span> yarn build

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build the app
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> tauri<span class="token punctuation">-</span>apps/tauri<span class="token punctuation">-</span>action@v0

        <span class="token key atrule">env</span><span class="token punctuation">:</span>
          <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">tagName</span><span class="token punctuation">:</span> v__VERSION__ <span class="token comment"># tauri-action replaces \_\_VERSION\_\_ with the app version</span>
          <span class="token key atrule">releaseName</span><span class="token punctuation">:</span> <span class="token string">'v__VERSION__'</span>
          <span class="token key atrule">releaseBody</span><span class="token punctuation">:</span> <span class="token string">'See the assets to download this version and install.'</span>
          <span class="token key atrule">releaseDraft</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token key atrule">prerelease</span><span class="token punctuation">:</span> <span class="token boolean important">false</span></code></pre>
        </section>
        <section id="github-environment-token" class="level3">
          <h3>GitHub Environment Token</h3>
          <p>The GitHub Token is automatically issued by GitHub for each workflow run without further configuration, which means there is no risk of secret leakage. This token however only has read permissions by default and you may get a Resource not accessible by integration error when running the workflow. If this happens, you may need to add write permissions to this token. To do this go to your GitHub Project Settings, and then select Actions, scroll down to Workflow permissions and check Read and write permissions.</p>
          <p>You can see the GitHub Token being passed to the workflow below:</p>
          <pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">env</span><span class="token punctuation">:</span>
  <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>
        </section>
        <section id="usage-notes" class="level3">
          <h3>Usage Notes</h3>
          <p>Make sure to check the <a href="https://docs.github.com/en/actions">documentation for GitHub Actions</a> to understand better how this workflow works. Take care to read the <a href="https://docs.github.com/en/actions/learn-github-actions/usage-limits-billing-and-administration">Usage limits, billing, and administration</a> documentation for GitHub Actions. Some project templates may already implement this GitHub action workflow, such as <a href="https://github.com/probablykasper/tauri-svelte-template">tauri-svelte-template</a>. You can use this action on a repo that doesn't have Tauri configured. Tauri automatically initializes before building and configuring it to use your web artifacts.</p>
          <p><span style="float: footnote;"><a href="../../index.html#toc">Go to TOC</a></span></p>
        </section>
      </section>
    </section>
  </body>
</html>
