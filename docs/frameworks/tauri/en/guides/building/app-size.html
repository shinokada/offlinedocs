<!doctypehtml><html lang="en"><meta charset="utf-8"><title>Reducing App Size</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="sidebar_position"content="6"><link rel="stylesheet"href="https://raw.githubusercontent.com/shinokada/prism-coy-theme/main/theme_common.css"><section id="reducing-app-size"class="level1"><h1>Reducing App Size</h1><p>With Tauri, we are working to reduce the environmental footprint of applications by using fewer system resources where available, providing compiled systems that don't need runtime evaluation, and offering guides so that engineers can go even smaller without sacrificing performance or security. By saving resources we are doing our part to help you help us save the planet -- which is the only bottom line that companies in the 21st Century should care about.<p>So if you are interested in learning how to improve your app size and performance, read on!<section id="you-cant-improve-what-you-cant-measure"class="level3"><h3>You can't improve what you can't measure</h3><p>Before you can optimize your app, you need to figure out what takes up space in your app! Here are a couple of tools that can assist you with that:<ul><li><p><strong><code>cargo-bloat</code></strong> - A Rust utility to determine what takes the most space in your app. It gives you an excellent, sorted overview of the most significant Rust functions.<li><p><strong><code>cargo-expand</code></strong> - <a href="https://doc.rust-lang.org/book/ch19-06-macros.html">Macros</a> make your rust code more concise and easier to read, but they are also hidden size traps! Use <a href="https://github.com/dtolnay/cargo-expand"><code>cargo-expand</code></a> to see what those macros generate under the hood.<li><p><strong><code>rollup-plugin-visualizer</code></strong> - A tool that generates beautiful (and insightful) graphs from your rollup bundle. Very convenient for figuring out what JavaScript dependencies contribute to your final bundle size the most.<li><p><strong><code>rollup-plugin-graph</code></strong> - You noticed a dependency included in your final frontend bundle, but you are unsure why? <a href="https://github.com/ondras/rollup-plugin-graph"><code>rollup-plugin-graph</code></a> generates Graphviz-compatible visualizations of your entire dependency graph.</ul><p>These are just a couple of tools that you might use. Make sure to check your frontend bundlers plugin list for more!</section><section id="checklist"class="level2"><h2>Checklist</h2><ol><li><a href="#minify-javascript">Minify Javascript</a><li><a href="#optimize-dependencies">Optimize Dependencies</a><li><a href="#optimize-images">Optimize Images</a><li><a href="#remove-unnecessary-custom-fonts">Remove Unnecessary Custom Fonts</a><li><a href="#allowlist-config">Allowlist Config</a><li><a href="#rust-build-time-optimizations">Rust Build-time Optimizations</a><li><a href="#stripping">Stripping</a><li><a href="#upx">UPX</a></ol><section id="minify-javascript"class="level3"><h3>Minify JavaScript</h3><p>JavaScript makes up a large portion of a typical Tauri app, so it's important to make the JavaScript as lightweight as possible.<p>You can choose from a plethora of JavaScript bundlers; popular choices are <a href="https://vitejs.dev">Vite</a>, <a href="https://webpack.js.org">webpack</a>, and <a href="https://rollupjs.org/guide/en/">rollup</a>. All of them can produce minified JavaScript if configured correctly, so consult your bundler documentation for specific options. Generally speaking, you should make sure to:<section id="enable-tree-shaking"class="level4"><h4>Enable tree shaking</h4><p>This option removes unused JavaScript from your bundle. All popular bundlers enable this by default.</section><section id="enable-minification"class="level4"><h4>Enable minification</h4><p>Minification removes unnecessary whitespace, shortens variable names, and applies other optimizations. Most bundlers enable this by default; a notable exception is <a href="https://rollupjs.org/guide/en/">rollup</a>, where you need plugins like <a href="https://github.com/TrySound/rollup-plugin-terser">rollup-plugin-terser</a> or <a href="https://github.com/TrySound/rollup-plugin-uglify">rollup-plugin-uglify</a>.<p>Note: You can use minifiers like <a href="https://terser.org">terser</a> and <a href="https://esbuild.github.io">esbuild</a> as standalone tools.</section><section id="disable-source-maps"class="level4"><h4>Disable source maps</h4><p>Source maps provide a pleasant developer experience when working with languages that compile to JavaScript, such as <a href="https://www.typescriptlang.org">TypeScript</a>. As source maps tend to be quite large, you must disable them when building for production. They have no benefit to your end-user, so it's effectively dead weight.</section></section><section id="optimize-dependencies"class="level3"><h3>Optimize Dependencies</h3><p>Many popular libraries have smaller and faster alternatives that you can choose from instead.<p>Most libraries you use depend on many libraries themselves, so a library that looks inconspicuous at first glance might add <strong>several megabytes</strong> worth of code to your app.<p>You can use <a href="https://bundlephobia.com">Bundlephobia</a> to find the cost of JavaScript dependencies. Inspecting the cost of Rust dependencies is generally harder since the compiler does many optimizations.<p>If you find a library that seems excessively large, Google around, chances are someone else already had the same thought and created an alternative. A good example is <a href="https://momentjs.com">Moment.js</a> and it's <a href="https://github.com/you-dont-need/You-Dont-Need-Momentjs">many alternatives</a>.<p>But keep in mind: <strong>The best dependency is no dependency</strong>, meaning that you should always prefer language builtins over 3rd party packages.</section><section id="optimize-images"class="level3"><h3>Optimize Images</h3><p>According to the <a href="https://httparchive.org">Http Archive</a>, images are the <a href="https://httparchive.org/reports/page-weight#bytesImg">biggest contributor to website weight</a>. So if your app includes images or icons, make sure to optimize them!<p>You can choose between a variety of manual options (<a href="https://www.gimp.org">GIMP</a>, <a href="https://www.adobe.com/de/products/photoshop.html">Photoshop</a>, <a href="https://squoosh.app">Squoosh</a>) or plugins for your favorite frontend build tools (<a href="https://github.com/JonasKruckenberg/imagetools">vite-imagetools</a>, <a href="https://github.com/vbenjs/vite-plugin-imagemin">vite-plugin-imagemin</a>, <a href="https://github.com/webpack-contrib/image-minimizer-webpack-plugin">image-minimizer-webpack-plugin</a>).<p>Do note that the <code>imagemin</code> library most of the plugins use is <a href="https://github.com/imagemin/imagemin/issues/385">officially unmaintained</a>.<section id="use-modern-image-formats"class="level4"><h4>Use Modern Image Formats</h4><p>Formats such as <code>webp</code> or <code>avif</code> offer size reductions of <strong>up to 95%</strong> compared to jpeg while maintaining excellent visual accuracy. You can use tools such as <a href="https://squoosh.app">Squoosh</a> to try different formats on your images.</section><section id="size-images-accordingly"class="level4"><h4>Size Images Accordingly</h4><p>No one appreciates you shipping the 6K raw image with your app, so make sure to size your image accordingly. Images that appear large on-screen should be sized larger than images that take up less screen space.</section><section id="dont-use-responsive-images"class="level4"><h4>Don't Use Responsive Images</h4><p>In a Web Environment, you are supposed to use <a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images">Responsive Images</a> to load the correct image size for each user dynamically. Since you are not dynamically distributing images over the web, using Responsive Images only needlessly bloats your app with redundant copies.</section><section id="remove-metadata"class="level4"><h4>Remove Metadata</h4><p>Images that were taken straight from a camera or stock photo side often include metadata about the camera and lens model or photographer. Not only are those wasted bytes, but metadata properties can also hold potentially sensitive information such as the time, day, and location of the photo.</section></section><section id="remove-unnecessary-custom-fonts"class="level3"><h3>Remove Unnecessary Custom Fonts</h3><p>Consider not shipping custom fonts with your app and relying on system fonts instead. If you must ship custom fonts, make sure they are in modern, optimized formats such as <code>woff2</code>.<p>Fonts can be pretty big, so using the fonts already included in the Operating System reduces the footprint of your app. It also avoids FOUT (Flash of Unstyled Text) and makes your app feel more native since it uses the same font as all other apps.<p>If you must include custom fonts, make sure you include them in modern formats such as <code>woff2</code> as those tend to be much smaller than legacy formats.<p>Use so-called <strong>System Font Stacks</strong> in your CSS. There are a number of variations, but here are 3 basic ones to get you started:<p><strong>Sans-Serif</strong><pre class="language-css"><code class="language-css"><span class="token property">font-family</span><span class="token punctuation">:</span> -apple-system<span class="token punctuation">,</span> BlinkMacSystemFont<span class="token punctuation">,</span> <span class="token string">'Segoe UI'</span><span class="token punctuation">,</span> Helvetica<span class="token punctuation">,</span> Arial<span class="token punctuation">,</span>
  sans-serif<span class="token punctuation">,</span> <span class="token string">'Apple Color Emoji'</span><span class="token punctuation">,</span> <span class="token string">'Segoe UI Emoji'</span><span class="token punctuation">;</span></code></pre><p><strong>Serif</strong><pre class="language-css"><code class="language-css"><span class="token property">font-family</span><span class="token punctuation">:</span> Iowan Old Style<span class="token punctuation">,</span> Apple Garamond<span class="token punctuation">,</span> Baskerville<span class="token punctuation">,</span> Times New Roman<span class="token punctuation">,</span> Droid
    Serif<span class="token punctuation">,</span> Times<span class="token punctuation">,</span> Source Serif Pro<span class="token punctuation">,</span> serif<span class="token punctuation">,</span> Apple Color Emoji<span class="token punctuation">,</span> Segoe UI Emoji<span class="token punctuation">,</span> Segoe
    UI Symbol<span class="token punctuation">;</span></code></pre><p><strong>Monospace</strong><pre class="language-css"><code class="language-css"><span class="token property">font-family</span><span class="token punctuation">:</span> ui-monospace<span class="token punctuation">,</span> SFMono-Regular<span class="token punctuation">,</span> SF Mono<span class="token punctuation">,</span> Menlo<span class="token punctuation">,</span> Consolas<span class="token punctuation">,</span> Liberation
    Mono<span class="token punctuation">,</span> monospace<span class="token punctuation">;</span></code></pre></section><section id="allowlist-config"class="level3"><h3>Allowlist Config</h3><p>You can reduce the size of your app by only enabling the Tauri API features you need in the <code>allowlist</code> config.<p>The <code>allowlist</code> config determines what API features to enable; disabled features will <strong>not be compiled into your app</strong>. This is an easy way of shedding some extra weight.<p>An example from a typical <code>tauri.conf.json</code>:<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  tauri<span class="token operator">:</span> <span class="token punctuation">{</span>
    allowlist<span class="token operator">:</span> <span class="token punctuation">{</span>
      all<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      fs<span class="token operator">:</span> <span class="token punctuation">{</span>
        writeFile<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      shell<span class="token operator">:</span> <span class="token punctuation">{</span>
        execute<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      dialog<span class="token operator">:</span> <span class="token punctuation">{</span>
        save<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></section><section id="rust-build-time-optimizations"class="level3"><h3>Rust Build-Time Optimizations</h3><p>Configure your cargo project to take advantage of Rusts size optimization features. <a href="https://lifthrasiir.github.io/rustlog/why-is-a-rust-executable-large.html">Why is a rust executable large ?</a> provides an excellent explanation of why this matters and an in-depth walkthrough. At the same time, <a href="https://github.com/johnthagen/min-sized-rust">Minimizing Rust Binary Size</a> is more up-to-date and has a couple of extra recommendations.<p>Rust is notorious for producing large binaries, but you can instruct the compiler to optimize the final executable's size.<p>Cargo exposes several options that determine how the compiler generates your binary. The recommended options for Tauri apps are these:<pre class="language-toml"><code class="language-toml"><span class="token punctuation">[</span><span class="token table class-name">profile.release</span><span class="token punctuation">]</span>
<span class="token key property">panic</span> <span class="token punctuation">=</span> abort <span class="token comment"># Strip expensive panic clean-up logic</span>
<span class="token key property">codegen-units</span> <span class="token punctuation">=</span> <span class="token number">1</span> <span class="token comment"># Compile crates one after another so the compiler can optimize better</span>
<span class="token key property">lto</span> <span class="token punctuation">=</span> <span class="token boolean">true</span> <span class="token comment"># Enables link to optimizations</span>
<span class="token key property">opt-level</span> <span class="token punctuation">=</span> s <span class="token comment"># Optimize for binary size</span></code></pre><blockquote>There is also `opt-level = z` available to reduce the resulting binary size. `s` and `z` can sometimes be smaller than the other, so test it with your application!<p>We've seen smaller binary sizes from <code>s</code> for Tauri example applications, but real-world applications can always differ.</blockquote><p>For a detailed explanation of each option and a bunch more, refer to the <a href="https://doc.rust-lang.org/cargo/reference/profiles.html">Cargo books Profiles section</a>.<section id="unstable-rust-compression-features"class="level4"><h4>Unstable Rust Compression Features</h4>caution The following suggestions are all unstable features and require a nightly toolchain. See the [Unstable Features][cargo unstable features] documentation for more information on what this involves.<p>The following methods involve using unstable compiler features and require the rust nightly toolchain. If you don't have the nightly toolchain + <code>rust-src</code> nightly component added, try the following:<pre class="language-shell"><code class="language-shell">rustup toolchain <span class="token function">install</span> nightly
rustup component <span class="token function">add</span> rust-src --toolchain nightly</code></pre><p>The Rust Standard Library comes precompiled. This means Rust is faster to install, but also that the compiler can't optimize the Standard Library. You can apply the optimization options for the rest of your binary + dependencies to the std with an unstable flag. This flag requires specifying your target, so know the target triple you are targeting.<pre class="language-shell"><code class="language-shell">cargo +nightly build --release -Z build-std --target x86_64-unknown-linux-gnu</code></pre><p>If you are using <code>panic = abort</code> in your release profile optimizations, you need to make sure the <code>panic_abort</code> crate is compiled with std. Additionally, an extra std feature can further reduce the binary size. The following applies to both:<pre class="language-shell"><code class="language-shell">cargo +nightly build --release -Z build-std<span class="token operator">=</span>std,panic_abort -Z build-std-features<span class="token operator">=</span>panic_immediate_abort --target x86_64-unknown-linux-gnu</code></pre><p>See the unstable documentation for more details about <a href="https://doc.rust-lang.org/cargo/reference/unstable.html#build-std"><code>-Z build-std</code></a> and <a href="https://doc.rust-lang.org/cargo/reference/unstable.html#build-std-features"><code>-Z build-std-features</code></a>.</section></section><section id="stripping"class="level3"><h3>Stripping</h3><p>Use strip utilities to remove debug symbols from your compiled app.<p>Your compiled app includes so-called Debug Symbols that include function and variable names. Your end-users will probably not care about Debug Symbols, so this is a pretty surefire way to save some bytes!<p>The easiest way is to use the famous <code>strip</code> utility to remove this debugging information.<pre class="language-shell"><code class="language-shell">strip target/release/my_application</code></pre><p>See your local <code>strip</code> manpage for more information and flags that can be used to specify what information gets stripped out from the binary.</p>info<p>Rust 1.59 now has a builtin version of <code>strip</code>! It can be enabled by adding the following to your <code>Cargo.toml</code>:<pre class="language-toml"><code class="language-toml"><span class="token punctuation">[</span><span class="token table class-name">profile.release</span><span class="token punctuation">]</span>
<span class="token key property">strip</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>  <span class="token comment"># Automatically strip symbols from the binary.</span></code></pre></section><section id="upx"class="level3"><h3>UPX</h3><p>UPX, <strong>Ultimate Packer for eXecutables</strong>, is a dinosaur amongst the binary packers. This 23-year old, well-maintained piece of kit is GPL-v2 licensed with a pretty liberal usage declaration. Our understanding of the licensing is that you can use it for any purposes (commercial or otherwise) without needing to change your license unless you modify the source code of UPX.<p>Maybe your target audience has very slow internet, or your app needs to fit on a tiny USB stick, and all the above steps haven't resulted in the savings you need. Fear not, as we have one last trick up our sleeves:<p><a href="https://github.com/upx/upx">UPX</a> compresses your binary and creates a self-extracting executable that decompresses itself at runtime.</p>caution You should know that this technique might flag your binary as a virus on Windows and macOS - so use at your own discretion, and as always, validate with [Frida] and do real distribution testing!<section id="usage-on-macos"class="level4"><h4>Usage on macOS</h4><pre class="language-text"><code class="language-text">brew install upx
yarn tauri build
upx --ultra-brute src-tauri/target/release/bundle/macos/app.app/Contents/macOS/app

                        Ultimate Packer for eXecutables
                            Copyright (C) 1996 - 2018
UPX 3.95        Markus Oberhumer, Laszlo Molnar &#x26; John Reiser   Aug 26th 2018

        File size         Ratio      Format      Name
    --------------------   ------   -----------   -----------
    963140 ->    274448   28.50%   macho/amd64   app</code></pre><p><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section></section></section>