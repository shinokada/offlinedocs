<!doctype html><html lang="en"><meta charset="utf-8"><title>Calling Rust from the frontend</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="calling-rust-from-the-frontend"><h1 id="calling-rust-from-the-frontend">Calling Rust from the frontend</h1><p>Tauri provides a simple yet powerful <code>command</code> system for calling Rust functions from your web app. Commands can accept arguments and return values. They can also return errors and be <code>async</code>.<section class="level2"aria-labelledby="basic-example"><h2 id="basic-example">Basic Example</h2><p>Commands are defined in your <code>src-tauri/src/main.rs</code> file. To create a command, just add a function and annotate it with <code>#[tauri::command]</code>:<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token class-name">I</span> was invoked from <span class="token macro property">JS!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>You will have to provide a list of your commands to the builder function like so:<pre class="language-rust"><code class="language-rust"><span class="token comment">// Also in main.rs</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">Builder</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// This is where you pass in your commands</span>
    <span class="token punctuation">.</span><span class="token function">invoke_handler</span><span class="token punctuation">(</span><span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token macro property">generate_handler!</span><span class="token punctuation">[</span>my_custom_command<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token macro property">generate_context!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span>failed to run app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Now, you can invoke the command from your JS code:<pre class="language-js"><code class="language-js"><span class="token comment">// When using the Tauri API npm package:</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> invoke <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@tauri-apps/api/tauri'</span>
<span class="token comment">// When using the Tauri global script (if not using the npm package)</span>
<span class="token comment">// Be sure to set `build.withGlobalTauri` in `tauri.conf.json` to true</span>
<span class="token keyword">const</span> invoke <span class="token operator">=</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">__TAURI__</span><span class="token punctuation">.</span><span class="token property-access">invoke</span>

<span class="token comment">// Invoke the command</span>
<span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'my_custom_command'</span><span class="token punctuation">)</span></code></pre></section><section class="level2"aria-labelledby="passing-arguments"><h2 id="passing-arguments">Passing Arguments</h2><p>Your command handlers can take arguments:<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span>invoke_message<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token class-name">I</span> was invoked from <span class="token constant">JS</span><span class="token punctuation">,</span> with this message<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> invoke_message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Arguments should be passed as a JSON object with camelCase keys:<pre class="language-js"><code class="language-js"><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'my_custom_command'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">invokeMessage</span><span class="token operator">:</span> <span class="token string">'Hello!'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>Arguments can be of any type, as long as they implement <a href="https://docs.serde.rs/serde/trait.Deserialize.html"><code>serde::Deserialize</code></a>.<p>Please note, when declaring arguments in Rust using snake_case, the arguments are converted to camelCase for JavaScript.<p>To use snake_case in JavaScript, you have to declare it in the <code>tauri::command</code> statement:<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[tauri::command(rename_all = snake_case)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span>invoke_message<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token class-name">I</span> was invoked from <span class="token constant">JS</span><span class="token punctuation">,</span> with this message<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> invoke_message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>The corresponding JavaScript:<pre class="language-js"><code class="language-js"><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'my_custom_command'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">invoke_message</span><span class="token operator">:</span> <span class="token string">'Hello!'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level2"aria-labelledby="returning-data"><h2 id="returning-data">Returning Data</h2><p>Command handlers can return data as well:<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
  <span class="token class-name">Hello</span> from <span class="token macro property">Rust!</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p>The <code>invoke</code> function returns a promise that resolves with the returned value:<pre class="language-js"><code class="language-js"><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'my_custom_command'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Returned data can be of any type, as long as it implements <a href="https://docs.serde.rs/serde/trait.Serialize.html"><code>serde::Serialize</code></a>.</section><section class="level2"aria-labelledby="error-handling"><h2 id="error-handling">Error Handling</h2><p>If your handler could fail and needs to be able to return an error, have the function return a <code>Result</code>:<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&#x3C;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment">// If something fails</span>
  <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">This</span> <span class="token macro property">failed!</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// If it worked</span>
  <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">This</span> <span class="token macro property">worked!</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p>If the command returns an error, the promise will reject, otherwise, it resolves:<pre class="language-js"><code class="language-js"><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'my_custom_command'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>As mentioned above, everything returned from commands must implement <a href="https://docs.serde.rs/serde/trait.Serialize.html"><code>serde::Serialize</code></a>, including errors. This can be problematic if you're working with error types from Rust's std library or external crates as most error types do not implement it. In simple scenarios you can use <code>map_err</code> to convert these errors to <code>String</code>s:<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&#x3C;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment">// This will return an error</span>
  <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span>path<span class="token operator">/</span>that<span class="token operator">/</span>does<span class="token operator">/</span>not<span class="token operator">/</span>exist<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map_err</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>err<span class="token closure-punctuation punctuation">|</span></span> err<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
  <span class="token comment">// Return nothing on success</span>
  <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p>Since this is not very idiomatic you may want to create your own error type which implements <code>serde::Serialize</code>. In the following example, we use the [thiserror] crate to help create the error type. It allows you to turn enums into error types by deriving the <code>thiserror::Error</code> trait. You can consult its documentation for more details.<pre class="language-rust"><code class="language-rust"><span class="token comment">// create the error type that represents all errors possible in our program</span>
<span class="token attribute attr-name">#[derive(Debug, thiserror::Error)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">Error</span> <span class="token punctuation">{</span>
  <span class="token attribute attr-name">#[error(transparent)]</span>
  <span class="token class-name">Io</span><span class="token punctuation">(</span><span class="token attribute attr-name">#[from]</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// we must manually implement serde::Serialize</span>
<span class="token keyword">impl</span> <span class="token namespace">serde<span class="token punctuation">::</span></span><span class="token class-name">Serialize</span> <span class="token keyword">for</span> <span class="token class-name">Error</span> <span class="token punctuation">{</span>
  <span class="token keyword">fn</span> <span class="token function-definition function">serialize</span><span class="token operator">&#x3C;</span><span class="token class-name">S</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&#x26;</span><span class="token keyword">self</span><span class="token punctuation">,</span> serializer<span class="token punctuation">:</span> <span class="token class-name">S</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&#x3C;</span><span class="token class-name">S</span><span class="token punctuation">::</span><span class="token class-name">Ok</span><span class="token punctuation">,</span> <span class="token class-name">S</span><span class="token punctuation">::</span><span class="token class-name">Error</span><span class="token operator">></span>
  <span class="token keyword">where</span>
    <span class="token class-name">S</span><span class="token punctuation">:</span> <span class="token namespace">serde<span class="token punctuation">::</span>ser<span class="token punctuation">::</span></span><span class="token class-name">Serializer</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    serializer<span class="token punctuation">.</span><span class="token function">serialize_str</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&#x3C;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Error</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment">// This will return an error</span>
  <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span>path<span class="token operator">/</span>that<span class="token operator">/</span>does<span class="token operator">/</span>not<span class="token operator">/</span>exist<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
  <span class="token comment">// Return nothing on success</span>
  <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p>A custom error type has the advantage of making all possible errors explicit so readers can quickly identify what errors can happen. This saves other people (and yourself) enormous amounts of time when reviewing and refactoring code later.<br>It also gives you full control over the way your error type gets serialized. In the above example, we simply returned the error message as a string, but you could assign each error a code similar to C, this way you could more easily map it to a similar looking TypeScript error enum for example.</section><section class="level2"aria-labelledby="async-commands"><h2 id="async-commands">Async Commands</h2><p>Asynchronous functions are benefical in Tauri to perform heavy work in a manner that doesn't result in UI freezes or slowdowns.<blockquote><p>Async commands are executed on a separate thread using <a href="https://docs.rs/tauri/1/tauri/async_runtime/fn.spawn.html"><code>async_runtime::spawn</code></a>. Commands without the <em>async</em> keyword are executed on the main thread unless defined with <em>#[tauri::command(async)]</em>.</blockquote><p><strong>If your command needs to run asynchronously, simply declare it as <code>async</code>.</strong></p>caution<p>You need to be careful when creating asynchronous functions using Tauri. Currently, you cannot simply include borrowed arguments in the signature of an asynchronous function. Some common examples of types like this are <code>&#x26;str</code> and <code>State&#x3C;'_, Data></code>. This limitation is tracked here: <a href="https://github.com/tauri-apps/tauri/issues/2533">https://github.com/tauri-apps/tauri/issues/2533</a> and workarounds are shown below.<p>When working with borrowed types, you have to make additional changes. These are your two main options:<p><strong>Option 1</strong>: Convert the type, such as <code>&#x26;str</code> to a similar type that is not borrowed, such as <code>String</code>. This may not work for all types, for example <code>State&#x3C;'_, Data></code>.<p><em>Example:</em><pre class="language-rust"><code class="language-rust"><span class="token comment">// Declare the async function using String instead of &#x26;str, as &#x26;str is borrowed and thus unsupported</span>
<span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
  <span class="token comment">// Call another async function and wait for it to finish</span>
  <span class="token function">some_async_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">;</span>
  <span class="token macro property">format!</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p><strong>Option 2</strong>: Wrap the return type in a <a href="https://doc.rust-lang.org/std/result/index.html"><code>Result</code></a>. This one is a bit harder to implement, but should work for all types.<p>Use the return type <code>Result&#x3C;a, b></code>, replacing <code>a</code> with the type you wish to return, or <code>()</code> if you wish to return nothing, and replacing <code>b</code> with an error type to return if something goes wrong, or <code>()</code> if you wish to have no optional error returned. For example:<ul><li><code>Result&#x3C;String, ()></code> to return a String, and no error.<li><code>Result&#x3C;(), ()></code> to return nothing.<li><code>Result&#x3C;bool, Error></code> to return a boolean or an error as shown in the <a href="#error-handling">Error Handling</a> section above.</ul><p><em>Example:</em><pre class="language-rust"><code class="language-rust"><span class="token comment">// Return a Result&#x3C;String, ()> to bypass the borrowing issue</span>
<span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token operator">&#x26;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&#x3C;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment">// Call another async function and wait for it to finish</span>
  <span class="token function">some_async_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">;</span>
  <span class="token comment">// Note that the return value must be wrapped in `Ok()` now.</span>


  <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token macro property">format!</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><section class="level4"aria-labelledby="invoking-from-js"><h4 id="invoking-from-js">Invoking from JS</h4><p>Since invoking the command from JavaScript already returns a promise, it works just like any other command:<pre class="language-js"><code class="language-js"><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'my_custom_command'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'Hello, Async!'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Completed!'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></section></section><section class="level2"aria-labelledby="accessing-the-window-in-commands"><h2 id="accessing-the-window-in-commands">Accessing the Window in Commands</h2><p>Commands can access the <code>Window</code> instance that invoked the message:<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span>window<span class="token punctuation">:</span> <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">Window</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token class-name">Window</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span><span class="token function">label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section><section class="level2"aria-labelledby="accessing-an-apphandle-in-commands"><h2 id="accessing-an-apphandle-in-commands">Accessing an AppHandle in Commands</h2><p>Commands can access an <code>AppHandle</code> instance:<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span>app_handle<span class="token punctuation">:</span> <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">AppHandle</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> app_dir <span class="token operator">=</span> app_handle<span class="token punctuation">.</span><span class="token function">path_resolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">app_dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">use</span> <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">GlobalShortcutManager</span><span class="token punctuation">;</span>
  app_handle<span class="token punctuation">.</span><span class="token function">global_shortcut_manager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token constant">CTRL</span> <span class="token operator">+</span> <span class="token class-name">U</span><span class="token punctuation">,</span> <span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section><section class="level2"aria-labelledby="accessing-managed-state"><h2 id="accessing-managed-state">Accessing managed state</h2><p>Tauri can manage state using the <code>manage</code> function on <code>tauri::Builder</code>. The state can be accessed on a command using <code>tauri::State</code>:<pre class="language-rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">MyState</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span>state<span class="token punctuation">:</span> <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">State</span><span class="token operator">&#x3C;</span><span class="token class-name">MyState</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>state<span class="token number">.0</span> <span class="token operator">==</span> some state value<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">Builder</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token class-name">MyState</span><span class="token punctuation">(</span>some state value<span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">invoke_handler</span><span class="token punctuation">(</span><span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token macro property">generate_handler!</span><span class="token punctuation">[</span>my_custom_command<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token macro property">generate_context!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span>error <span class="token keyword">while</span> running tauri application<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section><section class="level2"aria-labelledby="creating-multiple-commands"><h2 id="creating-multiple-commands">Creating Multiple Commands</h2><p>The <code>tauri::generate_handler!</code> macro takes an array of commands. To register multiple commands, you cannot call invoke_handler multiple times. Only the last call will be used. You must pass each command to a single call of <code>tauri::generate_handler!</code>.<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">cmd_a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
	<span class="token class-name">Command</span> a
<span class="token punctuation">}</span>
<span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">cmd_b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
	<span class="token class-name">Command</span> b
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">Builder</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">invoke_handler</span><span class="token punctuation">(</span><span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token macro property">generate_handler!</span><span class="token punctuation">[</span>cmd_a<span class="token punctuation">,</span> cmd_b<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token macro property">generate_context!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span>error <span class="token keyword">while</span> running tauri application<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section><section class="level2"aria-labelledby="complete-example"><h2 id="complete-example">Complete Example</h2><p>Any or all of the above features can be combined:<pre class="language-rust"><code class="language-rust">
<span class="token keyword">struct</span> <span class="token type-definition class-name">Database</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(serde::Serialize)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">CustomResponse</span> <span class="token punctuation">{</span>
  message<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
  other_val<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">some_other_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Option</span><span class="token operator">&#x3C;</span><span class="token class-name">String</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token class-name">Some</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[tauri::command]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">my_custom_command</span><span class="token punctuation">(</span>
  window<span class="token punctuation">:</span> <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">Window</span><span class="token punctuation">,</span>
  number<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span>
  database<span class="token punctuation">:</span> <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">State</span><span class="token operator">&#x3C;</span><span class="token lifetime-annotation symbol">'_</span><span class="token punctuation">,</span> <span class="token class-name">Database</span><span class="token operator">></span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&#x3C;</span><span class="token class-name">CustomResponse</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token class-name">Called</span> from <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span><span class="token function">label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&#x3C;</span><span class="token class-name">String</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token function">some_other_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token operator">=</span> result <span class="token punctuation">{</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">CustomResponse</span> <span class="token punctuation">{</span>
      message<span class="token punctuation">,</span>
      other_val<span class="token punctuation">:</span> <span class="token number">42</span> <span class="token operator">+</span> number<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">No</span> result<span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token class-name">Builder</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token class-name">Database</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">invoke_handler</span><span class="token punctuation">(</span><span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token macro property">generate_handler!</span><span class="token punctuation">[</span>my_custom_command<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token namespace">tauri<span class="token punctuation">::</span></span><span class="token macro property">generate_context!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span>error <span class="token keyword">while</span> running tauri application<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// Invocation from JS</span>

<span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">'my_custom_command'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">number</span><span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Message: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token punctuation">.</span><span class="token property-access">message</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, Other Val: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token punctuation">.</span><span class="token property-access">other_val</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section>