<!doctype html><html lang="en"><meta charset="utf-8"><title>WebdriverIO</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="sidebar_position"content="3"><link rel="stylesheet"href="../../../../../../../../../Vivliostyle/read-html-download-pdf/docs/themes/packages/prism-coy-theme/theme_common.css"><p>import Tabs from '@theme/Tabs' import TabItem from '@theme/TabItem'<section class="level1"aria-labelledby="webdriverio"><h1 id="webdriverio">WebdriverIO</h1><blockquote>Example Application This [WebdriverIO] guide expects you to have already gone through the [example Application setup] to follow step-by-step. The general information may still be helpful otherwise.otherwise.</blockquote><p>This WebDriver testing example will use <a href="https://webdriver.io/">WebdriverIO</a>, and its testing suite. It is expected to have Node.js already installed, along with <code>npm</code> or <code>yarn</code> although the <a href="https://github.com/chippers/hello_tauri">finished example project</a> uses <code>yarn</code>.<section class="level2"aria-labelledby="create-a-directory-for-the-tests"><h2 id="create-a-directory-for-the-tests">Create a Directory for the Tests</h2><p>Let's create a space to write these tests in our project. We will be using a nested directory for this example project as we will later also go over other frameworks, but typically you only need to use one. Create the directory we will use with <code>mkdir -p webdriver/webdriverio</code>. The rest of this guide assumes you are inside the <code>webdriver/webdriverio</code> directory.</section><section class="level2"aria-labelledby="initializing-a-webdriverio-project"><h2 id="initializing-a-webdriverio-project">Initializing a WebdriverIO Project</h2><p>We will be using a pre-existing <code>package.json</code> to bootstrap this test suite because we have already chosen specific <a href="https://webdriver.io/">WebdriverIO</a> config options and want to showcase a simple working solution. The bottom of this section has a collapsed guide on setting it up from scratch.<p><code>package.json</code>:<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  name<span class="token operator">:</span> webdriverio<span class="token punctuation">,</span>
  version<span class="token operator">:</span> <span class="token number">1.0</span>.<span class="token number">0</span><span class="token punctuation">,</span>
  private<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  scripts<span class="token operator">:</span> <span class="token punctuation">{</span>
    test<span class="token operator">:</span> wdio run wdio.conf.js
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  dependencies<span class="token operator">:</span> <span class="token punctuation">{</span>
    @wdio/cli<span class="token operator">:</span> ^<span class="token number">7.9</span>.<span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  devDependencies<span class="token operator">:</span> <span class="token punctuation">{</span>
    @wdio/local-runner<span class="token operator">:</span> ^<span class="token number">7.9</span>.<span class="token number">1</span><span class="token punctuation">,</span>
    @wdio/mocha-framework<span class="token operator">:</span> ^<span class="token number">7.9</span>.<span class="token number">1</span><span class="token punctuation">,</span>
    @wdio/spec-reporter<span class="token operator">:</span> ^<span class="token number">7.9</span>.<span class="token number">0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>We have a script that runs a <a href="https://webdriver.io/">WebdriverIO</a> config as a test suite exposed as the <code>test</code> command. We also have various dependencies added by the <code>@wdio/cli</code> command when we first set it up. In short, these dependencies are for the most simple setup using a local WebDriver runner, <a href="https://mochajs.org/">Mocha</a> as the test framework, and a simple Spec Reporter.<details><summary>Click me if you want to see how to set a project up from scratch</summary><p>The CLI is interactive, and you may choose the tools to work with yourself. Note that you will likely diverge from<p>the rest of the guide, and you need to set up the differences yourself.<p>Let's add the <a href="https://webdriver.io/">WebdriverIO</a> CLI to this npm project.<p>&#x3C;Tabs groupId=package-manager defaultValue=yarn values={[ {label: 'npm', value: 'npm'}, {label: 'Yarn', value: 'yarn'}, ]}><tabitem value="npm"></tabitem><pre class="language-shell"><code class="language-shell"><span class="token function">npm</span> <span class="token function">install</span> @wdio/cli</code></pre><tabitem value="yarn"><pre class="language-shell"><code class="language-shell"><span class="token function">yarn</span> <span class="token function">add</span> @wdio/cli</code></pre></tabitem><p>To then run the interactive config command to set up a <a href="https://webdriver.io/">WebdriverIO</a> test suite, you can then run:<p>&#x3C;Tabs groupId=package-manager defaultValue=yarn values={[ {label: 'npm', value: 'npm'}, {label: 'Yarn', value: 'yarn'}, ]}><tabitem value="npm"></tabitem><pre class="language-shell"><code class="language-shell">npx wdio config</code></pre><tabitem value="yarn"><pre class="language-shell"><code class="language-shell"><span class="token function">yarn</span> wdio config</code></pre></tabitem></details></section><section class="level2"aria-labelledby="config"><h2 id="config">Config</h2><p>You may have noticed that the <code>test</code> script in our <code>package.json</code> mentions a file <code>wdio.conf.js</code>. That's the <a href="https://webdriver.io/">WebdriverIO</a> config file which controls most aspects of our testing suite.<p><code>wdio.conf.js</code>:<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> spawn<span class="token punctuation">,</span> spawnSync <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span>

<span class="token comment">// keep track of the `tauri-driver` child process</span>
<span class="token keyword">let</span> tauriDriver

exports<span class="token punctuation">.</span><span class="token property-access">config</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">specs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./test/specs/**/*.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">maxInstances</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">capabilities</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">maxInstances</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token string-property property">'tauri:options'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">application</span><span class="token operator">:</span> <span class="token string">'../../target/release/hello-tauri-webdriver'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">reporters</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'spec'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">framework</span><span class="token operator">:</span> <span class="token string">'mocha'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mochaOpts</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">ui</span><span class="token operator">:</span> <span class="token string">'bdd'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">60000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// ensure the rust project is built since we expect this binary to exist for the webdriver sessions</span>
  <span class="token function-variable function">onPrepare</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">spawnSync</span><span class="token punctuation">(</span><span class="token string">'cargo'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token string">'--release'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token comment">// ensure we are running `tauri-driver` before the session starts so that we can proxy the webdriver requests</span>
  <span class="token function-variable function">beforeSession</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span>
    <span class="token punctuation">(</span>tauriDriver <span class="token operator">=</span> <span class="token function">spawn</span><span class="token punctuation">(</span>
      path<span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token method function property-access">homedir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'.cargo'</span><span class="token punctuation">,</span> <span class="token string">'bin'</span><span class="token punctuation">,</span> <span class="token string">'tauri-driver'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">stdio</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword null nil">null</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span><span class="token property-access">stdout</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span><span class="token property-access">stderr</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token comment">// clean up the `tauri-driver` process we spawned at the start of the session</span>
  <span class="token function-variable function">afterSession</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> tauriDriver<span class="token punctuation">.</span><span class="token method function property-access">kill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre><p>If you are interested in the properties on the <code>exports.config</code> object, I <a href="https://webdriver.io/docs/configurationfile">suggest reading the documentation</a>. For non-WDIO specific items, there are comments explaining why we are running commands in <code>onPrepare</code>, <code>beforeSession</code>, and <code>afterSession</code>. We also have our specs set to <code>./test/specs/**/*.js</code>, so let's create a spec now.</section><section class="level2"aria-labelledby="spec"><h2 id="spec">Spec</h2><p>A spec contains the code that is testing your actual application. The test runner will load these specs and automatically run them as it sees fit. Let's create our spec now in the directory we specified.<p><code>test/specs/example.e2e.js</code>:<pre class="language-js"><code class="language-js"><span class="token comment">// calculates the luma from a hex color `#abcdef`</span>
<span class="token keyword">function</span> <span class="token function">luma</span><span class="token punctuation">(</span><span class="token parameter">hex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>hex<span class="token punctuation">.</span><span class="token method function property-access">startsWith</span><span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    hex <span class="token operator">=</span> hex<span class="token punctuation">.</span><span class="token method function property-access">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> rgb <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>hex<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> r <span class="token operator">=</span> <span class="token punctuation">(</span>rgb <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&#x26;</span> <span class="token number">0xff</span>
  <span class="token keyword">const</span> g <span class="token operator">=</span> <span class="token punctuation">(</span>rgb <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&#x26;</span> <span class="token number">0xff</span>
  <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token punctuation">(</span>rgb <span class="token operator">>></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&#x26;</span> <span class="token number">0xff</span>
  <span class="token keyword control-flow">return</span> <span class="token number">0.2126</span> <span class="token operator">*</span> r <span class="token operator">+</span> <span class="token number">0.7152</span> <span class="token operator">*</span> g <span class="token operator">+</span> <span class="token number">0.0722</span> <span class="token operator">*</span> b
<span class="token punctuation">}</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Hello Tauri'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should be cordial'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> header <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body > h1'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword control-flow">await</span> header<span class="token punctuation">.</span><span class="token method function property-access">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatch</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[hH]ello</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should be excited'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> header <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body > h1'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword control-flow">await</span> header<span class="token punctuation">.</span><span class="token method function property-access">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatch</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">!$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should be easy on the eyes'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> body <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> backgroundColor <span class="token operator">=</span> <span class="token keyword control-flow">await</span> body<span class="token punctuation">.</span><span class="token method function property-access">getCSSProperty</span><span class="token punctuation">(</span><span class="token string">'background-color'</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">luma</span><span class="token punctuation">(</span>backgroundColor<span class="token punctuation">.</span><span class="token property-access">parsed</span><span class="token punctuation">.</span><span class="token property-access">hex</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeLessThan</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>The <code>luma</code> function on top is just a helper function for one of our tests and is not related to the actual testing of the application. If you are familiar with other testing frameworks, you may notice similar functions being exposed that are used, such as <code>describe</code>, <code>it</code>, and <code>expect</code>. The other APIs, such as items like <code>$</code> and its exposed methods, are covered by the <a href="https://webdriver.io/docs/api">WebdriverIO API docs</a>.</section><section class="level2"aria-labelledby="running-the-test-suite"><h2 id="running-the-test-suite">Running the Test Suite</h2><p>Now that we are all set up with config and a spec let's run it!<p>&#x3C;Tabs groupId=package-manager defaultValue=yarn values={[ {label: 'npm', value: 'npm'}, {label: 'Yarn', value: 'yarn'}, ]}><tabitem value="npm"></tabitem><pre class="language-shell"><code class="language-shell"><span class="token function">npm</span> <span class="token builtin class-name">test</span></code></pre><tabitem value="yarn"><pre class="language-shell"><code class="language-shell"><span class="token function">yarn</span> <span class="token builtin class-name">test</span></code></pre></tabitem><p>We should see output the following output:<pre class="language-text"><code class="language-text">➜  webdriverio git:(main) ✗ yarn test
yarn run v1.22.11
$ wdio run wdio.conf.js

Execution of 1 workers started at 2021-08-17T08:06:10.279Z

[0-0] RUNNING in undefined - /test/specs/example.e2e.js
[0-0] PASSED in undefined - /test/specs/example.e2e.js

 spec Reporter:
------------------------------------------------------------------
[wry 0.12.1 linux #0-0] Running: wry (v0.12.1) on linux
[wry 0.12.1 linux #0-0] Session ID: 81e0107b-4d38-4eed-9b10-ee80ca47bb83
[wry 0.12.1 linux #0-0]
[wry 0.12.1 linux #0-0] » /test/specs/example.e2e.js
[wry 0.12.1 linux #0-0] Hello Tauri
[wry 0.12.1 linux #0-0]    ✓ should be cordial
[wry 0.12.1 linux #0-0]    ✓ should be excited
[wry 0.12.1 linux #0-0]    ✓ should be easy on the eyes
[wry 0.12.1 linux #0-0]
[wry 0.12.1 linux #0-0] 3 passing (244ms)


Spec Files:	 1 passed, 1 total (100% completed) in 00:00:01

Done in 1.98s.</code></pre><p>We see the Spec Reporter tell us that all 3 tests from the <code>test/specs/example.e2e.js</code> file, along with the final report <code>Spec Files: 1 passed, 1 total (100% completed) in 00:00:01</code>.<p>Using the <a href="https://webdriver.io/">WebdriverIO</a> test suite, we just easily enabled e2e testing for our Tauri application from just a few lines of configuration and a single command to run it! Even better, we didn't have to modify the application at all.<p><span style="float:footnote"><a href="../../../../index.html#toc">Go to TOC</a></span></section></section>