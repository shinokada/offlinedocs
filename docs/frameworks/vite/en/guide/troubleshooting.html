<!doctypehtml><html lang="en"><meta charset="utf-8"><title>Troubleshooting</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="troubleshooting"class="level1"><h1>Troubleshooting</h1><p>See <a href="https://rollupjs.org/guide/en/#troubleshooting">Rollup's troubleshooting guide</a> for more information too.<p>If the suggestions here don't work, please try posting questions on <a href="https://github.com/vitejs/vite/discussions">GitHub Discussions</a> or in the <code>#help</code> channel of <a href="https://chat.vitejs.dev">Vite Land Discord</a>.<section id="cli"class="level2"><h2>CLI</h2><section id="error-cannot-find-module-cfoobarbazvitebinvitejs"class="level3"><h3><code>Error: Cannot find module 'C:\foo\bar&#x26;baz\vite\bin\vite.js'</code></h3><p>The path to your project folder may include <code>&#x26;</code>, which doesn't work with <code>npm</code> on Windows (<a href="https://github.com/npm/cmd-shim/issues/45">npm/cmd-shim#45</a>).<p>You will need to either:<ul><li>Switch to another package manager (e.g. <code>pnpm</code>, <code>yarn</code>)<li>Remove <code>&#x26;</code> from the path to your project</ul></section></section><section id="dev-server"class="level2"><h2>Dev Server</h2><section id="requests-are-stalled-forever"class="level3"><h3>Requests are stalled forever</h3><p>If you are using Linux, file descriptor limits and inotify limits may be causing the issue. As Vite does not bundle most of the files, browsers may request many files which require many file descriptors, going over the limit.<p>To solve this:<ul><li><p>Increase file descriptor limit by <code>ulimit</code><pre class="language-shell"><code class="language-shell"><span class="token comment"># Check current limit</span>
$ <span class="token builtin class-name">ulimit</span> -Sn
<span class="token comment"># Change limit (temporary)</span>
$ <span class="token builtin class-name">ulimit</span> -Sn <span class="token number">10000</span> <span class="token comment"># You might need to change the hard limit too</span>
<span class="token comment"># Restart your browser</span></code></pre><li><p>Increase the following inotify related limits by <code>sysctl</code><pre class="language-shell"><code class="language-shell"><span class="token comment"># Check current limits</span>
$ sysctl fs.inotify
<span class="token comment"># Change limits (temporary)</span>
$ <span class="token function">sudo</span> sysctl fs.inotify.max_queued_events<span class="token operator">=</span><span class="token number">16384</span>
$ <span class="token function">sudo</span> sysctl fs.inotify.max_user_instances<span class="token operator">=</span><span class="token number">8192</span>
$ <span class="token function">sudo</span> sysctl fs.inotify.max_user_watches<span class="token operator">=</span><span class="token number">524288</span></code></pre></ul><p>If the above steps don't work, you can try adding <code>DefaultLimitNOFILE=65536</code> as an un-commented config to the following files:<ul><li>/etc/systemd/system.conf<li>/etc/systemd/user.conf</ul><p>Note that these settings persist but a <strong>restart is required</strong>.</section><section id="431-request-header-fields-too-large"class="level3"><h3>431 Request Header Fields Too Large</h3><p>When the server / WebSocket server receives a large HTTP header, the request will be dropped and the following warning will be shown.<blockquote><p>Server responded with status code 431. See <a href="https://vitejs.dev/guide/troubleshooting.html#_431-request-header-fields-too-large">https://vitejs.dev/guide/troubleshooting.html#_431-request-header-fields-too-large</a>.</blockquote><p>This is because Node.js limits request header size to mitigate <a href="https://www.cve.org/CVERecord?id=CVE-2018-12121">CVE-2018-12121</a>.<p>To avoid this, try to reduce your request header size. For example, if the cookie is long, delete it. Or you can use <a href="https://nodejs.org/api/cli.html#--max-http-header-sizesize"><code>--max-http-header-size</code></a> to change max header size.</section></section><section id="hmr"class="level2"><h2>HMR</h2><section id="vite-detects-a-file-change-but-the-hmr-is-not-working"class="level3"><h3>Vite detects a file change but the HMR is not working</h3><p>You may be importing a file with a different case. For example, <code>src/foo.js</code> exists and <code>src/bar.js</code> contains:<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token string">'./Foo.js'</span> <span class="token comment">// should be './foo.js'</span></code></pre><p>Related issue: <a href="https://github.com/vitejs/vite/issues/964">#964</a></section><section id="vite-does-not-detect-a-file-change"class="level3"><h3>Vite does not detect a file change</h3><p>If you are running Vite with WSL2, Vite cannot watch file changes in some conditions. See <a href="/config/server-options.md#server-watch"><code>server.watch</code> option</a>.</section><section id="a-full-reload-happens-instead-of-hmr"class="level3"><h3>A full reload happens instead of HMR</h3><p>If HMR is not handled by Vite or a plugin, a full reload will happen.<p>Also if there is a dependency loop, a full reload will happen. To solve this, try removing the loop.</section></section><section id="build"class="level2"><h2>Build</h2><section id="built-file-does-not-work-because-of-cors-error"class="level3"><h3>Built file does not work because of CORS error</h3><p>If the HTML file output was opened with <code>file</code> protocol, the scripts won't run with the following error.<blockquote><p>Access to script at 'file:///foo/bar.js' from origin 'null' has been blocked by CORS policy: Cross origin requests are only supported for protocol schemes: http, data, isolated-app, chrome-extension, chrome, https, chrome-untrusted.</blockquote><blockquote><p>Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at file:///foo/bar.js. (Reason: CORS request not http).</blockquote><p>See <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSRequestNotHttp">Reason: CORS request not HTTP - HTTP | MDN</a> for more information about why this happens.<p>You will need to access the file with <code>http</code> protocol. The easiest way to achieve this is to run <code>npx vite preview</code>.</section></section><section id="others"class="level2"><h2>Others</h2><section id="syntax-error--type-error-happens"class="level3"><h3>Syntax Error / Type Error happens</h3><p>Vite cannot handle and does not support code that only runs on non-strict mode (sloppy mode). This is because Vite uses ESM and it is always <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode">strict mode</a> inside ESM.<p>For example, you might see these errors.<blockquote><p>[ERROR] With statements cannot be used with the "esm" output format due to strict mode</blockquote><blockquote><p>TypeError: Cannot create property 'foo' on boolean 'false'</blockquote><p>If these code are used inside dependencies, you could use <a href="https://github.com/ds300/patch-package"><code>patch-package</code></a> (or <a href="https://yarnpkg.com/cli/patch"><code>yarn patch</code></a> or <a href="https://pnpm.io/cli/patch"><code>pnpm patch</code></a>) for an escape hatch. <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section></section>