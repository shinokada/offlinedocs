<!doctype html><html lang="en"><meta charset="utf-8"><title>Env Variables and Modes</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="env-variables-and-modes"><h1 id="env-variables-and-modes">Env Variables and Modes</h1><section class="level2"aria-labelledby="env-variables"><h2 id="env-variables">Env Variables</h2><p>Vite exposes env variables on the special <strong><code>import.meta.env</code></strong> object, which are statically replaced at build time. Some built-in variables are available in all cases:<ul><li><p><strong><code>import.meta.env.MODE</code></strong>: {string} the <a href="#modes">mode</a> the app is running in.<li><p><strong><code>import.meta.env.BASE_URL</code></strong>: {string} the base url the app is being served from. This is determined by the <a href="/config/shared-options.md#base"><code>base</code> config option</a>.<li><p><strong><code>import.meta.env.PROD</code></strong>: {boolean} whether the app is running in production (running the dev server with <code>NODE_ENV='production'</code> or running an app built with <code>NODE_ENV='production'</code>).<li><p><strong><code>import.meta.env.DEV</code></strong>: {boolean} whether the app is running in development (always the opposite of <code>import.meta.env.PROD</code>)<li><p><strong><code>import.meta.env.SSR</code></strong>: {boolean} whether the app is running in the <a href="./ssr.md.html#conditional-logic">server</a>.</ul></section><section class="level2"aria-labelledby="env-files"><h2 id="env-files"><code>.env</code> Files</h2><p>Vite uses <a href="https://github.com/motdotla/dotenv">dotenv</a> to load additional environment variables from the following files in your <a href="/config/shared-options.md#envdir">environment directory</a>:<pre class="language-text"><code class="language-text">.env                # loaded in all cases
.env.local          # loaded in all cases, ignored by git
.env.[mode]         # only loaded in specified mode
.env.[mode].local   # only loaded in specified mode, ignored by git</code></pre><blockquote>Env Loading Priorities<p>An env file for a specific mode (e.g. <code>.env.production</code>) will take higher priority than a generic one (e.g. <code>.env</code>).<p>In addition, environment variables that already exist when Vite is executed have the highest priority and will not be overwritten by <code>.env</code> files. For example, when running <code>VITE_SOME_KEY=123 vite build</code>.<p><code>.env</code> files are loaded at the start of Vite. Restart the server after making changes.</blockquote><p>Loaded env variables are also exposed to your client source code via <code>import.meta.env</code> as strings.<p>To prevent accidentally leaking env variables to the client, only variables prefixed with <code>VITE_</code> are exposed to your Vite-processed code. e.g. for the following env variables:<pre class="language-[.env]"><code class="language-[.env]">VITE_SOME_KEY=123
DB_PASSWORD=foobar</code></pre><p>Only <code>VITE_SOME_KEY</code> will be exposed as <code>import.meta.env.VITE_SOME_KEY</code> to your client source code, but <code>DB_PASSWORD</code> will not.<pre class="language-js"><code class="language-js"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token keyword module">import</span><span class="token punctuation">.</span><span class="token property-access">meta</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">VITE_SOME_KEY</span><span class="token punctuation">)</span> <span class="token comment">// "123"</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token keyword module">import</span><span class="token punctuation">.</span><span class="token property-access">meta</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">DB_PASSWORD</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span></code></pre><blockquote>Env parsing<p>As shown above, <code>VITE_SOME_KEY</code> is a number but returns a string when parsed. The same would also happen for boolean env variables. Make sure to convert to the desired type when using it in your code.</blockquote><p>Also, Vite uses <a href="https://github.com/motdotla/dotenv-expand">dotenv-expand</a> to expand variables written in env files out of the box. To learn more about the syntax, check out <a href="https://github.com/motdotla/dotenv-expand#what-rules-does-the-expansion-engine-follow">their docs</a>.<p>Note that if you want to use <code>$</code> inside your environment value, you have to escape it with <code>\</code>.<pre class="language-[.env]"><code class="language-[.env]">KEY=123
NEW_KEY1=test$foo   # test
NEW_KEY2=test\$foo  # test$foo
NEW_KEY3=test$KEY   # test123</code></pre><p>If you want to customize the env variables prefix, see the <a href="/config/shared-options.html#envprefix">envPrefix</a> option.</p>warning SECURITY NOTES<ul><li><p><code>.env.*.local</code> files are local-only and can contain sensitive variables. You should add <code>*.local</code> to your <code>.gitignore</code> to avoid them being checked into git.<li><p>Since any variables exposed to your Vite source code will end up in your client bundle, <code>VITE_*</code> variables should <em>not</em> contain any sensitive information.</ul><section class="level3"aria-labelledby="intellisense-for-typescript"><h3 id="intellisense-for-typescript">IntelliSense for TypeScript</h3><p>By default, Vite provides type definitions for <code>import.meta.env</code> in <a href="https://github.com/vitejs/vite/blob/main/packages/vite/client.d.ts"><code>vite/client.d.ts</code></a>. While you can define more custom env variables in <code>.env.[mode]</code> files, you may want to get TypeScript IntelliSense for user-defined env variables that are prefixed with <code>VITE_</code>.<p>To achieve this, you can create an <code>vite-env.d.ts</code> in <code>src</code> directory, then augment <code>ImportMetaEnv</code> like this:<pre class="language-typescript"><code class="language-typescript"><span class="token comment">/// &#x3C;reference types="vite/client" /></span>

<span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">ImportMetaEnv</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">readonly</span> <span class="token constant">VITE_APP_TITLE</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token comment">// more env variables...</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">ImportMeta</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">readonly</span> env<span class="token operator">:</span> <span class="token maybe-class-name">ImportMetaEnv</span>
<span class="token punctuation">}</span></code></pre><p>If your code relies on types from browser environments such as <a href="https://github.com/microsoft/TypeScript/blob/main/src/lib/dom.generated.d.ts">DOM</a> and <a href="https://github.com/microsoft/TypeScript/blob/main/src/lib/webworker.generated.d.ts">WebWorker</a>, you can update the <a href="https://www.typescriptlang.org/tsconfig#lib">lib</a> field in <code>tsconfig.json</code>.<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"lib"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"WebWorker"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></section>warning Imports will break type augmentation<p>If the <code>ImportMetaEnv</code> augmentation does not work, make sure you do not have any <code>import</code> statements in <code>vite-env.d.ts</code>. See the <a href="https://www.typescriptlang.org/docs/handbook/2/modules.html#how-javascript-modules-are-defined">TypeScript documentation</a> for more information.</section><section class="level2"aria-labelledby="html-env-replacement"><h2 id="html-env-replacement">HTML Env Replacement</h2><p>Vite also supports replacing env variables in HTML files. Any properties in <code>import.meta.env</code> can be used in HTML files with a special <code>%ENV_NAME%</code> syntax:<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>Vite is running in %MODE%<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>Using data from %VITE_API_URL%<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span></code></pre><p>If the env doesn't exist in <code>import.meta.env</code>, e.g. <code>%NON_EXISTENT%</code>, it will be ignored and not replaced, unlike <code>import.meta.env.NON_EXISTENT</code> in JS where it's replaced as <code>undefined</code>.<p>Given that Vite is used by many frameworks, it is intentionally unopinionated about complex replacements like conditionals. Vite can be extended using <a href="https://github.com/vitejs/awesome-vite#transformers">an existing userland plugin</a> or a custom plugin that implements the <a href="./api-plugin.html#transformindexhtml"><code>transformIndexHtml</code> hook</a>.</section><section class="level2"aria-labelledby="modes"><h2 id="modes">Modes</h2><p>By default, the dev server (<code>dev</code> command) runs in <code>development</code> mode and the <code>build</code> command runs in <code>production</code> mode.<p>This means when running <code>vite build</code>, it will load the env variables from <code>.env.production</code> if there is one:<pre class="language-text"><code class="language-text"># .env.production
VITE_APP_TITLE=My App</code></pre><p>In your app, you can render the title using <code>import.meta.env.VITE_APP_TITLE</code>.<p>In some cases, you may want to run <code>vite build</code> with a different mode to render a different title. You can overwrite the default mode used for a command by passing the <code>--mode</code> option flag. For example, if you want to build your app for a staging mode:<pre class="language-bash"><code class="language-bash">vite build --mode staging</code></pre><p>And create a <code>.env.staging</code> file:<pre class="language-text"><code class="language-text"># .env.staging
VITE_APP_TITLE=My App (staging)</code></pre><p>As <code>vite build</code> runs a production build by default, you can also change this and run a development build by using a different mode and <code>.env</code> file configuration:<pre class="language-text"><code class="language-text"># .env.testing
NODE_ENV=development</code></pre></section><section class="level2"aria-labelledby="node_env-and-modes"><h2 id="node_env-and-modes">NODE_ENV and Modes</h2><p>It's important to note that <code>NODE_ENV</code> (<code>process.env.NODE_ENV</code>) and modes are two different concepts. Here's how different commands affect the <code>NODE_ENV</code> and mode:<table><thead><tr><th>Command<th>NODE_ENV<th>Mode<tbody><tr><td><code>vite build</code><td><code>"production"</code><td><code>"production"</code><tr><td><code>vite build --mode development</code><td><code>"production"</code><td><code>"development"</code><tr><td><code>NODE_ENV=development vite build</code><td><code>"development"</code><td><code>"production"</code><tr><td><code>NODE_ENV=development vite build --mode development</code><td><code>"development"</code><td><code>"development"</code></table><p>The different values of <code>NODE_ENV</code> and mode also reflect on its corresponding <code>import.meta.env</code> properties:<table><thead><tr><th>Command<th><code>import.meta.env.PROD</code><th><code>import.meta.env.DEV</code><tbody><tr><td><code>NODE_ENV=production</code><td><code>true</code><td><code>false</code><tr><td><code>NODE_ENV=development</code><td><code>false</code><td><code>true</code><tr><td><code>NODE_ENV=other</code><td><code>false</code><td><code>true</code></table><table><thead><tr><th>Command<th><code>import.meta.env.MODE</code><tbody><tr><td><code>--mode production</code><td><code>"production"</code><tr><td><code>--mode development</code><td><code>"development"</code><tr><td><code>--mode staging</code><td><code>"staging"</code></table><blockquote>`NODE_ENV` in `.env` files<p><code>NODE_ENV=...</code> can be set in the command, and also in your <code>.env</code> file. If <code>NODE_ENV</code> is specified in a <code>.env.[mode]</code> file, the mode can be used to control its value. However, both <code>NODE_ENV</code> and modes remain as two different concepts.<p>The main benefit with <code>NODE_ENV=...</code> in the command is that it allows Vite to detect the value early. It also allows you to read <code>process.env.NODE_ENV</code> in your Vite config as Vite can only load the env files once the config is evaluated.</blockquote><span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section>