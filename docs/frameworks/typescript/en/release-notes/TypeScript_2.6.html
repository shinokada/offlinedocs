<!doctype html><html lang="en"><meta charset="utf-8"><title>TypeScript 2.6</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="layout"content="docs"><meta name="permalink"content="/docs/handbook/release-notes/typescript-2-6.html"><meta name="oneline"content="TypeScript 2.6 Release Notes"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="strict-function-types"class="level2"><h2>Strict function types</h2><p>TypeScript 2.6 introduces a new strict checking flag, <a href="/tsconfig#strictFunctionTypes"><code>strictFunctionTypes</code></a>. The <a href="/tsconfig#strictFunctionTypes"><code>strictFunctionTypes</code></a> switch is part of the <a href="/tsconfig#strict"><code>strict</code></a> family of switches, meaning that it defaults to on in <a href="/tsconfig#strict"><code>strict</code></a> mode. You can opt-out by setting <code>--strictFunctionTypes false</code> on your command line or in your tsconfig.json.<p>Under <a href="/tsconfig#strictFunctionTypes"><code>strictFunctionTypes</code></a> function type parameter positions are checked <em>contravariantly</em> instead of <em>bivariantly</em>. For some background on what variance means for function types check out <a href="https://www.stephanboyer.com/post/132/what-are-covariance-and-contravariance">What are covariance and contravariance?</a>.<p>The stricter checking applies to all function types, <em>except</em> those originating in method or constructor declarations. Methods are excluded specifically to ensure generic classes and interfaces (such as <code>Array&#x3C;T></code>) continue to mostly relate covariantly.<p>Consider the following example in which <code>Animal</code> is the supertype of <code>Dog</code> and <code>Cat</code>:<pre class="language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">let</span> <span class="token function-variable function">f1</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token maybe-class-name">Animal</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">let</span> <span class="token function-variable function">f2</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token maybe-class-name">Dog</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">let</span> <span class="token function-variable function">f3</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token maybe-class-name">Cat</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
f1 <span class="token operator">=</span> f2<span class="token punctuation">;</span> <span class="token comment">// Error with --strictFunctionTypes</span>
f2 <span class="token operator">=</span> f1<span class="token punctuation">;</span> <span class="token comment">// Ok</span>
f2 <span class="token operator">=</span> f3<span class="token punctuation">;</span> <span class="token comment">// Error</span></code></pre><p>The first assignment is permitted in default type checking mode, but flagged as an error in strict function types mode. Intuitively, the default mode permits the assignment because it is <em>possibly</em> sound, whereas strict function types mode makes it an error because it isn't <em>provably</em> sound. In either mode the third assignment is an error because it is <em>never</em> sound.<p>Another way to describe the example is that the type <code>(x: T) => void</code> is <em>bivariant</em> (i.e. covariant <em>or</em> contravariant) for <code>T</code> in default type checking mode, but <em>contravariant</em> for <code>T</code> in strict function types mode.<section id="example"class="level5"><h5>Example</h5><pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">Comparer</span><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">{</span>
  <span class="token function-variable function">compare</span><span class="token operator">:</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">let</span> animalComparer<span class="token operator">:</span> <span class="token maybe-class-name">Comparer</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Animal</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">let</span> dogComparer<span class="token operator">:</span> <span class="token maybe-class-name">Comparer</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Dog</span><span class="token operator">></span><span class="token punctuation">;</span>

animalComparer <span class="token operator">=</span> dogComparer<span class="token punctuation">;</span> <span class="token comment">// Error</span>
dogComparer <span class="token operator">=</span> animalComparer<span class="token punctuation">;</span> <span class="token comment">// Ok</span></code></pre><p>The first assignment is now an error. Effectively, <code>T</code> is contravariant in <code>Comparer&#x3C;T></code> because it is used only in function type parameter positions.<p>By the way, note that whereas some languages (e.g. C# and Scala) require variance annotations (<code>out</code>/<code>in</code> or <code>+</code>/<code>-</code>), variance emerges naturally from the actual use of a type parameter within a generic type due to TypeScript's structural type system.</section><section id="note"class="level5"><h5>Note</h5><p>Under <a href="/tsconfig#strictFunctionTypes"><code>strictFunctionTypes</code></a> the first assignment is still permitted if <code>compare</code> was declared as a method. Effectively, <code>T</code> is bivariant in <code>Comparer&#x3C;T></code> because it is used only in method parameter positions.<pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">Comparer</span><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">{</span>
  <span class="token function">compare</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">let</span> animalComparer<span class="token operator">:</span> <span class="token maybe-class-name">Comparer</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Animal</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">let</span> dogComparer<span class="token operator">:</span> <span class="token maybe-class-name">Comparer</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Dog</span><span class="token operator">></span><span class="token punctuation">;</span>

animalComparer <span class="token operator">=</span> dogComparer<span class="token punctuation">;</span> <span class="token comment">// Ok because of bivariance</span>
dogComparer <span class="token operator">=</span> animalComparer<span class="token punctuation">;</span> <span class="token comment">// Ok</span></code></pre><p>TypeScript 2.6 also improves type inference involving contravariant positions:<pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">combine</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token spread operator">...</span>funcs<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> x <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> f <span class="token keyword">of</span> funcs<span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">animalFunc</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token maybe-class-name">Animal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">dogFunc</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token maybe-class-name">Dog</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">let</span> combined <span class="token operator">=</span> <span class="token function">combine</span><span class="token punctuation">(</span>animalFunc<span class="token punctuation">,</span> dogFunc<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (x: Dog) => void</span></code></pre><p>Above, all inferences for <code>T</code> originate in contravariant positions, and we therefore infer the <em>best common subtype</em> for <code>T</code>. This contrasts with inferences from covariant positions, where we infer the <em>best common supertype</em>.</section></section><section id="cache-tagged-template-objects-in-modules"class="level2"><h2>Cache tagged template objects in modules</h2><p>TypeScript 2.6 fixes the tagged string template emit to align better with the ECMAScript spec. As per the <a href="https://tc39.github.io/ecma262/#sec-gettemplateobject">ECMAScript spec</a>, every time a template tag is evaluated, the <em>same</em> template strings object (the same <code>TemplateStringsArray</code>) should be passed as the first argument. Before TypeScript 2.6, the generated output was a completely new template object each time. Though the string contents are the same, this emit affects libraries that use the identity of the string for cache invalidation purposes, e.g. <a href="https://github.com/PolymerLabs/lit-html/issues/58">lit-html</a>.<section id="example-1"class="level5"><h5>Example</h5><pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">id</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token maybe-class-name">TemplateStringsArray</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">templateObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> id<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">hello world</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">templateObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">templateObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true in TS 2.6</span></code></pre><p>Results in the following generated code:<pre class="language-js"><code class="language-js"><span class="token string">"use strict"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> __makeTemplateObject <span class="token operator">=</span>
  <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">&#x26;&#x26;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__makeTemplateObject</span><span class="token punctuation">)</span> <span class="token operator">||</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cooked<span class="token punctuation">,</span> raw</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token property-access">defineProperty</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">defineProperty</span><span class="token punctuation">(</span>cooked<span class="token punctuation">,</span> <span class="token string">"raw"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> raw <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
      cooked<span class="token punctuation">.</span><span class="token property-access">raw</span> <span class="token operator">=</span> raw<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> cooked<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">id</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> _a<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">templateObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token function">id</span><span class="token punctuation">(</span>
    _a <span class="token operator">||</span> <span class="token punctuation">(</span>_a <span class="token operator">=</span> <span class="token function">__makeTemplateObject</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"hello world"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"hello world"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">templateObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">templateObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><blockquote><p>Note: This change brings a new emit helper, <code>__makeTemplateObject</code>; if you are using <a href="/tsconfig#importHelpers"><code>importHelpers</code></a> with <a href="https://github.com/Microsoft/tslib"><code>tslib</code></a>, an updated to version 1.8 or later.</blockquote></section></section><section id="localized-diagnostics-on-the-command-line"class="level2"><h2>Localized diagnostics on the command line</h2><p>TypeScript 2.6 npm package ships with localized versions of diagnostic messages for 13 languages. The localized messages are available when using <code>--locale</code> flag on the command line.<section id="example-2"class="level5"><h5>Example</h5><p>Error messages in Russian:<pre class="language-sh"><code class="language-sh">c:\ts>tsc --v
Version 2.6.0-dev.20171003

c:\ts>tsc --locale ru --pretty c:\test\a.ts

../test/a.ts(1,5): error TS2322: Тип ""string"" не может быть назначен для типа "number".

1 var x: number = "string";
      ~</code></pre><p>And help in Japanese:<pre class="language-sh"><code class="language-sh">PS C:\ts> tsc --v
Version 2.6.0-dev.20171003

PS C:\ts> tsc --locale ja-jp
バージョン 2.6.0-dev.20171003
構文: tsc [オプション] [ファイル ...]

例:  tsc hello.ts
    tsc --outFile file.js file.ts
    tsc @args.txt

オプション:
 -h, --help                                 このメッセージを表示します。
 --all                                      コンパイラ オプションをすべて表示します。
 -v, --version                              コンパイラのバージョンを表示します。
 --init                                     TypeScript プロジェクトを初期化して、tsconfig.json ファイルを作成します。
 -p ファイルまたはディレクトリ, --project ファイルまたはディレクトリ  構成ファイルか、'tsconfig.json' を含むフォルダーにパスが指定されたプロジェクトをコ
ンパイルします。
 --pretty                                   色とコンテキストを使用してエラーとメッセージにスタイルを適用します (試験的)。
 -w, --watch                                入力ファイルを監視します。
 -t バージョン, --target バージョン                   ECMAScript のターゲット バージョンを指定します: 'ES3' (既定)、'ES5'、'ES2015'、'ES2016'、'ES2017'、'ES
NEXT'。
 -m 種類, --module 種類                         モジュール コード生成を指定します: 'none'、'commonjs'、'amd'、'system'、'umd'、'es2015'、'ESNext'。
 --lib                                      コンパイルに含めるライブラリ ファイルを指定します:
                                              'es5' 'es6' 'es2015' 'es7' 'es2016' 'es2017' 'esnext' 'dom' 'dom.iterable' 'webworker' 'scripthost' 'es201
5.core' 'es2015.collection' 'es2015.generator' 'es2015.iterable' 'es2015.promise' 'es2015.proxy' 'es2015.reflect' 'es2015.symbol' 'es2015.symbol.wellkno
wn' 'es2016.array.include' 'es2017.object' 'es2017.sharedmemory' 'es2017.string' 'es2017.intl' 'esnext.asynciterable'
 --allowJs                                  javascript ファイルのコンパイルを許可します。
 --jsx 種類                                   JSX コード生成を指定します: 'preserve'、'react-native'、'react'。
 -d, --declaration                          対応する '.d.ts' ファイルを生成します。
 --sourceMap                                対応する '.map' ファイルを生成します。
 --outFile ファイル                             出力を連結して 1 つのファイルを生成します。
 --outDir ディレクトリ                            ディレクトリへ出力構造をリダイレクトします。
 --removeComments                           コメントを出力しないでください。
 --noEmit                                   出力しないでください。
 --strict                                   strict 型チェックのオプションをすべて有効にします。
 --noImplicitAny                            暗黙的な 'any' 型を含む式と宣言に関するエラーを発生させます。
 --strictNullChecks                         厳格な null チェックを有効にします。
 --noImplicitThis                           暗黙的な 'any' 型を持つ 'this' 式でエラーが発生します。
 --alwaysStrict                             厳格モードで解析してソース ファイルごとに "use strict" を生成します。
 --noUnusedLocals                           使用されていないローカルに関するエラーを報告します。
 --noUnusedParameters                       使用されていないパラメーターに関するエラーを報告します。
 --noImplicitReturns                        関数の一部のコード パスが値を返さない場合にエラーを報告します。
 --noFallthroughCasesInSwitch               switch ステートメントに case のフォールスルーがある場合にエラーを報告します。
 --types                                    コンパイルに含む型宣言ファイル。
 @&#x3C;ファイル></code></pre></section></section><section id="suppress-errors-in-ts-files-using--ts-ignore-comments"class="level2"><h2>Suppress errors in .ts files using '// @ts-ignore' comments</h2><p>TypeScript 2.6 support suppressing errors in .js files using <code>// @ts-ignore</code> comments placed above the offending lines.<section id="example-3"class="level5"><h5>Example</h5><pre class="language-ts"><code class="language-ts"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// @ts-ignore: Unreachable code error</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>A <code>// @ts-ignore</code> comment suppresses all errors that originate on the following line. It is recommended practice to have the remainder of the comment following <code>@ts-ignore</code> explain which error is being suppressed.<p>Please note that this comment only suppresses the error reporting, and we recommend you use this comments <em>very sparingly</em>.</section></section><section id="faster-tsc---watch"class="level2"><h2>Faster <code>tsc --watch</code></h2><p>TypeScript 2.6 brings a faster <code>--watch</code> implementation. The new version optimizes code generation and checking for code bases using ES modules. Changes detected in a module file will result in <em>only</em> regenerating the changed module, and files that depend on it, instead of the whole project. Projects with large number of files should reap the most benefit from this change.<p>The new implementation also brings performance enhancements to watching in tsserver. The watcher logic has been completely rewritten to respond faster to change events.</section><section id="write-only-references-now-flagged-as-unused"class="level2"><h2>Write-only references now flagged as unused</h2><p>TypeScript 2.6 adds revised implementation the <a href="/tsconfig#noUnusedLocals"><code>noUnusedLocals</code></a> and <a href="/tsconfig#noUnusedParameters"><code>noUnusedParameters</code></a> <a href="/docs/handbook/compiler-options.html">compiler options</a>. Declarations are only written to but never read from are now flagged as unused.<section id="example-4"class="level5"><h5>Example</h5><p>Bellow both <code>n</code> and <code>m</code> will be marked as unused, because their values are never <em>read</em>. Previously TypeScript would only check whether their values were <em>referenced</em>.<pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> m<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">m</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Also functions that are only called within their own bodies are considered unused.</section><section id="example-5"class="level5"><h5>Example</h5><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: 'f' is declared but its value is never read</span>
<span class="token punctuation">}</span></code></pre><p><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>