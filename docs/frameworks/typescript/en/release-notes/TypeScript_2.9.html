<!doctype html><html lang="en"><meta charset="utf-8"><title>TypeScript 2.9</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="layout"content="docs"><meta name="permalink"content="/docs/handbook/release-notes/typescript-2-9.html"><meta name="oneline"content="TypeScript 2.9 Release Notes"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="support-number-and-symbol-named-properties-with-keyof-and-mapped-types"class="level2"><h2>Support <code>number</code> and <code>symbol</code> named properties with <code>keyof</code> and mapped types</h2><p>TypeScript 2.9 adds support for <code>number</code> and <code>symbol</code> named properties in index types and mapped types. Previously, the <code>keyof</code> operator and mapped types only supported <code>string</code> named properties.<p>Changes include:<ul><li>An index type <code>keyof T</code> for some type <code>T</code> is a subtype of <code>string | number | symbol</code>.<li>A mapped type <code>{ [P in K]: XXX }</code> permits any <code>K</code> assignable to <code>string | number | symbol</code>.<li>In a <code>for...in</code> statement for an object of a generic type <code>T</code>, the inferred type of the iteration variable was previously <code>keyof T</code> but is now <code>Extract&#x3C;keyof T, string></code>. (In other words, the subset of <code>keyof T</code> that includes only string-like values.)</ul><p>Given an object type <code>X</code>, <code>keyof X</code> is resolved as follows:<ul><li>If <code>X</code> contains a string index signature, <code>keyof X</code> is a union of <code>string</code>, <code>number</code>, and the literal types representing symbol-like properties, otherwise<li>If <code>X</code> contains a numeric index signature, <code>keyof X</code> is a union of <code>number</code> and the literal types representing string-like and symbol-like properties, otherwise<li><code>keyof X</code> is a union of the literal types representing string-like, number-like, and symbol-like properties.</ul><p>Where:<ul><li>String-like properties of an object type are those declared using an identifier, a string literal, or a computed property name of a string literal type.<li>Number-like properties of an object type are those declared using a numeric literal or computed property name of a numeric literal type.<li>Symbol-like properties of an object type are those declared using a computed property name of a unique symbol type.</ul><p>In a mapped type <code>{ [P in K]: XXX }</code>, each string literal type in <code>K</code> introduces a property with a string name, each numeric literal type in <code>K</code> introduces a property with a numeric name, and each unique symbol type in <code>K</code> introduces a property with a unique symbol name. Furthermore, if <code>K</code> includes type <code>string</code>, a string index signature is introduced, and if <code>K</code> includes type <code>number</code>, a numeric index signature is introduced.<section id="example"class="level5"><h5>Example</h5><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token string">"c"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> d <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> e <span class="token operator">=</span> <span class="token known-class-name class-name">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">enum</span> <span class="token constant">E1</span> <span class="token punctuation">{</span>
  <span class="token constant">A</span><span class="token punctuation">,</span>
  <span class="token constant">B</span><span class="token punctuation">,</span>
  <span class="token constant">C</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token keyword">enum</span> <span class="token constant">E2</span> <span class="token punctuation">{</span>
  <span class="token constant">A</span> <span class="token operator">=</span> <span class="token string">"A"</span><span class="token punctuation">,</span>
  <span class="token constant">B</span> <span class="token operator">=</span> <span class="token string">"B"</span><span class="token punctuation">,</span>
  <span class="token constant">C</span> <span class="token operator">=</span> <span class="token string">"C"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token maybe-class-name">Foo</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// String-like name</span>
  <span class="token number">5</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// Number-like name</span>
  <span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// String-like name</span>
  <span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// Number-like name</span>
  <span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// Symbol-like name</span>
  <span class="token punctuation">[</span><span class="token constant">E1</span><span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// Number-like name</span>
  <span class="token punctuation">[</span><span class="token constant">E2</span><span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// String-like name</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">K1</span></span> <span class="token operator">=</span> <span class="token keyword">keyof</span> <span class="token maybe-class-name">Foo</span><span class="token punctuation">;</span> <span class="token comment">// "a" | 5 | "c" | 10 | typeof e | E1.A | E2.A</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">K2</span></span> <span class="token operator">=</span> <span class="token maybe-class-name">Extract</span><span class="token operator">&#x3C;</span><span class="token keyword">keyof</span> <span class="token maybe-class-name">Foo</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// "a" | "c" | E2.A</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">K3</span></span> <span class="token operator">=</span> <span class="token maybe-class-name">Extract</span><span class="token operator">&#x3C;</span><span class="token keyword">keyof</span> <span class="token maybe-class-name">Foo</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// 5 | 10 | E1.A</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">K4</span></span> <span class="token operator">=</span> <span class="token maybe-class-name">Extract</span><span class="token operator">&#x3C;</span><span class="token keyword">keyof</span> <span class="token maybe-class-name">Foo</span><span class="token punctuation">,</span> <span class="token builtin">symbol</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// typeof e</span></code></pre><p>Since <code>keyof</code> now reflects the presence of a numeric index signature by including type <code>number</code> in the key type, mapped types such as <code>Partial&#x3C;T></code> and <code>Readonly&#x3C;T></code> work correctly when applied to object types with numeric index signatures:<pre class="language-ts"><code class="language-ts"><span class="token keyword">type</span> <span class="token class-name"><span class="token maybe-class-name">Arrayish</span><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token punctuation">[</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token maybe-class-name">ReadonlyArrayish</span><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token maybe-class-name">Readonly</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Arrayish</span><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">>></span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">const</span> map<span class="token operator">:</span> <span class="token maybe-class-name">ReadonlyArrayish</span><span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">let</span> n <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> map<span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Previously of type any (or an error with --noImplicitAny)</span></code></pre><p>Furthermore, with the <code>keyof</code> operator's support for <code>number</code> and <code>symbol</code> named keys, it is now possible to abstract over access to properties of objects that are indexed by numeric literals (such as numeric enum types) and unique symbols.<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token keyword">enum</span> <span class="token maybe-class-name">Enum</span> <span class="token punctuation">{</span>
  <span class="token constant">A</span><span class="token punctuation">,</span>
  <span class="token constant">B</span><span class="token punctuation">,</span>
  <span class="token constant">C</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> enumToStringMap <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token maybe-class-name">Enum</span><span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">"Name A"</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token maybe-class-name">Enum</span><span class="token punctuation">.</span><span class="token constant">B</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">"Name B"</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token maybe-class-name">Enum</span><span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">"Name C"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> sym1 <span class="token operator">=</span> <span class="token known-class-name class-name">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sym2 <span class="token operator">=</span> <span class="token known-class-name class-name">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sym3 <span class="token operator">=</span> <span class="token known-class-name class-name">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> symbolToNumberMap <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>sym1<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>sym2<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>sym3<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">KE</span></span> <span class="token operator">=</span> <span class="token keyword">keyof</span> <span class="token keyword">typeof</span> enumToStringMap<span class="token punctuation">;</span> <span class="token comment">// Enum (i.e. Enum.A | Enum.B | Enum.C)</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">KS</span></span> <span class="token operator">=</span> <span class="token keyword">keyof</span> <span class="token keyword">typeof</span> symbolToNumberMap<span class="token punctuation">;</span> <span class="token comment">// typeof sym1 | typeof sym2 | typeof sym3</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getValue</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> x1 <span class="token operator">=</span> <span class="token function">getValue</span><span class="token punctuation">(</span>enumToStringMap<span class="token punctuation">,</span> <span class="token maybe-class-name">Enum</span><span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Returns "Name C"</span>
<span class="token keyword">let</span> x2 <span class="token operator">=</span> <span class="token function">getValue</span><span class="token punctuation">(</span>symbolToNumberMap<span class="token punctuation">,</span> sym3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Returns 3</span></code></pre><p>This is a breaking change; previously, the <code>keyof</code> operator and mapped types only supported <code>string</code> named properties. Code that assumed values typed with <code>keyof T</code> were always <code>string</code>s, will now be flagged as error.</section><section id="example-1"class="level5"><h5>Example</h5><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useKey</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> k<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> k<span class="token punctuation">;</span> <span class="token comment">// Error: keyof T is not assignable to string</span>
<span class="token punctuation">}</span></code></pre></section><section id="recommendations"class="level4"><h4>Recommendations</h4><ul><li><p>If your functions are only able to handle string named property keys, use <code>Extract&#x3C;keyof T, string></code> in the declaration:<pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useKey</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token maybe-class-name">Extract</span><span class="token operator">&#x3C;</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">>></span></span></span><span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> k<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> k<span class="token punctuation">;</span> <span class="token comment">// OK</span>
<span class="token punctuation">}</span></code></pre><li><p>If your functions are open to handling all property keys, then the changes should be done down-stream:<pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useKey</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> k<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">symbol</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><li><p>Otherwise use <a href="/tsconfig#keyofStringsOnly"><code>keyofStringsOnly</code></a> compiler option to disable the new behavior.</ul></section></section><section id="generic-type-arguments-in-jsx-elements"class="level2"><h2>Generic type arguments in JSX elements</h2><p>JSX elements now allow passing type arguments to generic components.<section id="example-2"class="level5"><h5>Example</h5><pre class="language-ts"><code class="language-ts"><span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">GenericComponent</span><span class="token operator">&#x3C;</span><span class="token constant">P</span><span class="token operator">></span></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token maybe-class-name">React</span></span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Component</span></span><span class="token operator">&#x3C;</span><span class="token constant">P</span><span class="token operator">></span> <span class="token punctuation">{</span>
  internalProp<span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token maybe-class-name">Props</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> b<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">GenericComponent</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Props</span><span class="token operator">></span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span> b<span class="token operator">=</span><span class="token string">"hi"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// OK</span>

<span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">GenericComponent</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Props</span><span class="token operator">></span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span> b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">20</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// Error</span></code></pre></section></section><section id="generic-type-arguments-in-generic-tagged-templates"class="level2"><h2>Generic type arguments in generic tagged templates</h2><p>Tagged templates are a form of invocation introduced in ECMAScript 2015. Like call expressions, generic functions may be used in a tagged template and TypeScript will infer the type arguments utilized.<p>TypeScript 2.9 allows passing generic type arguments to tagged template strings.<section id="example-3"class="level5"><h5>Example</h5><pre class="language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">styledComponent</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Props</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
  strs<span class="token operator">:</span> <span class="token maybe-class-name">TemplateStringsArray</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">Component</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Props</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">MyProps</span></span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

styledComponent<span class="token operator">&#x3C;</span><span class="token maybe-class-name">MyProps</span><span class="token operator">></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  font-size: 1.5em;
  text-align: center;
  color: palevioletred;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">tag</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>strs<span class="token operator">:</span> <span class="token maybe-class-name">TemplateStringsArray</span><span class="token punctuation">,</span> <span class="token spread operator">...</span>args<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// inference fails because 'number' and 'string' are both candidates that conflict</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> tag<span class="token operator">&#x3C;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token operator">></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">100</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token string">"hello"</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre></section></section><section id="import-types"class="level2"><h2><code>import</code> types</h2><p>Modules can import types declared in other modules. But non-module global scripts cannot access types declared in modules. Enter <code>import</code> types.<p>Using <code>import("mod")</code> in a type annotation allows for reaching in a module and accessing its exported declaration without importing it.<section id="example-4"class="level5"><h5>Example</h5><p>Given a declaration of a class <code>Pet</code> in a module file:<pre class="language-ts"><code class="language-ts"><span class="token comment">// module.d.ts</span>

<span class="token keyword module">export</span> <span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">Pet</span></span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Can be used in a non-module file <code>global-script.ts</code>:<pre class="language-ts"><code class="language-ts"><span class="token comment">// global-script.ts</span>

<span class="token keyword">function</span> <span class="token function">adopt</span><span class="token punctuation">(</span>p<span class="token operator">:</span> <span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">"./module"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Pet</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Adopting </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>p<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>This also works in JSDoc comments to refer to types from other modules in <code>.js</code>:<pre class="language-js"><code class="language-js"><span class="token comment">// a.js</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token parameter">p</span> <span class="token punctuation">{</span> import("./module").Pet <span class="token punctuation">}</span>
 */</span>
<span class="token keyword">function</span> <span class="token function">walk</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Walking </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>p<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section></section><section id="relaxing-declaration-emit-visiblity-rules"class="level2"><h2>Relaxing declaration emit visiblity rules</h2><p>With <code>import</code> types available, many of the visibility errors reported during declaration file generation can be handled by the compiler without the need to change the input.<p>For instance:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createHash <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"crypto"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">const</span> hash <span class="token operator">=</span> <span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">"sha256"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//           ^^^^</span>
<span class="token comment">// Exported variable 'hash' has or is using name 'Hash' from external module "crypto" but cannot be named.</span></code></pre><p>With TypeScript 2.9, no errors are reported, and now the generated file looks like:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> hash<span class="token operator">:</span> <span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">"crypto"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Hash</span></span><span class="token punctuation">;</span></code></pre></section><section id="support-for-importmeta"class="level2"><h2>Support for <code>import.meta</code></h2><p>TypeScript 2.9 introduces support for <code>import.meta</code>, a new meta-property as described by the current <a href="https://github.com/tc39/proposal-import-meta">TC39 proposal</a>.<p>The type of <code>import.meta</code> is the global <code>ImportMeta</code> type which is defined in <code>lib.es5.d.ts</code>. This interface is extremely limited. Adding well-known properties for Node or browsers requires interface merging and possibly a global augmentation depending on the context.<section id="example-5"class="level5"><h5>Example</h5><p>Assuming that <code>__dirname</code> is always available on <code>import.meta</code>, the declaration would be done through reopening <code>ImportMeta</code> interface:<pre class="language-ts"><code class="language-ts"><span class="token comment">// node.d.ts</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">ImportMeta</span></span> <span class="token punctuation">{</span>
  __dirname<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>And usage would be:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span><span class="token punctuation">.</span><span class="token property-access">meta</span><span class="token punctuation">.</span><span class="token property-access">__dirname</span><span class="token punctuation">;</span> <span class="token comment">// Has type 'string'</span></code></pre><p><code>import.meta</code> is only allowed when targeting <code>ESNext</code> modules and ECMAScript targets.</section></section><section id="new---resolvejsonmodule"class="level2"><h2>New <code>--resolveJsonModule</code></h2><p>Often in Node.js applications a <code>.json</code> is needed. With TypeScript 2.9, <a href="/tsconfig#resolveJsonModule"><code>resolveJsonModule</code></a> allows for importing, extracting types from and generating <code>.json</code> files.<section id="example-6"class="level5"><h5>Example</h5><pre class="language-ts"><code class="language-ts"><span class="token comment">// settings.json</span>

<span class="token punctuation">{</span>
    <span class="token string-property property">"repo"</span><span class="token operator">:</span> <span class="token string">"TypeScript"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"dry"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">"debug"</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span></code></pre><pre class="language-ts"><code class="language-ts"><span class="token comment">// a.ts</span>

<span class="token keyword module">import</span> <span class="token imports">settings</span> <span class="token keyword module">from</span> <span class="token string">"./settings.json"</span><span class="token punctuation">;</span>

settings<span class="token punctuation">.</span><span class="token property-access">debug</span> <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
settings<span class="token punctuation">.</span><span class="token property-access">dry</span> <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// Error: Operator '===' cannot be applied boolean and number</span></code></pre><pre class="language-json"><code class="language-json"><span class="token comment">// tsconfig.json</span>

<span class="token punctuation">{</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"commonjs"</span><span class="token punctuation">,</span>
    <span class="token property">"resolveJsonModule"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"esModuleInterop"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></section></section><section id="--pretty-output-by-default"class="level2"><h2><code>--pretty</code> output by default</h2><p>Starting TypeScript 2.9 errors are displayed under <a href="/tsconfig#pretty"><code>pretty</code></a> by default if the output device is applicable for colorful text. TypeScript will check if the output stream has <a href="https://nodejs.org/api/tty.html"><code>isTty</code></a> property set.<p>Use <code>--pretty false</code> on the command line or set <code>"pretty": false</code> in your <code>tsconfig.json</code> to disable <a href="/tsconfig#pretty"><code>pretty</code></a> output.</section><section id="new---declarationmap"class="level2"><h2>New <code>--declarationMap</code></h2><p>Enabling <a href="/tsconfig#declarationMap"><code>declarationMap</code></a> alongside <a href="/tsconfig#declaration"><code>declaration</code></a> causes the compiler to emit <code>.d.ts.map</code> files alongside the output <code>.d.ts</code> files. Language Services can also now understand these map files, and uses them to map declaration-file based definition locations to their original source, when available.<p>In other words, hitting go-to-definition on a declaration from a <code>.d.ts</code> file generated with <a href="/tsconfig#declarationMap"><code>declarationMap</code></a> will take you to the source file (<code>.ts</code>) location where that declaration was defined, and not to the <code>.d.ts</code>. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section>