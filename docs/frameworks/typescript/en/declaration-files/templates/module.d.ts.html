<!doctype html><html lang="en"><meta charset="utf-8"><title>Modules .d.ts</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="layout"content="docs"><meta name="permalink"content="/docs/handbook/declaration-files/templates/module-d-ts.html"><link rel="stylesheet"href="../../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="comparing-javascript-to-an-example-dts"class="level2"><h2>Comparing JavaScript to an example DTS</h2></section><section id="common-commonjs-patterns"class="level2"><h2>Common CommonJS Patterns</h2><p>A module using CommonJS patterns uses <code>module.exports</code> to describe the exported values. For example, here is a module which exports a function and a numerical constant:<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> maxInterval <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getArrayLength</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> arr<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  getArrayLength<span class="token punctuation">,</span>
  maxInterval<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>This can be described by the following <code>.d.ts</code>:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">getArrayLength</span><span class="token punctuation">(</span>arr<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword module">export</span> <span class="token keyword">const</span> maxInterval<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">;</span></code></pre><p>The TypeScript playground can show you the <code>.d.ts</code> equivalent for JavaScript code. You can <a href="/play?useJavaScript=true#code/GYVwdgxgLglg9mABAcwKZQIICcsEMCeAMqmMlABYAUuOAlIgN6IBQiiW6IWSNWAdABsSZcswC+zCAgDOURAFtcADwAq5GKUQBeRAEYATM2by4AExBC+qJQAc4WKNO2NWKdNjxFhFADSvFquqk4sxAA">try it yourself here</a>.<p>The <code>.d.ts</code> syntax intentionally looks like <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">ES Modules</a> syntax. ES Modules was ratified by TC39 in 2019, while it has been available via transpilers for a long time, however if you have a JavaScript codebase using ES Modules:<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">getArrayLength</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> arr<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>This would have the following <code>.d.ts</code> equivalent:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">getArrayLength</span><span class="token punctuation">(</span>arr<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></code></pre><section id="default-exports"class="level3"><h3>Default Exports</h3><p>In CommonJS you can export any value as the default export, for example here is a regular expression module:<pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">hello( world)?</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span></code></pre><p>Which can be described by the following .d.ts:<pre class="language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">const</span> helloWorld<span class="token operator">:</span> <span class="token known-class-name class-name">RegExp</span><span class="token punctuation">;</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> helloWorld<span class="token punctuation">;</span></code></pre><p>Or a number:<pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token number">3.142</span><span class="token punctuation">;</span></code></pre><pre class="language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">const</span> pi<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> pi<span class="token punctuation">;</span></code></pre><p>One style of exporting in CommonJS is to export a function. Because a function is also an object, then extra fields can be added and are included in the export.<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getArrayLength</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> arr<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
getArrayLength<span class="token punctuation">.</span><span class="token property-access">maxInterval</span> <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> getArrayLength<span class="token punctuation">;</span></code></pre><p>Which can be described with:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function">getArrayLength</span><span class="token punctuation">(</span>arr<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword module">export</span> <span class="token keyword">const</span> maxInterval<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">;</span></code></pre><p>Note that using <code>export default</code> in your .d.ts files requires <a href="/tsconfig#esModuleInterop"><code>esModuleInterop: true</code></a> to work. If you can't have <code>esModuleInterop: true</code> in your project, such as when you're submitting a PR to Definitely Typed, you'll have to use the <code>export=</code> syntax instead. This older syntax is harder to use but works everywhere. Here's how the above example would have to be written using <code>export=</code>:<pre class="language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">getArrayLength</span><span class="token punctuation">(</span>arr<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">namespace</span> getArrayLength <span class="token punctuation">{</span>
  <span class="token keyword">declare</span> <span class="token keyword">const</span> maxInterval<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token operator">=</span> getArrayLength<span class="token punctuation">;</span></code></pre><p>See <a href="/docs/handbook/declaration-files/templates/module-function-d-ts.html">Module: Functions</a> for details of how that works, and the <a href="/docs/handbook/modules.html">Modules reference</a> page.</section></section><section id="handling-many-consuming-import"class="level2"><h2>Handling Many Consuming Import</h2><p>There are many ways to import a module in modern consuming code:<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> fastify <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">"fastify"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> fastify <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">"fastify"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> fastify <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">"fastify"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> <span class="token maybe-class-name">Fastify</span></span> <span class="token keyword module">from</span> <span class="token string">"fastify"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> fastify<span class="token punctuation">,</span> <span class="token maybe-class-name">FastifyInstance</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"fastify"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports">fastify</span> <span class="token keyword module">from</span> <span class="token string">"fastify"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports">fastify<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">FastifyInstance</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"fastify"</span><span class="token punctuation">;</span></code></pre><p>Covering all of these cases requires the JavaScript code to actually support all of these patterns. To support many of these patterns, a CommonJS module would need to look something like:<pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">FastifyInstance</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fastify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">FastifyInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

fastify<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">FastifyInstance</span></span> <span class="token operator">=</span> <span class="token maybe-class-name">FastifyInstance</span><span class="token punctuation">;</span>

<span class="token comment">// Allows for { fastify }</span>
fastify<span class="token punctuation">.</span><span class="token property-access">fastify</span> <span class="token operator">=</span> fastify<span class="token punctuation">;</span>
<span class="token comment">// Allows for strict ES Module support</span>
fastify<span class="token punctuation">.</span><span class="token keyword module">default</span> <span class="token operator">=</span> fastify<span class="token punctuation">;</span>
<span class="token comment">// Sets the default export</span>
module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> fastify<span class="token punctuation">;</span></code></pre></section><section id="types-in-modules"class="level2"><h2>Types in Modules</h2><p>You may want to provide a type for JavaScript code which does not exist<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getArrayMetadata</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token function">getArrayLength</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">firstObject</span><span class="token operator">:</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  getArrayMetadata<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>This can be described with:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">type</span> <span class="token class-name"><span class="token maybe-class-name">ArrayMetadata</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  firstObject<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">|</span> <span class="token keyword nil">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">getArrayMetadata</span><span class="token punctuation">(</span>arr<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">ArrayMetadata</span><span class="token punctuation">;</span></code></pre><p>This example is a good case for <a href="/docs/handbook/generics.html#generic-types">using generics</a> to provide richer type information:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">type</span> <span class="token class-name"><span class="token maybe-class-name">ArrayMetadata</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">ArrType</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  firstObject<span class="token operator">:</span> <span class="token maybe-class-name">ArrType</span> <span class="token operator">|</span> <span class="token keyword nil">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getArrayMetadata</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">ArrType</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
  arr<span class="token operator">:</span> <span class="token maybe-class-name">ArrType</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">ArrayMetadata</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">ArrType</span><span class="token operator">></span><span class="token punctuation">;</span></code></pre><p>Now the type of the array propagates into the <code>ArrayMetadata</code> type.<p>The types which are exported can then be re-used by consumers of the modules using either <code>import</code> or <code>import type</code> in TypeScript code or <a href="/docs/handbook/jsdoc-supported-types.html#import-types">JSDoc imports</a>.<section id="namespaces-in-module-code"class="level3"><h3>Namespaces in Module Code</h3><p>Trying to describe the runtime relationship of JavaScript code can be tricky. When the ES Module-like syntax doesn't provide enough tools to describe the exports then you can use <code>namespaces</code>.<p>For example, you may have complex enough types to describe that you choose to namespace them inside your <code>.d.ts</code>:<pre class="language-ts"><code class="language-ts"><span class="token comment">// This represents the JavaScript class which would be available at runtime</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token constant">API</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>baseURL<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">getInfo</span><span class="token punctuation">(</span>opts<span class="token operator">:</span> <span class="token constant">API</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">InfoRequest</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">API</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">InfoResponse</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// This namespace is merged with the API class and allows for consumers, and this file</span>
<span class="token comment">// to have types which are nested away in their own sections.</span>
<span class="token keyword">declare</span> <span class="token keyword">namespace</span> <span class="token constant">API</span> <span class="token punctuation">{</span>
  <span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">InfoRequest</span></span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">InfoResponse</span></span> <span class="token punctuation">{</span>
    width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>To understand how namespaces work in <code>.d.ts</code> files read the <a href="/docs/handbook/declaration-files/deep-dive.html"><code>.d.ts</code> deep dive</a>.</section><section id="optional-global-usage"class="level3"><h3>Optional Global Usage</h3><p>You can use <code>export as namespace</code> to declare that your module will be available in the global scope in UMD contexts:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword module">as</span> <span class="token keyword">namespace</span> moduleName<span class="token punctuation">;</span></code></pre></section></section><section id="reference-example"class="level2"><h2>Reference Example</h2><p>To give you an idea of how all these pieces can come together, here is a reference <code>.d.ts</code> to start with when making a new module<pre class="language-ts"><code class="language-ts"><span class="token comment">// Type definitions for [~THE LIBRARY NAME~] [~OPTIONAL VERSION NUMBER~]</span>
<span class="token comment">// Project: [~THE PROJECT NAME~]</span>
<span class="token comment">// Definitions by: [~YOUR NAME~] &#x3C;[~A URL FOR YOU~]></span>

<span class="token comment">/*~ This is the module template file. You should rename it to index.d.ts
 *~ and place it in a folder with the same name as the module.
 *~ For example, if you were writing a file for "super-greeter", this
 *~ file should be 'super-greeter/index.d.ts'
 */</span>

<span class="token comment">/*~ If this module is a UMD module that exposes a global variable 'myLib' when
 *~ loaded outside a module loader environment, declare that global here.
 *~ Otherwise, delete this declaration.
 */</span>
<span class="token keyword module">export</span> <span class="token keyword module">as</span> <span class="token keyword">namespace</span> myLib<span class="token punctuation">;</span>

<span class="token comment">/*~ If this module exports functions, declare them like so.
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">myFunction</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">myOtherFunction</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

<span class="token comment">/*~ You can declare types that are available via importing the module */</span>
<span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">SomeType</span></span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  extras<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*~ You can declare properties of the module using const, let, or var */</span>
<span class="token keyword module">export</span> <span class="token keyword">const</span> myField<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></code></pre><section id="library-file-layout"class="level3"><h3>Library file layout</h3><p>The layout of your declaration files should mirror the layout of the library.<p>A library can consist of multiple modules, such as<pre class="language-text"><code class="language-text">myLib
  +---- index.js
  +---- foo.js
  +---- bar
         +---- index.js
         +---- baz.js</code></pre><p>These could be imported as<pre class="language-js"><code class="language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"myLib"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"myLib/foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"myLib/bar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"myLib/bar/baz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Your declaration files should thus be<pre class="language-text"><code class="language-text">@types/myLib
  +---- index.d.ts
  +---- foo.d.ts
  +---- bar
         +---- index.d.ts
         +---- baz.d.ts</code></pre></section><section id="testing-your-types"class="level3"><h3>Testing your types</h3><p>If you are planning on submitting these changes to DefinitelyTyped for everyone to also use, then we recommend you:<blockquote><ol><li>Create a new folder in <code>node_modules/@types/[libname]</code><li>Create an <code>index.d.ts</code> in that folder, and copy the example in<li>See where your usage of the module breaks, and start to fill out the index.d.ts<li>When you're happy, clone <a href="https://github.com/DefinitelyTyped">DefinitelyTyped/DefinitelyTyped</a> and follow the instructions in the README.</ol></blockquote><p>Otherwise<blockquote><ol><li>Create a new file in the root of your source tree: <code>[libname].d.ts</code><li>Add <code>declare module "[libname]" { }</code><li>Add the template inside the braces of the declare module, and see where your usage breaks <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></ol></blockquote></section></section>