<!doctype html><html lang="en"><meta charset="utf-8"><title>Interfaces</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="interfaces"class="level3"><h3>Interfaces</h3><p>Like many type systems, GraphQL supports interfaces. An <strong>Interface</strong> is an abstract type that includes a certain set of fields that a type must include to implement the interface (read more <a href="https://graphql.org/learn/schema/#interfaces">here</a>).<section id="code-first"class="level4"><h4>Code first</h4><p>When using the code first approach, you define a GraphQL interface by creating an abstract class annotated with the <code>@InterfaceType()</code> decorator exported from the <code>@nestjs/graphql</code>.<pre class="language-typescript"><code class="language-typescript"><span class="token keyword module">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">Field</span><span class="token punctuation">,</span> <span class="token constant">ID</span><span class="token punctuation">,</span> <span class="token maybe-class-name">InterfaceType</span> <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">'@nestjs/graphql'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">InterfaceType</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">Character</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Field</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token constant">ID</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Field</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><blockquote><p>warning <strong>Warning</strong> TypeScript interfaces cannot be used to define GraphQL interfaces.</blockquote><p>This will result in generating the following part of the GraphQL schema in SDL:<pre class="language-graphql"><code class="language-graphql"><span class="token keyword">interface</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
  <span class="token attr-name">id</span><span class="token punctuation">:</span> <span class="token scalar">ID</span><span class="token operator">!</span>
  <span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token scalar">String</span><span class="token operator">!</span>
<span class="token punctuation">}</span></code></pre><p>Now, to implement the <code>Character</code> interface, use the <code>implements</code> key:<pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ObjectType</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">implements</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span><span class="token maybe-class-name">Character</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">Human</span></span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token maybe-class-name">Character</span></span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><blockquote><p>info <strong>Hint</strong> The <code>@ObjectType()</code> decorator is exported from the <code>@nestjs/graphql</code> package.</blockquote><p>The default <code>resolveType()</code> function generated by the library extracts the type based on the value returned from the resolver method. This means that you must return class instances (you cannot return literal JavaScript objects).<p>To provide a customized <code>resolveType()</code> function, pass the <code>resolveType</code> property to the options object passed into the <code>@InterfaceType()</code> decorator, as follows:<pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">InterfaceType</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">resolveType</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>book<span class="token punctuation">.</span><span class="token property-access">colors</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> <span class="token maybe-class-name">ColoringBook</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> <span class="token maybe-class-name">TextBook</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">Book</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Field</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token constant">ID</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Field</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section><section id="interface-resolvers"class="level4"><h4>Interface resolvers</h4><p>So far, using interfaces, you could only share field definitions with your objects. If you also want to share the actual field resolvers implementation, you can create a dedicated interface resolver, as follows:<pre class="language-typescript"><code class="language-typescript"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">Resolver</span><span class="token punctuation">,</span> <span class="token maybe-class-name">ResolveField</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Parent</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Info</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@nestjs/graphql'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Resolver</span></span><span class="token punctuation">(</span>type <span class="token arrow operator">=></span> <span class="token maybe-class-name">Character</span><span class="token punctuation">)</span> <span class="token comment">// Reminder: Character is an interface</span>
<span class="token class-name"><span class="token keyword module">export</span></span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CharacterInterfaceResolver</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ResolveField</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span><span class="token maybe-class-name">Character</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">friends</span><span class="token punctuation">(</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Parent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> character<span class="token punctuation">,</span> <span class="token comment">// Resolved object that implements Character</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Info</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> parentType <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Type of the object that implements Character</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Args</span></span><span class="token punctuation">(</span><span class="token string">'search'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token function-variable function">type</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token known-class-name class-name">String</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> searchTerm<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Get character's friends</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Now the <code>friends</code> field resolver is auto-registered for all object types that implement the <code>Character</code> interface.</section><section id="schema-first"class="level4"><h4>Schema first</h4><p>To define an interface in the schema first approach, simply create a GraphQL interface with SDL.<pre class="language-graphql"><code class="language-graphql"><span class="token keyword">interface</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
  <span class="token attr-name">id</span><span class="token punctuation">:</span> <span class="token scalar">ID</span><span class="token operator">!</span>
  <span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token scalar">String</span><span class="token operator">!</span>
<span class="token punctuation">}</span></code></pre><p>Then, you can use the typings generation feature (as shown in the <a href="/graphql/quick-start">quick start</a> chapter) to generate corresponding TypeScript definitions:<pre class="language-typescript"><code class="language-typescript"><span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">Character</span></span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Interfaces require an extra <code>__resolveType</code> field in the resolver map to determine which type the interface should resolve to. Let's create a <code>CharactersResolver</code> class and define the <code>__resolveType</code> method:<pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Resolver</span></span><span class="token punctuation">(</span><span class="token string">'Character'</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CharactersResolver</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ResolveField</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">__resolveType</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token string">'age'</span> <span class="token keyword">in</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> <span class="token maybe-class-name">Person</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><blockquote><p>info <strong>Hint</strong> All decorators are exported from the <code>@nestjs/graphql</code> package. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></blockquote></section></section>