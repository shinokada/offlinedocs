<!doctype html><html lang="en"><meta charset="utf-8"><title>HTTP adapter</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="http-adapter"class="level3"><h3>HTTP adapter</h3><p>Occasionally, you may want to access the underlying HTTP server, either within the Nest application context or from the outside.<p>Every native (platform-specific) HTTP server/library (e.g., Express and Fastify) instance is wrapped in an <strong>adapter</strong>. The adapter is registered as a globally available provider that can be retrieved from the application context, as well as injected into other providers.<section id="outside-application-context-strategy"class="level4"><h4>Outside application context strategy</h4><p>To get a reference to the <code>HttpAdapter</code> from outside of the application context, call the <code>getHttpAdapter()</code> method.<pre class="language-typescript"><code class="language-typescript">@<span class="token decorator"><span class="token at operator">@</span><span class="token function">filename</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">NestFactory</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token maybe-class-name">AppModule</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> httpAdapter <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token method function property-access">getHttpAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></section><section id="in-context-strategy"class="level4"><h4>In-context strategy</h4><p>To get a reference to the <code>HttpAdapterHost</code> from within the application context, inject it using the same technique as any other existing provider (e.g., using constructor injection).<pre class="language-typescript"><code class="language-typescript">@<span class="token decorator"><span class="token at operator">@</span><span class="token function">filename</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CatsService</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> adapterHost<span class="token operator">:</span> <span class="token maybe-class-name">HttpAdapterHost</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
@@<span class="token keyword control-flow">switch</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Dependencies</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">HttpAdapterHost</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CatsService</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>adapterHost<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">adapterHost</span> <span class="token operator">=</span> adapterHost<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><blockquote><p>info <strong>Hint</strong> The <code>HttpAdapterHost</code> is imported from the <code>@nestjs/core</code> package.</blockquote><p>The <code>HttpAdapterHost</code> is <strong>not</strong> an actual <code>HttpAdapter</code>. To get the actual <code>HttpAdapter</code> instance, simply access the <code>httpAdapter</code> property.<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> adapterHost <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token maybe-class-name">HttpAdapterHost</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> httpAdapter <span class="token operator">=</span> adapterHost<span class="token punctuation">.</span><span class="token property-access">httpAdapter</span><span class="token punctuation">;</span></code></pre><p>The <code>httpAdapter</code> is the actual instance of the HTTP adapter used by the underlying framework. It is an instance of either <code>ExpressAdapter</code> or <code>FastifyAdapter</code> (both classes extend <code>AbstractHttpAdapter</code>).<p>The adapter object exposes several useful methods to interact with the HTTP server. However, if you want to access the library instance (e.g., the Express instance) directly, call the <code>getInstance()</code> method.<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> instance <span class="token operator">=</span> httpAdapter<span class="token punctuation">.</span><span class="token method function property-access">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>