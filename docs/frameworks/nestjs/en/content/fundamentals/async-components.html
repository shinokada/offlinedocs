<!doctype html><html lang="en"><meta charset="utf-8"><title>Asynchronous providers</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="asynchronous-providers"class="level3"><h3>Asynchronous providers</h3><p>At times, the application start should be delayed until one or more <strong>asynchronous tasks</strong> are completed. For example, you may not want to start accepting requests until the connection with the database has been established. You can achieve this using asynchronous providers.<p>The syntax for this is to use <code>async/await</code> with the <code>useFactory</code> syntax. The factory returns a <code>Promise</code>, and the factory function can <code>await</code> asynchronous tasks. Nest will await resolution of the promise before instantiating any class that depends on (injects) such a provider.<pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">{</span>
  provide<span class="token operator">:</span> <span class="token string">'ASYNC_CONNECTION'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">useFactory</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> connection<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre><blockquote><p>info <strong>Hint</strong> Learn more about custom provider syntax <a href="/fundamentals/custom-providers">here</a>.</blockquote><section id="injection"class="level4"><h4>Injection</h4><p>Asynchronous providers are injected to other components by their tokens, like any other provider. In the example above, you would use the construct <code>@Inject('ASYNC_CONNECTION')</code>.</section><section id="example"class="level4"><h4>Example</h4><p><a href="/recipes/sql-typeorm">The TypeORM recipe</a> has a more substantial example of an asynchronous provider. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>