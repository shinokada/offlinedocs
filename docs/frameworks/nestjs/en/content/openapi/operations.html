<!doctype html><html lang="en"><meta charset="utf-8"><title>Operations</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="operations"class="level3"><h3>Operations</h3><p>In OpenAPI terms, paths are endpoints (resources), such as <code>/users</code> or <code>/reports/summary</code>, that your API exposes, and operations are the HTTP methods used to manipulate these paths, such as <code>GET</code>, <code>POST</code> or <code>DELETE</code>.<section id="tags"class="level4"><h4>Tags</h4><p>To attach a controller to a specific tag, use the <code>@ApiTags(...tags)</code> decorator.<pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiTags</span></span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CatsController</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></section><section id="headers"class="level4"><h4>Headers</h4><p>To define custom headers that are expected as part of the request, use <code>@ApiHeader()</code>.<pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiHeader</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'X-MyHeader'</span><span class="token punctuation">,</span>
  description<span class="token operator">:</span> <span class="token string">'Custom header'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CatsController</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></section><section id="responses"class="level4"><h4>Responses</h4><p>To define a custom HTTP response, use the <code>@ApiResponse()</code> decorator.<pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiResponse</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token number">201</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">'The record has been successfully created.'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiResponse</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">'Forbidden.'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> <span class="token maybe-class-name">CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">catsService</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Nest provides a set of short-hand <strong>API response</strong> decorators that inherit from the <code>@ApiResponse</code> decorator:<ul><li><code>@ApiOkResponse()</code><li><code>@ApiCreatedResponse()</code><li><code>@ApiAcceptedResponse()</code><li><code>@ApiNoContentResponse()</code><li><code>@ApiMovedPermanentlyResponse()</code><li><code>@ApiFoundResponse()</code><li><code>@ApiBadRequestResponse()</code><li><code>@ApiUnauthorizedResponse()</code><li><code>@ApiNotFoundResponse()</code><li><code>@ApiForbiddenResponse()</code><li><code>@ApiMethodNotAllowedResponse()</code><li><code>@ApiNotAcceptableResponse()</code><li><code>@ApiRequestTimeoutResponse()</code><li><code>@ApiConflictResponse()</code><li><code>@ApiPreconditionFailedResponse()</code><li><code>@ApiTooManyRequestsResponse()</code><li><code>@ApiGoneResponse()</code><li><code>@ApiPayloadTooLargeResponse()</code><li><code>@ApiUnsupportedMediaTypeResponse()</code><li><code>@ApiUnprocessableEntityResponse()</code><li><code>@ApiInternalServerErrorResponse()</code><li><code>@ApiNotImplementedResponse()</code><li><code>@ApiBadGatewayResponse()</code><li><code>@ApiServiceUnavailableResponse()</code><li><code>@ApiGatewayTimeoutResponse()</code><li><code>@ApiDefaultResponse()</code></ul><pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiCreatedResponse</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> description<span class="token operator">:</span> <span class="token string">'The record has been successfully created.'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiForbiddenResponse</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> description<span class="token operator">:</span> <span class="token string">'Forbidden.'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> <span class="token maybe-class-name">CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">catsService</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>To specify a return model for a request, we must create a class and annotate all properties with the <code>@ApiProperty()</code> decorator.<pre class="language-typescript"><code class="language-typescript"><span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">Cat</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Then the <code>Cat</code> model can be used in combination with the <code>type</code> property of the response decorator.<pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiTags</span></span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CatsController</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiCreatedResponse</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    description<span class="token operator">:</span> <span class="token string">'The record has been successfully created.'</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token maybe-class-name">Cat</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> <span class="token maybe-class-name">CreateCatDto</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Cat</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">catsService</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Let's open the browser and verify the generated <code>Cat</code> model:<figure><img src="/Users/shinichiokada/Bash_Projects/markdown-docs-as-pdf/.vivliostyle/nestjs/en/src/assets/swagger-response-type.png"></figure></section><section id="file-upload"class="level4"><h4>File upload</h4><p>You can enable file upload for a specific method with the <code>@ApiBody</code> decorator together with <code>@ApiConsumes()</code>. Here's a full example using the <a href="/techniques/file-upload">File Upload</a> technique:<pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">UseInterceptors</span></span><span class="token punctuation">(</span><span class="token function"><span class="token maybe-class-name">FileInterceptor</span></span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiConsumes</span></span><span class="token punctuation">(</span><span class="token string">'multipart/form-data'</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiBody</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  description<span class="token operator">:</span> <span class="token string">'List of cats'</span><span class="token punctuation">,</span>
  type<span class="token operator">:</span> <span class="token maybe-class-name">FileUploadDto</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">UploadedFile</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre><p>Where <code>FileUploadDto</code> is defined as follows:<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">FileUploadDto</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span> format<span class="token operator">:</span> <span class="token string">'binary'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  file<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>To handle multiple files uploading, you can define <code>FilesUploadDto</code> as follows:<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">FilesUploadDto</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span> items<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span> format<span class="token operator">:</span> <span class="token string">'binary'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  files<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section><section id="extensions"class="level4"><h4>Extensions</h4><p>To add an Extension to a request use the <code>@ApiExtension()</code> decorator. The extension name must be prefixed with <code>x-</code>.<pre class="language-typescript"><code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiExtension</span></span><span class="token punctuation">(</span><span class="token string">'x-foo'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> hello<span class="token operator">:</span> <span class="token string">'world'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section id="advanced-generic-apiresponse"class="level4"><h4>Advanced: Generic <code>ApiResponse</code></h4><p>With the ability to provide <a href="/openapi/types-and-parameters#raw-definitions">Raw Definitions</a>, we can define Generic schema for Swagger UI. Assume we have the following DTO:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">PaginatedDto</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">TData</span><span class="token operator">></span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  total<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  limit<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  offset<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  results<span class="token operator">:</span> <span class="token maybe-class-name">TData</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>We skip decorating <code>results</code> as we will be providing a raw definition for it later. Now, let's define another DTO and name it, for example, <code>CatDto</code>, as follows:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CatDto</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>With this in place, we can define a <code>PaginatedDto&#x3C;CatDto></code> response, as follows:<pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiOkResponse</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  schema<span class="token operator">:</span> <span class="token punctuation">{</span>
    allOf<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span><span class="token maybe-class-name">PaginatedDto</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        properties<span class="token operator">:</span> <span class="token punctuation">{</span>
          results<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
            items<span class="token operator">:</span> <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span><span class="token maybe-class-name">CatDto</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">PaginatedDto</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">CatDto</span><span class="token operator">>></span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre><p>In this example, we specify that the response will have allOf <code>PaginatedDto</code> and the <code>results</code> property will be of type <code>Array&#x3C;CatDto></code>.<ul><li><code>getSchemaPath()</code> function that returns the OpenAPI Schema path from within the OpenAPI Spec File for a given model.<li><code>allOf</code> is a concept that OAS 3 provides to cover various Inheritance related use-cases.</ul><p>Lastly, since <code>PaginatedDto</code> is not directly referenced by any controller, the <code>SwaggerModule</code> will not be able to generate a corresponding model definition just yet. In this case, we must add it as an <a href="/openapi/types-and-parameters#extra-models">Extra Model</a>. For example, we can use the <code>@ApiExtraModels()</code> decorator on the controller level, as follows:<pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiExtraModels</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">PaginatedDto</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CatsController</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre><p>If you run Swagger now, the generated <code>swagger.json</code> for this specific endpoint should have the following response defined:<pre class="language-json"><code class="language-json"><span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"allOf"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              <span class="token property">"$ref"</span><span class="token operator">:</span> <span class="token string">"#/components/schemas/PaginatedDto"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">"$ref"</span><span class="token operator">:</span> <span class="token string">"#/components/schemas/CatDto"</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>To make it reusable, we can create a custom decorator for <code>PaginatedDto</code>, as follows:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token maybe-class-name">ApiPaginatedResponse</span> <span class="token operator">=</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">TModel</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token maybe-class-name">Type</span><span class="token operator">&#x3C;</span><span class="token builtin">any</span><span class="token operator">></span></span><span class="token operator">></span><span class="token punctuation">(</span>
  model<span class="token operator">:</span> <span class="token maybe-class-name">TModel</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token function">applyDecorators</span><span class="token punctuation">(</span>
    <span class="token function"><span class="token maybe-class-name">ApiOkResponse</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      schema<span class="token operator">:</span> <span class="token punctuation">{</span>
        allOf<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span><span class="token maybe-class-name">PaginatedDto</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            properties<span class="token operator">:</span> <span class="token punctuation">{</span>
              results<span class="token operator">:</span> <span class="token punctuation">{</span>
                type<span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
                items<span class="token operator">:</span> <span class="token punctuation">{</span> $ref<span class="token operator">:</span> <span class="token function">getSchemaPath</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><blockquote><p>info <strong>Hint</strong> <code>Type&#x3C;any></code> interface and <code>applyDecorators</code> function are imported from the <code>@nestjs/common</code> package.</blockquote><p>With this in place, we can use the custom <code>@ApiPaginatedResponse()</code> decorator on our endpoint:<pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiPaginatedResponse</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">CatDto</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">PaginatedDto</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">CatDto</span><span class="token operator">>></span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre><p>For client generation tools, this approach poses an ambiguity in how the <code>PaginatedResponse&#x3C;TModel></code> is being generated for the client. The following snippet is an example of a client generator result for the above <code>GET /</code> endpoint.<pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Angular</span>
<span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">Observable</span><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> total<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> offset<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> results<span class="token operator">:</span> <span class="token maybe-class-name">CatDto</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token operator">></span></code></pre><p>As you can see, the <strong>Return Type</strong> here is ambiguous. To workaround this issue, you can add a <code>title</code> property to the <code>schema</code> for <code>ApiPaginatedResponse</code>:<pre class="language-typescript"><code class="language-typescript"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token maybe-class-name">ApiPaginatedResponse</span> <span class="token operator">=</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">TModel</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token maybe-class-name">Type</span><span class="token operator">&#x3C;</span><span class="token builtin">any</span><span class="token operator">></span></span><span class="token operator">></span><span class="token punctuation">(</span>model<span class="token operator">:</span> <span class="token maybe-class-name">TModel</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token function">applyDecorators</span><span class="token punctuation">(</span>
    <span class="token function"><span class="token maybe-class-name">ApiOkResponse</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      schema<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">PaginatedResponseOf</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>model<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        allOf<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// ...</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Now the result of the client generator tool will become:<pre class="language-ts"><code class="language-ts"><span class="token comment">// Angular</span>
<span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">Observable</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">PaginatedResponseOfCatDto</span><span class="token operator">></span></code></pre><p><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>