<!doctype html><html lang="en"><meta charset="utf-8"><title>Hot Reload</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="hot-reload"class="level3"><h3>Hot Reload</h3><p>The highest impact on your application's bootstrapping process is <strong>TypeScript compilation</strong>. Fortunately, with <a href="https://github.com/webpack/webpack">webpack</a> HMR (Hot-Module Replacement), we don't need to recompile the entire project each time a change occurs. This significantly decreases the amount of time necessary to instantiate your application, and makes iterative development a lot easier.<blockquote><p>warning <strong>Warning</strong> Note that <code>webpack</code> won't automatically copy your assets (e.g. <code>graphql</code> files) to the <code>dist</code> folder. Similarly, <code>webpack</code> is not compatible with glob static paths (e.g., the <code>entities</code> property in <code>TypeOrmModule</code>).</blockquote></section><section id="with-cli"class="level3"><h3>With CLI</h3><p>If you are using the <a href="https://docs.nestjs.com/cli/overview">Nest CLI</a>, the configuration process is pretty straightforward. The CLI wraps <code>webpack</code>, which allows use of the <code>HotModuleReplacementPlugin</code>.<section id="installation"class="level4"><h4>Installation</h4><p>First install the required packages:<pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> i --save-dev webpack-node-externals run-script-webpack-plugin webpack</code></pre><blockquote><p>info <strong>Hint</strong> If you use <strong>Yarn Berry</strong> (not classic Yarn), install the <code>webpack-pnp-externals</code> package instead of the <code>webpack-node-externals</code>.</blockquote></section><section id="configuration"class="level4"><h4>Configuration</h4><p>Once the installation is complete, create a <code>webpack-hmr.config.js</code> file in the root directory of your application.<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> nodeExternals <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'webpack-node-externals'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">RunScriptWebpackPlugin</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'run-script-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>options<span class="token punctuation">,</span> webpack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token spread operator">...</span>options<span class="token punctuation">,</span>
    entry<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'webpack/hot/poll?100'</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span><span class="token property-access">entry</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    externals<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token function">nodeExternals</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        allowlist<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'webpack/hot/poll?100'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token spread operator">...</span>options<span class="token punctuation">.</span><span class="token property-access">plugins</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name">webpack</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">HotModuleReplacementPlugin</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name">webpack</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">WatchIgnorePlugin</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        paths<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.d\.ts$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name"><span class="token maybe-class-name">RunScriptWebpackPlugin</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> options<span class="token punctuation">.</span><span class="token property-access">output</span><span class="token punctuation">.</span><span class="token property-access">filename</span><span class="token punctuation">,</span> autoRestart<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><blockquote><p>info <strong>Hint</strong> With <strong>Yarn Berry</strong> (not classic Yarn), instead of using the <code>nodeExternals</code> in the <code>externals</code> configuration property, use the <code>WebpackPnpExternals</code> from <code>webpack-pnp-externals</code> package: <code>WebpackPnpExternals({{ '{' }} exclude: ['webpack/hot/poll?100'] {{ '}' }})</code>.</blockquote><p>This function takes the original object containing the default webpack configuration as a first argument, and the reference to the underlying <code>webpack</code> package used by the Nest CLI as the second one. Also, it returns a modified webpack configuration with the <code>HotModuleReplacementPlugin</code>, <code>WatchIgnorePlugin</code>, and <code>RunScriptWebpackPlugin</code> plugins.</section><section id="hot-module-replacement"class="level4"><h4>Hot-Module Replacement</h4><p>To enable <strong>HMR</strong>, open the application entry file (<code>main.ts</code>) and add the following webpack-related instructions:<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">const</span> module<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">NestFactory</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token maybe-class-name">AppModule</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span><span class="token property-access">hot</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">.</span><span class="token property-access">hot</span><span class="token punctuation">.</span><span class="token method function property-access">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    module<span class="token punctuation">.</span><span class="token property-access">hot</span><span class="token punctuation">.</span><span class="token method function property-access">dispose</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> app<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>To simplify the execution process, add a script to your <code>package.json</code> file.<pre class="language-json"><code class="language-json"><span class="token property">"start:dev"</span><span class="token operator">:</span> <span class="token string">"nest build --webpack --webpackPath webpack-hmr.config.js --watch"</span></code></pre><p>Now simply open your command line and run the following command:<pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> run start:dev</code></pre></section></section><section id="without-cli"class="level3"><h3>Without CLI</h3><p>If you are not using the <a href="https://docs.nestjs.com/cli/overview">Nest CLI</a>, the configuration will be slightly more complex (will require more manual steps).<section id="installation-1"class="level4"><h4>Installation</h4><p>First install the required packages:<pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> i --save-dev webpack webpack-cli webpack-node-externals ts-loader run-script-webpack-plugin</code></pre><blockquote><p>info <strong>Hint</strong> If you use <strong>Yarn Berry</strong> (not classic Yarn), install the <code>webpack-pnp-externals</code> package instead of the <code>webpack-node-externals</code>.</blockquote></section><section id="configuration-1"class="level4"><h4>Configuration</h4><p>Once the installation is complete, create a <code>webpack.config.js</code> file in the root directory of your application.<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nodeExternals <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'webpack-node-externals'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">RunScriptWebpackPlugin</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'run-script-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'webpack/hot/poll?100'</span><span class="token punctuation">,</span> <span class="token string">'./src/main.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  target<span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>
  externals<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">nodeExternals</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      allowlist<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'webpack/hot/poll?100'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.tsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">'ts-loader'</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.tsx'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">HotModuleReplacementPlugin</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name"><span class="token maybe-class-name">RunScriptWebpackPlugin</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'server.js'</span><span class="token punctuation">,</span> autoRestart<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'server.js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><blockquote><p>info <strong>Hint</strong> With <strong>Yarn Berry</strong> (not classic Yarn), instead of using the <code>nodeExternals</code> in the <code>externals</code> configuration property, use the <code>WebpackPnpExternals</code> from <code>webpack-pnp-externals</code> package: <code>WebpackPnpExternals({{ '{' }} exclude: ['webpack/hot/poll?100'] {{ '}' }})</code>.</blockquote><p>This configuration tells webpack a few essential things about your application: location of the entry file, which directory should be used to hold <strong>compiled</strong> files, and what kind of loader we want to use to compile source files. Generally, you should be able to use this file as-is, even if you don't fully understand all of the options.</section><section id="hot-module-replacement-1"class="level4"><h4>Hot-Module Replacement</h4><p>To enable <strong>HMR</strong>, open the application entry file (<code>main.ts</code>) and add the following webpack-related instructions:<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">const</span> module<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">NestFactory</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token maybe-class-name">AppModule</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span><span class="token property-access">hot</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">.</span><span class="token property-access">hot</span><span class="token punctuation">.</span><span class="token method function property-access">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    module<span class="token punctuation">.</span><span class="token property-access">hot</span><span class="token punctuation">.</span><span class="token method function property-access">dispose</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> app<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>To simplify the execution process, add a script to your <code>package.json</code> file.<pre class="language-json"><code class="language-json"><span class="token property">"start:dev"</span><span class="token operator">:</span> <span class="token string">"webpack --config webpack.config.js --watch"</span></code></pre><p>Now simply open your command line and run the following command:<pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> run start:dev</code></pre></section><section id="example"class="level4"><h4>Example</h4><p>A working example is available <a href="https://github.com/nestjs/nest/tree/master/sample/08-webpack">here</a>. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>