<!doctype html><html lang="ja"><meta charset="utf-8"><title>アプリをビルドする</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../Vivliostyle/read-html-download-pdf/docs/themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="アプリをビルドする"><h1 id="アプリをビルドする">アプリをビルドする</h1><p>SvelteKit アプリのビルドは2つのステージで行われます。どちらも <code>vite build</code> (通常は <code>npm run build</code> を経由します) を実行したときに行われます。<p>まず最初に、Vite がサーバーのコード、ブラウザのコード、service worker(もしあれば) の、最適化された本番向けビルドを作成します。必要に応じて、このステージで <a href="page-options#prerender">プリレンダリング</a> が実行されます。<p>次に、<em>adapter</em> がこの本番向けビルドをあなたがデプロイしたいターゲットの環境向けに調整します — これについての詳細は以降のページにございます。<section class="level2"aria-labelledby="ビルド中に"><h2 id="ビルド中に">ビルド中に</h2><p>SvelteKit はビルド中に、解析のために <code>+page/layout(.server).js</code> ファイル (とそこにインポートされている全てのファイル) を読み込みます。このステージで読み込まれるべきでないコードがある場合は、<a href="modules#$app-environment"><code>$app/environment</code></a> からインポートする <code>building</code> が <code>false</code> であることをチェックするコードを追加してください:<pre class="language-diff"><code class="language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import { building } from '$app/environment';
</span></span>import { setupMyDatabase } from '$lib/server/database';

<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">if (!building) {
</span></span>	setupMyDatabase();
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">}
</span></span>
export function load() {
	// ...
}</code></pre></section><section class="level2"aria-labelledby="アプリのプレビュー"><h2 id="アプリのプレビュー">アプリのプレビュー</h2><p>ビルド後、<code>vite preview</code> (<code>npm run preview</code> 経由) を使用してローカルで本番向けビルドを確認することができます。これは Node 上でアプリを実行しているので、デプロイされるアプリの完全な再現ではないことにご注意ください。<a href="adapters#platform-specific-context"><code>platform</code> オブジェクト</a> などの adapter 固有の調整はプレビューには適用されません。 <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section>