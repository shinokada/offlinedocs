<!doctypehtml><html lang="ja"><meta charset="utf-8"><title>Service workers</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="service-workers"class="level1"><h1>Service workers</h1><p>Service Worker は、アプリ内部でネットワークリクエストを処理するプロキシサーバーとして機能します。これによりアプリをオフラインで動作させることが可能になります。もしオフラインサポートが不要な場合（または構築するアプリの種類によって現実的に実装できない場合）でも、ビルドした JS と CSS を事前にキャッシュしてナビゲーションを高速化するために Service Worker を使用する価値はあります。<p>SvelteKit では、<code>src/service-worker.js</code> ファイル（または <code>src/service-worker.ts</code> や <code>src/service-worker/index.js</code> など）があれば、Vite でビルドされて自動的に登録されます。Service Worker を独自のロジックで登録する必要がある場合、自動登録を無効にすることができます (例えば、更新をユーザーに促すプロンプトや、定期的な更新の設定、<code>workbox</code> の使用、など)。<blockquote><p><a href="../50-api-reference/10-configuration.html#files">Service Worker のロケーション</a> と <a href="../50-api-reference/10-configuration.html#serviceworker">自動登録の無効化</a> についてはプロジェクトの設定で変更することができます。</blockquote><p>Service Worker の内部では、<a href="../50-api-reference/30-modules.html#$service-worker"><code>$service-worker</code> モジュール</a> にアクセスすることができます。Vite コンフィグで <code>define</code> が設定されている場合、server/client のビルドと同様、service worker にもそれが適用されます。<p>service worker はプロダクション向けにはバンドルされますが、開発中はバンドルされません。そのため、<a href="https://web.dev/es-modules-in-sw">modules in service workers</a> をサポートするブラウザのみ、開発時にもそれを使用することができます。service worker を手動で登録する場合、開発時に <code>{ type: 'module' }</code> オプションを渡す必要があります:<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> dev <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'$app/environment'</span><span class="token punctuation">;</span>

<span class="token dom variable">navigator</span><span class="token punctuation">.</span><span class="token property-access">serviceWorker</span><span class="token punctuation">.</span><span class="token method function property-access">register</span><span class="token punctuation">(</span><span class="token string">'/service-worker.js'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">type</span><span class="token operator">:</span> dev <span class="token operator">?</span> <span class="token string">'module'</span> <span class="token operator">:</span> <span class="token string">'classic'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section>