<!doctype html><html lang="ja"><meta charset="utf-8"><title>Link options</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="link-options"><h1 id="link-options">Link options</h1><p>SvelteKit では、アプリのルート(routes)間の移動に、(フレームワーク固有の <code>&#x3C;Link></code> コンポーネントではなく) <code>&#x3C;a></code> 要素を使用します。ユーザーが、<code>href</code> がアプリのものであるリンク (外部サイトではないリンク) をクリックする場合、SvelteKit はそのコードをインポートし、データを取得するために必要な <code>load</code> 関数を呼び出して、新しいページに移動します。<p><code>data-sveltekit-*</code> 属性でリンクの挙動をカスタマイズすることができます。これらは <code>&#x3C;a></code> 自身やその親要素に適用することができます。<p>これらのオプションは、<a href="form-actions#get-vs-post"><code>method="GET"</code></a> を持つ <code>&#x3C;form></code> 要素にも適用されます。<section class="level2"aria-labelledby="data-sveltekit-preload-data"><h2 id="data-sveltekit-preload-data">data-sveltekit-preload-data</h2><p>ユーザーがリンクをクリックしたことをブラウザが検知するより前に、(デスクトップでは) マウスがリンクをホバーしたことや、<code>touchstart</code> や <code>mousedown</code> がトリガーされることを検知することができます。どちらの場合も、<code>click</code> イベントが発生することを経験に基づいて推測することができます。<p>SvelteKit はこの情報を使ってインポートするコードやそのページのデータの取得をいち早く開始することができ、数百ミリ秒を稼ぐことができます。これが、ユーザーインターフェースが遅延していると感じるか、それともきびきび動いていると感じるかの差になります。<p>この動作は <code>data-sveltekit-preload-data</code> 属性によってコントロールすることができ、2つの値のうちどちらかを設定することができます:<ul><li><code>"hover"</code> は、マウスがリンクの上にきたときにプリロードを開始します。モバイルでは、<code>touchstart</code> でプリロードが開始されます<li><code>"tap"</code> は、<code>touchstart</code> や <code>mousedown</code> イベントが検知されるとすぐにプリロードが開始されます</ul><p>デフォルトのプロジェクテンプレートには、<code>src/app.html</code> の <code>&#x3C;body></code> 要素に <code>data-sveltekit-preload-data="hover"</code> が適用されており、デフォルトで全てのリンクがホバー時にプリロードされます:<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span> <span class="token attr-name">data-sveltekit-preload-data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hover<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> contents</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>%sveltekit.body%<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span></code></pre><p>時には、ユーザーがリンクをホバーしたときに <code>load</code> を呼ぶのは望ましくないことがあるでしょう。誤検出の可能性もありますし (必ずしもホバーに続いてクリックが発生するわけではない)、データの更新が非常に早い場合はデータが古くなってしまうこともあります。<p>これらの場合には、値に <code>"tap"</code> を指定します。こうすると SvelteKit は、ユーザーがリンクをタップまたはクリックしたときのみ、<code>load</code> を呼び出すようになります:<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">data-sveltekit-preload-data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tap<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/stonks<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	Get current stonk values
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span></code></pre><blockquote><p>プログラムで <code>$app/navigation</code> の <code>preloadData</code> を実行することもできます。</blockquote><p>ユーザーがデータ使用量の削減を選択している場合、つまり <a href="https://developer.mozilla.org/ja/docs/Web/API/NetworkInformation/saveData"><code>navigator.connection.saveData</code></a> が <code>true</code> になっている場合は、データは決してプリロードされません。</section><section class="level2"aria-labelledby="data-sveltekit-preload-code"><h2 id="data-sveltekit-preload-code">data-sveltekit-preload-code</h2><p>リンク先の <em>データ</em> をプリロードしたくない場所であっても、<em>コード</em> をプリロードするのは有益なこともあります。<code>data-sveltekit-preload-code</code> 属性は <code>data-sveltekit-preload-data</code> と同様に動作しますが、4つの値から選択できる点が異なります。'先行度'('eagerness') の降順で並べると:<ul><li><code>"eager"</code> は、すぐにリンクをプリロードします<li><code>"viewport"</code> は、リンクがビューポートに入るとすぐにプリロードします<li><code>"hover"</code> - コードだけがプリロードされることを除き、上記(<code>data-sveltekit-preload-data</code> の <code>"hover"</code>)と同じです<li><code>"tap"</code> - コードだけがプリロードされることを除き、上記(<code>data-sveltekit-preload-data</code> の <code>"tap"</code>)と同じです</ul><p><code>viewport</code> と <code>eager</code> は、ナビゲーション直後の DOM に存在するリンクにのみ適用されることにご注意ください。リンクが後から追加された場合 (例えば <code>{#if ...}</code> ブロックの中)、<code>hover</code> や <code>tap</code> によってトリガーされるまでプリロードされません。DOM の変更を積極的に観察することによって生じてしまうパフォーマンス劣化を避けるためです。<blockquote><p>コードのプリロードはデータのプリロードの前提条件であるため、この属性は、存在するどの <code>data-sveltekit-preload-data</code> 属性よりも先行度が高い値(more eager value)を指定した場合にのみ、効果を発揮します。</blockquote><p><code>data-sveltekit-preload-data</code> と同様、ユーザーがデータ使用量の削減を選択している場合、この属性も無視されます。</section><section class="level2"aria-labelledby="data-sveltekit-reload"><h2 id="data-sveltekit-reload">data-sveltekit-reload</h2><p>時には、SvelteKit にリンクを処理させないで、ブラウザに処理をさせる必要があります。<code>data-sveltekit-reload</code> 属性をリンクに追加すると…<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">data-sveltekit-reload</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/path<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Path<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span></code></pre><p>…リンクがクリックされたときにフルページナビゲーションが発生します。<p><code>rel="external"</code> 属性があるリンクも同様に扱われます。加えて、<a href="page-options#prerender">プリレンダリング中</a> は無視されます。</section><section class="level2"aria-labelledby="data-sveltekit-replacestate"><h2 id="data-sveltekit-replacestate">data-sveltekit-replacestate</h2><p>ナビゲーションするときにブラウザのセッション履歴(session history)に新しいエントリを作成したくない場合があります。リンクに <code>data-sveltekit-replacestate</code> 属性を追加すると…<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">data-sveltekit-replacestate</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/path<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Path<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span></code></pre><p>…リンクがクリックされたときに、<code>pushState</code> で新しいエントリを作成する代わりに現在の <code>history</code> エントリを置き換えます。</section><section class="level2"aria-labelledby="data-sveltekit-keepfocus"><h2 id="data-sveltekit-keepfocus">data-sveltekit-keepfocus</h2><p>ナビゲーションの後に<a href="accessibility#focus-management">フォーカスをリセット</a>したくない場合があります。例えば、ユーザーが入力している途中で送信をするような検索フォームがあり、テキストの input にフォーカスを維持したい場合です。<code>data-sveltekit-keepfocus</code> 属性を追加すると…<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>form</span> <span class="token attr-name">data-sveltekit-keepfocus</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>query<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>form</span><span class="token punctuation">></span></span></code></pre><p>…ナビゲーション後も現在フォーカスされている要素にフォーカスが維持されるようになります。通常、リンクにこの属性を使用するのは避けてください、フォーカスされる要素が (その前にフォーカスされていた要素ではなく) <code>&#x3C;a></code> タグになってしまい、スクリーンリーダーなどの支援技術を使用するユーザーはナビゲーションの後にフォーカスが移動することを期待することが多いです。また、この属性はナビゲーションの後にもまだ存在する要素にのみ使用する必要があります。もしその要素が消えてしまうと、ユーザーのフォーカスは失われてしまい、支援技術ユーザーにとって混乱した体験となってしまいます。</section><section class="level2"aria-labelledby="data-sveltekit-noscroll"><h2 id="data-sveltekit-noscroll">data-sveltekit-noscroll</h2><p>内部のリンクに移動するとき、SvelteKit はブラウザのデフォルトのナビゲーションの挙動を模倣します: ユーザーがページの左上に来るように、スクロールポジションを <code>0,0</code> に変更します (リンクに <code>#hash</code> が含まれている場合は、ID が一致する要素までスクロールします)。<p>特定のケースでは、この挙動を無効化したいことがあるでしょう。<code>data-sveltekit-noscroll</code> 属性をリンクに追加すると…<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>path<span class="token punctuation">"</span></span> <span class="token attr-name">data-sveltekit-noscroll</span><span class="token punctuation">></span></span>Path<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span></code></pre><p>…リンクがクリックされたあとのスクロールを中止します。</section><section class="level2"aria-labelledby="disabling-options"><h2 id="disabling-options">Disabling options</h2><p>これらのオプションが有効になっている要素の中でこれらのオプションを無効にするには、<code>"false"</code> 値を使用します:<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">data-sveltekit-preload-data</span><span class="token punctuation">></span></span>
	<span class="token comment">&#x3C;!-- these links will be preloaded --></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/a<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>a<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/b<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>b<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/c<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>c<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">data-sveltekit-preload-data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		<span class="token comment">&#x3C;!-- these links will NOT be preloaded --></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/d<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>d<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/e<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>e<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/f<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>f<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span></code></pre><p>条件によって要素に属性を適用する場合は、このようにします (<code>"true"</code> と <code>"false"</code> はどちらも使用することができます):<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">data-sveltekit-reload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{shouldReload</span> <span class="token attr-name">?</span> <span class="token attr-name">''</span> <span class="token attr-name">:</span> <span class="token attr-name">'off'}</span><span class="token punctuation">></span></span></code></pre><blockquote><p>HTML では <code>&#x3C;element attribute></code> と <code>&#x3C;element attribute=""></code> が同等であるため、これがうまく動作します <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></blockquote></section></section>