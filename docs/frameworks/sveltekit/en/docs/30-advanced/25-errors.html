<!doctype html><html lang="en"><meta charset="utf-8"><title>Errors</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="errors"><h1 id="errors">Errors</h1><p>Errors are an inevitable fact of software development. SvelteKit handles errors differently depending on where they occur, what kind of errors they are, and the nature of the incoming request.<section class="level2"aria-labelledby="error-objects"><h2 id="error-objects">Error objects</h2><p>SvelteKit distinguishes between expected and unexpected errors, both of which are represented as simple <code>{ message: string }</code> objects by default.<p>You can add additional properties, like a <code>code</code> or a tracking <code>id</code>, as shown in the examples below. (When using TypeScript this requires you to redefine the <code>Error</code> type as described in <a href="errors#type-safety">type safety</a>).</section><section class="level2"aria-labelledby="expected-errors"><h2 id="expected-errors">Expected errors</h2><p>An <em>expected</em> error is one created with the <a href="modules#sveltejs-kit-error"><code>error</code></a> helper imported from <code>@sveltejs/kit</code>:<pre class="language-js"><code class="language-js"><span class="token comment">/// file: src/routes/blog/[slug]/+page.server.js</span>
<span class="token comment">// @filename: ambient.d.ts</span>
declare module <span class="token string">'$lib/server/database'</span> <span class="token punctuation">{</span>
	<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">getPost</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">slug</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> # string<span class="token punctuation">,</span> <span class="token literal-property property">content</span><span class="token operator">:</span> string <span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token keyword nil">undefined</span><span class="token operator">></span>
<span class="token punctuation">}</span>

<span class="token comment">// @filename: index.js</span>
<span class="token comment">// cut---</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> error <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@sveltejs/kit'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> db</span> <span class="token keyword module">from</span> <span class="token string">'$lib/server/database'</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'./$types'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>PageServerLoad<span class="token punctuation">}</span></span> */</span>
<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword control-flow">await</span> db<span class="token punctuation">.</span><span class="token method function property-access">getPost</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token property-access">slug</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>post<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword control-flow">throw</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
			<span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'Not found'</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> post <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>This tells SvelteKit to set the response status code to 404 and render an <a href="routing#error"><code>+error.svelte</code></a> component, where <code>$page.error</code> is the object provided as the second argument to <code>error(...)</code>.<pre class="language-svelte"><code class="language-svelte">&#x3C;! file: src/routes/+error.svelte --->
&#x3C;script>
	import { page } from '$app/stores';
&#x3C;/script>

&#x3C;h1>{$page.error.message}&#x3C;/h1></code></pre><p>You can add extra properties to the error object if needed...<pre class="language-diff"><code class="language-diff">throw error(404, {
	message: 'Not found',
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">	code: 'NOT_FOUND'
</span></span>});</code></pre><p>...otherwise, for convenience, you can pass a string as the second argument:<pre class="language-diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">throw error(404, { message: 'Not found' });
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">throw error(404, 'Not found');</span></span></code></pre></section><section class="level2"aria-labelledby="unexpected-errors"><h2 id="unexpected-errors">Unexpected errors</h2><p>An <em>unexpected</em> error is any other exception that occurs while handling a request. Since these can contain sensitive information, unexpected error messages and stack traces are not exposed to users.<p>By default, unexpected errors are printed to the console (or, in production, your server logs), while the error that is exposed to the user has a generic shape:<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">"Internal Error"</span> <span class="token punctuation">}</span></code></pre><p>Unexpected errors will go through the <a href="hooks#shared-hooks-handleerror"><code>handleError</code></a> hook, where you can add your own error handling â€” for example, sending errors to a reporting service, or returning a custom error object.<pre class="language-js"><code class="language-js"><span class="token comment">/// file: src/hooks.server.js</span>
<span class="token comment">// @errors: 2322 1360 2571 2339</span>
<span class="token comment">// @filename: ambient.d.ts</span>
declare module <span class="token string">'@sentry/node'</span> <span class="token punctuation">{</span>
	<span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">opts</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
	<span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function-variable function">captureException</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">error</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token literal-property property">opts</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// @filename: index.js</span>
<span class="token comment">// cut---</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> <span class="token maybe-class-name">Sentry</span></span> <span class="token keyword module">from</span> <span class="token string">'@sentry/node'</span><span class="token punctuation">;</span>

<span class="token maybe-class-name">Sentry</span><span class="token punctuation">.</span><span class="token method function property-access">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'@sveltejs/kit'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>HandleServerError<span class="token punctuation">}</span></span> */</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">handleError</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> error<span class="token punctuation">,</span> event <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// example integration with https://sentry.io/</span>
	<span class="token maybe-class-name">Sentry</span><span class="token punctuation">.</span><span class="token method function property-access">captureException</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">extra</span><span class="token operator">:</span> <span class="token punctuation">{</span> event <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'Whoops!'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">code</span><span class="token operator">:</span> error<span class="token operator">?.</span>code <span class="token operator">??</span> <span class="token string">'UNKNOWN'</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><blockquote><p>Make sure that <code>handleError</code> <em>never</em> throws an error</blockquote></section><section class="level2"aria-labelledby="responses"><h2 id="responses">Responses</h2><p>If an error occurs inside <code>handle</code> or inside a <a href="routing#server"><code>+server.js</code></a> request handler, SvelteKit will respond with either a fallback error page or a JSON representation of the error object, depending on the request's <code>Accept</code> headers.<p>You can customise the fallback error page by adding a <code>src/error.html</code> file:<pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>title</span><span class="token punctuation">></span></span>%sveltekit.error.message%<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>title</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>My custom error page<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>Status: %sveltekit.status%<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>Message: %sveltekit.error.message%<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>SvelteKit will replace <code>%sveltekit.status%</code> and <code>%sveltekit.error.message%</code> with their corresponding values.<p>If the error instead occurs inside a <code>load</code> function while rendering a page, SvelteKit will render the <a href="routing#error"><code>+error.svelte</code></a> component nearest to where the error occurred. If the error occurs inside a <code>load</code> function in <code>+layout(.server).js</code>, the closest error boundary in the tree is an <code>+error.svelte</code> file <em>above</em> that layout (not next to it).<p>The exception is when the error occurs inside the root <code>+layout.js</code> or <code>+layout.server.js</code>, since the root layout would ordinarily <em>contain</em> the <code>+error.svelte</code> component. In this case, SvelteKit uses the fallback error page.</section><section class="level2"aria-labelledby="type-safety"><h2 id="type-safety">Type safety</h2><p>If you're using TypeScript and need to customize the shape of errors, you can do so by declaring an <code>App.Error</code> interface in your app (by convention, in <code>src/app.d.ts</code>, though it can live anywhere that TypeScript can 'see'):<pre class="language-diff"><code class="language-diff">/// file: src/app.d.ts
declare global {
	namespace App {
		interface Error {
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">			code: string;
</span><span class="token prefix inserted">+</span><span class="token line">			id: string;
</span></span>		}
	}
}

export {};</code></pre><p>This interface always includes a <code>message: string</code> property.</section><section class="level2"aria-labelledby="further-reading"><h2 id="further-reading">Further reading</h2><ul><li><a href="https://learn.svelte.dev/tutorial/error-basics">Tutorial: Errors and redirects</a><li><a href="https://learn.svelte.dev/tutorial/handle">Tutorial: Hooks</a> <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></ul></section></section>