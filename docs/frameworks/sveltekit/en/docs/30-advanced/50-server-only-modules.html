<!doctype html><html lang="en"><meta charset="utf-8"><title>Server-only modules</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="server-only-modules"class="level1"><h1>Server-only modules</h1><p>Like a good friend, SvelteKit keeps your secrets. When writing your backend and frontend in the same repository, it can be easy to accidentally import sensitive data into your front-end code (environment variables containing API keys, for example). SvelteKit provides a way to prevent this entirely: server-only modules.<section id="private-environment-variables"class="level2"><h2>Private environment variables</h2><p>The <code>$env/static/private</code> and <code>$env/dynamic/private</code> modules, which are covered in the <a href="../50-api-reference/30-modules.html">modules</a> section, can only be imported into modules that only run on the server, such as <a href="../30-advanced/20-hooks.html#server-hooks"><code>hooks.server.js</code></a> or <a href="../20-core-concepts/10-routing.html#page-page-server-js"><code>+page.server.js</code></a>.</section><section id="your-modules"class="level2"><h2>Your modules</h2><p>You can make your own modules server-only in two ways:<ul><li>adding <code>.server</code> to the filename, e.g. <code>secrets.server.js</code><li>placing them in <code>$lib/server</code>, e.g. <code>$lib/server/secrets.js</code></ul></section><section id="how-it-works"class="level2"><h2>How it works</h2><p>Any time you have public-facing code that imports server-only code (whether directly or indirectly)...<pre class="language-js"><code class="language-js"><span class="token comment">// @errors: 7005</span>
<span class="token comment">/// file: $lib/server/secrets.js</span>
<span class="token keyword module">export</span> <span class="token keyword">const</span> atlantisCoordinates <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token comment">/* redacted */</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// @errors: 2307 7006 7005</span>
<span class="token comment">/// file: src/routes/utils.js</span>
<span class="token keyword module">export</span> <span class="token exports"><span class="token punctuation">{</span> atlantisCoordinates <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'$lib/server/secrets.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> a <span class="token operator">+</span> b<span class="token punctuation">;</span></code></pre><pre class="language-html"><code class="language-html">/// file: src/routes/+page.svelte
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> add <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./utils.js'</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>...SvelteKit will error:<pre class="language-text"><code class="language-text">Cannot import $lib/server/secrets.js into public-facing code:
- src/routes/+page.svelte
	- src/routes/utils.js
		- $lib/server/secrets.js</code></pre><p>Even though the public-facing code — <code>src/routes/+page.svelte</code> — only uses the <code>add</code> export and not the secret <code>atlantisCoordinates</code> export, the secret code could end up in JavaScript that the browser downloads, and so the import chain is considered unsafe.<p>This feature also works with dynamic imports, even interpolated ones like <code>await import(`./${foo}.js`)</code>, with one small caveat: during development, if there are two or more dynamic imports between the public-facing code and the server-only module, the illegal import will not be detected the first time the code is loaded.<span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section>