<!doctype html><html lang="en"><meta charset="utf-8"><title>Writing adapters</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../Vivliostyle/read-html-download-pdf/docs/themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="writing-adapters"><h1 id="writing-adapters">Writing adapters</h1><p>If an adapter for your preferred environment doesn't yet exist, you can build your own. We recommend <a href="https://github.com/sveltejs/kit/tree/master/packages">looking at the source for an adapter</a> to a platform similar to yours and copying it as a starting point.<p>Adapters packages must implement the following API, which creates an <code>Adapter</code>:<pre class="language-js"><code class="language-js"><span class="token comment">// @filename: ambient.d.ts</span>
type <span class="token maybe-class-name">AdapterSpecificOptions</span> <span class="token operator">=</span> any<span class="token punctuation">;</span>

<span class="token comment">// @filename: index.js</span>
<span class="token comment">// cut---</span>
<span class="token doc-comment comment">/** <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>AdapterSpecificOptions<span class="token punctuation">}</span></span> <span class="token parameter">options</span> */</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword module">import</span><span class="token punctuation">(</span><span class="token string">'@sveltejs/kit'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Adapter<span class="token punctuation">}</span></span> */</span>
	<span class="token keyword">const</span> adapter <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'adapter-package-name'</span><span class="token punctuation">,</span>
		<span class="token keyword">async</span> <span class="token function">adapt</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// adapter implementation</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword control-flow">return</span> adapter<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>The types for <code>Adapter</code> and its parameters are available in <a href="https://github.com/sveltejs/kit/blob/master/packages/kit/types/index.d.ts">types/index.d.ts</a>.<p>Within the <code>adapt</code> method, there are a number of things that an adapter should do:<ul><li>Clear out the build directory<li>Write SvelteKit output with <code>builder.writeClient</code>, <code>builder.writeServer</code>, and <code>builder.writePrerendered</code><li>Output code that:<ul><li>Imports <code>Server</code> from <code>${builder.getServerDirectory()}/index.js</code><li>Instantiates the app with a manifest generated with <code>builder.generateManifest({ relativePath })</code><li>Listens for requests from the platform, converts them to a standard <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request">Request</a> if necessary, calls the <code>server.respond(request, { getClientAddress })</code> function to generate a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response">Response</a> and responds with it<li>expose any platform-specific information to SvelteKit via the <code>platform</code> option passed to <code>server.respond</code><li>Globally shims <code>fetch</code> to work on the target platform, if necessary. SvelteKit provides a <code>@sveltejs/kit/install-fetch</code> helper for platforms that can use <code>node-fetch</code></ul><li>Bundle the output to avoid needing to install dependencies on the target platform, if necessary<li>Put the user's static files and the generated JS/CSS in the correct location for the target platform</ul><p>Where possible, we recommend putting the adapter output under the <code>build/</code> directory with any intermediate output placed under <code>.svelte-kit/[adapter-name]</code>. <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section>