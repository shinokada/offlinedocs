<!doctype html><html lang="en"><meta charset="utf-8"><title>Building your app</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../Vivliostyle/read-html-download-pdf/docs/themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="building-your-app"><h1 id="building-your-app">Building your app</h1><p>Building a SvelteKit app happens in two stages, which both happen when you run <code>vite build</code> (usually via <code>npm run build</code>).<p>Firstly, Vite creates an optimized production build of your server code, your browser code, and your service worker (if you have one). <a href="page-options#prerender">Prerendering</a> is executed at this stage, if appropriate.<p>Secondly, an <em>adapter</em> takes this production build and tunes it for your target environment — more on this on the following pages.<section class="level2"aria-labelledby="during-the-build"><h2 id="during-the-build">During the build</h2><p>SvelteKit will load your <code>+page/layout(.server).js</code> files (and all files they import) for analysis during the build. Any code that should <em>not</em> be executed at this stage must check that <code>building</code> from <a href="modules#$app-environment"><code>$app/environment</code></a> is <code>false</code>:<pre class="language-diff"><code class="language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import { building } from '$app/environment';
</span></span>import { setupMyDatabase } from '$lib/server/database';

<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">if (!building) {
</span></span>	setupMyDatabase();
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">}
</span></span>
export function load() {
	// ...
}</code></pre></section><section class="level2"aria-labelledby="preview-your-app"><h2 id="preview-your-app">Preview your app</h2><p>After building, you can view your production build locally with <code>vite preview</code> (via <code>npm run preview</code>). Note that this will run the app in Node, and so is not a perfect reproduction of your deployed app — adapter-specific adjustments like the <a href="adapters#platform-specific-context"><code>platform</code> object</a> do not apply to previews. <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section>