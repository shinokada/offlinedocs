<!doctype html><html lang="en"><meta charset="utf-8"><title>How do I fix the error I'm getting trying to include a package?</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../Vivliostyle/read-html-download-pdf/docs/themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="how-do-i-fix-the-error-im-getting-trying-to-include-a-package"><h1 id="how-do-i-fix-the-error-im-getting-trying-to-include-a-package">How do I fix the error I'm getting trying to include a package?</h1><p>Most issues related to including a library are due to incorrect packaging. You can check if a library's packaging is compatible with Node.js by entering it into <a href="https://publint.dev/">the publint website</a>.<p>Here are a few things to keep in mind when checking if a library is packaged correctly:<ul><li><code>exports</code> takes precedence over the other entry point fields such as <code>main</code> and <code>module</code>. Adding an <code>exports</code> field may not be backwards-compatible as it prevents deep imports.<li>ESM files should end with <code>.mjs</code> unless <code>"type": "module"</code> is set in which any case CommonJS files should end with <code>.cjs</code>.<li><code>main</code> should be defined if <code>exports</code> is not. It should be either a CommonJS or ESM file and adhere to the previous bullet. If a <code>module</code> field is defined, it should refer to an ESM file.<li>Svelte components should be distributed as uncompiled <code>.svelte</code> files with any JS in the package written as ESM only. Custom script and style languages, like TypeScript and SCSS, should be preprocessed as vanilla JS and CSS respectively. We recommend using <a href="docs/packaging"><code>svelte-package</code></a> for packaging Svelte libraries, which will do this for you.</ul><p>Libraries work best in the browser with Vite when they distribute an ESM version, especially if they are dependencies of a Svelte component library. You may wish to suggest to library authors that they provide an ESM version. However, CommonJS (CJS) dependencies should work as well since, by default, <a href="https://github.com/sveltejs/vite-plugin-svelte/blob/main/docs/faq.md#what-is-going-on-with-vite-and-pre-bundling-dependencies"><code>vite-plugin-svelte</code> will ask Vite to pre-bundle them</a> using <code>esbuild</code> to convert them to ESM.<p>If you are still encountering issues we recommend searching both <a href="https://github.com/vitejs/vite/issues">the Vite issue tracker</a> and the issue tracker of the library in question. Sometimes issues can be worked around by fiddling with the <a href="https://vitejs.dev/config/#dep-optimization-options"><code>optimizeDeps</code></a> or <a href="https://vitejs.dev/config/#ssr-options"><code>ssr</code></a> config values though we recommend this as only a short-term workaround in favor of fixing the library in question. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section>