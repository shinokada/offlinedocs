<!doctypehtml><html lang="cn"><meta charset="utf-8"><title>配置 Monaco</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="configure-monaco"class="level1"><h1>配置 Monaco</h1><environment type="client"><p>创建一份包含以下内容的 <code>./setup/monaco.ts</code> 文件：<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineMonacoSetup <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@slidev/types'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineMonacoSetup</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>monaco<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// 使用 `monaco` 配置</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>访问 <a href="https://github.com/Microsoft/monaco-editor">monaco-editor</a> 了解更多关于 Monaco 配置的相关信息。<section id="usage"class="level2"><h2>用法</h2><p>如果你想在你的幻灯片中使用 Monaco， 只需添加 <code>{monaco}</code> 到你的代码片段中：<pre class="language-js"><code class="language-js"><span class="token comment">//```js</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> plusOne <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> count<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>plusOne<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span> <span class="token comment">// 2</span>

plusOne<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token operator">++</span> <span class="token comment">// 报错</span>
<span class="token comment">//```</span></code></pre><p>修改为<pre class="language-js"><code class="language-js"><span class="token comment">//```js {monaco}</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> plusOne <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> count<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>plusOne<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span> <span class="token comment">// 2</span>

plusOne<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token operator">++</span> <span class="token comment">// 报错</span>
<span class="token comment">//```</span></code></pre></section><section id="exporting"class="level2"><h2>导出</h2><p>默认情况下， Monaco 只会在开发模式开启。如果你想在导出的单页应用中使用，你需要配置你的扉页：<pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">---</span>
<span class="token key atrule">monaco</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 默认为 "dev"</span>
<span class="token punctuation">---</span></code></pre></section><section id="types-auto-installing"class="level2"><h2>类型自动安装</h2><p>当你使用 Monaco 编写 TypeScript 时，类型依赖将会自动安装到客户端.<pre class="language-ts"><code class="language-ts"><span class="token comment">//```ts {monaco}</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> ref <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vue'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useMouse <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vueuse/core'</span>

<span class="token keyword">const</span> counter <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">//```</span></code></pre><p>在上面的示例中，只需确保项目依赖（<code>dependencies</code> 或 <code>devDependencies</code>）中包含所用到的 <code>vue</code> 和 <code>@vueuse/core</code>，Slidev 将处理剩余的部分以使你的 Monaco 编辑器获得正确的类型支持。</section><section id="configure-themes"class="level2"><h2>配置主题</h2><p>Monaco 主题受 Slidev 的亮色/暗色主题控制。如果你想定制主题，可以在配置函数中传入主题 id：<pre class="language-ts"><code class="language-ts"><span class="token comment">// ./setup/monaco.ts</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineMonacoSetup <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@slidev/types'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineMonacoSetup</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    theme<span class="token operator">:</span> <span class="token punctuation">{</span>
      dark<span class="token operator">:</span> <span class="token string">'vs-dark'</span><span class="token punctuation">,</span>
      light<span class="token operator">:</span> <span class="token string">'vs'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>如果你想载入自定义主题：<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineMonacoSetup <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@slidev/types'</span>

<span class="token comment">// 改成你的主题</span>
<span class="token keyword module">import</span> <span class="token imports">dark</span> <span class="token keyword module">from</span> <span class="token string">'theme-vitesse/themes/vitesse-dark.json'</span>
<span class="token keyword module">import</span> <span class="token imports">light</span> <span class="token keyword module">from</span> <span class="token string">'theme-vitesse/themes/vitesse-light.json'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineMonacoSetup</span><span class="token punctuation">(</span><span class="token punctuation">(</span>monaco<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  monaco<span class="token punctuation">.</span><span class="token property-access">editor</span><span class="token punctuation">.</span><span class="token method function property-access">defineTheme</span><span class="token punctuation">(</span><span class="token string">'vitesse-light'</span><span class="token punctuation">,</span> light <span class="token keyword module">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span>
  monaco<span class="token punctuation">.</span><span class="token property-access">editor</span><span class="token punctuation">.</span><span class="token method function property-access">defineTheme</span><span class="token punctuation">(</span><span class="token string">'vitesse-dark'</span><span class="token punctuation">,</span> dark <span class="token keyword module">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    theme<span class="token operator">:</span> <span class="token punctuation">{</span>
      light<span class="token operator">:</span> <span class="token string">'vitesse-light'</span><span class="token punctuation">,</span>
      dark<span class="token operator">:</span> <span class="token string">'vitesse-dark'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><blockquote><p>如果你在创建一个 Slidev 主题，在配置函数中使用动态 <code>import()</code> 以获得更好的 tree-shaking 和代码分割结果。 <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></blockquote></section></environment></section>