<!doctype html><html lang="cn"><meta charset="utf-8"><title>Examples | Browser Mode</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="examples"><h1 id="examples">Examples</h1><p>浏览器模式与框架无关，因此不提供任何渲染组件的方法。不过，你应该可以使用框架的测试工具包。<p>我们建议根据您的框架使用 <code>testing-library</code> packages：<ul><li><a href="https://testing-library.com/docs/dom-testing-library/intro"><code>@testing-library/dom</code></a> if you don't use a framework<li><a href="https://testing-library.com/docs/vue-testing-library/intro"><code>@testing-library/vue</code></a> to render <a href="https://vuejs.org">vue</a> components<li><a href="https://testing-library.com/docs/svelte-testing-library/intro"><code>@testing-library/svelte</code></a> to render <a href="https://svelte.dev">svelte</a> components<li><a href="https://testing-library.com/docs/react-testing-library/intro"><code>@testing-library/react</code></a> to render <a href="https://react.dev">react</a> components<li><a href="https://testing-library.com/docs/preact-testing-library/intro"><code>@testing-library/preact</code></a> to render <a href="https://preactjs.com">preact</a> components<li><a href="https://testing-library.com/docs/solid-testing-library/intro"><code>@solidjs/testing-library</code></a> to render <a href="https://www.solidjs.com">solid</a> components<li><a href="https://testing-library.com/docs/marko-testing-library/intro"><code>@marko/testing-library</code></a> to render <a href="https://markojs.com">marko</a> components</ul><blockquote>`testing-library` 提供了一个包`@testing-library/user-event`。我们不建议直接使用它，因为它会模拟事件而非实际触发事件--相反，请使用从 `@vitest/browser/context`导入的 [`userEvent`](#interactivity-api)，它使用 Chrome DevTools 协议或 Webdriver（取决于provider）。</blockquote>code-group ```ts [vue] // based on @testing-library/vue example // https://testing-library.com/docs/vue-testing-library/examples<p>import { userEvent } from '@vitest/browser/context' import { render, screen } from '@testing-library/vue' import Component from './Component.vue'<p>test('properly handles v-model', async () => { render(Component)<p>// Asserts initial state. expect(screen.getByText('Hi, my name is Alice')).toBeInTheDocument()<p>// Get the input DOM node by querying the associated label. const usernameInput = await screen.findByLabelText(/username/i)<p>// Type the name into the input. This already validates that the input // is filled correctly, no need to check the value manually. await userEvent.fill(usernameInput, 'Bob')<p>expect(screen.getByText('Hi, my name is Alice')).toBeInTheDocument() })<pre class="language-text"><code class="language-text">```ts [svelte]
// based on @testing-library/svelte
// https://testing-library.com/docs/svelte-testing-library/example

import { render, screen } from '@testing-library/svelte'
import { userEvent } from '@vitest/browser/context'
import { expect, test } from 'vitest'

import Greeter from './greeter.svelte'

test('greeting appears on click', async () => {
  const user = userEvent.setup()
  render(Greeter, { name: 'World' })

  const button = screen.getByRole('button')
  await user.click(button)
  const greeting = await screen.findByText(/hello world/iu)

  expect(greeting).toBeInTheDocument()
})</code></pre><pre class="language-tsx"><code class="language-tsx"><span class="token comment">// based on @testing-library/react example</span>
<span class="token comment">// https://testing-library.com/docs/react-testing-library/example-intro</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> render<span class="token punctuation">,</span> screen <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@testing-library/react'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">Fetch</span></span> <span class="token keyword module">from</span> <span class="token string">'./fetch'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'loads and displays greeting'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Render a React element into the DOM</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Fetch</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/greeting<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span><span class="token method function property-access">getByText</span><span class="token punctuation">(</span><span class="token string">'Load Greeting'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// wait before throwing an error if it cannot find an element</span>
  <span class="token keyword">const</span> heading <span class="token operator">=</span> <span class="token keyword control-flow">await</span> screen<span class="token punctuation">.</span><span class="token method function property-access">findByRole</span><span class="token punctuation">(</span><span class="token string">'heading'</span><span class="token punctuation">)</span>

  <span class="token comment">// assert that the alert message is correct</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>heading<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveTextContent</span><span class="token punctuation">(</span><span class="token string">'hello there'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeDisabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><pre class="language-tsx"><code class="language-tsx"><span class="token comment">// based on @testing-library/preact example</span>
<span class="token comment">// https://testing-library.com/docs/preact-testing-library/example</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> h <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'preact'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> render <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@testing-library/preact'</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">HiddenMessage</span></span> <span class="token keyword module">from</span> <span class="token string">'../hidden-message'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'shows the children when the checkbox is checked'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> testMessage <span class="token operator">=</span> <span class="token string">'Test Message'</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span> queryByText<span class="token punctuation">,</span> getByLabelText<span class="token punctuation">,</span> getByText <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">HiddenMessage</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>testMessage<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span><span class="token class-name">HiddenMessage</span></span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>

  <span class="token comment">// query* functions will return the element or null if it cannot be found.</span>
  <span class="token comment">// get* functions will return the element or throw an error if it cannot be found.</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">queryByText</span><span class="token punctuation">(</span>testMessage<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token method function property-access">toBeInTheDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// The queries can accept a regex to make your selectors more</span>
  <span class="token comment">// resilient to content tweaks and changes.</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span><span class="token function">getByLabelText</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">show</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getByText</span><span class="token punctuation">(</span>testMessage<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeInTheDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><pre class="language-tsx"><code class="language-tsx"><span class="token comment">// baed on @testing-library/solid API</span>
<span class="token comment">// https://testing-library.com/docs/solid-testing-library/api</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> render <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@testing-library/solid'</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'uses params'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">App</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Route</span></span>
        <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/ids/:id<span class="token punctuation">"</span></span>
        <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
            Id:
            </span><span class="token punctuation">{</span><span class="token function">useParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?.</span>id<span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Start</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> findByText <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">App</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token dom variable">location</span><span class="token operator">:</span> <span class="token string">'ids/1234'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token keyword control-flow">await</span> <span class="token function">findByText</span><span class="token punctuation">(</span><span class="token string">'Id: 1234'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeInTheDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><pre class="language-ts"><code class="language-ts"><span class="token comment">// baed on @testing-library/marko API</span>
<span class="token comment">// https://testing-library.com/docs/marko-testing-library/api</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> render<span class="token punctuation">,</span> screen <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@marko/testing-library'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">Greeting</span></span> <span class="token keyword module">from</span> <span class="token string">'./greeting.marko'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'renders a message'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> container <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token maybe-class-name">Greeting</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Marko'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span><span class="token method function property-access">getByText</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Marko</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeInTheDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span><span class="token property-access">firstChild</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatchInlineSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &#x3C;h1>Hello, Marko!&#x3C;/h1>
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section>