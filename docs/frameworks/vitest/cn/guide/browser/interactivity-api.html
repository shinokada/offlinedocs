<!doctype html><html lang="cn"><meta charset="utf-8"><title>Interactivity API | Browser Mode</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="interactivity-api"><h1 id="interactivity-api">Interactivity API</h1><p>Vitest 使用 <a href="https://chromedevtools.github.io/devtools-protocol/">Chrome DevTools Protocol</a> 或 <a href="https://www.w3.org/TR/webdriver/">webdriver</a> API 实现了 <a href="https://testing-library.com/docs/user-event"><code>@testing-library/user-event</code></a>应用程序接口的子集，而不是伪造事件，这使得浏览器行为更加可靠和一致。<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'.button'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>几乎每个 <code>userEvent</code> 方法都继承了其provider选项。要在集成开发环境中查看所有可用选项，请在 <code>tsconfig.json</code> 文件中添加 <code>webdriver</code> 或 <code>playwright</code> 类型：</p>code-group ```json [playwright] { "compilerOptions": { "types": [ "@vitest/browser/providers/playwright" ] } } ``` ```json [webdriverio] { "compilerOptions": { "types": [ "@vitest/browser/providers/webdriverio" ] } } ```<section class="level2"aria-labelledby="usereventsetup"><h2 id="usereventsetup">userEvent.setup</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEvent</span></code></pre><p>创建一个新的用户事件实例。如果需要保持键盘状态，以便正确按下和释放按钮，这将非常有用。<blockquote>与 `@testing-library/user-event` 不同，来自 `@vitest/browser/context` 的默认 `userEvent` 实例只创建一次，而不是每次调用其方法时都创建一次！您可以从本代码段中看到其工作方式的不同之处：<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> userEvent <span class="token keyword module">as</span> vitestUserEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> userEvent <span class="token keyword module">as</span> originalUserEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@testing-library/user-event'</span>

<span class="token keyword control-flow">await</span> vitestUserEvent<span class="token punctuation">.</span><span class="token method function property-access">keyboard</span><span class="token punctuation">(</span><span class="token string">'{Shift}'</span><span class="token punctuation">)</span> <span class="token comment">// press shift without releasing</span>
<span class="token keyword control-flow">await</span> vitestUserEvent<span class="token punctuation">.</span><span class="token method function property-access">keyboard</span><span class="token punctuation">(</span><span class="token string">'{/Shift}'</span><span class="token punctuation">)</span> <span class="token comment">// releases shift</span>

<span class="token keyword control-flow">await</span> originalUserEvent<span class="token punctuation">.</span><span class="token method function property-access">keyboard</span><span class="token punctuation">(</span><span class="token string">'{Shift}'</span><span class="token punctuation">)</span> <span class="token comment">// press shift without releasing</span>
<span class="token keyword control-flow">await</span> originalUserEvent<span class="token punctuation">.</span><span class="token method function property-access">keyboard</span><span class="token punctuation">(</span><span class="token string">'{/Shift}'</span><span class="token punctuation">)</span> <span class="token comment">// DID NOT release shift because the state is different</span></code></pre><p>这种行为更有用，因为我们并没有模拟键盘，而是实际按下了 Shift 键，所以保留原来的行为会在字段中键入时造成意想不到的问题。</blockquote></section><section class="level2"aria-labelledby="usereventclick"><h2 id="usereventclick">userEvent.click</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">click</span><span class="token punctuation">(</span>
  element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEventClickOptions</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>点击元素。继承 provider 的选项。有关此方法如何工作的详细说明，请参阅 provider 的文档。<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'clicks on an element'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> logo <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">logo</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span>logo<span class="token punctuation">)</span>
  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> logo<span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-click">Playwright <code>locator.click</code> API</a><li><a href="https://webdriver.io/docs/api/element/click/">WebdriverIO <code>element.click</code> API</a><li><a href="https://testing-library.com/docs/user-event/convenience/#click">testing-library <code>click</code> API</a></ul></section><section class="level2"aria-labelledby="usereventdblclick"><h2 id="usereventdblclick">userEvent.dblClick</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">dblClick</span><span class="token punctuation">(</span>
  element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEventDoubleClickOptions</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>触发元素的双击事件<p>请参阅你的 provider 的文档以获取有关此方法如何工作的详细说明。<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'triggers a double click on an element'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> logo <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">logo</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">dblClick</span><span class="token punctuation">(</span>logo<span class="token punctuation">)</span>
  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> logo<span class="token punctuation">.</span><span class="token method function property-access">dblClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-dblclick">Playwright <code>locator.dblclick</code> API</a><li><a href="https://webdriver.io/docs/api/element/doubleClick/">WebdriverIO <code>element.doubleClick</code> API</a><li><a href="https://testing-library.com/docs/user-event/convenience/#dblClick">testing-library <code>dblClick</code> API</a></ul></section><section class="level2"aria-labelledby="usereventtripleclick"><h2 id="usereventtripleclick">userEvent.tripleClick</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">tripleClick</span><span class="token punctuation">(</span>
  element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEventTripleClickOptions</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>Triggers a triple click event on an element. Since there is no <code>tripleclick</code> in browser api, this method will fire three click events in a row, and so you must check <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/click_event#usage_notes">click event detail</a> to filter the event: <code>evt.detail === 3</code>.<p>Please refer to your provider's documentation for detailed explanation about how this method works.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'triggers a triple click on an element'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> logo <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">logo</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> tripleClickFired <span class="token operator">=</span> <span class="token boolean">false</span>
  logo<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>evt<span class="token punctuation">.</span><span class="token property-access">detail</span> <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      tripleClickFired <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">tripleClick</span><span class="token punctuation">(</span>logo<span class="token punctuation">)</span>
  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> logo<span class="token punctuation">.</span><span class="token method function property-access">tripleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>tripleClickFired<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-click">Playwright <code>locator.click</code> API</a>: implemented via <code>click</code> with <code>clickCount: 3</code> .<li><a href="https://webdriver.io/docs/api/browser/action/">WebdriverIO <code>browser.action</code> API</a>: implemented via actions api with <code>move</code> plus three <code>down + up + pause</code> events in a row<li><a href="https://testing-library.com/docs/user-event/convenience/#tripleClick">testing-library <code>tripleClick</code> API</a></ul></section><section class="level2"aria-labelledby="usereventfill"><h2 id="usereventfill">userEvent.fill</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">fill</span><span class="token punctuation">(</span>
  element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>为 <code>input/textarea/conteneditable</code> 字段设置值。这将在设置新值前移除输入中的任何现有文本。<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'update input'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> input <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token comment">// input.value == foo</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token string">'{{a[['</span><span class="token punctuation">)</span> <span class="token comment">// input.value == {{a[[</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token string">'{Shift}'</span><span class="token punctuation">)</span> <span class="token comment">// input.value == {Shift}</span>

  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> input<span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token comment">// input.value == foo</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>该方法聚焦元素、填充元素并在填充后触发一个 <code>input</code> 事件。您可以使用空字符串来清除字段。<blockquote>该 API 比使用 [`userEvent.type`](#userevent-type) 或 [`userEvent.keyboard`](#userevent-keyboard) 更快，但**不支持** [user-event `keyboard` syntax](https://testing-library.com/docs/user-event/keyboard) （例如，`{Shift}{selectall}`）。<p>在不需要输入特殊字符或对按键事件进行细粒度控制的情况下，我们建议使用此 API 而不是 <a href="#userevent-type"><code>userEvent.type</code></a>。</blockquote><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-fill">Playwright <code>locator.fill</code> API</a><li><a href="https://webdriver.io/docs/api/element/setValue">WebdriverIO <code>element.setValue</code> API</a><li><a href="https://testing-library.com/docs/user-event/utility/#type">testing-library <code>type</code> API</a></ul></section><section class="level2"aria-labelledby="usereventkeyboard"><h2 id="usereventkeyboard">userEvent.keyboard</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">keyboard</span><span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>通过 <code>userEvent.keyboard</code> 可以触发键盘输入。如果任何输入有焦点，它就会在该输入中键入字符。否则，它将触发当前焦点元素（如果没有焦点元素，则为 <code>document.body</code>）上的键盘事件。<p>This API supports <a href="https://testing-library.com/docs/user-event/keyboard">user-event <code>keyboard</code> syntax</a>.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'trigger keystrokes'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">keyboard</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token comment">// translates to: f, o, o</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">keyboard</span><span class="token punctuation">(</span><span class="token string">'{{a[['</span><span class="token punctuation">)</span> <span class="token comment">// translates to: {, a, [</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">keyboard</span><span class="token punctuation">(</span><span class="token string">'{Shift}{f}{o}{o}'</span><span class="token punctuation">)</span> <span class="token comment">// translates to: Shift, f, o, o</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">keyboard</span><span class="token punctuation">(</span><span class="token string">'{a>5}'</span><span class="token punctuation">)</span> <span class="token comment">// press a without releasing it and trigger 5 keydown</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">keyboard</span><span class="token punctuation">(</span><span class="token string">'{a>5/}'</span><span class="token punctuation">)</span> <span class="token comment">// press a for 5 keydown and then release it</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-keyboard">Playwright <code>Keyboard</code> API</a><li><a href="https://webdriver.io/docs/api/browser/action#key-input-source">WebdriverIO <code>action('key')</code> API</a><li><a href="https://testing-library.com/docs/user-event/utility/#type">testing-library <code>type</code> API</a></ul></section><section class="level2"aria-labelledby="usereventtab"><h2 id="usereventtab">userEvent.tab</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">tab</span><span class="token punctuation">(</span>options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEventTabOptions</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>发送一个 <code>Tab</code> 键事件。这是<code>userEvent.keyboard('{tab}')</code>的简写。<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'tab works'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>input1<span class="token punctuation">,</span> input2<span class="token punctuation">]</span> <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">elements</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>input1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">tab</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>input2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">tab</span><span class="token punctuation">(</span><span class="token punctuation">{</span> shift<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>input1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-keyboard">Playwright <code>Keyboard</code> API</a><li><a href="https://webdriver.io/docs/api/browser/action#key-input-source">WebdriverIO <code>action('key')</code> API</a><li><a href="https://testing-library.com/docs/user-event/convenience/#tab">testing-library <code>tab</code> API</a></ul></section><section class="level2"aria-labelledby="usereventtype"><h2 id="usereventtype">userEvent.type</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">type</span><span class="token punctuation">(</span>
  element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEventTypeOptions</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><blockquote>如果不依赖 [special characters](https://testing-library.com/docs/user-event/keyboard)（例如，`{shift}` 或 `{selectall}`），建议使用 [`userEvent.fill`](#userevent-fill)。</blockquote><p><code>type</code> 方法在 <a href="https://testing-library.com/docs/user-event/keyboard"><code>keyboard</code></a> API 的基础上实现了 <code>@testing-library/user-event</code> 的 <a href="https://testing-library.com/docs/user-event/utility/#type"><code>type</code></a> 工具。<p>该函数允许您在 input/textarea/conteneditable 中键入字符。它支持 <a href="https://testing-library.com/docs/user-event/keyboard">user-event <code>keyboard</code> syntax</a>。<p>如果只需按下字符而无需输入，请使用 <a href="#userevent-keyboard"><code>userEvent.keyboard</code></a> API。<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'update input'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> input <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">type</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token comment">// input.value == foo</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">type</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token string">'{{a[['</span><span class="token punctuation">)</span> <span class="token comment">// input.value == foo{a[</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">type</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token string">'{Shift}'</span><span class="token punctuation">)</span> <span class="token comment">// input.value == foo{a[</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>info Vitest 没有像 `input.type` 那样在定位器上公开 `.type` 方法，因为它的存在只是为了与 `userEvent` 库兼容。请考虑使用 `.fill`，因为它更快。<p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-press">Playwright <code>locator.press</code> API</a><li><a href="https://webdriver.io/docs/api/browser/action#key-input-source">WebdriverIO <code>action('key')</code> API</a><li><a href="https://testing-library.com/docs/user-event/utility/#type">testing-library <code>type</code> API</a></ul></section><section class="level2"aria-labelledby="usereventclear"><h2 id="usereventclear">userEvent.clear</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">clear</span><span class="token punctuation">(</span>element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>此方法会清除输入元素的内容。<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'clears input'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> input <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveValue</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">clear</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> input<span class="token punctuation">.</span><span class="token method function property-access">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveValue</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-clear">Playwright <code>locator.clear</code> API</a><li><a href="https://webdriver.io/docs/api/element/clearValue">WebdriverIO <code>element.clearValue</code> API</a><li><a href="https://testing-library.com/docs/user-event/utility/#clear">testing-library <code>clear</code> API</a></ul></section><section class="level2"aria-labelledby="usereventselectoptions"><h2 id="usereventselectoptions">userEvent.selectOptions</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">selectOptions</span><span class="token punctuation">(</span>
  element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  values<span class="token operator">:</span>
    <span class="token operator">|</span> <span class="token maybe-class-name">HTMLElement</span>
    <span class="token operator">|</span> <span class="token maybe-class-name">HTMLElement</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span>
    <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token operator">|</span> <span class="token builtin">string</span>
    <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEventSelectOptions</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>The <code>userEvent.selectOptions</code> allows selecting a value in a <code>&#x3C;select></code> element.<blockquote>如果 select 元素没有 [`multiple`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select#attr-multiple) 属性，Vitest 将只选择数组中的第一个元素。<p>与 <code>@testing-library</code> 不同，Vitest 目前不支持 <a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles/listbox_role">listbox</a>，但我们计划在将来添加对它的支持。</blockquote><pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'clears input'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> select <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'select'</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">selectOptions</span><span class="token punctuation">(</span>select<span class="token punctuation">,</span> <span class="token string">'Option 1'</span><span class="token punctuation">)</span>
  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> select<span class="token punctuation">.</span><span class="token method function property-access">selectOptions</span><span class="token punctuation">(</span><span class="token string">'Option 1'</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveValue</span><span class="token punctuation">(</span><span class="token string">'option-1'</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">selectOptions</span><span class="token punctuation">(</span>select<span class="token punctuation">,</span> <span class="token string">'option-1'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveValue</span><span class="token punctuation">(</span><span class="token string">'option-1'</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">selectOptions</span><span class="token punctuation">(</span>select<span class="token punctuation">,</span> <span class="token punctuation">[</span>
    page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'option'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Option 1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'option'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Option 2'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveValue</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'option-1'</span><span class="token punctuation">,</span> <span class="token string">'option-2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><blockquote>`webdriverio` provider 不支持选择多个元素，因为它不提供选择多个元素的 API。</blockquote><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-select-option">Playwright <code>locator.selectOption</code> API</a><li><a href="https://webdriver.io/docs/api/element/selectByIndex">WebdriverIO <code>element.selectByIndex</code> API</a><li><a href="https://testing-library.com/docs/user-event/utility/#-selectoptions-deselectoptions">testing-library <code>selectOptions</code> API</a></ul></section><section class="level2"aria-labelledby="usereventhover"><h2 id="usereventhover">userEvent.hover</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">hover</span><span class="token punctuation">(</span>
  element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEventHoverOptions</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>该方法将光标位置移动到所选元素上。有关此方法如何工作的详细说明，请参阅 provider 的文档。<blockquote>如果使用的是 `webdriverio` provider，光标默认会移动到元素的中心。<p>如果使用的是 <code>playwright</code> provider，光标会移动到元素的某个可见点。</blockquote><pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'hovers logo element'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> logo <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">logo</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">hover</span><span class="token punctuation">(</span>logo<span class="token punctuation">)</span>
  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> logo<span class="token punctuation">.</span><span class="token method function property-access">hover</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-hover">Playwright <code>locator.hover</code> API</a><li><a href="https://webdriver.io/docs/api/element/moveTo/">WebdriverIO <code>element.moveTo</code> API</a><li><a href="https://testing-library.com/docs/user-event/convenience/#hover">testing-library <code>hover</code> API</a></ul></section><section class="level2"aria-labelledby="usereventunhover"><h2 id="usereventunhover">userEvent.unhover</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">unhover</span><span class="token punctuation">(</span>
  element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEventHoverOptions</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>其作用与 <a href="#userevent-hover"><code>userEvent.hover</code></a> 相同，但会将光标移至 <code>document.body</code> 元素。<blockquote>默认情况下，光标位置位于 body 元素的 "某个" 可见位置（在 `playwright` provider中）或中心位置（在 `webdriverio` provider中），因此如果当前悬停的元素已经位于相同位置，本方法将不起作用。</blockquote><pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'unhover logo element'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> logo <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">logo</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">unhover</span><span class="token punctuation">(</span>logo<span class="token punctuation">)</span>
  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> logo<span class="token punctuation">.</span><span class="token method function property-access">unhover</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-hover">Playwright <code>locator.hover</code> API</a><li><a href="https://webdriver.io/docs/api/element/moveTo/">WebdriverIO <code>element.moveTo</code> API</a><li><a href="https://testing-library.com/docs/user-event/convenience/#hover">testing-library <code>hover</code> API</a></ul></section><section class="level2"aria-labelledby="usereventupload"><h2 id="usereventupload">userEvent.upload</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">upload</span><span class="token punctuation">(</span>
  element<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  files<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token maybe-class-name">File</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token maybe-class-name">File</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>更改文件输入元素，使其包含指定文件。<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'can upload a file'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> input <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Upload files</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token maybe-class-name">File</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'file.png'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'image/png'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">upload</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> file<span class="token punctuation">)</span>
  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> input<span class="token punctuation">.</span><span class="token method function property-access">upload</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>

  <span class="token comment">// you can also use file paths relative to the test file</span>
  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">upload</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token string">'../fixtures/file.png'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><blockquote>`webdriverio` provider 仅在 `chrome` 和 `edge` 浏览器中支持该命令。目前也只支持字符串类型。</blockquote><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-locator#locator-set-input-files">Playwright <code>locator.setInputFiles</code> API</a><li><a href="https://webdriver.io/docs/api/browser/uploadFile">WebdriverIO <code>browser.uploadFile</code> API</a><li><a href="https://testing-library.com/docs/user-event/utility/#upload">testing-library <code>upload</code> API</a></ul></section><section class="level2"aria-labelledby="usereventdraganddrop"><h2 id="usereventdraganddrop">userEvent.dragAndDrop</h2><pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">dragAndDrop</span><span class="token punctuation">(</span>
  source<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  target<span class="token operator">:</span> <span class="token maybe-class-name">Element</span> <span class="token operator">|</span> <span class="token maybe-class-name">Locator</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">UserEventDragAndDropOptions</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></code></pre><p>将源元素拖到目标元素的顶部。不要忘记，源元素的<code>draggable</code>属性必须设置为 <code>true</code>。<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'drag and drop works'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> source <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">logo</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByTestId</span><span class="token punctuation">(</span><span class="token string">'logo-target'</span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">dragAndDrop</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> target<span class="token punctuation">)</span>
  <span class="token comment">// or you can access it directly on the locator</span>
  <span class="token keyword control-flow">await</span> source<span class="token punctuation">.</span><span class="token method function property-access">dropTo</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> expect<span class="token punctuation">.</span><span class="token method function property-access">element</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveTextContent</span><span class="token punctuation">(</span><span class="token string">'Logo is processed'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><blockquote>`preview` provider不支持此 API。</blockquote><p>References:<ul><li><a href="https://playwright.dev/docs/api/class-frame#frame-drag-and-drop">Playwright <code>frame.dragAndDrop</code> API</a><li><a href="https://webdriver.io/docs/api/element/dragAndDrop/">WebdriverIO <code>element.dragAndDrop</code> API</a> <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></ul></section></section>