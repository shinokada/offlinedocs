<!doctype html><html lang="cn"><meta charset="utf-8"><title>Testing Types | Guide</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="testing-types"class="level1"><h1>Testing Types</h1><p>Vitest allows you to write tests for your types, using <code>expectTypeOf</code> or <code>assertType</code> syntaxes. By default all tests inside <code>*.test-d.ts</code> files are considered type tests, but you can change it with <a href="../config.html#typecheck-include"><code>typecheck.include</code></a> config option.<p>Under the hood Vitest calls <code>tsc</code> or <code>vue-tsc</code>, depending on your config, and parses results. Vitest will also print out type errors in your source code, if it finds any. You can disable it with <a href="../config.html#typecheck-ignoresourceerrors"><code>typecheck.ignoreSourceErrors</code></a> config option.<p>Keep in mind that Vitest doesn't run or compile these files, they are only statically analyzed by the compiler, and because of that you cannot use any dynamic statements. Meaning, you cannot use dynamic test names, and <code>test.each</code>, <code>test.runIf</code>, <code>test.skipIf</code>, <code>test.each</code>, <code>test.concurrent</code> APIs. But you can use other APIs, like <code>test</code>, <code>describe</code>, <code>.only</code>, <code>.skip</code> and <code>.todo</code>.<p>Using CLI flags, like <code>--allowOnly</code> and <code>-t</code> are also supported for type checking.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> assertType<span class="token punctuation">,</span> expectTypeOf <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> mount <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./mount.js'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'my types work properly'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">expectTypeOf</span><span class="token punctuation">(</span>mount<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">expectTypeOf</span><span class="token punctuation">(</span>mount<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">parameter</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">toMatchTypeOf</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// @ts-expect-error name is a string</span>
  <span class="token function">assertType</span><span class="token punctuation">(</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token number">42</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>Any type error triggered inside a test file will be treated as a test error, so you can use any type trick you want to test types of your project.<p>You can see a list of possible matchers in <a href="../api.html#expecttypeof">API section</a>.<section id="reading-errors"class="level2"><h2>Reading Errors</h2><p>If you are using <code>expectTypeOf</code> API, you might notice hard to read errors or unexpected:<pre class="language-ts"><code class="language-ts"><span class="token function">expectTypeOf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">toEqualTypeOf</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//             ^^^^^^^^^^^^^^^^^^^^^^</span>
<span class="token comment">// index-c3943160.d.ts(90, 20): Arguments for the rest parameter 'MISMATCH' were not provided.</span></code></pre><p>This is due to how <a href="https://github.com/mmkal/expect-type"><code>expect-type</code></a> handles type errors.<p>Unfortunately, TypeScript doesn't provide type metadata without patching, so we cannot provide useful error messages at this point, but there are <a href="https://github.com/microsoft/TypeScript/pull/40468"tatger="_blank">works in TypeScript project</a> to fix this. If you want better messages, please, ask TypeScript team to have a look at mentioned PR.<p>If you find it hard working with <code>expectTypeOf</code> API and figuring out errors, you can always use more simple <code>assertType</code> API:<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> answer <span class="token operator">=</span> <span class="token number">42</span>

<span class="token generic-function"><span class="token function">assertType</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token builtin">number</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span>
<span class="token comment">// @ts-expect-error answer is not a string</span>
<span class="token generic-function"><span class="token function">assertType</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span></code></pre><blockquote>When using `@ts-expect-error` syntax, you might want to make sure that you didn't make a typo. You can do that by including your type files in [`test.include`](../config.html#include) config option, so Vitest will also actually *run* these tests and fail with `ReferenceError`.<p>This will pass, because it expects an error, but the word “answer” has a typo, so it's a false positive error:<pre class="language-ts"><code class="language-ts"><span class="token comment">// @ts-expect-error answer is not a string</span>
<span class="token generic-function"><span class="token function">assertType</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>answr<span class="token punctuation">)</span> <span class="token comment">//</span></code></pre></blockquote></section><section id="run-typechecking"class="level2"><h2>Run typechecking</h2><p>Add this command to your <code>scripts</code> section in <code>package.json</code>:<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"typecheck"</span><span class="token operator">:</span> <span class="token string">"vitest typecheck"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Now you can run typecheck:<pre class="language-sh"><code class="language-sh"># npm
npm run typecheck

# yarn
yarn typecheck

# pnpm
pnpm run typecheck</code></pre><p>Vitest uses <code>tsc --noEmit</code> or <code>vue-tsc --noEmit</code>, depending on your configuration, so you can remove these scripts from your pipeline. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>