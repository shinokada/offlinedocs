<!doctype html><html lang="cn"><meta charset="utf-8"><title>Command Line Interface | Guide</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="命令行界面"><h1 id="命令行界面">命令行界面</h1><section class="level2"aria-labelledby="命令"><h2 id="命令">命令</h2><section class="level3"aria-labelledby="vitest"><h3 id="vitest"><code>vitest</code></h3><p>在当前目录中启动 Vitest。在开发环境会自动进入监听(<code>watch</code>)模式，在 CI 环境会自动进入运行(<code>run</code>)模式。<p>你可以通过添加参数作为过滤器来运行测试文件，比如：<pre class="language-bash"><code class="language-bash">vitest foobar</code></pre><p>将仅运行路径中包含 <code>foobar</code> 的测试文件。 此过滤器仅检查包含，不支持正则表达式或 glob 模式（除非你的终端在 Vitest 接收过滤器之前对其进行处理）。</section><section class="level3"aria-labelledby="vitest-run"><h3 id="vitest-run"><code>vitest run</code></h3><p>在没有监听模式的情况下执行单次运行。</section><section class="level3"aria-labelledby="vitest-watch"><h3 id="vitest-watch"><code>vitest watch</code></h3><p>运行所有测试套件，监听变化并在变化时重新运行测试。与没有参数的情况下调用 <code>vitest</code> 一样。在 CI 环境中，此命令将回退到 <code>vitest run</code>。</section><section class="level3"aria-labelledby="vitest-dev"><h3 id="vitest-dev"><code>vitest dev</code></h3><p><code>vitest watch</code> 的别名。</section><section class="level3"aria-labelledby="vitest-related"><h3 id="vitest-related"><code>vitest related</code></h3><p>仅运行涵盖源文件列表的测试。 适用于静态惰性导入(例如, <code>import('./index.ts')</code> 或者 <code>import index from './index.ts</code>)，但不适用于动态导入(例如, <code>import(filepath)</code>)。 所有文件都应该相对于根文件夹。<p>与 <a href="https://github.com/okonet/lint-staged"><code>lint-staged</code></a> 或你的 CI 设置一起运行很有用。<pre class="language-bash"><code class="language-bash">vitest related /src/index.ts /src/hello-world.js</code></pre></section><section class="level3"aria-labelledby="vitest-clean-cache"><h3 id="vitest-clean-cache"><code>vitest clean cache</code></h3><blockquote>不要忘记 Vitest 默认情况下以启用的监视模式运行。如果你使用的是 `lint-staged` 之类的工具，你还应该传递 `--run` 选项，以便该命令可以正常退出。<pre class="language-js"><code class="language-js"><span class="token comment">// .lintstagedrc.js</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  <span class="token string-property property">'*.{js,ts}'</span><span class="token operator">:</span> <span class="token string">'vitest related --run'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></blockquote></section><section class="level3"aria-labelledby="vitest-bench"><h3 id="vitest-bench"><code>vitest bench</code></h3><p>仅运行 <a href="https://vitest.dev/guide/features.html#benchmarking-experimental">基准测试</a> 测试，比较性能结果。</section></section><section class="level2"aria-labelledby="选项"><h2 id="选项">选项</h2><table><thead><tr><th>选项<th>描述<tbody><tr><td><code>-v, --version</code><td>显示版本号<tr><td><code>-r, --root &#x3C;path></code><td>定义项目根目录<tr><td><code>-c, --config &#x3C;path></code><td>定义配置文件路径<tr><td><code>-u, --update</code><td>更新快照<tr><td><code>-w, --watch</code><td>智能即时浏览模式<tr><td><code>-t, --testNamePattern &#x3C;pattern></code><td>使用与模式匹配的全名运行测试<tr><td><code>--dir &#x3C;path></code><td>用于扫描测试文件的基本目录<tr><td><code>--ui</code><td>启用 UI<tr><td><code>--open</code><td>如果启用，则自动打开 UI (default: <code>true</code>)<tr><td><code>--api [api]</code><td>服务 API，可用选项：<code>--api.port &#x3C;port></code>、<code>--api.host [host]</code> 和 <code>--api.strictPort</code><tr><td><code>--threads</code><td>启用线程 (default: <code>true</code>)<tr><td><code>--silent</code><td>控制台输出测试结果<tr><td><code>--isolate</code><td>为每个测试文件隔离环境 (default: <code>true</code>)<tr><td><code>--reporter &#x3C;name></code><td>选择报告器：<code>default</code>、<code>verbose</code>、<code>dot</code>、<code>junit</code>、<code>json</code> 或自定义报告器的路径<tr><td><code>--outputDiffLines &#x3C;lines></code><td>使用 <code>&#x3C;lines></code> 指定输出 diff 的数量<tr><td><code>--outputFile &#x3C;filename/-s></code><td>当指定了 <code>--reporter=json</code> 或 <code>--reporter=junit</code> 选项时，将测试结果写入文件<br>通过 [cac's dot notation] 可以为多个报告器指定单独的输出<tr><td><code>--coverage</code><td>启用输出覆盖率报告<tr><td><code>--run</code><td>不使用浏览模式<tr><td><code>--mode &#x3C;name></code><td>覆盖 Vite 模式 (default: <code>test</code>)<tr><td><code>--globals</code><td>注入全局 API<tr><td><code>--dom</code><td>使用 happy-dom 模拟浏览器 API<tr><td><code>--browser [options]</code><td>在 <a href="/guide/browser">浏览器模式</a> 中运行测试(默认值：<code>false</code>）<tr><td><code>--environment &#x3C;env></code><td>Runner environment (default: <code>node</code>)<tr><td><code>--passWithNoTests</code><td>未找到测试时通过<tr><td><code>--logHeapUsage</code><td>显示每个测试的堆大小<tr><td><code>--allowOnly</code><td>允许标记为 <code>only</code> 的测试和套件 (default: false in CI, true otherwise)<tr><td><code>--dangerouslyIgnoreUnhandledErrors</code><td>忽略发生的任何未处理的错误<tr><td><code>--changed [since]</code><td>运行受更改文件影响的测试 (default: false)，更多内容请查看 <a href="#changed">文档</a><tr><td><code>--shard &#x3C;shard></code><td>配置测试分片<tr><td><code>--sequence</code><td>定义运行测试的顺序，使用 [cac's dot notation] 来指定选项（例如，使用 <code>--sequence.suffle</code> 以随机顺序运行测试）<tr><td><code>--no-color</code><td>控制台输出中禁用颜色<tr><td><code>--inspect</code><td>启用 Node.js 检查器<tr><td><code>--inspect-brk</code><td>使用中断模式启用 Node.js 检查器<tr><td><code>--bail &#x3C;number></code><td>当给定数量的测试失败时停止测试执行。<tr><td><code>-h, --help</code><td>显示可用的 CLI 选项</table><blockquote>Vitest 支持 CLI 参数的骆驼式命名法和烤肉串式命名法。例如，`--passWithNoTests` 和 `--pass-with-no-tests` 都有效（`--no-color` 和 `--inspect-brk` 是例外）。<p>Vitest 还支持不同的指定值的方式：<code>--reporter dot</code> 和 <code>--reporter=dot</code> 都是有效的。<p>如果选项支持值数组，则需要多次传递选项：<pre class="language-text"><code class="language-text">vitest --reporter=dot --reporter=default</code></pre><p>布尔值选项可以用 <code>no-</code> 前缀来否定。将值指定为 <code>false</code> 也有效：<pre class="language-text"><code class="language-text">vitest --no-api
vitest --api=false</code></pre></blockquote><section class="level3"aria-labelledby="变更"><h3 id="变更">变更</h3><ul><li><p><strong>类型</strong>: <code>boolean | string</code><li><p><strong>默认值</strong>: false<p>再次运行有变更的测试文件。如果未发生变更，它将再次运行未提交的变更（包括分段和非分段）。<p>在上次提交的变更模式下，再次运行测试，你可以使用 <code>--changed HEAD~1</code>。也可以使用提交哈希或者分支名称。</ul></section><section class="level3"aria-labelledby="分片"><h3 id="分片">分片</h3><p>假如找到匹配项，如果配置了 <code>forceRerunTriggers</code> 选项，那么它将运行整个测试套件。<ul><li><p><strong>类型</strong>: <code>string</code><li><p><strong>默认值</strong>: disabled<p>要以 <code>&#x3C;index></code>/<code>&#x3C;count></code> 格式来执行的测试套件分片，其中<ul><li><code>count</code> 是一个正整数，它表示拆分测试分片的数量<li><code>index</code> 是一个正整数, 它表示拆分测试分片的索引</ul><p>该命令将所有测试通过 <code>count</code> 来拆分，并仅运行恰好位于 <code>index</code> 部分的测试。比如，将你的测试套件拆分为三份，可以这样使用：<pre class="language-sh"><code class="language-sh">vitest run --shard=1/3
vitest run --shard=2/3
vitest run --shard=3/3</code></pre></ul><blockquote>警告 你不能使用 `--watch` 选项 (在开发环境下默认启用)。</blockquote><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section></section>