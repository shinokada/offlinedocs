<!doctype html><html lang="cn"><meta charset="utf-8"><title>Command Line Interface | Guide</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="命令行界面"class="level1"><h1>命令行界面</h1><section id="命令"class="level2"><h2>命令</h2><section id="vitest"class="level3"><h3><code>vitest</code></h3><p>在当前目录中启动 Vitest 将进入浏览模式，它运行在开发环境并且在 CI 中自动运行。<p>你可以通过添加参数作为过滤器来运行测试文件，比如：<pre class="language-bash"><code class="language-bash">vitest foobar</code></pre><p>只运行包含 <code>foobar</code> 路径下的测试文件。</section><section id="vitest-run"class="level3"><h3><code>vitest run</code></h3><p>在没有浏览模式的情况下执行单次运行。</section><section id="vitest-watch"class="level3"><h3><code>vitest watch</code></h3><p>运行所有测试套件，但要注意更改并在更改时重新运行测试。类似于在没有命令的情况下调用 <code>vitest</code>。在 CI 环境中，此命令将回退到 <code>vitest run</code>。</section><section id="vitest-dev"class="level3"><h3><code>vitest dev</code></h3><p><code>vitest watch</code> 的别名。</section><section id="vitest-related"class="level3"><h3><code>vitest related</code></h3><p>仅运行涵盖源文件列表的测试。 适用于静态惰性导入(例如, <code>import('./index.ts')</code> 或者 <code>import index from './index.ts</code>)，但不适用于动态导入(例如, <code>import(filepath)</code>)。 所有文件都应该相对于根文件夹。<p>与 <a href="https://github.com/okonet/lint-staged"><code>lint-staged</code></a> 或你的 CI 设置一起运行很有用。<pre class="language-bash"><code class="language-bash">vitest related /src/index.ts /src/hello-world.js</code></pre></section><section id="vitest-clean-cache"class="level3"><h3><code>vitest clean cache</code></h3><p>清空缓存目录。</section></section><section id="选项"class="level2"><h2>选项</h2><table><thead><tr><th>选项<th>描述<tbody><tr><td><code>-v, --version</code><td>显示版本号<tr><td><code>-r, --root &#x3C;path></code><td>定义项目根目录<tr><td><code>-c, --config &#x3C;path></code><td>定义配置文件路径<tr><td><code>-u, --update</code><td>更新快照<tr><td><code>-w, --watch</code><td>智能即时浏览模式<tr><td><code>-t, --testNamePattern &#x3C;pattern></code><td>使用与模式匹配的全名运行测试<tr><td><code>--dir &#x3C;path></code><td>用于扫描测试文件的基本目录<tr><td><code>--ui</code><td>启用 UI<tr><td><code>--open</code><td>如果启用，则自动打开 UI (default: <code>true</code>)<tr><td><code>--api [api]</code><td>服务 API，可用选项：<code>--api.port &#x3C;port></code>、<code>--api.host [host]</code> 和 <code>--api.strictPort</code><tr><td><code>--threads</code><td>启用线程 (default: <code>true</code>)<tr><td><code>--silent</code><td>测试的控制台输出<tr><td><code>--isolate</code><td>为每个测试文件隔离环境 (default: <code>true</code>)<tr><td><code>--reporter &#x3C;name></code><td>选择报告器：<code>default</code>、<code>verbose</code>、<code>dot</code>、<code>junit</code>、<code>json</code> 或自定义报告器的路径<tr><td><code>--outputTruncateLength &#x3C;length></code><td>使用 <code>&#x3C;length></code> 指定截断输出差异的字符行数<tr><td><code>--outputDiffLines &#x3C;lines></code><td>使用 <code>&#x3C;lines></code> 指定输出差线的数量<tr><td><code>--outputFile &#x3C;filename/-s></code><td>当还指定了 <code>--reporter=json</code> 或 <code>--reporter=junit</code> 选项时，将测试结果写入文件<br>通过 [cac's dot notation] 可以为多个报告器指定单独的输出<tr><td><code>--coverage</code><td>使用 c8 进行覆盖率输出<tr><td><code>--run</code><td>不使用浏览模式<tr><td><code>--mode</code><td>覆盖 Vite 模式 (default: <code>test</code>)<tr><td><code>--mode &#x3C;name></code><td>覆盖 Vite 模式 (default: <code>test</code>)<tr><td><code>--globals</code><td>注入全局 API<tr><td><code>--dom</code><td>使用 happy-dom 模拟浏览器 API<tr><td><code>--browser</code><td>在浏览器中运行测试<tr><td><code>--environment &#x3C;env></code><td>设置运行的环境 (default: <code>node</code>)<tr><td><code>--passWithNoTests</code><td>未找到测试时通过<tr><td><code>--allowOnly</code><td>允许标记为 <code>only</code> 的测试和套件 (default: false in CI, true otherwise)<tr><td><code>--dangerouslyIgnoreUnhandledErrors</code><td>忽略发生的任何未处理的错误<tr><td><code>--changed [since]</code><td>运行受更改文件影响的测试 (default: false)，更多内容请查看 <a href="#changed">文档</a><tr><td><code>--shard &#x3C;shard></code><td>配置测试分片<tr><td><code>--sequence</code><td>定义运行测试的顺序，使用 [cac's dot notation] 来指定选项（例如，使用 <code>--sequence.suffle</code> 以随机顺序运行测试）<tr><td><code>--no-color</code><td>从控制台输出中禁用颜色<tr><td><code>-h, --help</code><td>显示可用的 CLI 选项</table><section id="变更"class="level3"><h3>变更</h3><ul><li><p><strong>类型</strong>: <code>boolean | string</code><li><p><strong>默认值</strong>: false<p>再次运行有变更的测试文件。如果未发生变更，它将再次运行未提交的变更（包括分段和非分段）。<p>在上次提交的变更模式下，再次运行测试，你可以使用 <code>--changed HEAD~1</code>。也可以使用提交哈希或者分支名称。</ul></section><section id="分片"class="level3"><h3>分片</h3><p>假如找到匹配项，如果配置了 <code>forceRerunTriggers</code> 选项，那么它将运行整个测试套件。<ul><li><p><strong>类型</strong>: <code>string</code><li><p><strong>默认值</strong>: disabled<p>要以 <code>&#x3C;index></code>/<code>&#x3C;count></code> 格式来执行的测试套件分片，其中<ul><li><code>count</code> 是一个正整数，它表示拆分测试分片的数量<li><code>index</code> 是一个正整数, 它表示拆分测试分片的索引</ul><p>该命令将所有测试通过 <code>count</code> 来拆分，并仅运行恰好位于 <code>index</code> 部分的测试。比如，将你的测试套件拆分为三份，可以这样使用：<pre class="language-sh"><code class="language-sh">vitest run --shard=1/3
vitest run --shard=2/3
vitest run --shard=3/3</code></pre></ul><blockquote>警告 你不能使用 `--watch` 选项 (在开发环境下默认启用)。</blockquote><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section></section>