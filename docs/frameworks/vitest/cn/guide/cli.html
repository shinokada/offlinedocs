<!doctype html><html lang="cn"><meta charset="utf-8"><title>Command Line Interface | Guide</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="命令行界面"><h1 id="命令行界面">命令行界面</h1><section class="level2"aria-labelledby="命令"><h2 id="命令">命令</h2><section class="level3"aria-labelledby="vitest"><h3 id="vitest"><code>vitest</code></h3><p>在当前目录中启动 Vitest。在开发环境会自动进入监听(<code>watch</code>)模式，在 CI 环境会自动进入运行(<code>run</code>)模式。<p>你可以通过添加参数作为过滤器来运行测试文件，比如：<pre class="language-bash"><code class="language-bash">vitest foobar</code></pre><p>将仅运行路径中包含 <code>foobar</code> 的测试文件。 此过滤器仅检查包含，不支持正则表达式或 glob 模式（除非你的终端在 Vitest 接收过滤器之前对其进行处理）。</section><section class="level3"aria-labelledby="vitest-run"><h3 id="vitest-run"><code>vitest run</code></h3><p>在没有监听模式的情况下执行单次运行。</section><section class="level3"aria-labelledby="vitest-watch"><h3 id="vitest-watch"><code>vitest watch</code></h3><p>运行所有测试套件，监听变化并在变化时重新运行测试。与没有参数的情况下调用 <code>vitest</code> 一样。在 CI 环境中，此命令将回退到 <code>vitest run</code>。</section><section class="level3"aria-labelledby="vitest-dev"><h3 id="vitest-dev"><code>vitest dev</code></h3><p><code>vitest watch</code> 的别名。</section><section class="level3"aria-labelledby="vitest-related"><h3 id="vitest-related"><code>vitest related</code></h3><p>仅运行涵盖源文件列表的测试。 适用于静态惰性导入(例如, <code>import('./index.ts')</code> 或者 <code>import index from './index.ts</code>)，但不适用于动态导入(例如, <code>import(filepath)</code>)。 所有文件都应该相对于根文件夹。<p>与 <a href="https://github.com/okonet/lint-staged"><code>lint-staged</code></a> 或你的 CI 设置一起运行很有用。<pre class="language-bash"><code class="language-bash">vitest related /src/index.ts /src/hello-world.js</code></pre><blockquote>不要忘记 Vitest 默认情况下以启用的监视模式运行。如果你使用的是 `lint-staged` 之类的工具，你还应该传递 `--run` 选项，以便该命令可以正常退出。<pre class="language-js"><code class="language-js"><span class="token comment">// .lintstagedrc.js</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  <span class="token string-property property">'*.{js,ts}'</span><span class="token operator">:</span> <span class="token string">'vitest related --run'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></blockquote></section><section class="level3"aria-labelledby="vitest-bench"><h3 id="vitest-bench"><code>vitest bench</code></h3><p>仅运行 <a href="https://vitest.dev/guide/features.html#benchmarking-experimental">基准</a> 测试，比较性能结果。</section></section><section class="level2"aria-labelledby="选项"><h2 id="选项">选项</h2><table><thead><tr><th>选项<th><tbody><tr><td><code>-v, --version</code><td>显示版本号<tr><td><code>-r, --root &#x3C;path></code><td>指定项目根目录<tr><td><code>-c, --config &#x3C;path></code><td>指定配置文件路径<tr><td><code>-u, --update</code><td>更新快照<tr><td><code>-w, --watch</code><td>智能即时浏览模式<tr><td><code>-t, --testNamePattern &#x3C;pattern></code><td>使用与模式匹配的全名运行测试<tr><td><code>--dir &#x3C;path></code><td>指定扫描测试文件的基本目录<tr><td><code>--ui</code><td>启用 UI<tr><td><code>--open</code><td>如果启用，则自动打开 UI (默认值: <code>true</code>)<tr><td><code>--api [api]</code><td>服务端 API，可用选项：<code>--api.port &#x3C;port></code>、<code>--api.host [host]</code> 和 <code>--api.strictPort</code><tr><td><code>--threads</code><td>启用线程 (默认值: <code>true</code>)<tr><td><code>--single-thread</code><td>在单个线程内运行测试，使用 --threads (默认值: <code>false</code>)<tr><td><code>--experimental-vm-threads</code><td>使用虚拟机隔离在工作池中运行测试 (默认值: <code>false</code>)<tr><td><code>--experimental-vm-worker-memory-limit</code><td>设置工作线程允许的最大内存。当达到时，将创建一个新的工作线程<tr><td><code>--silent</code><td>控制台输出测试结果<tr><td><code>--isolate</code><td>为每个测试文件设置隔离环境 (默认值: <code>true</code>)<tr><td><code>--reporter &#x3C;name></code><td>选择报告器：<code>default</code>、<code>verbose</code>、<code>dot</code>、<code>junit</code>、<code>json</code> 或自定义报告器的路径<tr><td><code>--outputFile &#x3C;filename/-s></code><td>当指定了 <code>--reporter=json</code> 或 <code>--reporter=junit</code> 选项时，将测试结果写入文件<br>通过 [cac's dot notation] 可以为多个报告器指定单独的输出<tr><td><code>--coverage</code><td>启用输出覆盖率报告<tr><td><code>--run</code><td>不使用监听模式运行测试<tr><td><code>--mode</code><td>覆盖 Vite 模式 (默认值: <code>test</code>)<tr><td><code>--mode &#x3C;name></code><td>覆盖 Vite 模式 (默认值: <code>test</code>)<tr><td><code>--globals</code><td>注入全局 API<tr><td><code>--dom</code><td>使用 happy-dom 模拟浏览器<tr><td><code>--browser [options]</code><td>在 <a href="/guide/browser">浏览器模式</a> 中运行测试 (默认值：<code>false</code>)<tr><td><code>--environment &#x3C;env></code><td>运行环境 (默认值: <code>node</code>)<tr><td><code>--passWithNoTests</code><td>未找到测试时通过<tr><td><code>--logHeapUsage</code><td>显示每个测试的堆大小 test<tr><td><code>--allowOnly</code><td>允许标记为 <code>only</code> 的测试和套件 (默认值: 在 CI 中 false, 否则为 true)<tr><td><code>--dangerouslyIgnoreUnhandledErrors</code><td>忽略发生的任何未处理的错误<tr><td><code>--changed [since]</code><td>运行受更改文件影响的测试 (默认值: false)，更多内容请查看 <a href="#changed">文档</a><tr><td><code>--shard &#x3C;shard></code><td>按照指定分片执行测试<tr><td><code>--sequence</code><td>定义运行测试的顺序，使用 [cac's dot notation] 来指定选项（例如，使用 <code>--sequence.suffle</code> 以随机顺序运行测试）<tr><td><code>--no-color</code><td>控制台输出中禁用颜色<tr><td><code>--inspect</code><td>启用 Node.js 检查器<tr><td><code>--inspect-brk</code><td>使用中断模式启用 Node.js 检查器<tr><td><code>--bail &#x3C;number></code><td>当给定数量的测试失败时停止测试执行<tr><td><code>--retry &#x3C;times></code><td>当测试失败时，指定重试的次数<tr><td><code>-h, --help</code><td>显示可用的命令行选项</table><blockquote>Vitest 支持 CLI 参数的骆驼式命名法和烤肉串式命名法。例如，`--passWithNoTests` 和 `--pass-with-no-tests` 都有效（`--no-color` 和 `--inspect-brk` 是例外）。<p>Vitest 还支持不同的指定值的方式：<code>--reporter dot</code> 和 <code>--reporter=dot</code> 都是有效的。<p>如果选项支持值数组，则需要多次传递选项：<pre class="language-bash"><code class="language-bash">vitest --reporter<span class="token operator">=</span>dot --reporter<span class="token operator">=</span>default</code></pre><p>布尔值选项可以用 <code>no-</code> 前缀来否定。将值指定为 <code>false</code> 也有效：<pre class="language-bash"><code class="language-bash">vitest --no-api
vitest --api<span class="token operator">=</span>false</code></pre></blockquote><section class="level3"aria-labelledby="changed"><h3 id="changed">changed</h3><ul><li><p><strong>类型</strong>: <code>boolean | string</code><li><p><strong>默认值</strong>: false<p>设置为 true 时，仅对已更改的文件运行测试。默认情况下，将考虑所有未提交的更改（包括已暂存和未暂存的文件）。<p>要对最近一次提交中的更改运行测试，可以使用 <code>--changed HEAD~1</code>。还可以使用提交哈希（<code>commit hash</code>）或分支名称。<p>如果与 <code>forceRerunTriggers</code> 配置选项配合使用，并找到与更改的文件匹配的内容，将运行整个测试套件。</ul></section><section class="level3"aria-labelledby="shard"><h3 id="shard">shard</h3><ul><li><p><strong>类型</strong>: <code>string</code><li><p><strong>默认值</strong>: disabled<p>测试套件分片，格式为 <code>&#x3C;index>/&#x3C;count></code>，其中<ul><li><code>count</code> 是正整数，表示分割的部分数<li><code>index</code> 是正整数，表示当前分片的索引</ul><p>该命令将将所有测试分成 <code>count</code> 个相等的部分，并只运行位于 <code>index</code> 部分的测试。例如，要将测试套件分成三个部分，请使用以下命令：<pre class="language-sh"><code class="language-sh">vitest run --shard=1/3
vitest run --shard=2/3
vitest run --shard=3/3</code></pre></ul><blockquote>警告 无法在启用 `--watch`（默认情况下在开发中启用）时使用此选项。</blockquote><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section></section>