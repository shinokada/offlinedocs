<!doctype html><html lang="en"><meta charset="utf-8"><title>Mock Functions</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="mock-functions"><h1 id="mock-functions">Mock Functions</h1><p>You can create a mock function to track its execution with <code>vi.fn</code> method. If you want to track a method on an already created object, you can use <code>vi.spyOn</code> method:<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> vi <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest'</span>

<span class="token keyword">const</span> fn <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
fn<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">calls</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token punctuation">[</span><span class="token string">'hello world'</span><span class="token punctuation">]</span>

<span class="token keyword">const</span> market <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">getApples</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token number">100</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> getApplesSpy <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">spyOn</span><span class="token punctuation">(</span>market<span class="token punctuation">,</span> <span class="token string">'getApples'</span><span class="token punctuation">)</span>
market<span class="token punctuation">.</span><span class="token method function property-access">getApples</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
getApplesSpy<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">calls</span><span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">===</span> <span class="token number">1</span></code></pre><p>You should use mock assertions (e.g., <a href="/api/expect#tohavebeencalled"><code>toHaveBeenCalled</code></a>) on <a href="/api/expect"><code>expect</code></a> to assert mock result. This API reference describes available properties and methods to manipulate mock behavior.<section class="level2"aria-labelledby="getmockimplementation"><h2 id="getmockimplementation">getMockImplementation</h2><ul><li><strong>Type:</strong> <code>(...args: any) => any</code></ul><p>Returns current mock implementation if there is one.<p>If mock was created with <a href="/api/vi#vi-fn"><code>vi.fn</code></a>, it will consider passed down method as a mock implementation.<p>If mock was created with <a href="/api/vi#vi-spyon"><code>vi.spyOn</code></a>, it will return <code>undefined</code> unless a custom implementation was provided.</section><section class="level2"aria-labelledby="getmockname"><h2 id="getmockname">getMockName</h2><ul><li><strong>Type:</strong> <code>() => string</code></ul><p>Use it to return the name given to mock with method <code>.mockName(name)</code>.</section><section class="level2"aria-labelledby="mockclear"><h2 id="mockclear">mockClear</h2><ul><li><strong>Type:</strong> <code>() => MockInstance</code></ul><p>Clears all information about every call. After calling it, all properties on <code>.mock</code> will return empty state. This method does not reset implementations. It is useful if you need to clean up mock between different assertions.<p>If you want this method to be called before each test automatically, you can enable <a href="../config.html#clearmocks"><code>clearMocks</code></a> setting in config.</section><section class="level2"aria-labelledby="mockname"><h2 id="mockname">mockName</h2><ul><li><strong>Type:</strong> <code>(name: string) => MockInstance</code></ul><p>Sets internal mock name. Useful to see the name of the mock if assertion fails.</section><section class="level2"aria-labelledby="mockimplementation"><h2 id="mockimplementation">mockImplementation</h2><ul><li><strong>Type:</strong> <code>(fn: Function) => MockInstance</code></ul><p>Accepts a function that will be used as an implementation of the mock.<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> mockFn <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span>apples<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> apples <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">// or: vi.fn(apples => apples + 1);</span>

<span class="token keyword">const</span> <span class="token maybe-class-name">NelliesBucket</span> <span class="token operator">=</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">BobsBucket</span> <span class="token operator">=</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token maybe-class-name">NelliesBucket</span> <span class="token operator">===</span> <span class="token number">1</span> <span class="token comment">// true</span>
<span class="token maybe-class-name">BobsBucket</span> <span class="token operator">===</span> <span class="token number">2</span> <span class="token comment">// true</span>

mockFn<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">calls</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">0</span> <span class="token comment">// true</span>
mockFn<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">calls</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">1</span> <span class="token comment">// true</span></code></pre></section><section class="level2"aria-labelledby="mockimplementationonce"><h2 id="mockimplementationonce">mockImplementationOnce</h2><ul><li><strong>Type:</strong> <code>(fn: Function) => MockInstance</code></ul><p>Accepts a function that will be used as mock's implementation during the next call. Can be chained so that multiple function calls produce different results.<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> myMockFn <span class="token operator">=</span> vi
  <span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockImplementationOnce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockImplementationOnce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// false</span></code></pre><p>When the mocked function runs out of implementations, it will invoke the default implementation that was set with <code>vi.fn(() => defaultValue)</code> or <code>.mockImplementation(() => defaultValue)</code> if they were called:<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> myMockFn <span class="token operator">=</span> vi
  <span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token string">'default'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockImplementationOnce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token string">'first call'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockImplementationOnce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token string">'second call'</span><span class="token punctuation">)</span>

<span class="token comment">// 'first call', 'second call', 'default', 'default'</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></section><section class="level2"aria-labelledby="withimplementation"><h2 id="withimplementation">withImplementation</h2><ul><li><strong>Type:</strong> <code>(fn: Function, callback: () => void) => MockInstance</code><li><strong>Type:</strong> <code>(fn: Function, callback: () => Promise&#x3C;unknown>) => Promise&#x3C;MockInstance></code></ul><p>Overrides the original mock implementation temporarily while the callback is being executed.<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> myMockFn <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token string">'original'</span><span class="token punctuation">)</span>

myMockFn<span class="token punctuation">.</span><span class="token method function property-access">withImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token string">'temp'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'temp'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'original'</span></code></pre><p>Can be used with an asynchronous callback. The method has to be awaited to use the original implementation afterward.<pre class="language-ts"><code class="language-ts"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'async callback'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> myMockFn <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token string">'original'</span><span class="token punctuation">)</span>

  <span class="token comment">// We await this call since the callback is async</span>
  <span class="token keyword control-flow">await</span> myMockFn<span class="token punctuation">.</span><span class="token method function property-access">withImplementation</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token string">'temp'</span><span class="token punctuation">,</span>
    <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'temp'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>

  <span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'original'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>Note that this method takes precedence over the <a href="#mockimplementationonce"><code>mockImplementationOnce</code></a>.</section><section class="level2"aria-labelledby="mockrejectedvalue"><h2 id="mockrejectedvalue">mockRejectedValue</h2><ul><li><strong>Type:</strong> <code>(value: any) => MockInstance</code></ul><p>Accepts an error that will be rejected when async function is called.<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> asyncMock <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">mockRejectedValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token known-class-name class-name">Error</span></span><span class="token punctuation">(</span><span class="token string">'Async error'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword control-flow">await</span> <span class="token function">asyncMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// throws "Async error"</span></code></pre></section><section class="level2"aria-labelledby="mockrejectedvalueonce"><h2 id="mockrejectedvalueonce">mockRejectedValueOnce</h2><ul><li><strong>Type:</strong> <code>(value: any) => MockInstance</code></ul><p>Accepts a value that will be rejected during the next function call. If chained, every consecutive call will reject specified value.<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> asyncMock <span class="token operator">=</span> vi
  <span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockResolvedValueOnce</span><span class="token punctuation">(</span><span class="token string">'first call'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockRejectedValueOnce</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token known-class-name class-name">Error</span></span><span class="token punctuation">(</span><span class="token string">'Async error'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword control-flow">await</span> <span class="token function">asyncMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// first call</span>
<span class="token keyword control-flow">await</span> <span class="token function">asyncMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// throws "Async error"</span></code></pre></section><section class="level2"aria-labelledby="mockreset"><h2 id="mockreset">mockReset</h2><ul><li><strong>Type:</strong> <code>() => MockInstance</code></ul><p>Does what <code>mockClear</code> does and makes inner implementation an empty function (returning <code>undefined</code> when invoked). This also resets all "once" implementations. This is useful when you want to completely reset a mock to the default state.<p>If you want this method to be called before each test automatically, you can enable <a href="../config.html#mockreset"><code>mockReset</code></a> setting in config.</section><section class="level2"aria-labelledby="mockrestore"><h2 id="mockrestore">mockRestore</h2><ul><li><strong>Type:</strong> <code>() => MockInstance</code></ul><p>Does what <code>mockReset</code> does and restores inner implementation to the original function.<p>Note that restoring mock from <code>vi.fn()</code> will set implementation to an empty function that returns <code>undefined</code>. Restoring a <code>vi.fn(impl)</code> will restore implementation to <code>impl</code>.<p>If you want this method to be called before each test automatically, you can enable <a href="../config.html#restoremocks"><code>restoreMocks</code></a> setting in config.</section><section class="level2"aria-labelledby="mockresolvedvalue"><h2 id="mockresolvedvalue">mockResolvedValue</h2><ul><li><strong>Type:</strong> <code>(value: any) => MockInstance</code></ul><p>Accepts a value that will be resolved when async function is called.<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> asyncMock <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">mockResolvedValue</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token keyword control-flow">await</span> <span class="token function">asyncMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 42</span></code></pre></section><section class="level2"aria-labelledby="mockresolvedvalueonce"><h2 id="mockresolvedvalueonce">mockResolvedValueOnce</h2><ul><li><strong>Type:</strong> <code>(value: any) => MockInstance</code></ul><p>Accepts a value that will be resolved during the next function call. If chained, every consecutive call will resolve specified value.<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> asyncMock <span class="token operator">=</span> vi
  <span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockResolvedValue</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockResolvedValueOnce</span><span class="token punctuation">(</span><span class="token string">'first call'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockResolvedValueOnce</span><span class="token punctuation">(</span><span class="token string">'second call'</span><span class="token punctuation">)</span>

<span class="token keyword control-flow">await</span> <span class="token function">asyncMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// first call</span>
<span class="token keyword control-flow">await</span> <span class="token function">asyncMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// second call</span>
<span class="token keyword control-flow">await</span> <span class="token function">asyncMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// default</span>
<span class="token keyword control-flow">await</span> <span class="token function">asyncMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// default</span></code></pre></section><section class="level2"aria-labelledby="mockreturnthis"><h2 id="mockreturnthis">mockReturnThis</h2><ul><li><strong>Type:</strong> <code>() => MockInstance</code></ul><p>Use this if you need to return <code>this</code> context from the method without invoking actual implementation. This is a shorthand for:<pre class="language-ts"><code class="language-ts">spy<span class="token punctuation">.</span><span class="token method function property-access">mockImplementation</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level2"aria-labelledby="mockreturnvalue"><h2 id="mockreturnvalue">mockReturnValue</h2><ul><li><strong>Type:</strong> <code>(value: any) => MockInstance</code></ul><p>Accepts a value that will be returned whenever the mock function is called.<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> mock <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
mock<span class="token punctuation">.</span><span class="token method function property-access">mockReturnValue</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
<span class="token function">mock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 42</span>
mock<span class="token punctuation">.</span><span class="token method function property-access">mockReturnValue</span><span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">)</span>
<span class="token function">mock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 43</span></code></pre></section><section class="level2"aria-labelledby="mockreturnvalueonce"><h2 id="mockreturnvalueonce">mockReturnValueOnce</h2><ul><li><strong>Type:</strong> <code>(value: any) => MockInstance</code></ul><p>Accepts a value that will be returned during the next function call. If chained, every consecutive call will return the specified value.<p>When there are no more <code>mockReturnValueOnce</code> values to use, mock will fallback to previously defined implementation if there is one.<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> myMockFn <span class="token operator">=</span> vi
  <span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockReturnValue</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockReturnValueOnce</span><span class="token punctuation">(</span><span class="token string">'first call'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockReturnValueOnce</span><span class="token punctuation">(</span><span class="token string">'second call'</span><span class="token punctuation">)</span>

<span class="token comment">// 'first call', 'second call', 'default', 'default'</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">myMockFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></section><section class="level2"aria-labelledby="mockcalls"><h2 id="mockcalls">mock.calls</h2><p>This is an array containing all arguments for each call. One item of the array is the arguments of that call.<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> fn <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'arg1'</span><span class="token punctuation">,</span> <span class="token string">'arg2'</span><span class="token punctuation">)</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'arg3'</span><span class="token punctuation">)</span>

fn<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">calls</span> <span class="token operator">===</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'arg1'</span><span class="token punctuation">,</span> <span class="token string">'arg2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// first call</span>
  <span class="token punctuation">[</span><span class="token string">'arg3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// second call</span>
<span class="token punctuation">]</span></code></pre></section><section class="level2"aria-labelledby="mocklastcall"><h2 id="mocklastcall">mock.lastCall</h2><p>This contains the arguments of the last call. If mock wasn't called, will return <code>undefined</code>.</section><section class="level2"aria-labelledby="mockresults"><h2 id="mockresults">mock.results</h2><p>This is an array containing all values that were <code>returned</code> from the function. One item of the array is an object with properties <code>type</code> and <code>value</code>. Available types are:<ul><li><code>'return'</code> - function returned without throwing.<li><code>'throw'</code> - function threw a value.</ul><p>The <code>value</code> property contains the returned value or thrown error. If the function returned a <code>Promise</code>, then <code>result</code> will always be <code>'return'</code> even if the promise was rejected.<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> fn <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockReturnValueOnce</span><span class="token punctuation">(</span><span class="token string">'result'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">mockImplementationOnce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span> <span class="token keyword control-flow">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'thrown error'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// returned 'result'</span>

<span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// threw Error</span>
<span class="token punctuation">}</span>
<span class="token keyword control-flow">catch</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

fn<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">results</span> <span class="token operator">===</span> <span class="token punctuation">[</span>
  <span class="token comment">// first result</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'return'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'result'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// last result</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'throw'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></section><section class="level2"aria-labelledby="mocksettledresults"><h2 id="mocksettledresults">mock.settledResults</h2><p>An array containing all values that were <code>resolved</code> or <code>rejected</code> from the function.<p>This array will be empty if the function was never resolved or rejected.<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> fn <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">mockResolvedValueOnce</span><span class="token punctuation">(</span><span class="token string">'result'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

fn<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">settledResults</span> <span class="token operator">===</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword control-flow">await</span> result

fn<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">settledResults</span> <span class="token operator">===</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'fulfilled'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'result'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></section><section class="level2"aria-labelledby="mockinvocationcallorder"><h2 id="mockinvocationcallorder">mock.invocationCallOrder</h2><p>This property returns the order of the mock function's execution. It is an array of numbers that are shared between all defined mocks.<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> fn1 <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fn2 <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

fn1<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">invocationCallOrder</span> <span class="token operator">===</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
fn2<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">invocationCallOrder</span> <span class="token operator">===</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></code></pre></section><section class="level2"aria-labelledby="mockcontexts"><h2 id="mockcontexts">mock.contexts</h2><p>This property is an array of <code>this</code> values used during each call to the mock function.<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> fn <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

fn<span class="token punctuation">.</span><span class="token method function property-access">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
fn<span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

fn<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">contexts</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> context
fn<span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">contexts</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">===</span> context</code></pre></section><section class="level2"aria-labelledby="mockinstances"><h2 id="mockinstances">mock.instances</h2><p>This property is an array containing all instances that were created when the mock was called with the <code>new</code> keyword. Note that this is an actual context (<code>this</code>) of the function, not a return value.<blockquote>If mock was instantiated with `new MyClass()`, then `mock.instances` will be an array with one value:<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token maybe-class-name">MyClass</span> <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token maybe-class-name">MyClass</span><span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">instances</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> a</code></pre><p>If you return a value from constructor, it will not be in <code>instances</code> array, but instead inside <code>results</code>:<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token maybe-class-name">Spy</span> <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">method</span><span class="token operator">:</span> vi<span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Spy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token maybe-class-name">Spy</span><span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">instances</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!==</span> a
<span class="token maybe-class-name">Spy</span><span class="token punctuation">.</span><span class="token property-access">mock</span><span class="token punctuation">.</span><span class="token property-access">results</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> a</code></pre></blockquote><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>