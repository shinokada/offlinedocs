<!doctype html><html lang="en"><meta charset="utf-8"><title>Browser Mode | Guide</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="outline"content="deep"><link rel="stylesheet"type="text/css"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="browser-mode-experimental-browser-mode"><h1 id="browser-mode-experimental-browser-mode">Browser Mode<badge type="warning">Experimental</badge>{#browser-mode}</h1><p>This page provides information about the experimental browser mode feature in the Vitest API, which allows you to run your tests in the browser natively, providing access to browser globals like window and document. This feature is currently under development, and APIs may change in the future.</p><img alt="Vitest UI"img-light=""src="/ui-browser-1-light.png"> <img alt="Vitest UI"img-dark=""src="/ui-browser-1-dark.png"><section class="level2"aria-labelledby="installation"><h2 id="installation">Installation</h2><p>For easier setup, you can use <code>vitest init browser</code> command to install required dependencies and create browser configuration.</p>code-group ```bash [npm] npx vitest init browser ``` ```bash [yarn] yarn exec vitest init browser ``` ```bash [pnpm] pnpx vitest init browser ``` ```bash [bun] bunx vitest init browser ```<section class="level3"aria-labelledby="manual-installation"><h3 id="manual-installation">Manual Installation</h3><p>You can also install packages manually. By default, Browser Mode doesn't require any additional E2E provider to run tests locally because it reuses your existing browser.</p>code-group ```bash [npm] npm install -D vitest @vitest/browser ``` ```bash [yarn] yarn add -D vitest @vitest/browser ``` ```bash [pnpm] pnpm add -D vitest @vitest/browser ``` ```bash [bun] bun add -D vitest @vitest/browser ```<blockquote>However, to run tests in CI you need to install either [`playwright`](https://npmjs.com/package/playwright) or [`webdriverio`](https://www.npmjs.com/package/webdriverio). We also recommend switching to either one of them for testing locally instead of using the default `preview` provider since it relies on simulating events instead of using Chrome DevTools Protocol.<p>If you don't already use one of these tools, we recommend starting with Playwright because it supports parallel execution, which makes your tests run faster. Additionally, the Chrome DevTools Protocol that Playwright uses is generally faster than WebDriver.</blockquote>tabs key:provider == Playwright [Playwright](https://npmjs.com/package/playwright) is a framework for Web Testing and Automation.Automation. code-group ```bash [npm] npm install -D vitest @vitest/browser playwright ``` ```bash [yarn] yarn add -D vitest @vitest/browser playwright ``` ```bash [pnpm] pnpm add -D vitest @vitest/browser playwright ``` ```bash [bun] bun add -D vitest @vitest/browser playwright ``` == WebdriverIO<p><a href="https://www.npmjs.com/package/webdriverio">WebdriverIO</a> allows you to run tests locally using the WebDriver protocol.</p>code-group ```bash [npm] npm install -D vitest @vitest/browser webdriverio ``` ```bash [yarn] yarn add -D vitest @vitest/browser webdriverio ``` ```bash [pnpm] pnpm add -D vitest @vitest/browser webdriverio ``` ```bash [bun] bun add -D vitest @vitest/browser webdriverio ```</section></section><section class="level2"aria-labelledby="configuration"><h2 id="configuration">Configuration</h2><p>To activate browser mode in your Vitest configuration, you can use the <code>--browser</code> flag or set the <code>browser.enabled</code> field to <code>true</code> in your Vitest configuration file. Here is an example configuration using the browser field:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    browser<span class="token operator">:</span> <span class="token punctuation">{</span>
      provider<span class="token operator">:</span> <span class="token string">'playwright'</span><span class="token punctuation">,</span> <span class="token comment">// or 'webdriverio'</span>
      enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'chromium'</span><span class="token punctuation">,</span> <span class="token comment">// browser name is required</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>info Vitest assigns port `63315` to avoid conflicts with the development server, allowing you to run both in parallel. You can change that with the [`browser.api`](../config.html#browser-api) option.<p>If you have not used Vite before, make sure you have your framework's plugin installed and specified in the config. Some frameworks might require extra configuration to work - check their Vite related documentation to be sure.</p>code-group ```ts [vue] import { defineConfig } from 'vitest/config' import vue from '@vitejs/plugin-vue'<p>export default defineConfig({ plugins: [vue()], test: { browser: { enabled: true, provider: 'playwright', name: 'chromium', } } })<pre class="language-text"><code class="language-text">```ts [svelte]
import { defineConfig } from 'vitest/config'
import { svelte } from '@sveltejs/vite-plugin-svelte'

export default defineConfig({
  plugins: [svelte()],
  test: {
    browser: {
      enabled: true,
      provider: 'playwright',
      name: 'chromium',
    }
  }
})</code></pre><pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>
<span class="token keyword module">import</span> <span class="token imports">solidPlugin</span> <span class="token keyword module">from</span> <span class="token string">'vite-plugin-solid'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">solidPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    browser<span class="token operator">:</span> <span class="token punctuation">{</span>
      enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      provider<span class="token operator">:</span> <span class="token string">'playwright'</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'chromium'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>
<span class="token keyword module">import</span> <span class="token imports">marko</span> <span class="token keyword module">from</span> <span class="token string">'@marko/vite'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">marko</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    browser<span class="token operator">:</span> <span class="token punctuation">{</span>
      enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      provider<span class="token operator">:</span> <span class="token string">'playwright'</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'chromium'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><blockquote>`react` doesn't require a plugin to work, but `preact` requires [extra configuration](https://preactjs.com/guide/v10/getting-started/#create-a-vite-powered-preact-app) to make aliases work.</blockquote><p>If you need to run some tests using Node-based runner, you can define a <a href="/guide/workspace">workspace</a> file with separate configurations for different testing strategies:<p>{#workspace-config}<pre class="language-ts"><code class="language-ts"><span class="token comment">// vitest.workspace.ts</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineWorkspace <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineWorkspace</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// an example of file based convention,</span>
      <span class="token comment">// you don't have to follow it</span>
      include<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'tests/unit/**/*.{test,spec}.ts'</span><span class="token punctuation">,</span>
        <span class="token string">'tests/**/*.unit.{test,spec}.ts'</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'unit'</span><span class="token punctuation">,</span>
      environment<span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// an example of file based convention,</span>
      <span class="token comment">// you don't have to follow it</span>
      include<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'tests/browser/**/*.{test,spec}.ts'</span><span class="token punctuation">,</span>
        <span class="token string">'tests/**/*.browser.{test,spec}.ts'</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'browser'</span><span class="token punctuation">,</span>
      browser<span class="token operator">:</span> <span class="token punctuation">{</span>
        enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">'chrome'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><section class="level3"aria-labelledby="provider-configuration"><h3 id="provider-configuration">Provider Configuration</h3></section>tabs key:provider == Playwright You can configure how Vitest [launches the browser](https://playwright.dev/docs/api/class-browsertype#browser-type-launch) and creates the [page context](https://playwright.dev/docs/api/class-browsercontext) via [`providerOptions`](../config.html#browser-provideroptions) field:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    browser<span class="token operator">:</span> <span class="token punctuation">{</span>
      providerOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
        launch<span class="token operator">:</span> <span class="token punctuation">{</span>
          devtools<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        context<span class="token operator">:</span> <span class="token punctuation">{</span>
          geolocation<span class="token operator">:</span> <span class="token punctuation">{</span>
            latitude<span class="token operator">:</span> <span class="token number">45</span><span class="token punctuation">,</span>
            longitude<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          reducedMotion<span class="token operator">:</span> <span class="token string">'reduce'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>To have type hints, add <code>@vitest/browser/providers/playwright</code> to <code>compilerOptions.types</code> in your <code>tsconfig.json</code> file. == WebdriverIO You can configure what <a href="https://webdriver.io/docs/configuration#webdriverio">options</a> Vitest should use when starting a browser via <a href="../config.html#browser-provideroptions"><code>providerOptions</code></a> field:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    browser<span class="token operator">:</span> <span class="token punctuation">{</span>
      browser<span class="token operator">:</span> <span class="token string">'chrome'</span><span class="token punctuation">,</span>
      providerOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
        region<span class="token operator">:</span> <span class="token string">'eu'</span><span class="token punctuation">,</span>
        capabilities<span class="token operator">:</span> <span class="token punctuation">{</span>
          browserVersion<span class="token operator">:</span> <span class="token string">'27.0'</span><span class="token punctuation">,</span>
          platformName<span class="token operator">:</span> <span class="token string">'Windows 10'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>To have type hints, add <code>@vitest/browser/providers/webdriverio</code> to <code>compilerOptions.types</code> in your <code>tsconfig.json</code> file.</section><section class="level2"aria-labelledby="browser-option-types"><h2 id="browser-option-types">Browser Option Types</h2><p>The browser option in Vitest depends on the provider. Vitest will fail, if you pass <code>--browser</code> and don't specify its name in the config file. Available options:<ul><li><code>webdriverio</code> supports these browsers:<ul><li><code>firefox</code><li><code>chrome</code><li><code>edge</code><li><code>safari</code></ul><li><code>playwright</code> supports these browsers:<ul><li><code>firefox</code><li><code>webkit</code><li><code>chromium</code></ul></ul></section><section class="level2"aria-labelledby="browser-compatibility"><h2 id="browser-compatibility">Browser Compatibility</h2><p>Vitest uses <a href="https://vitejs.dev/guide/#browser-support">Vite dev server</a> to run your tests, so we only support features specified in the <a href="https://vitejs.dev/config/shared-options.html#esbuild"><code>esbuild.target</code></a> option (<code>esnext</code> by default).<p>By default, Vite targets browsers which support the native <a href="https://caniuse.com/es6-module">ES Modules</a>, native <a href="https://caniuse.com/es6-module-dynamic-import">ESM dynamic import</a>, and <a href="https://caniuse.com/mdn-javascript_operators_import_meta"><code>import.meta</code></a>. On top of that, we utilize <a href="https://caniuse.com/?search=BroadcastChannel"><code>BroadcastChannel</code></a> to communicate between iframes:<ul><li>Chrome >=87<li>Firefox >=78<li>Safari >=15.4<li>Edge >=88</ul></section><section class="level2"aria-labelledby="running-tests"><h2 id="running-tests">Running Tests</h2><p>When you specify a browser name in the browser option, Vitest will try to run the specified browser using <code>preview</code> by default, and then run the tests there. If you don't want to use <code>preview</code>, you can configure the custom browser provider by using <code>browser.provider</code> option.<p>To specify a browser using the CLI, use the <code>--browser</code> flag followed by the browser name, like this:<pre class="language-sh"><code class="language-sh">npx vitest --browser=chrome</code></pre><p>Or you can provide browser options to CLI with dot notation:<pre class="language-sh"><code class="language-sh">npx vitest --browser.name=chrome --browser.headless</code></pre><p>By default, Vitest will automatically open the browser UI for development. Your tests will run inside an iframe in the center. You can configure the viewport by selecting the preferred dimensions, calling <code>page.viewport</code> inside the test, or setting default values in <a href="../config.html#browser-viewport">the config</a>.</section><section class="level2"aria-labelledby="headless"><h2 id="headless">Headless</h2><p>Headless mode is another option available in the browser mode. In headless mode, the browser runs in the background without a user interface, which makes it useful for running automated tests. The headless option in Vitest can be set to a boolean value to enable or disable headless mode.<p>When using headless mode, Vitest won't open the UI automatically. If you want to continue using the UI but have tests run headlessly, you can install the <a href="/guide/ui"><code>@vitest/ui</code></a> package and pass the --ui flag when running Vitest.<p>Here's an example configuration enabling headless mode:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    browser<span class="token operator">:</span> <span class="token punctuation">{</span>
      provider<span class="token operator">:</span> <span class="token string">'playwright'</span><span class="token punctuation">,</span>
      enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      headless<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>You can also set headless mode using the <code>--browser.headless</code> flag in the CLI, like this:<pre class="language-sh"><code class="language-sh">npx vitest --browser.name=chrome --browser.headless</code></pre><p>In this case, Vitest will run in headless mode using the Chrome browser.<blockquote>Headless mode is not available by default. You need to use either [`playwright`](https://npmjs.com/package/playwright) or [`webdriverio`](https://www.npmjs.com/package/webdriverio) providers to enable this feature.</blockquote></section><section class="level2"aria-labelledby="examples"><h2 id="examples">Examples</h2><p>Vitest provides packages to render components for several popular frameworks out of the box:<ul><li><a href="https://github.com/vitest-dev/vitest-browser-vue"><code>vitest-browser-vue</code></a> to render <a href="https://vuejs.org">vue</a> components<li><a href="https://github.com/vitest-dev/vitest-browser-svelte"><code>vitest-browser-svelte</code></a> to render <a href="https://svelte.dev">svelte</a> components<li><a href="https://github.com/vitest-dev/vitest-browser-react"><code>vitest-browser-react</code></a> to render <a href="https://react.dev">react</a> components</ul><p>If your framework is not represented, feel free to create your own package - it is a simple wrapper around the framework renderer and <code>page.elementLocator</code> API. We will add a link to it on this page. Make sure it has a name starting with <code>vitest-browser-</code>.<p>Besides rendering components and locating elements, you will also need to make assertions. Vitest bundles the <a href="https://github.com/testing-library/jest-dom"><code>@testing-library/jest-dom</code></a> library to provide a wide range of DOM assertions out of the box. Read more at the <a href="/guide/browser/assertion-api">Assertions API</a>.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> expect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>
<span class="token comment">// element is rendered correctly</span>
<span class="token keyword control-flow">await</span> expect<span class="token punctuation">.</span><span class="token method function property-access">element</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token method function property-access">getByText</span><span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeInTheDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>Vitest exposes a <a href="/guide/browser/context">Context API</a> with a small set of utilities that might be useful to you in tests. For example, if you need to make an interaction, like clicking an element or typing text into an input, you can use <code>userEvent</code> from <code>@vitest/browser/context</code>. Read more at the <a href="/guide/browser/interactivity-api">Interactivity API</a>.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> page<span class="token punctuation">,</span> userEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@vitest/browser/context'</span>
<span class="token keyword control-flow">await</span> userEvent<span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token method function property-access">getByLabelText</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">username</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Alice'</span><span class="token punctuation">)</span>
<span class="token comment">// or just locator.fill</span>
<span class="token keyword control-flow">await</span> page<span class="token punctuation">.</span><span class="token method function property-access">getByLabelText</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">username</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">fill</span><span class="token punctuation">(</span><span class="token string">'Alice'</span><span class="token punctuation">)</span></code></pre>code-group ```ts [vue] import { render } from 'vitest-browser-vue' import Component from './Component.vue'<p>test('properly handles v-model', async () => { const screen = render(Component)<p>// Asserts initial state. await expect.element(screen.getByText('Hi, my name is Alice')).toBeInTheDocument()<p>// Get the input DOM node by querying the associated label. const usernameInput = screen.getByLabelText(/username/i)<p>// Type the name into the input. This already validates that the input // is filled correctly, no need to check the value manually. await usernameInput.fill('Bob')<p>await expect.element(screen.getByText('Hi, my name is Bob')).toBeInTheDocument() })<pre class="language-text"><code class="language-text">```ts [svelte]
import { render } from 'vitest-browser-svelte'
import { expect, test } from 'vitest'

import Greeter from './greeter.svelte'

test('greeting appears on click', async () => {
  const screen = render(Greeter, { name: 'World' })

  const button = screen.getByRole('button')
  await button.click()
  const greeting = screen.getByText(/hello world/iu)

  await expect.element(greeting).toBeInTheDocument()
})</code></pre><pre class="language-tsx"><code class="language-tsx"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> render <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest-browser-react'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">Fetch</span></span> <span class="token keyword module">from</span> <span class="token string">'./fetch'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'loads and displays greeting'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Render a React element into the DOM</span>
  <span class="token keyword">const</span> screen <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Fetch</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/greeting<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">)</span>

  <span class="token keyword control-flow">await</span> screen<span class="token punctuation">.</span><span class="token method function property-access">getByText</span><span class="token punctuation">(</span><span class="token string">'Load Greeting'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// wait before throwing an error if it cannot find an element</span>
  <span class="token keyword">const</span> heading <span class="token operator">=</span> screen<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'heading'</span><span class="token punctuation">)</span>

  <span class="token comment">// assert that the alert message is correct</span>
  <span class="token keyword control-flow">await</span> expect<span class="token punctuation">.</span><span class="token method function property-access">element</span><span class="token punctuation">(</span>heading<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveTextContent</span><span class="token punctuation">(</span><span class="token string">'hello there'</span><span class="token punctuation">)</span>
  <span class="token keyword control-flow">await</span> expect<span class="token punctuation">.</span><span class="token method function property-access">element</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span><span class="token method function property-access">getByRole</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeDisabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>Vitest doesn't support all frameworks out of the box, but you can use external tools to run tests with these frameworks. We also encourage the community to create their own <code>vitest-browser</code> wrappers - if you have one, feel free to add it to the examples above.<p>For unsupported frameworks, we recommend using <code>testing-library</code> packages:<ul><li><a href="https://testing-library.com/docs/preact-testing-library/intro"><code>@testing-library/preact</code></a> to render <a href="https://preactjs.com">preact</a> components<li><a href="https://testing-library.com/docs/solid-testing-library/intro"><code>@solidjs/testing-library</code></a> to render <a href="https://www.solidjs.com">solid</a> components<li><a href="https://testing-library.com/docs/marko-testing-library/intro"><code>@marko/testing-library</code></a> to render <a href="https://markojs.com">marko</a> components</ul><blockquote>`testing-library` provides a package `@testing-library/user-event`. We do not recommend using it directly because it simulates events instead of actually triggering them - instead, use [`userEvent`](/guide/browser/interactivity-api) imported from `@vitest/browser/context` that uses Chrome DevTools Protocol or Webdriver (depending on the provider) under the hood.</blockquote>code-group ```tsx [preact] // based on @testing-library/preact example // https://testing-library.com/docs/preact-testing-library/example<p>import { h } from 'preact' import { page } from '@vitest/browser/context' import { render } from '@testing-library/preact'<p>import HiddenMessage from '../hidden-message'<p>test('shows the children when the checkbox is checked', async () => { const testMessage = 'Test Message'<p>const { baseElement } = render(<hiddenmessage>{testMessage}</hiddenmessage>, )<p>const screen = page.elementLocator(baseElement)<p>// .query() will return the element or null if it cannot be found. // .element() will return the element or throw an error if it cannot be found. expect(screen.getByText(testMessage).query()).not.toBeInTheDocument()<p>// The queries can accept a regex to make your selectors more // resilient to content tweaks and changes. await screen.getByLabelText(/show/i).click()<p>await expect.element(screen.getByText(testMessage)).toBeInTheDocument() })<pre class="language-text"><code class="language-text">```tsx [solid]
// baed on @testing-library/solid API
// https://testing-library.com/docs/solid-testing-library/api

import { render } from '@testing-library/solid'

it('uses params', async () => {
  const App = () => (
    &#x3C;>
      &#x3C;Route
        path="/ids/:id"
        component={() => (
          &#x3C;p>
            Id:
            {useParams()?.id}
          &#x3C;/p>
        )}
      />
      &#x3C;Route path="/" component={() => &#x3C;p>Start&#x3C;/p>} />
    &#x3C;/>
  )
  const { baseElement } = render(() => &#x3C;App />, { location: 'ids/1234' })
  const screen = page.elementLocator(baseElement)

  await expect.screen(screen.getByText('Id: 1234')).toBeInTheDocument()
})</code></pre><pre class="language-ts"><code class="language-ts"><span class="token comment">// baed on @testing-library/marko API</span>
<span class="token comment">// https://testing-library.com/docs/marko-testing-library/api</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> render<span class="token punctuation">,</span> screen <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@marko/testing-library'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">Greeting</span></span> <span class="token keyword module">from</span> <span class="token string">'./greeting.marko'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'renders a message'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> baseElement <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token maybe-class-name">Greeting</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Marko'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> screen <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token method function property-access">elementLocator</span><span class="token punctuation">(</span>baseElement<span class="token punctuation">)</span>
  <span class="token keyword control-flow">await</span> expect<span class="token punctuation">.</span><span class="token method function property-access">element</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span><span class="token method function property-access">getByText</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Marko</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBeInTheDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword control-flow">await</span> expect<span class="token punctuation">.</span><span class="token method function property-access">element</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span><span class="token property-access">firstChild</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatchInlineSnapshot</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &#x3C;h1>Hello, Marko!&#x3C;/h1>
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level2"aria-labelledby="limitations"><h2 id="limitations">Limitations</h2><section class="level3"aria-labelledby="thread-blocking-dialogs"><h3 id="thread-blocking-dialogs">Thread Blocking Dialogs</h3><p>When using Vitest Browser, it's important to note that thread blocking dialogs like <code>alert</code> or <code>confirm</code> cannot be used natively. This is because they block the web page, which means Vitest cannot continue communicating with the page, causing the execution to hang.<p>In such situations, Vitest provides default mocks with default returned values for these APIs. This ensures that if the user accidentally uses synchronous popup web APIs, the execution would not hang. However, it's still recommended for the user to mock these web APIs for better experience. Read more in <a href="/guide/mocking">Mocking</a>. <span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section></section>