<!doctype html><html lang="en"><meta charset="utf-8"><title>Test Context | Guide</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="test-context"class="level1"><h1>Test Context</h1><p>Inspired by <a href="https://playwright.dev/docs/test-fixtures">Playwright Fixtures</a>, Vitest's test context allows you to define utils, states, and fixtures that can be used in your tests.<section id="usage"class="level2"><h2>Usage</h2><p>The first argument for each test callback is a test context.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> it <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest'</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should work'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// prints name of the test</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token property-access">meta</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section id="built-in-test-context"class="level2"><h2>Built-in Test Context</h2><section id="contextmeta"class="level4"><h4><code>context.meta</code></h4><p>A readonly object containing metadata about the test.</section><section id="contextexpect"class="level4"><h4><code>context.expect</code></h4><p>The <code>expect</code> API bound to the current test.</section></section><section id="extend-test-context"class="level2"><h2>Extend Test Context</h2><p>The contexts are different for each test. You can access and extend them within the <code>beforeEach</code> and <code>afterEach</code> hooks.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> beforeEach<span class="token punctuation">,</span> it <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest'</span>

<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// extend context</span>
  context<span class="token punctuation">.</span><span class="token property-access">foo</span> <span class="token operator">=</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should work'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> foo <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span> <span class="token comment">// 'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><section id="typescript"class="level3"><h3>TypeScript</h3><p>To provide property types for all your custom contexts, you can aggregate the <code>TestContext</code> type by adding<pre class="language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'vitest'</span> <span class="token punctuation">{</span>
  <span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">TestContext</span></span> <span class="token punctuation">{</span>
    foo<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>If you want to provide property types only for specific <code>beforeEach</code>, <code>afterEach</code>, <code>it</code> and <code>test</code> hooks, you can pass the type as a generic.<pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">LocalTestContext</span></span> <span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token generic-function"><span class="token function">beforeEach</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">LocalTestContext</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// typeof context is 'TestContext &#x26; LocalTestContext'</span>
  context<span class="token punctuation">.</span><span class="token property-access">foo</span> <span class="token operator">=</span> <span class="token string">'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token generic-function"><span class="token function">it</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">LocalTestContext</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token string">'should work'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> foo <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// typeof foo is 'string'</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span> <span class="token comment">// 'bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>`<span class="token operator">&#x3C;</span>span style<span class="token operator">=</span><span class="token string">'float: footnote;'</span><span class="token operator">></span><span class="token operator">&#x3C;</span>a href<span class="token operator">=</span><span class="token string">"../index.html#toc"</span><span class="token operator">></span><span class="token maybe-class-name">Go</span> to <span class="token constant">TOC</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token operator">&#x3C;</span><span class="token operator">/</span>span<span class="token operator">></span>
</code></pre></section></section></section>