<!doctype html><html lang="en"><meta charset="utf-8"><title>Node API</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="node-api"><h1 id="node-api">Node API</h1><blockquote>Vitest exposes experimental private API. Breaking changes might not follow semver, please pin Vitest's version when using it.</blockquote><section class="level2"aria-labelledby="startvitest"><h2 id="startvitest">startVitest</h2><p>You can start running Vitest tests using its Node API:<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> startVitest <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/node'</span>

<span class="token keyword">const</span> vitest <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">startVitest</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span>

<span class="token keyword control-flow">await</span> vitest<span class="token operator">?.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><code>startVitest</code> function returns <code>Vitest</code> instance if tests can be started. It returns <code>undefined</code>, if one of the following occurs:<ul><li>Vitest didn't find "vite" package (usually installed with Vitest)<li>If coverage is enabled and run mode is "test", but the coverage package is not installed (<code>@vitest/coverage-v8</code> or <code>@vitest/coverage-istanbul</code>)<li>If the environment package is not installed (<code>jsdom</code>/<code>happy-dom</code>/<code>@edge-runtime/vm</code>)</ul><p>If <code>undefined</code> is returned or tests failed during the run, Vitest sets <code>process.exitCode</code> to <code>1</code>.<p>If watch mode is not enabled, Vitest will call <code>close</code> method.<p>If watch mode is enabled and the terminal supports TTY, Vitest will register console shortcuts.<p>You can pass down a list of filters as a second argument. Vitest will run only tests that contain at least one of the passed-down strings in their file path.<p>Additionally, you can use the third argument to pass in CLI arguments, which will override any test config options.<p>Alternatively, you can pass in the complete Vite config as the fourth argument, which will take precedence over any other user-defined options.</section><section class="level2"aria-labelledby="createvitest"><h2 id="createvitest">createVitest</h2><p>You can create Vitest instance yourself using <code>createVitest</code> function. It returns the same <code>Vitest</code> instance as <code>startVitest</code>, but it doesn't start tests and doesn't validate installed packages.<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createVitest <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/node'</span>

<span class="token keyword">const</span> vitest <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">createVitest</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level2"aria-labelledby="vitest"><h2 id="vitest">Vitest</h2><p>Vitest instance requires the current test mode. It can be either:<ul><li><code>test</code> when running runtime tests<li><code>benchmark</code> when running benchmarks<li><code>typecheck</code> when running type tests</ul><section class="level3"aria-labelledby="mode"><h3 id="mode">mode</h3><section class="level4"aria-labelledby="test"><h4 id="test">test</h4><p>Test mode will only call functions inside <code>test</code> or <code>it</code>, and throws an error when <code>bench</code> is encountered. This mode uses <code>include</code> and <code>exclude</code> options in the config to find test files.</section><section class="level4"aria-labelledby="benchmark"><h4 id="benchmark">benchmark</h4><p>Benchmark mode calls <code>bench</code> functions and throws an error, when it encounters <code>test</code> or <code>it</code>. This mode uses <code>benchmark.include</code> and <code>benchmark.exclude</code> options in the config to find benchmark files.</section><section class="level4"aria-labelledby="typecheck"><h4 id="typecheck">typecheck</h4><p>Typecheck mode doesn't <em>run</em> tests. It only analyses types and gives a summary. This mode uses <code>typecheck.include</code> and <code>typecheck.exclude</code> options in the config to find files to analyze.</section></section><section class="level3"aria-labelledby="start"><h3 id="start">start</h3><p>You can start running tests or benchmarks with <code>start</code> method. You can pass an array of strings to filter test files. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section></section>