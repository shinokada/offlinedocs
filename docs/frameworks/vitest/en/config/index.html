<!doctype html><html lang="en"><meta charset="utf-8"><title>Configuring Vitest</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta name="outline"content="deep"><link rel="stylesheet"type="text/css"href="../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="configuring-vitest"><h1 id="configuring-vitest">Configuring Vitest</h1><p>To create a Vitest configuration file, follow <a href="/config/file">the guide</a>. Make sure you understand how Vitest config resolution works before proceeding.<blockquote>_All_ listed options here are located on a `test` property inside the config:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    exclude<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></blockquote><blockquote>In addition to the following options, you can also use any configuration option from [Vite](https://vitejs.dev/config/). For example, `define` to define global variables, or `resolve.alias` to define aliases.<p>All configuration options that are not supported inside a <a href="/guide/workspace">workspace</a> project config have<nonprojectoption>sign next to them.</nonprojectoption></blockquote><section class="level3"aria-labelledby="include"><h3 id="include">include</h3><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>['**/*.{test,spec}.?(c|m)[jt]s?(x)']</code><li><strong>CLI:</strong> <code>vitest [...include]</code>, <code>vitest **/*.test.js</code></ul><p>A list of glob patterns that match your test files.<blockquote>NOTE When using coverage, Vitest automatically adds test files `include` patterns to coverage's default `exclude` patterns. See [`coverage.exclude`](#coverage-exclude).</blockquote></section><section class="level3"aria-labelledby="exclude"><h3 id="exclude">exclude</h3><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>['**/node_modules/**', '**/dist/**', '**/cypress/**', '**/.{idea,git,cache,output,temp}/**', '**/{karma,rollup,webpack,vite,vitest,jest,ava,babel,nyc,cypress,tsup,build}.config.*']</code><li><strong>CLI:</strong> <code>vitest --exclude "**/excluded-file"</code></ul><p>A list of glob patterns that should be excluded from your test files.<blockquote>This option does not affect coverage. If you need to remove certain files from the coverage report, use [`coverage.exclude`](#coverage-exclude).<p>This is the only option that doesn't override your configuration if you provide it with a CLI flag. All glob patterns added via <code>--exclude</code> flag will be added to the config's <code>exclude</code>.</blockquote></section><section class="level3"aria-labelledby="includesource"><h3 id="includesource">includeSource</h3><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Include globs for in-source test files.<p>When defined, Vitest will run all matched files with <code>import.meta.vitest</code> inside.</section><section class="level3"aria-labelledby="server"><h3 id="server">server</h3><ul><li><strong>Type:</strong> <code>{ sourcemap?, deps?, ... }</code></ul><p>Vite-Node server options.<section class="level4"aria-labelledby="serversourcemap"><h4 id="serversourcemap">server.sourcemap</h4><ul><li><strong>Type:</strong> <code>'inline' | boolean</code><li><strong>Default:</strong> <code>'inline'</code></ul><p>Inject inline source map to modules.</section><section class="level4"aria-labelledby="serverdebug"><h4 id="serverdebug">server.debug</h4><ul><li><strong>Type:</strong> <code>{ dumpModules?, loadDumppedModules? }</code></ul><p>Vite-Node debugger options.</section><section class="level4"aria-labelledby="serverdebugdumpmodules"><h4 id="serverdebugdumpmodules">server.debug.dumpModules</h4><ul><li><strong>Type:</strong> <code>boolean | string</code></ul><p>Dump the transformed module to filesystem. Passing a string will dump to the specified path.</section><section class="level4"aria-labelledby="serverdebugloaddumppedmodules"><h4 id="serverdebugloaddumppedmodules">server.debug.loadDumppedModules</h4><ul><li><strong>Type:</strong> <code>boolean</code></ul><p>Read dumped module from filesystem whenever exists. Useful for debugging by modifying the dump result from the filesystem.</section><section class="level4"aria-labelledby="serverdeps"><h4 id="serverdeps">server.deps</h4><ul><li><strong>Type:</strong> <code>{ external?, inline?, ... }</code></ul><p>Handling for dependencies resolution.</section><section class="level4"aria-labelledby="serverdepsexternal"><h4 id="serverdepsexternal">server.deps.external</h4><ul><li><strong>Type:</strong> <code>(string | RegExp)[]</code><li><strong>Default:</strong> <code>[/\/node_modules\//]</code></ul><p>Externalize means that Vite will bypass the package to the native Node. Externalized dependencies will not be applied to Vite's transformers and resolvers, so they do not support HMR on reload. By default, all packages inside <code>node_modules</code> are externalized.<p>These options support package names as they are written in <code>node_modules</code> or specified inside <a href="#deps-moduledirectories"><code>deps.moduleDirectories</code></a>. For example, package <code>@company/some-name</code> located inside <code>packages/some-name</code> should be specified as <code>some-name</code>, and <code>packages</code> should be included in <code>deps.moduleDirectories</code>. Basically, Vitest always checks the file path, not the actual package name.<p>If regexp is used, Vitest calls it on the <em>file path</em>, not the package name.</section><section class="level4"aria-labelledby="serverdepsinline"><h4 id="serverdepsinline">server.deps.inline</h4><ul><li><strong>Type:</strong> <code>(string | RegExp)[] | true</code><li><strong>Default:</strong> <code>[]</code></ul><p>Vite will process inlined modules. This could be helpful to handle packages that ship <code>.js</code> in ESM format (that Node can't handle).<p>If <code>true</code>, every dependency will be inlined. All dependencies, specified in <a href="https://vitejs.dev/guide/ssr.html#ssr-externals"><code>ssr.noExternal</code></a> will be inlined by default.</section><section class="level4"aria-labelledby="serverdepsfallbackcjs"><h4 id="serverdepsfallbackcjs">server.deps.fallbackCJS</h4><ul><li><strong>Type</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>When a dependency is a valid ESM package, try to guess the cjs version based on the path. This might be helpful, if a dependency has the wrong ESM file.<p>This might potentially cause some misalignment if a package has different logic in ESM and CJS mode.</section><section class="level4"aria-labelledby="serverdepscachedir"><h4 id="serverdepscachedir">server.deps.cacheDir</h4><ul><li><strong>Type</strong> <code>string</code><li><strong>Default</strong>: <code>'node_modules/.vite'</code></ul><p>Directory to save cache files.</section></section><section class="level3"aria-labelledby="deps"><h3 id="deps">deps</h3><ul><li><strong>Type:</strong> <code>{ optimizer?, ... }</code></ul><p>Handling for dependencies resolution.<section class="level4"aria-labelledby="deps-optimizer"><h4 id="deps-optimizer">deps.optimizer</h4><ul><li><strong>Type:</strong> <code>{ ssr?, web? }</code><li><strong>See also:</strong> <a href="https://vitejs.dev/config/dep-optimization-options.html">Dep Optimization Options</a></ul><p>Enable dependency optimization. If you have a lot of tests, this might improve their performance.<p>When Vitest encounters the external library listed in <code>include</code>, it will be bundled into a single file using esbuild and imported as a whole module. This is good for several reasons:<ul><li>Importing packages with a lot of imports is expensive. By bundling them into one file we can save a lot of time<li>Importing UI libraries is expensive because they are not meant to run inside Node.js<li>Your <code>alias</code> configuration is now respected inside bundled packages<li>Code in your tests is running closer to how it's running in the browser</ul><p>Be aware that only packages in <code>deps.optimizer?.[mode].include</code> option are bundled (some plugins populate this automatically, like Svelte). You can read more about available options in <a href="https://vitejs.dev/config/dep-optimization-options.html">Vite</a> docs (Vitest doesn't support <code>disable</code> and <code>noDiscovery</code> options). By default, Vitest uses <code>optimizer.web</code> for <code>jsdom</code> and <code>happy-dom</code> environments, and <code>optimizer.ssr</code> for <code>node</code> and <code>edge</code> environments, but it is configurable by <a href="#testtransformmode"><code>transformMode</code></a>.<p>This options also inherits your <code>optimizeDeps</code> configuration (for web Vitest will extend <code>optimizeDeps</code>, for ssr - <code>ssr.optimizeDeps</code>). If you redefine <code>include</code>/<code>exclude</code> option in <code>deps.optimizer</code> it will extend your <code>optimizeDeps</code> when running tests. Vitest automatically removes the same options from <code>include</code>, if they are listed in <code>exclude</code>.<blockquote>You will not be able to edit your `node_modules` code for debugging, since the code is actually located in your `cacheDir` or `test.cache.dir` directory. If you want to debug with `console.log` statements, edit it directly or force rebundling with `deps.optimizer?.[mode].force` option.</blockquote></section><section class="level4"aria-labelledby="depsoptimizermodeenabled"><h4 id="depsoptimizermodeenabled">deps.optimizer.{mode}.enabled</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Enable dependency optimization.</section><section class="level4"aria-labelledby="deps-web"><h4 id="deps-web">deps.web</h4><ul><li><strong>Type:</strong> <code>{ transformAssets?, ... }</code></ul><p>Options that are applied to external files when transform mode is set to <code>web</code>. By default, <code>jsdom</code> and <code>happy-dom</code> use <code>web</code> mode, while <code>node</code> and <code>edge</code> environments use <code>ssr</code> transform mode, so these options will have no affect on files inside those environments.<p>Usually, files inside <code>node_modules</code> are externalized, but these options also affect files in <a href="#server-deps-external"><code>server.deps.external</code></a>.</section><section class="level4"aria-labelledby="depswebtransformassets"><h4 id="depswebtransformassets">deps.web.transformAssets</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code></ul><p>Should Vitest process assets (.png, .svg, .jpg, etc) files and resolve them like Vite does in the browser.<p>This module will have a default export equal to the path to the asset, if no query is specified.<blockquote>At the moment, this option only works with [`vmThreads`](#vmthreads) and [`vmForks`](#vmforks) pools.</blockquote></section><section class="level4"aria-labelledby="depswebtransformcss"><h4 id="depswebtransformcss">deps.web.transformCss</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code></ul><p>Should Vitest process CSS (.css, .scss, .sass, etc) files and resolve them like Vite does in the browser.<p>If CSS files are disabled with <a href="#css"><code>css</code></a> options, this option will just silence <code>ERR_UNKNOWN_FILE_EXTENSION</code> errors.<blockquote>At the moment, this option only works with [`vmThreads`](#vmthreads) and [`vmForks`](#vmforks) pools.</blockquote></section><section class="level4"aria-labelledby="depswebtransformglobpattern"><h4 id="depswebtransformglobpattern">deps.web.transformGlobPattern</h4><ul><li><strong>Type:</strong> <code>RegExp | RegExp[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Regexp pattern to match external files that should be transformed.<p>By default, files inside <code>node_modules</code> are externalized and not transformed, unless it's CSS or an asset, and corresponding option is not disabled.<blockquote>At the moment, this option only works with [`vmThreads`](#vmthreads) and [`vmForks`](#vmforks) pools.</blockquote></section><section class="level4"aria-labelledby="depsinteropdefault"><h4 id="depsinteropdefault">deps.interopDefault</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code></ul><p>Interpret CJS module's default as named exports. Some dependencies only bundle CJS modules and don't use named exports that Node.js can statically analyze when a package is imported using <code>import</code> syntax instead of <code>require</code>. When importing such dependencies in Node environment using named exports, you will see this error:<pre class="language-text"><code class="language-text">import { read } from 'fs-jetpack';
         ^^^^
SyntaxError: Named export 'read' not found. The requested module 'fs-jetpack' is a CommonJS module, which may not support all module.exports as named exports.
CommonJS modules can always be imported via the default export.</code></pre><p>Vitest doesn't do static analysis, and cannot fail before your running code, so you will most likely see this error when running tests, if this feature is disabled:<pre class="language-text"><code class="language-text">TypeError: createAsyncThunk is not a function
TypeError: default is not a function</code></pre><p>By default, Vitest assumes you are using a bundler to bypass this and will not fail, but you can disable this behaviour manually, if you code is not processed.</section><section class="level4"aria-labelledby="depsmoduledirectories"><h4 id="depsmoduledirectories">deps.moduleDirectories</h4><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default</strong>: <code>['node_modules']</code></ul><p>A list of directories that should be treated as module directories. This config option affects the behavior of <a href="/api/vi#vi-mock"><code>vi.mock</code></a>: when no factory is provided and the path of what you are mocking matches one of the <code>moduleDirectories</code> values, Vitest will try to resolve the mock by looking for a <code>__mocks__</code> folder in the <a href="#root">root</a> of the project.<p>This option will also affect if a file should be treated as a module when externalizing dependencies. By default, Vitest imports external modules with native Node.js bypassing Vite transformation step.<p>Setting this option will <em>override</em> the default, if you wish to still search <code>node_modules</code> for packages include it along with any other options:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    deps<span class="token operator">:</span> <span class="token punctuation">{</span>
      moduleDirectories<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'node_modules'</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token string">'../../packages'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section></section><section class="level3"aria-labelledby="runner"><h3 id="runner">runner</h3><ul><li><strong>Type</strong>: <code>VitestRunnerConstructor</code><li><strong>Default</strong>: <code>node</code>, when running tests, or <code>benchmark</code>, when running benchmarks</ul><p>Path to a custom test runner. This is an advanced feature and should be used with custom library runners. You can read more about it in <a href="/advanced/runner">the documentation</a>.</section><section class="level3"aria-labelledby="benchmark"><h3 id="benchmark">benchmark</h3><ul><li><strong>Type:</strong> <code>{ include?, exclude?, ... }</code></ul><p>Options used when running <code>vitest bench</code>.<section class="level4"aria-labelledby="benchmarkinclude"><h4 id="benchmarkinclude">benchmark.include</h4><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>['**/*.{bench,benchmark}.?(c|m)[jt]s?(x)']</code></ul><p>Include globs for benchmark test files</section><section class="level4"aria-labelledby="benchmarkexclude"><h4 id="benchmarkexclude">benchmark.exclude</h4><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>['node_modules', 'dist', '.idea', '.git', '.cache']</code></ul><p>Exclude globs for benchmark test files</section><section class="level4"aria-labelledby="benchmarkincludesource"><h4 id="benchmarkincludesource">benchmark.includeSource</h4><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Include globs for in-source benchmark test files. This option is similar to <a href="#includesource"><code>includeSource</code></a>.<p>When defined, Vitest will run all matched files with <code>import.meta.vitest</code> inside.</section><section class="level4"aria-labelledby="benchmarkreporters"><h4 id="benchmarkreporters">benchmark.reporters</h4><ul><li><strong>Type:</strong> <code>Arrayable&#x3C;BenchmarkBuiltinReporters | Reporter></code><li><strong>Default:</strong> <code>'default'</code></ul><p>Custom reporter for output. Can contain one or more built-in report names, reporter instances, and/or paths to custom reporters.</section><section class="level4"aria-labelledby="benchmarkoutputfile"><h4 id="benchmarkoutputfile">benchmark.outputFile</h4><p>Deprecated in favor of <code>benchmark.outputJson</code>.</section><section class="level4"aria-labelledby="benchmark-outputJson"><h4 id="benchmark-outputJson">benchmark.outputJson</h4><ul><li><strong>Type:</strong> <code>string | undefined</code><li><strong>Default:</strong> <code>undefined</code></ul><p>A file path to store the benchmark result, which can be used for <code>--compare</code> option later.<p>For example:<pre class="language-sh"><code class="language-sh"># save main branch's result
git checkout main
vitest bench --outputJson main.json

# change a branch and compare against main
git checkout feature
vitest bench --compare main.json</code></pre></section><section class="level4"aria-labelledby="benchmark-compare"><h4 id="benchmark-compare">benchmark.compare</h4><ul><li><strong>Type:</strong> <code>string | undefined</code><li><strong>Default:</strong> <code>undefined</code></ul><p>A file path to a previous benchmark result to compare against current runs.</section></section><section class="level3"aria-labelledby="alias"><h3 id="alias">alias</h3><ul><li><strong>Type:</strong> <code>Record&#x3C;string, string> | Array&#x3C;{ find: string | RegExp, replacement: string, customResolver?: ResolverFunction | ResolverObject }></code></ul><p>Define custom aliases when running inside tests. They will be merged with aliases from <code>resolve.alias</code>.<blockquote>Vitest uses Vite SSR primitives to run tests which has [certain pitfalls](https://vitejs.dev/guide/ssr.html#ssr-externals).<ol><li>Aliases affect only modules imported directly with an <code>import</code> keyword by an <a href="#server-deps-inline">inlined</a> module (all source code is inlined by default).<li>Vitest does not support aliasing <code>require</code> calls.<li>If you are aliasing an external dependency (e.g., <code>react</code> -> <code>preact</code>), you may want to alias the actual <code>node_modules</code> packages instead to make it work for externalized dependencies. Both <a href="https://classic.yarnpkg.com/en/docs/cli/add/#toc-yarn-add-alias">Yarn</a> and <a href="https://pnpm.io/aliases/">pnpm</a> support aliasing via the <code>npm:</code> prefix.</ol></blockquote></section><section class="level3"aria-labelledby="globals"><h3 id="globals">globals</h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>CLI:</strong> <code>--globals</code>, <code>--globals=false</code></ul><p>By default, <code>vitest</code> does not provide global APIs for explicitness. If you prefer to use the APIs globally like Jest, you can pass the <code>--globals</code> option to CLI or add <code>globals: true</code> in the config.<pre class="language-ts"><code class="language-ts"><span class="token comment">// vitest.config.ts</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    globals<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>To get TypeScript working with the global APIs, add <code>vitest/globals</code> to the <code>types</code> field in your <code>tsconfig.json</code><pre class="language-json"><code class="language-json"><span class="token comment">// tsconfig.json</span>
<span class="token punctuation">{</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"types"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"vitest/globals"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>If you are already using <a href="https://github.com/antfu/unplugin-auto-import"><code>unplugin-auto-import</code></a> in your project, you can also use it directly for auto importing those APIs.<pre class="language-ts"><code class="language-ts"><span class="token comment">// vitest.config.ts</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">AutoImport</span></span> <span class="token keyword module">from</span> <span class="token string">'unplugin-auto-import/vite'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function"><span class="token maybe-class-name">AutoImport</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      imports<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'vitest'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      dts<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// generate TypeScript declaration</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level3"aria-labelledby="environment"><h3 id="environment">environment</h3><ul><li><strong>Type:</strong> <code>'node' | 'jsdom' | 'happy-dom' | 'edge-runtime' | string</code><li><strong>Default:</strong> <code>'node'</code><li><strong>CLI:</strong> <code>--environment=&#x3C;env></code></ul><p>The environment that will be used for testing. The default environment in Vitest is a Node.js environment. If you are building a web application, you can use browser-like environment through either <a href="https://github.com/jsdom/jsdom"><code>jsdom</code></a> or <a href="https://github.com/capricorn86/happy-dom"><code>happy-dom</code></a> instead. If you are building edge functions, you can use <a href="https://edge-runtime.vercel.app/packages/vm"><code>edge-runtime</code></a> environment<blockquote>You can also use [Browser Mode](/guide/browser/) to run integration or unit tests in the browser without mocking the environment.</blockquote><p>By adding a <code>@vitest-environment</code> docblock or comment at the top of the file, you can specify another environment to be used for all tests in that file:<p>Docblock style:<pre class="language-js"><code class="language-js"><span class="token doc-comment comment">/**
 * <span class="token keyword">@vitest-environment</span> jsdom
 */</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'use jsdom in this test file'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token method function property-access">toBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>Comment style:<pre class="language-js"><code class="language-js"><span class="token comment">// @vitest-environment happy-dom</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'use happy-dom in this test file'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token method function property-access">toBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>For compatibility with Jest, there is also a <code>@jest-environment</code>:<pre class="language-js"><code class="language-js"><span class="token doc-comment comment">/**
 * <span class="token keyword">@jest-environment</span> jsdom
 */</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'use jsdom in this test file'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token method function property-access">toBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>If you are running Vitest with <a href="#isolate"><code>--isolate=false</code></a> flag, your tests will be run in this order: <code>node</code>, <code>jsdom</code>, <code>happy-dom</code>, <code>edge-runtime</code>, <code>custom environments</code>. Meaning, that every test with the same environment is grouped, but is still running sequentially.<p>Starting from 0.23.0, you can also define custom environment. When non-builtin environment is used, Vitest will try to load package <code>vitest-environment-${name}</code>. That package should export an object with the shape of <code>Environment</code>:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">Environment</span> <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">'vitest'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Environment</span><span class="token operator">></span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'custom'</span><span class="token punctuation">,</span>
  transformMode<span class="token operator">:</span> <span class="token string">'ssr'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// custom setup</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
      <span class="token function">teardown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// called after all tests with this env have been run</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Vitest also exposes <code>builtinEnvironments</code> through <code>vitest/environments</code> entry, in case you just want to extend it. You can read more about extending environments in <a href="/guide/environment">our guide</a>.<blockquote>jsdom environment exposes `jsdom` global variable equal to the current [JSDOM](https://github.com/jsdom/jsdom) instance. If you want TypeScript to recognize it, you can add `vitest/jsdom` to your `tsconfig.json` when you use this environment:<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"types"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"vitest/jsdom"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></blockquote></section><section class="level3"aria-labelledby="environmentoptions"><h3 id="environmentoptions">environmentOptions</h3><ul><li><strong>Type:</strong> <code>Record&#x3C;'jsdom' | string, unknown></code><li><strong>Default:</strong> <code>{}</code></ul><p>These options are passed down to <code>setup</code> method of current <a href="#environment"><code>environment</code></a>. By default, you can configure only JSDOM options, if you are using it as your test environment.</section><section class="level3"aria-labelledby="environmentmatchglobs"><h3 id="environmentmatchglobs">environmentMatchGlobs</h3><ul><li><strong>Type:</strong> <code>[string, EnvironmentName][]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Automatically assign environment based on globs. The first match will be used.<p>For example:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    environmentMatchGlobs<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// all tests in tests/dom will run in jsdom</span>
      <span class="token punctuation">[</span><span class="token string">'tests/dom/**'</span><span class="token punctuation">,</span> <span class="token string">'jsdom'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// all tests in tests/ with .edge.test.ts will run in edge-runtime</span>
      <span class="token punctuation">[</span><span class="token string">'**\/*.edge.test.ts'</span><span class="token punctuation">,</span> <span class="token string">'edge-runtime'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level3"aria-labelledby="poolmatchglobs"><h3 id="poolmatchglobs">poolMatchGlobs</h3><ul><li><strong>Type:</strong> <code>[string, 'threads' | 'forks' | 'vmThreads' | 'vmForks' | 'typescript'][]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Automatically assign pool in which tests will run based on globs. The first match will be used.<p>For example:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    poolMatchGlobs<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// all tests in "worker-specific" directory will run inside a worker as if you enabled `--pool=threads` for them,</span>
      <span class="token punctuation">[</span><span class="token string">'**/tests/worker-specific/**'</span><span class="token punctuation">,</span> <span class="token string">'threads'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// run all tests in "browser" directory in an actual browser</span>
      <span class="token punctuation">[</span><span class="token string">'**/tests/browser/**'</span><span class="token punctuation">,</span> <span class="token string">'browser'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// all other tests will run based on "browser.enabled" and "threads" options, if you didn't specify other globs</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level3"aria-labelledby="update"><h3 id="update">update<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>CLI:</strong> <code>-u</code>, <code>--update</code>, <code>--update=false</code></ul><p>Update snapshot files. This will update all changed snapshots and delete obsolete ones.</section><section class="level3"aria-labelledby="watch"><h3 id="watch">watch<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>!process.env.CI</code><li><strong>CLI:</strong> <code>-w</code>, <code>--watch</code>, <code>--watch=false</code></ul><p>Enable watch mode</section><section class="level3"aria-labelledby="root"><h3 id="root">root</h3><ul><li><strong>Type:</strong> <code>string</code><li><strong>CLI:</strong> <code>-r &#x3C;path></code>, <code>--root=&#x3C;path></code></ul><p>Project root</section><section class="level3"aria-labelledby="dir"><h3 id="dir">dir</h3><ul><li><strong>Type:</strong> <code>string</code><li><strong>CLI:</strong> <code>--dir=&#x3C;path></code><li><strong>Default:</strong> same as <code>root</code></ul><p>Base directory to scan for the test files. You can specify this option to speed up test discovery if your root covers the whole project</section><section class="level3"aria-labelledby="reporters"><h3 id="reporters">reporters<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type:</strong> <code>Reporter | Reporter[]</code><li><strong>Default:</strong> <code>'default'</code><li><strong>CLI:</strong> <code>--reporter=&#x3C;name></code>, <code>--reporter=&#x3C;name1> --reporter=&#x3C;name2></code></ul><p>Custom <a href="/guide/reporters">reporters</a> for output. Reporters can be <a href="https://github.com/vitest-dev/vitest/blob/main/packages/vitest/src/node/types/reporter.ts">a Reporter instance</a>, a string to select built-in reporters, or a path to a custom implementation (e.g. <code>'./path/to/reporter.ts'</code>, <code>'@scope/reporter'</code>).</section><section class="level3"aria-labelledby="outputfile"><h3 id="outputfile">outputFile<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type:</strong> <code>string | Record&#x3C;string, string></code><li><strong>CLI:</strong> <code>--outputFile=&#x3C;path></code>, <code>--outputFile.json=./path</code></ul><p>Write test results to a file when the <code>--reporter=json</code>, <code>--reporter=html</code> or <code>--reporter=junit</code> option is also specified. By providing an object instead of a string you can define individual outputs when using multiple reporters.</section><section class="level3"aria-labelledby="pool-pool"><h3 id="pool-pool">pool<nonprojectoption>{#pool}</nonprojectoption></h3><ul><li><strong>Type:</strong> <code>'threads' | 'forks' | 'vmThreads' | 'vmForks'</code><li><strong>Default:</strong> <code>'forks'</code><li><strong>CLI:</strong> <code>--pool=threads</code></ul><p>Pool used to run tests in.<section class="level4"aria-labelledby="threads"><h4 id="threads">threads<nonprojectoption></nonprojectoption></h4><p>Enable multi-threading using <a href="https://github.com/tinylibs/tinypool">tinypool</a> (a lightweight fork of <a href="https://github.com/piscinajs/piscina">Piscina</a>). When using threads you are unable to use process related APIs such as <code>process.chdir()</code>. Some libraries written in native languages, such as Prisma, <code>bcrypt</code> and <code>canvas</code>, have problems when running in multiple threads and run into segfaults. In these cases it is advised to use <code>forks</code> pool instead.</section><section class="level4"aria-labelledby="forks"><h4 id="forks">forks<nonprojectoption></nonprojectoption></h4><p>Similar as <code>threads</code> pool but uses <code>child_process</code> instead of <code>worker_threads</code> via <a href="https://github.com/tinylibs/tinypool">tinypool</a>. Communication between tests and main process is not as fast as with <code>threads</code> pool. Process related APIs such as <code>process.chdir()</code> are available in <code>forks</code> pool.</section><section class="level4"aria-labelledby="vmthreads"><h4 id="vmthreads">vmThreads<nonprojectoption></nonprojectoption></h4><p>Run tests using <a href="https://nodejs.org/api/vm.html">VM context</a> (inside a sandboxed environment) in a <code>threads</code> pool.<p>This makes tests run faster, but the VM module is unstable when running <a href="https://github.com/nodejs/node/issues/37648">ESM code</a>. Your tests will <a href="https://github.com/nodejs/node/issues/33439">leak memory</a> - to battle that, consider manually editing <a href="#pooloptions-vmthreads-memorylimit"><code>poolOptions.vmThreads.memoryLimit</code></a> value.<blockquote>Running code in a sandbox has some advantages (faster tests), but also comes with a number of disadvantages.<ul><li>The globals within native modules, such as (<code>fs</code>, <code>path</code>, etc), differ from the globals present in your test environment. As a result, any error thrown by these native modules will reference a different Error constructor compared to the one used in your code:</ul><pre class="language-ts"><code class="language-ts"><span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
  fs<span class="token punctuation">.</span><span class="token method function property-access">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'/doesnt exist'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>err <span class="token keyword">instanceof</span> <span class="token class-name"><span class="token known-class-name class-name">Error</span></span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token punctuation">}</span></code></pre><ul><li>Importing ES modules caches them indefinitely which introduces memory leaks if you have a lot of contexts (test files). There is no API in Node.js that clears that cache.<li>Accessing globals <a href="https://github.com/nodejs/node/issues/31658">takes longer</a> in a sandbox environment.</ul><p>Please, be aware of these issues when using this option. Vitest team cannot fix any of the issues on our side.</blockquote></section><section class="level4"aria-labelledby="vmforks"><h4 id="vmforks">vmForks<nonprojectoption></nonprojectoption></h4><p>Similar as <code>vmThreads</code> pool but uses <code>child_process</code> instead of <code>worker_threads</code> via <a href="https://github.com/tinylibs/tinypool">tinypool</a>. Communication between tests and the main process is not as fast as with <code>vmThreads</code> pool. Process related APIs such as <code>process.chdir()</code> are available in <code>vmForks</code> pool. Please be aware that this pool has the same pitfalls listed in <code>vmThreads</code>.</section></section><section class="level3"aria-labelledby="pooloptions-pooloptions"><h3 id="pooloptions-pooloptions">poolOptions<nonprojectoption>{#pooloptions}</nonprojectoption></h3><ul><li><strong>Type:</strong> <code>Record&#x3C;'threads' | 'forks' | 'vmThreads' | 'vmForks', {}></code><li><strong>Default:</strong> <code>{}</code></ul><section class="level4"aria-labelledby="pooloptionsthreads"><h4 id="pooloptionsthreads">poolOptions.threads</h4><p>Options for <code>threads</code> pool.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    poolOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
      threads<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// Threads related options here</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><section class="level5"aria-labelledby="pooloptionsthreadsmaxthreads"><h5 id="pooloptionsthreadsmaxthreads">poolOptions.threads.maxThreads<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>number | string</code><li><strong>Default:</strong> <em>available CPUs</em></ul><p>Maximum number or percentage of threads. You can also use <code>VITEST_MAX_THREADS</code> environment variable.</section><section class="level5"aria-labelledby="pooloptionsthreadsminthreads"><h5 id="pooloptionsthreadsminthreads">poolOptions.threads.minThreads<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>number | string</code><li><strong>Default:</strong> <em>available CPUs</em></ul><p>Minimum number or percentage of threads. You can also use <code>VITEST_MIN_THREADS</code> environment variable.</section><section class="level5"aria-labelledby="pooloptionsthreadssinglethread"><h5 id="pooloptionsthreadssinglethread">poolOptions.threads.singleThread</h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Run all tests with the same environment inside a single worker thread. This will disable built-in module isolation (your source code or <a href="#server-deps-inline">inlined</a> code will still be reevaluated for each test), but can improve test performance.<blockquote>Even though this option will force tests to run one after another, this option is different from Jest's `--runInBand`. Vitest uses workers not only for running tests in parallel, but also to provide isolation. By disabling this option, your tests will run sequentially, but in the same global context, so you must provide isolation yourself.<p>This might cause all sorts of issues, if you are relying on global state (frontend frameworks usually do) or your code relies on environment to be defined separately for each test. But can be a speed boost for your tests (up to 3 times faster), that don't necessarily rely on global state or can easily bypass that.</blockquote></section><section class="level5"aria-labelledby="pooloptionsthreadsuseatomics"><h5 id="pooloptionsthreadsuseatomics">poolOptions.threads.useAtomics<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Use Atomics to synchronize threads.<p>This can improve performance in some cases, but might cause segfault in older Node versions.</section><section class="level5"aria-labelledby="pooloptionsthreadsisolate"><h5 id="pooloptionsthreadsisolate">poolOptions.threads.isolate</h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code></ul><p>Isolate environment for each test file.</section><section class="level5"aria-labelledby="pooloptionsthreadsexecargv"><h5 id="pooloptionsthreadsexecargv">poolOptions.threads.execArgv<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Pass additional arguments to <code>node</code> in the threads. See <a href="https://nodejs.org/docs/latest/api/cli.html">Command-line API | Node.js</a> for more information.<blockquote>Be careful when using, it as some options may crash worker, e.g. --prof, --title. See https://github.com/nodejs/node/issues/41103.</blockquote></section></section><section class="level4"aria-labelledby="pooloptionsforks"><h4 id="pooloptionsforks">poolOptions.forks</h4><p>Options for <code>forks</code> pool.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    poolOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
      forks<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// Forks related options here</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><section class="level5"aria-labelledby="pooloptionsforksmaxforks"><h5 id="pooloptionsforksmaxforks">poolOptions.forks.maxForks<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>number | string</code><li><strong>Default:</strong> <em>available CPUs</em></ul><p>Maximum number or percentage of forks.</section><section class="level5"aria-labelledby="pooloptionsforksminforks"><h5 id="pooloptionsforksminforks">poolOptions.forks.minForks<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>number | string</code><li><strong>Default:</strong> <em>available CPUs</em></ul><p>Minimum number or percentage of forks.</section><section class="level5"aria-labelledby="pooloptionsforksisolate"><h5 id="pooloptionsforksisolate">poolOptions.forks.isolate</h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code></ul><p>Isolate environment for each test file.</section><section class="level5"aria-labelledby="pooloptionsforkssinglefork"><h5 id="pooloptionsforkssinglefork">poolOptions.forks.singleFork</h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Run all tests with the same environment inside a single child process. This will disable built-in module isolation (your source code or <a href="#server-deps-inline">inlined</a> code will still be reevaluated for each test), but can improve test performance.<blockquote>Even though this option will force tests to run one after another, this option is different from Jest's `--runInBand`. Vitest uses child processes not only for running tests in parallel, but also to provide isolation. By disabling this option, your tests will run sequentially, but in the same global context, so you must provide isolation yourself.<p>This might cause all sorts of issues, if you are relying on global state (frontend frameworks usually do) or your code relies on environment to be defined separately for each test. But can be a speed boost for your tests (up to 3 times faster), that don't necessarily rely on global state or can easily bypass that.</blockquote></section><section class="level5"aria-labelledby="pooloptionsforksexecargv"><h5 id="pooloptionsforksexecargv">poolOptions.forks.execArgv<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Pass additional arguments to <code>node</code> process in the child processes. See <a href="https://nodejs.org/docs/latest/api/cli.html">Command-line API | Node.js</a> for more information.<blockquote>Be careful when using, it as some options may crash worker, e.g. --prof, --title. See https://github.com/nodejs/node/issues/41103.</blockquote></section></section><section class="level4"aria-labelledby="pooloptionsvmthreads"><h4 id="pooloptionsvmthreads">poolOptions.vmThreads</h4><p>Options for <code>vmThreads</code> pool.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    poolOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
      vmThreads<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// VM threads related options here</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><section class="level5"aria-labelledby="pooloptionsvmthreadsmaxthreads"><h5 id="pooloptionsvmthreadsmaxthreads">poolOptions.vmThreads.maxThreads<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>number | string</code><li><strong>Default:</strong> <em>available CPUs</em></ul><p>Maximum number or percentage of threads. You can also use <code>VITEST_MAX_THREADS</code> environment variable.</section><section class="level5"aria-labelledby="pooloptionsvmthreadsminthreads"><h5 id="pooloptionsvmthreadsminthreads">poolOptions.vmThreads.minThreads<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>number | string</code><li><strong>Default:</strong> <em>available CPUs</em></ul><p>Minimum number or percentage of threads. You can also use <code>VITEST_MIN_THREADS</code> environment variable.</section><section class="level5"aria-labelledby="pooloptionsvmthreadsmemorylimit"><h5 id="pooloptionsvmthreadsmemorylimit">poolOptions.vmThreads.memoryLimit<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>string | number</code><li><strong>Default:</strong> <code>1 / CPU Cores</code></ul><p>Specifies the memory limit for workers before they are recycled. This value heavily depends on your environment, so it's better to specify it manually instead of relying on the default.<blockquote>The implementation is based on Jest's [`workerIdleMemoryLimit`](https://jestjs.io/docs/configuration#workeridlememorylimit-numberstring).<p>The limit can be specified in a number of different ways and whatever the result is <code>Math.floor</code> is used to turn it into an integer value:<ul><li><code>&#x3C;= 1</code> - The value is assumed to be a percentage of system memory. So 0.5 sets the memory limit of the worker to half of the total system memory<li><code>\> 1</code> - Assumed to be a fixed byte value. Because of the previous rule if you wanted a value of 1 byte (I don't know why) you could use 1.1.<li>With units<ul><li><code>50%</code> - As above, a percentage of total system memory<li><code>100KB</code>, <code>65MB</code>, etc - With units to denote a fixed memory limit. - <code>K</code> / <code>KB</code> - Kilobytes (x1000) - <code>KiB</code> - Kibibytes (x1024) - <code>M</code> / <code>MB</code> - Megabytes - <code>MiB</code> - Mebibytes - <code>G</code> / <code>GB</code> - Gigabytes - <code>GiB</code> - Gibibytes</ul></ul></blockquote><blockquote>Percentage based memory limit [does not work on Linux CircleCI](https://github.com/jestjs/jest/issues/11956#issuecomment-1212925677) workers due to incorrect system memory being reported.</blockquote></section><section class="level5"aria-labelledby="pooloptionsvmthreadsuseatomics"><h5 id="pooloptionsvmthreadsuseatomics">poolOptions.vmThreads.useAtomics<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Use Atomics to synchronize threads.<p>This can improve performance in some cases, but might cause segfault in older Node versions.</section><section class="level5"aria-labelledby="pooloptionsvmthreadsexecargv"><h5 id="pooloptionsvmthreadsexecargv">poolOptions.vmThreads.execArgv<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Pass additional arguments to <code>node</code> process in the VM context. See <a href="https://nodejs.org/docs/latest/api/cli.html">Command-line API | Node.js</a> for more information.<blockquote>Be careful when using, it as some options may crash worker, e.g. --prof, --title. See https://github.com/nodejs/node/issues/41103.</blockquote></section></section><section class="level4"aria-labelledby="pooloptionsvmforks"><h4 id="pooloptionsvmforks">poolOptions.vmForks<nonprojectoption></nonprojectoption></h4><p>Options for <code>vmForks</code> pool.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    poolOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
      vmForks<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// VM forks related options here</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><section class="level5"aria-labelledby="pooloptionsvmforksmaxforks"><h5 id="pooloptionsvmforksmaxforks">poolOptions.vmForks.maxForks<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>number | string</code><li><strong>Default:</strong> <em>available CPUs</em></ul><p>Maximum number or percentage of threads. You can also use <code>VITEST_MAX_FORKS</code> environment variable.</section><section class="level5"aria-labelledby="pooloptionsvmforksminforks"><h5 id="pooloptionsvmforksminforks">poolOptions.vmForks.minForks<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>number | string</code><li><strong>Default:</strong> <em>available CPUs</em></ul><p>Minimum number or percentage of threads. You can also use <code>VITEST_MIN_FORKS</code> environment variable.</section><section class="level5"aria-labelledby="pooloptionsvmforksmemorylimit"><h5 id="pooloptionsvmforksmemorylimit">poolOptions.vmForks.memoryLimit<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>string | number</code><li><strong>Default:</strong> <code>1 / CPU Cores</code></ul><p>Specifies the memory limit for workers before they are recycled. This value heavily depends on your environment, so it's better to specify it manually instead of relying on the default. How the value is calculated is described in <a href="#pooloptions-vmthreads-memorylimit"><code>poolOptions.vmThreads.memoryLimit</code></a></section><section class="level5"aria-labelledby="pooloptionsvmforksexecargv"><h5 id="pooloptionsvmforksexecargv">poolOptions.vmForks.execArgv<nonprojectoption></nonprojectoption></h5><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Pass additional arguments to <code>node</code> process in the VM context. See <a href="https://nodejs.org/docs/latest/api/cli.html">Command-line API | Node.js</a> for more information.<blockquote>Be careful when using, it as some options may crash worker, e.g. --prof, --title. See https://github.com/nodejs/node/issues/41103.</blockquote></section></section></section><section class="level3"aria-labelledby="fileparallelism-fileparallelism"><h3 id="fileparallelism-fileparallelism">fileParallelism<nonprojectoption>{#fileparallelism}</nonprojectoption></h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code><li><strong>CLI:</strong> <code>--no-file-parallelism</code>, <code>--fileParallelism=false</code></ul><p>Should all test files run in parallel. Setting this to <code>false</code> will override <code>maxWorkers</code> and <code>minWorkers</code> options to <code>1</code>.<blockquote>This option doesn't affect tests running in the same file. If you want to run those in parallel, use `concurrent` option on [describe](../api.html#describe-concurrent) or via [a config](#sequence-concurrent).</blockquote></section><section class="level3"aria-labelledby="maxworkers-maxworkers"><h3 id="maxworkers-maxworkers">maxWorkers<nonprojectoption>{#maxworkers}</nonprojectoption></h3><ul><li><strong>Type:</strong> <code>number | string</code></ul><p>Maximum number or percentage of workers to run tests in. <code>poolOptions.{threads,vmThreads}.maxThreads</code>/<code>poolOptions.forks.maxForks</code> has higher priority.</section><section class="level3"aria-labelledby="minworkers-minworkers"><h3 id="minworkers-minworkers">minWorkers<nonprojectoption>{#minworkers}</nonprojectoption></h3><ul><li><strong>Type:</strong> <code>number | string</code></ul><p>Minimum number or percentage of workers to run tests in. <code>poolOptions.{threads,vmThreads}.minThreads</code>/<code>poolOptions.forks.minForks</code> has higher priority.</section><section class="level3"aria-labelledby="testtimeout"><h3 id="testtimeout">testTimeout</h3><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>5_000</code> in Node.js, <code>15_000</code> if <code>browser.enabled</code> is <code>true</code><li><strong>CLI:</strong> <code>--test-timeout=5000</code>, <code>--testTimeout=5000</code></ul><p>Default timeout of a test in milliseconds</section><section class="level3"aria-labelledby="hooktimeout"><h3 id="hooktimeout">hookTimeout</h3><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>10_000</code> in Node.js, <code>30_000</code> if <code>browser.enabled</code> is <code>true</code><li><strong>CLI:</strong> <code>--hook-timeout=10000</code>, <code>--hookTimeout=10000</code></ul><p>Default timeout of a hook in milliseconds</section><section class="level3"aria-labelledby="teardowntimeout"><h3 id="teardowntimeout">teardownTimeout<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>10000</code><li><strong>CLI:</strong> <code>--teardown-timeout=5000</code>, <code>--teardownTimeout=5000</code></ul><p>Default timeout to wait for close when Vitest shuts down, in milliseconds</section><section class="level3"aria-labelledby="silent"><h3 id="silent">silent<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>CLI:</strong> <code>--silent</code>, <code>--silent=false</code></ul><p>Silent console output from tests</section><section class="level3"aria-labelledby="setupfiles"><h3 id="setupfiles">setupFiles</h3><ul><li><strong>Type:</strong> <code>string | string[]</code></ul><p>Path to setup files. They will be run before each test file.</section>info Changing setup files will trigger rerun of all tests.<p>You can use <code>process.env.VITEST_POOL_ID</code> (integer-like string) inside to distinguish between threads.<blockquote>Note, that if you are running [`--isolate=false`](#isolate), this setup file will be run in the same global scope multiple times. Meaning, that you are accessing the same global object before each test, so make sure you are not doing the same thing more than you need.need.</blockquote><p>For example, you may rely on a global variable:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> config <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@some-testing-lib'</span>

<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>globalThis<span class="token punctuation">.</span><span class="token property-access">defined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span><span class="token property-access">plugins</span> <span class="token operator">=</span> <span class="token punctuation">[</span>myCoolPlugin<span class="token punctuation">]</span>
  <span class="token function">computeHeavyThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  globalThis<span class="token punctuation">.</span><span class="token property-access">defined</span> <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token comment">// hooks are reset before each suite</span>
<span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

globalThis<span class="token punctuation">.</span><span class="token property-access">resetBeforeEachTest</span> <span class="token operator">=</span> <span class="token boolean">true</span></code></pre><section class="level3"aria-labelledby="provide-210-provide"><h3 id="provide-210-provide">provide<version>2.1.0</version>{#provide}</h3><ul><li><strong>Type:</strong> <code>Partial&#x3C;ProvidedContext></code></ul><p>Define values that can be accessed inside your tests using <code>inject</code> method.</section>code-group ```ts [vitest.config.js] import { defineConfig } from 'vitest/config'<p>export default defineConfig({ test: { provide: { API_KEY: '123', }, }, })<pre class="language-text"><code class="language-text">```ts [my.test.js]
import { expect, inject, test } from 'vitest'

test('api key is defined', () => {
  expect(inject('API_KEY')).toBe('123')
})</code></pre><blockquote>Properties have to be strings and values need to be [serializable](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm#supported_types) because this object will be transferred between different processes.</blockquote><blockquote>If you are using TypeScript, you will need to augment `ProvidedContext` type for type safe access:<pre class="language-ts"><code class="language-ts"><span class="token comment">// vitest.shims.d.ts</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'vitest'</span> <span class="token punctuation">{</span>
  <span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">ProvidedContext</span></span> <span class="token punctuation">{</span>
    <span class="token constant">API_KEY</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// mark this file as a module so augmentation works correctly</span>
<span class="token keyword module">export</span> <span class="token exports"><span class="token punctuation">{</span><span class="token punctuation">}</span></span></code></pre></blockquote><section class="level3"aria-labelledby="globalsetup"><h3 id="globalsetup">globalSetup</h3><ul><li><strong>Type:</strong> <code>string | string[]</code></ul><p>Path to global setup files, relative to project root.<p>A global setup file can either export named functions <code>setup</code> and <code>teardown</code> or a <code>default</code> function that returns a teardown function (<a href="https://github.com/vitest-dev/vitest/blob/main/test/global-setup/vitest.config.ts">example</a>).</section>info Multiple globalSetup files are possible. setup and teardown are executed sequentially with teardown in reverse order.<blockquote>Global setup runs only if there is at least one running test. This means that global setup might start running during watch mode after test file is changed (the test file will wait for global setup to finish before running).<p>Beware that the global setup is running in a different global scope, so your tests don't have access to variables defined here. However, you can pass down serializable data to tests via <a href="#provide"><code>provide</code></a> method:</blockquote>code-group ```js [globalSetup.js] export default function setup({ provide }) { provide('wsPort', 3000) } ``` ```ts [globalSetup.ts] import type { GlobalSetupContext } from 'vitest/node'<p>export default function setup({ provide }: GlobalSetupContext) { provide('wsPort', 3000) }<p>declare module 'vitest' { export interface ProvidedContext { wsPort: number } }<pre class="language-text"><code class="language-text">```ts [example.test.js]
import { inject } from 'vitest'

inject('wsPort') === 3000</code></pre><section class="level3"aria-labelledby="forcereruntriggers"><h3 id="forcereruntriggers">forceRerunTriggers<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type</strong>: <code>string[]</code><li><strong>Default:</strong> <code>['**/package.json/**', '**/vitest.config.*/**', '**/vite.config.*/**']</code></ul><p>Glob pattern of file paths that will trigger the whole suite rerun. When paired with the <code>--changed</code> argument will run the whole test suite if the trigger is found in the git diff.<p>Useful if you are testing calling CLI commands, because Vite cannot construct a module graph:<pre class="language-ts"><code class="language-ts"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'execute a script'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Vitest cannot rerun this test, if content of `dist/index.js` changes</span>
  <span class="token keyword control-flow">await</span> <span class="token function">execa</span><span class="token punctuation">(</span><span class="token string">'node'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dist/index.js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><blockquote>Make sure that your files are not excluded by [`server.watch.ignored`](https://vitejs.dev/config/server-options.html#server-watch).</blockquote></section><section class="level3"aria-labelledby="coverage"><h3 id="coverage">coverage<nonprojectoption></nonprojectoption></h3><p>You can use <a href="https://v8.dev/blog/javascript-code-coverage"><code>v8</code></a>, <a href="https://istanbul.js.org/"><code>istanbul</code></a> or <a href="/guide/coverage#custom-coverage-provider">a custom coverage solution</a> for coverage collection.<p>You can provide coverage options to CLI with dot notation:<pre class="language-sh"><code class="language-sh">npx vitest --coverage.enabled --coverage.provider=istanbul --coverage.all</code></pre><blockquote>If you are using coverage options with dot notation, don't forget to specify `--coverage.enabled`. Do not provide a single `--coverage` option in that case.</blockquote><section class="level4"aria-labelledby="coverageprovider"><h4 id="coverageprovider">coverage.provider</h4><ul><li><strong>Type:</strong> <code>'v8' | 'istanbul' | 'custom'</code><li><strong>Default:</strong> <code>'v8'</code><li><strong>CLI:</strong> <code>--coverage.provider=&#x3C;provider></code></ul><p>Use <code>provider</code> to select the tool for coverage collection.</section><section class="level4"aria-labelledby="coverageenabled"><h4 id="coverageenabled">coverage.enabled</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.enabled</code>, <code>--coverage.enabled=false</code></ul><p>Enables coverage collection. Can be overridden using <code>--coverage</code> CLI option.</section><section class="level4"aria-labelledby="coverageinclude"><h4 id="coverageinclude">coverage.include</h4><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>['**']</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.include=&#x3C;path></code>, <code>--coverage.include=&#x3C;path1> --coverage.include=&#x3C;path2></code></ul><p>List of files included in coverage as glob patterns</section><section class="level4"aria-labelledby="coverageextension"><h4 id="coverageextension">coverage.extension</h4><ul><li><strong>Type:</strong> <code>string | string[]</code><li><strong>Default:</strong> <code>['.js', '.cjs', '.mjs', '.ts', '.mts', '.tsx', '.jsx', '.vue', '.svelte', '.marko', '.astro']</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.extension=&#x3C;extension></code>, <code>--coverage.extension=&#x3C;extension1> --coverage.extension=&#x3C;extension2></code></ul></section><section class="level4"aria-labelledby="coverageexclude"><h4 id="coverageexclude">coverage.exclude</h4><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong></ul><pre class="language-js"><code class="language-js"><span class="token punctuation">[</span>
  <span class="token string">'coverage/**'</span><span class="token punctuation">,</span>
  <span class="token string">'dist/**'</span><span class="token punctuation">,</span>
  <span class="token string">'**/node_modules/**'</span><span class="token punctuation">,</span>
  <span class="token string">'**/[.]**'</span><span class="token punctuation">,</span>
  <span class="token string">'packages/*/test?(s)/**'</span><span class="token punctuation">,</span>
  <span class="token string">'**/*.d.ts'</span><span class="token punctuation">,</span>
  <span class="token string">'**/virtual:*'</span><span class="token punctuation">,</span>
  <span class="token string">'**/__x00__*'</span><span class="token punctuation">,</span>
  <span class="token string">'**/\x00*'</span><span class="token punctuation">,</span>
  <span class="token string">'cypress/**'</span><span class="token punctuation">,</span>
  <span class="token string">'test?(s)/**'</span><span class="token punctuation">,</span>
  <span class="token string">'test?(-*).?(c|m)[jt]s?(x)'</span><span class="token punctuation">,</span>
  <span class="token string">'**/*{.,-}{test,spec,bench,benchmark}?(-d).?(c|m)[jt]s?(x)'</span><span class="token punctuation">,</span>
  <span class="token string">'**/__tests__/**'</span><span class="token punctuation">,</span>
  <span class="token string">'**/{karma,rollup,webpack,vite,vitest,jest,ava,babel,nyc,cypress,tsup,build,eslint,prettier}.config.*'</span><span class="token punctuation">,</span>
  <span class="token string">'**/vitest.{workspace,projects}.[jt]s?(on)'</span><span class="token punctuation">,</span>
  <span class="token string">'**/.{eslint,mocha,prettier}rc.{?(c|m)js,yml}'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre><ul><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.exclude=&#x3C;path></code>, <code>--coverage.exclude=&#x3C;path1> --coverage.exclude=&#x3C;path2></code></ul><p>List of files excluded from coverage as glob patterns.<p>This option overrides all default options. Extend the default options when adding new patterns to ignore:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> coverageConfigDefaults<span class="token punctuation">,</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    coverage<span class="token operator">:</span> <span class="token punctuation">{</span>
      exclude<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'**/custom-pattern/**'</span><span class="token punctuation">,</span> <span class="token spread operator">...</span>coverageConfigDefaults<span class="token punctuation">.</span><span class="token property-access">exclude</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><blockquote>NOTE Vitest automatically adds test files `include` patterns to the default value of `coverage.exclude`.</blockquote></section><section class="level4"aria-labelledby="coverageall"><h4 id="coverageall">coverage.all</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.all</code>, <code>--coverage.all=false</code></ul><p>Whether to include all files, including the untested ones into report.</section><section class="level4"aria-labelledby="coverageclean"><h4 id="coverageclean">coverage.clean</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.clean</code>, <code>--coverage.clean=false</code></ul><p>Clean coverage results before running tests</section><section class="level4"aria-labelledby="coveragecleanonrerun"><h4 id="coveragecleanonrerun">coverage.cleanOnRerun</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.cleanOnRerun</code>, <code>--coverage.cleanOnRerun=false</code></ul><p>Clean coverage report on watch rerun. Set to <code>false</code> to preserve coverage results from previous run in watch mode.</section><section class="level4"aria-labelledby="coveragereportsdirectory"><h4 id="coveragereportsdirectory">coverage.reportsDirectory</h4><ul><li><strong>Type:</strong> <code>string</code><li><strong>Default:</strong> <code>'./coverage'</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.reportsDirectory=&#x3C;path></code></ul><blockquote>Vitest will delete this directory before running tests if `coverage.clean` is enabled (default value).</blockquote><p>Directory to write coverage report to.<p>To preview the coverage report in the output of <a href="/guide/reporters.html#html-reporter">HTML reporter</a>, this option must be set as a sub-directory of the html report directory (for example <code>./html/coverage</code>).</section><section class="level4"aria-labelledby="coveragereporter"><h4 id="coveragereporter">coverage.reporter</h4><ul><li><strong>Type:</strong> <code>string | string[] | [string, {}][]</code><li><strong>Default:</strong> <code>['text', 'html', 'clover', 'json']</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.reporter=&#x3C;reporter></code>, <code>--coverage.reporter=&#x3C;reporter1> --coverage.reporter=&#x3C;reporter2></code></ul><p>Coverage reporters to use. See <a href="https://istanbul.js.org/docs/advanced/alternative-reporters/">istanbul documentation</a> for detailed list of all reporters. See <a href="https://github.com/DefinitelyTyped/DefinitelyTyped/blob/276d95e4304b3670eaf6e8e5a7ea9e265a14e338/types/istanbul-reports/index.d.ts"><code>@types/istanbul-reporter</code></a> for details about reporter specific options.<p>The reporter has three different types:<ul><li>A single reporter: <code>{ reporter: 'html' }</code><li>Multiple reporters without options: <code>{ reporter: ['html', 'json'] }</code><li>A single or multiple reporters with reporter options:<pre class="language-ts"><code class="language-ts"><span class="token punctuation">{</span>
  reporter<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">'lcov'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">'projectRoot'</span><span class="token operator">:</span> <span class="token string">'./src'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'json'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">'file'</span><span class="token operator">:</span> <span class="token string">'coverage.json'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></ul><p>You can also pass custom coverage reporters. See <a href="/guide/coverage#custom-coverage-reporter">Guide - Custom Coverage Reporter</a> for more information.<pre class="language-ts"><code class="language-ts">  <span class="token punctuation">{</span>
    reporter<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// Specify reporter using name of the NPM package</span>
      <span class="token string">'@vitest/custom-coverage-reporter'</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">'@vitest/custom-coverage-reporter'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> someOption<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

      <span class="token comment">// Specify reporter using local path</span>
      <span class="token string">'/absolute/path/to/custom-reporter.cjs'</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">'/absolute/path/to/custom-reporter.cjs'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> someOption<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span></code></pre><p>You can check your coverage report in Vitest UI: check <a href="/guide/coverage#vitest-ui">Vitest UI Coverage</a> for more details.</section><section class="level4"aria-labelledby="coverage-reportonfailure"><h4 id="coverage-reportonfailure">coverage.reportOnFailure</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.reportOnFailure</code>, <code>--coverage.reportOnFailure=false</code></ul><p>Generate coverage report even when tests fail.</section><section class="level4"aria-labelledby="coverageallowexternal"><h4 id="coverageallowexternal">coverage.allowExternal</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.allowExternal</code>, <code>--coverage.allowExternal=false</code></ul><p>Collect coverage of files outside the <a href="#root">project <code>root</code></a>.</section><section class="level4"aria-labelledby="coverageexcludeafterremap-210-coverage-exclude-after-remap"><h4 id="coverageexcludeafterremap-210-coverage-exclude-after-remap">coverage.excludeAfterRemap<version>2.1.0</version>{#coverage-exclude-after-remap}</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.excludeAfterRemap</code>, <code>--coverage.excludeAfterRemap=false</code></ul><p>Apply exclusions again after coverage has been remapped to original sources. This is useful when your source files are transpiled and may contain source maps of non-source files.<p>Use this option when you are seeing files that show up in report even if they match your <code>coverage.exclude</code> patterns.</section><section class="level4"aria-labelledby="coverageskipfull"><h4 id="coverageskipfull">coverage.skipFull</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.skipFull</code>, <code>--coverage.skipFull=false</code></ul><p>Do not show files with 100% statement, branch, and function coverage.</section><section class="level4"aria-labelledby="coveragethresholds"><h4 id="coveragethresholds">coverage.thresholds</h4><p>Options for coverage thresholds<section class="level5"aria-labelledby="coveragethresholdslines"><h5 id="coveragethresholdslines">coverage.thresholds.lines</h5><ul><li><strong>Type:</strong> <code>number</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.thresholds.lines=&#x3C;number></code></ul><p>Global threshold for lines. See <a href="https://github.com/istanbuljs/nyc#coverage-thresholds">istanbul documentation</a> for more information.</section><section class="level5"aria-labelledby="coveragethresholdsfunctions"><h5 id="coveragethresholdsfunctions">coverage.thresholds.functions</h5><ul><li><strong>Type:</strong> <code>number</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.thresholds.functions=&#x3C;number></code></ul><p>Global threshold for functions. See <a href="https://github.com/istanbuljs/nyc#coverage-thresholds">istanbul documentation</a> for more information.</section><section class="level5"aria-labelledby="coveragethresholdsbranches"><h5 id="coveragethresholdsbranches">coverage.thresholds.branches</h5><ul><li><strong>Type:</strong> <code>number</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.thresholds.branches=&#x3C;number></code></ul><p>Global threshold for branches. See <a href="https://github.com/istanbuljs/nyc#coverage-thresholds">istanbul documentation</a> for more information.</section><section class="level5"aria-labelledby="coveragethresholdsstatements"><h5 id="coveragethresholdsstatements">coverage.thresholds.statements</h5><ul><li><strong>Type:</strong> <code>number</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.thresholds.statements=&#x3C;number></code></ul><p>Global threshold for statements. See <a href="https://github.com/istanbuljs/nyc#coverage-thresholds">istanbul documentation</a> for more information.</section><section class="level5"aria-labelledby="coveragethresholdsperfile"><h5 id="coveragethresholdsperfile">coverage.thresholds.perFile</h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.thresholds.perFile</code>, <code>--coverage.thresholds.perFile=false</code></ul><p>Check thresholds per file.</section><section class="level5"aria-labelledby="coveragethresholdsautoupdate"><h5 id="coveragethresholdsautoupdate">coverage.thresholds.autoUpdate</h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.thresholds.autoUpdate=&#x3C;boolean></code></ul><p>Update all threshold values <code>lines</code>, <code>functions</code>, <code>branches</code> and <code>statements</code> to configuration file when current coverage is above the configured thresholds. This option helps to maintain thresholds when coverage is improved.</section><section class="level5"aria-labelledby="coveragethresholds100"><h5 id="coveragethresholds100">coverage.thresholds.100</h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.thresholds.100</code>, <code>--coverage.thresholds.100=false</code></ul><p>Sets global thresholds to 100. Shortcut for <code>--coverage.thresholds.lines 100 --coverage.thresholds.functions 100 --coverage.thresholds.branches 100 --coverage.thresholds.statements 100</code>.</section><section class="level5"aria-labelledby="coveragethresholdsglob-pattern"><h5 id="coveragethresholdsglob-pattern">coverage.thresholds[glob-pattern]</h5><ul><li><strong>Type:</strong> <code>{ statements?: number functions?: number branches?: number lines?: number }</code><li><strong>Default:</strong> <code>undefined</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code></ul><p>Sets thresholds for files matching the glob pattern.<blockquote>NOTE Vitest counts all files, including those covered by glob-patterns, into the global coverage thresholds. This is different from Jest behavior.</blockquote><pre class="language-ts"><code class="language-ts"><span class="token punctuation">{</span>
  coverage<span class="token operator">:</span> <span class="token punctuation">{</span>
    thresholds<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// Thresholds for all files</span>
      functions<span class="token operator">:</span> <span class="token number">95</span><span class="token punctuation">,</span>
      branches<span class="token operator">:</span> <span class="token number">70</span><span class="token punctuation">,</span>

      <span class="token comment">// Thresholds for matching glob pattern</span>
      <span class="token string-property property">'src/utils/**.ts'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        statements<span class="token operator">:</span> <span class="token number">95</span><span class="token punctuation">,</span>
        functions<span class="token operator">:</span> <span class="token number">90</span><span class="token punctuation">,</span>
        branches<span class="token operator">:</span> <span class="token number">85</span><span class="token punctuation">,</span>
        lines<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">// Files matching this pattern will only have lines thresholds set.</span>
      <span class="token comment">// Global thresholds are not inherited.</span>
      <span class="token string-property property">'**/math.ts'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        lines<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></section><section class="level5"aria-labelledby="coveragethresholdsglob-pattern100-210-coverage-thresholds-glob-pattern-100"><h5 id="coveragethresholdsglob-pattern100-210-coverage-thresholds-glob-pattern-100">coverage.thresholds[glob-pattern].100<version>2.1.0</version>{#coverage-thresholds-glob-pattern-100}</h5><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code></ul><p>Sets thresholds to 100 for files matching the glob pattern.<pre class="language-ts"><code class="language-ts"><span class="token punctuation">{</span>
  coverage<span class="token operator">:</span> <span class="token punctuation">{</span>
    thresholds<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// Thresholds for all files</span>
      functions<span class="token operator">:</span> <span class="token number">95</span><span class="token punctuation">,</span>
      branches<span class="token operator">:</span> <span class="token number">70</span><span class="token punctuation">,</span>

      <span class="token comment">// Thresholds for matching glob pattern</span>
      <span class="token string-property property">'src/utils/**.ts'</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token number">100</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string-property property">'**/math.ts'</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token number">100</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></section></section><section class="level4"aria-labelledby="coverageignoreemptylines"><h4 id="coverageignoreemptylines">coverage.ignoreEmptyLines</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code> (<code>false</code> in v1)<li><strong>Available for providers:</strong> <code>'v8'</code><li><strong>CLI:</strong> <code>--coverage.ignoreEmptyLines=&#x3C;boolean></code></ul><p>Ignore empty lines, comments and other non-runtime code, e.g. Typescript types.<p>This option works only if the used compiler removes comments and other non-runtime code from the transpiled code. By default Vite uses ESBuild which removes comments and Typescript types from <code>.ts</code>, <code>.tsx</code> and <code>.jsx</code> files.<p>If you want to apply ESBuild to other files as well, define them in <a href="https://vitejs.dev/config/shared-options.html#esbuild"><code>esbuild</code> options</a>:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  esbuild<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// Transpile all files with ESBuild to remove comments from code coverage.</span>
    <span class="token comment">// Required for `test.coverage.ignoreEmptyLines` to work:</span>
    include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'**/*.js'</span><span class="token punctuation">,</span> <span class="token string">'**/*.jsx'</span><span class="token punctuation">,</span> <span class="token string">'**/*.mjs'</span><span class="token punctuation">,</span> <span class="token string">'**/*.ts'</span><span class="token punctuation">,</span> <span class="token string">'**/*.tsx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    coverage<span class="token operator">:</span> <span class="token punctuation">{</span>
      provider<span class="token operator">:</span> <span class="token string">'v8'</span><span class="token punctuation">,</span>
      ignoreEmptyLines<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level4"aria-labelledby="coverageignoreclassmethods"><h4 id="coverageignoreclassmethods">coverage.ignoreClassMethods</h4><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code><li><strong>Available for providers:</strong> <code>'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.ignoreClassMethods=&#x3C;method></code></ul><p>Set to array of class method names to ignore for coverage. See <a href="https://github.com/istanbuljs/nyc#ignoring-methods">istanbul documentation</a> for more information.</section><section class="level4"aria-labelledby="coveragewatermarks"><h4 id="coveragewatermarks">coverage.watermarks</h4><ul><li><strong>Type:</strong></ul><pre class="language-ts"><code class="language-ts"><span class="token punctuation">{</span>
  statements<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  functions<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  branches<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  lines<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre><ul><li><strong>Default:</strong></ul><pre class="language-ts"><code class="language-ts"><span class="token punctuation">{</span>
  statements<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  functions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  branches<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  lines<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre><ul><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.watermarks.statements=50,80</code>, <code>--coverage.watermarks.branches=50,80</code></ul><p>Watermarks for statements, lines, branches and functions. See <a href="https://github.com/istanbuljs/nyc#high-and-low-watermarks">istanbul documentation</a> for more information.</section><section class="level4"aria-labelledby="coverageprocessingconcurrency"><h4 id="coverageprocessingconcurrency">coverage.processingConcurrency</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>Math.min(20, os.availableParallelism?.() ?? os.cpus().length)</code><li><strong>Available for providers:</strong> <code>'v8' | 'istanbul'</code><li><strong>CLI:</strong> <code>--coverage.processingConcurrency=&#x3C;number></code></ul><p>Concurrency limit used when processing the coverage results.</section><section class="level4"aria-labelledby="coveragecustomprovidermodule"><h4 id="coveragecustomprovidermodule">coverage.customProviderModule</h4><ul><li><strong>Type:</strong> <code>string</code><li><strong>Available for providers:</strong> <code>'custom'</code><li><strong>CLI:</strong> <code>--coverage.customProviderModule=&#x3C;path or module name></code></ul><p>Specifies the module name or path for the custom coverage provider module. See <a href="/guide/coverage#custom-coverage-provider">Guide - Custom Coverage Provider</a> for more information.</section></section><section class="level3"aria-labelledby="testnamepattern"><h3 id="testnamepattern">testNamePattern<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type</strong> <code>string | RegExp</code><li><strong>CLI:</strong> <code>-t &#x3C;pattern></code>, <code>--testNamePattern=&#x3C;pattern></code>, <code>--test-name-pattern=&#x3C;pattern></code></ul><p>Run tests with full names matching the pattern. If you add <code>OnlyRunThis</code> to this property, tests not containing the word <code>OnlyRunThis</code> in the test name will be skipped.<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> expect<span class="token punctuation">,</span> test <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest'</span>

<span class="token comment">// run</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'OnlyRunThis'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// skipped</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'doNotRun'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level3"aria-labelledby="open"><h3 id="open">open<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>!process.env.CI</code><li><strong>CLI:</strong> <code>--open</code>, <code>--open=false</code></ul><p>Open Vitest UI (WIP)</section><section class="level3"aria-labelledby="api"><h3 id="api">api</h3><ul><li><strong>Type:</strong> <code>boolean | number</code><li><strong>Default:</strong> <code>false</code><li><strong>CLI:</strong> <code>--api</code>, <code>--api.port</code>, <code>--api.host</code>, <code>--api.strictPort</code></ul><p>Listen to port and serve API. When set to true, the default port is 51204</section><section class="level3"aria-labelledby="browser"><h3 id="browser">browser</h3><ul><li><strong>Type:</strong> <code>{ enabled?, name?, provider?, headless?, api? }</code><li><strong>Default:</strong> <code>{ enabled: false, headless: process.env.CI, api: 63315 }</code><li><strong>CLI:</strong> <code>--browser</code>, <code>--browser=&#x3C;name></code>, <code>--browser.name=chrome --browser.headless</code></ul><p>Run Vitest tests in a browser. We use <a href="https://webdriver.io/">WebdriverIO</a> for running tests by default, but it can be configured with <a href="#browser-provider">browser.provider</a> option.<blockquote>NOTE Read more about testing in a real browser in the [guide page](/guide/browser/).</blockquote><blockquote>This is an experimental feature. Breaking changes might not follow SemVer, please pin Vitest's version when using it.</blockquote><section class="level4"aria-labelledby="browserenabled"><h4 id="browserenabled">browser.enabled</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code><li><strong>CLI:</strong> <code>--browser</code>, <code>--browser.enabled=false</code></ul><p>Run all tests inside a browser by default. Can be overridden with <a href="#poolmatchglobs"><code>poolMatchGlobs</code></a> option.</section><section class="level4"aria-labelledby="browsername"><h4 id="browsername">browser.name</h4><ul><li><strong>Type:</strong> <code>string</code><li><strong>CLI:</strong> <code>--browser=safari</code></ul><p>Run all tests in a specific browser. Possible options in different providers:<ul><li><code>webdriverio</code>: <code>firefox</code>, <code>chrome</code>, <code>edge</code>, <code>safari</code><li><code>playwright</code>: <code>firefox</code>, <code>webkit</code>, <code>chromium</code><li>custom: any string that will be passed to the provider</ul></section><section class="level4"aria-labelledby="browserheadless"><h4 id="browserheadless">browser.headless</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>process.env.CI</code><li><strong>CLI:</strong> <code>--browser.headless</code>, <code>--browser.headless=false</code></ul><p>Run the browser in a <code>headless</code> mode. If you are running Vitest in CI, it will be enabled by default.</section><section class="level4"aria-labelledby="browserisolate"><h4 id="browserisolate">browser.isolate</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code><li><strong>CLI:</strong> <code>--browser.isolate</code>, <code>--browser.isolate=false</code></ul><p>Run every test in a separate iframe.</section><section class="level4"aria-labelledby="browserapi"><h4 id="browserapi">browser.api</h4><ul><li><strong>Type:</strong> <code>number | { port?, strictPort?, host? }</code><li><strong>Default:</strong> <code>63315</code><li><strong>CLI:</strong> <code>--browser.api=63315</code>, <code>--browser.api.port=1234, --browser.api.host=example.com</code></ul><p>Configure options for Vite server that serves code in the browser. Does not affect <a href="#api"><code>test.api</code></a> option. By default, Vitest assigns port <code>63315</code> to avoid conflicts with the development server, allowing you to run both in parallel.</section><section class="level4"aria-labelledby="browserprovider"><h4 id="browserprovider">browser.provider</h4><ul><li><strong>Type:</strong> <code>'webdriverio' | 'playwright' | 'preview' | string</code><li><strong>Default:</strong> <code>'preview'</code><li><strong>CLI:</strong> <code>--browser.provider=playwright</code></ul><p>Path to a provider that will be used when running browser tests. Vitest provides three providers which are <code>preview</code> (default), <code>webdriverio</code> and <code>playwright</code>. Custom providers should be exported using <code>default</code> export and have this shape:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">BrowserProvider</span></span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token function-variable function">getSupportedBrowsers</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">readonly</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token function-variable function">initialize</span><span class="token operator">:</span> <span class="token punctuation">(</span>ctx<span class="token operator">:</span> <span class="token maybe-class-name">Vitest</span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token punctuation">{</span> browser<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">BrowserProviderOptions</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token maybe-class-name">Awaitable</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span>
  <span class="token function-variable function">openPage</span><span class="token operator">:</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token maybe-class-name">Awaitable</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span>
  <span class="token function-variable function">close</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token maybe-class-name">Awaitable</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span>
<span class="token punctuation">}</span></code></pre><blockquote>This is an advanced API for library authors. If you just need to run tests in a browser, use the [browser](#browser) option.</blockquote></section><section class="level4"aria-labelledby="browser-provideroptions"><h4 id="browser-provideroptions">browser.providerOptions</h4><ul><li><strong>Type:</strong> <code>BrowserProviderOptions</code></ul><p>Options that will be passed down to provider when calling <code>provider.initialize</code>.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    browser<span class="token operator">:</span> <span class="token punctuation">{</span>
      providerOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
        launch<span class="token operator">:</span> <span class="token punctuation">{</span>
          devtools<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><blockquote>To have a better type safety when using built-in providers, you can add one of these types (for provider that you are using) to your tsconfig's `compilerOptions.types` field:<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"types"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"@vitest/browser/providers/webdriverio"</span><span class="token punctuation">,</span>
      <span class="token string">"@vitest/browser/providers/playwright"</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></blockquote></section><section class="level4"aria-labelledby="browser-ui"><h4 id="browser-ui">browser.ui</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>!isCI</code><li><strong>CLI:</strong> <code>--browser.ui=false</code></ul><p>Should Vitest UI be injected into the page. By default, injects UI iframe during development.</section><section class="level4"aria-labelledby="browser-viewport"><h4 id="browser-viewport">browser.viewport</h4><ul><li><strong>Type:</strong> <code>{ width, height }</code><li><strong>Default:</strong> <code>414x896</code></ul><p>Default iframe's viewport.</section><section class="level4"aria-labelledby="browser-locators"><h4 id="browser-locators">browser.locators</h4><p>Options for built-in <a href="/guide/browser/locators">browser locators</a>.<section class="level5"aria-labelledby="browserlocatorstestidattribute"><h5 id="browserlocatorstestidattribute">browser.locators.testIdAttribute</h5><ul><li><strong>Type:</strong> <code>string</code><li><strong>Default:</strong> <code>data-testid</code></ul><p>Attribute used to find elements with <code>getByTestId</code> locator.</section></section><section class="level4"aria-labelledby="browser-screenshotdirectory"><h4 id="browser-screenshotdirectory">browser.screenshotDirectory</h4><ul><li><strong>Type:</strong> <code>string</code><li><strong>Default:</strong> <code>__snapshots__</code> in the test file directory</ul><p>Path to the snapshots directory relative to the <code>root</code>.</section><section class="level4"aria-labelledby="browser-screenshotfailures"><h4 id="browser-screenshotfailures">browser.screenshotFailures</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>!browser.ui</code></ul><p>Should Vitest take screenshots if the test fails.</section><section class="level4"aria-labelledby="browser-orchestratorscripts"><h4 id="browser-orchestratorscripts">browser.orchestratorScripts</h4><ul><li><strong>Type:</strong> <code>BrowserScript[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Custom scripts that should be injected into the orchestrator HTML before test iframes are initiated. This HTML document only sets up iframes and doesn't actually import your code.<p>The script <code>src</code> and <code>content</code> will be processed by Vite plugins. Script should be provided in the following shape:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">BrowserScript</span></span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
   * If "content" is provided and type is "module", this will be its identifier.
   *
   * If you are using TypeScript, you can add `.ts` extension here for example.
   * <span class="token keyword">@default</span> `injected-$<span class="token punctuation">{</span>index<span class="token punctuation">}</span>.js`
   */</span>
  id<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token doc-comment comment">/**
   * JavaScript content to be injected. This string is processed by Vite plugins if type is "module".
   *
   * You can use `id` to give Vite a hint about the file extension.
   */</span>
  content<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token doc-comment comment">/**
   * Path to the script. This value is resolved by Vite so it can be a node module or a file path.
   */</span>
  src<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token doc-comment comment">/**
   * If the script should be loaded asynchronously.
   */</span>
  async<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  <span class="token doc-comment comment">/**
   * Script type.
   * <span class="token keyword">@default</span> 'module'
   */</span>
  type<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span></code></pre></section><section class="level4"aria-labelledby="browser-testerscripts"><h4 id="browser-testerscripts">browser.testerScripts</h4><ul><li><strong>Type:</strong> <code>BrowserScript[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Custom scripts that should be injected into the tester HTML before the tests environment is initiated. This is useful to inject polyfills required for Vitest browser implementation. It is recommended to use <a href="#setupfiles"><code>setupFiles</code></a> in almost all cases instead of this.<p>The script <code>src</code> and <code>content</code> will be processed by Vite plugins.</section><section class="level4"aria-labelledby="browser-commands"><h4 id="browser-commands">browser.commands</h4><ul><li><strong>Type:</strong> <code>Record&#x3C;string, BrowserCommand></code><li><strong>Default:</strong> <code>{ readFile, writeFile, ... }</code></ul><p>Custom <a href="/guide/browser/commands">commands</a> that can be imported during browser tests from <code>@vitest/browser/commands</code>.</section></section><section class="level3"aria-labelledby="clearmocks"><h3 id="clearmocks">clearMocks</h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Will call <a href="/api/mock#mockclear"><code>.mockClear()</code></a> on all spies before each test. This will clear mock history, but not reset its implementation to the default one.</section><section class="level3"aria-labelledby="mockreset"><h3 id="mockreset">mockReset</h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Will call <a href="/api/mock#mockreset"><code>.mockReset()</code></a> on all spies before each test. This will clear mock history and reset its implementation to an empty function (will return <code>undefined</code>).</section><section class="level3"aria-labelledby="restoremocks"><h3 id="restoremocks">restoreMocks</h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Will call <a href="/api/mock#mockrestore"><code>.mockRestore()</code></a> on all spies before each test. This will clear mock history and reset its implementation to the original one.</section><section class="level3"aria-labelledby="unstubenvs"><h3 id="unstubenvs">unstubEnvs</h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Will call <a href="/api/vi#vi-unstuballenvs"><code>vi.unstubAllEnvs</code></a> before each test.</section><section class="level3"aria-labelledby="unstubglobals"><h3 id="unstubglobals">unstubGlobals</h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Will call <a href="/api/vi#vi-unstuballglobals"><code>vi.unstubAllGlobals</code></a> before each test.</section><section class="level3"aria-labelledby="testtransformmode"><h3 id="testtransformmode">testTransformMode</h3><ul><li><strong>Type:</strong> <code>{ web?, ssr? }</code></ul><p>Determine the transform method for all modules imported inside a test that matches the glob pattern. By default, relies on the environment. For example, tests with JSDOM environment will process all files with <code>ssr: false</code> flag and tests with Node environment process all modules with <code>ssr: true</code>.<section class="level4"aria-labelledby="testtransformmodessr"><h4 id="testtransformmodessr">testTransformMode.ssr</h4><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>Use SSR transform pipeline for all modules inside specified tests.<br>Vite plugins will receive <code>ssr: true</code> flag when processing those files.</section><section class="level4"aria-labelledby="testtransformmodeweb"><h4 id="testtransformmodeweb">testTransformMode.web</h4><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>First do a normal transform pipeline (targeting browser), then do a SSR rewrite to run the code in Node.<br>Vite plugins will receive <code>ssr: false</code> flag when processing those files.</section></section><section class="level3"aria-labelledby="snapshotformat"><h3 id="snapshotformat">snapshotFormat<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type:</strong> <code>PrettyFormatOptions</code></ul><p>Format options for snapshot testing. These options are passed down to <a href="https://www.npmjs.com/package/pretty-format"><code>pretty-format</code></a>.<blockquote>Beware that `plugins` field on this object will be ignored.<p>If you need to extend snapshot serializer via pretty-format plugins, please, use <a href="/api/expect#expect-addsnapshotserializer"><code>expect.addSnapshotSerializer</code></a> API or <a href="#snapshotserializers">snapshotSerializers</a> option.</blockquote></section><section class="level3"aria-labelledby="snapshotserializers-snapshotserializers"><h3 id="snapshotserializers-snapshotserializers">snapshotSerializers<nonprojectoption>{#snapshotserializers}</nonprojectoption></h3><ul><li><strong>Type:</strong> <code>string[]</code><li><strong>Default:</strong> <code>[]</code></ul><p>A list of paths to snapshot serializer modules for snapshot testing, useful if you want add custom snapshot serializers. See <a href="/guide/snapshot#custom-serializer">Custom Serializer</a> for more information.</section><section class="level3"aria-labelledby="resolvesnapshotpath"><h3 id="resolvesnapshotpath">resolveSnapshotPath<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type</strong>: <code>(testPath: string, snapExtension: string) => string</code><li><strong>Default</strong>: stores snapshot files in <code>__snapshots__</code> directory</ul><p>Overrides default snapshot path. For example, to store snapshots next to test files:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">resolveSnapshotPath</span><span class="token operator">:</span> <span class="token punctuation">(</span>testPath<span class="token punctuation">,</span> snapExtension<span class="token punctuation">)</span> <span class="token arrow operator">=></span> testPath <span class="token operator">+</span> snapExtension<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level3"aria-labelledby="allowonly"><h3 id="allowonly">allowOnly</h3><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>!process.env.CI</code><li><strong>CLI:</strong> <code>--allowOnly</code>, <code>--allowOnly=false</code></ul><p>Allow tests and suites that are marked as only.</section><section class="level3"aria-labelledby="dangerouslyignoreunhandlederrors"><h3 id="dangerouslyignoreunhandlederrors">dangerouslyIgnoreUnhandledErrors<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code><li><strong>CLI:</strong> <code>--dangerouslyIgnoreUnhandledErrors</code> <code>--dangerouslyIgnoreUnhandledErrors=false</code></ul><p>Ignore any unhandled errors that occur.</section><section class="level3"aria-labelledby="passwithnotests"><h3 id="passwithnotests">passWithNoTests<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code><li><strong>CLI:</strong> <code>--passWithNoTests</code>, <code>--passWithNoTests=false</code></ul><p>Vitest will not fail, if no tests will be found.</section><section class="level3"aria-labelledby="logheapusage"><h3 id="logheapusage">logHeapUsage</h3><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code><li><strong>CLI:</strong> <code>--logHeapUsage</code>, <code>--logHeapUsage=false</code></ul><p>Show heap usage after each test. Useful for debugging memory leaks.</section><section class="level3"aria-labelledby="css"><h3 id="css">css</h3><ul><li><strong>Type</strong>: <code>boolean | { include?, exclude?, modules? }</code></ul><p>Configure if CSS should be processed. When excluded, CSS files will be replaced with empty strings to bypass the subsequent processing. CSS Modules will return a proxy to not affect runtime.<section class="level4"aria-labelledby="cssinclude"><h4 id="cssinclude">css.include</h4><ul><li><strong>Type</strong>: <code>RegExp | RegExp[]</code><li><strong>Default</strong>: <code>[]</code></ul><p>RegExp pattern for files that should return actual CSS and will be processed by Vite pipeline.<blockquote>To process all CSS files, use `/.+/`.</blockquote></section><section class="level4"aria-labelledby="cssexclude"><h4 id="cssexclude">css.exclude</h4><ul><li><strong>Type</strong>: <code>RegExp | RegExp[]</code><li><strong>Default</strong>: <code>[]</code></ul><p>RegExp pattern for files that will return an empty CSS file.</section><section class="level4"aria-labelledby="cssmodules"><h4 id="cssmodules">css.modules</h4><ul><li><strong>Type</strong>: <code>{ classNameStrategy? }</code><li><strong>Default</strong>: <code>{}</code></ul></section><section class="level4"aria-labelledby="cssmodulesclassnamestrategy"><h4 id="cssmodulesclassnamestrategy">css.modules.classNameStrategy</h4><ul><li><strong>Type</strong>: <code>'stable' | 'scoped' | 'non-scoped'</code><li><strong>Default</strong>: <code>'stable'</code></ul><p>If you decide to process CSS files, you can configure if class names inside CSS modules should be scoped. You can choose one of the options:<ul><li><code>stable</code>: class names will be generated as <code>_${name}_${hashedFilename}</code>, which means that generated class will stay the same, if CSS content is changed, but will change, if the name of the file is modified, or file is moved to another folder. This setting is useful, if you use snapshot feature.<li><code>scoped</code>: class names will be generated as usual, respecting <code>css.modules.generateScopedName</code> method, if you have one and CSS processing is enabled. By default, filename will be generated as <code>_${name}_${hash}</code>, where hash includes filename and content of the file.<li><code>non-scoped</code>: class names will not be hashed.</ul><blockquote>By default, Vitest exports a proxy, bypassing CSS Modules processing. If you rely on CSS properties on your classes, you have to enable CSS processing using `include` option.</blockquote></section></section><section class="level3"aria-labelledby="maxconcurrency"><h3 id="maxconcurrency">maxConcurrency</h3><ul><li><strong>Type</strong>: <code>number</code><li><strong>Default</strong>: <code>5</code><li><strong>CLI</strong>: <code>--max-concurrency=10</code>, <code>--maxConcurrency=10</code></ul><p>A number of tests that are allowed to run at the same time marked with <code>test.concurrent</code>.<p>Test above this limit will be queued to run when available slot appears.</section><section class="level3"aria-labelledby="cache"><h3 id="cache">cache<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type</strong>: <code>false</code><li><strong>CLI</strong>: <code>--no-cache</code>, <code>--cache=false</code></ul><p>Use this option if you want to disable the cache feature. At the moment Vitest stores cache for test results to run the longer and failed tests first.<p>The cache directory is controlled by the Vite's <a href="https://vitejs.dev/config/shared-options.html#cachedir"><code>cacheDir</code></a> option:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cacheDir<span class="token operator">:</span> <span class="token string">'custom-folder/.vitest'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>You can limit the directory only for Vitest by using <code>process.env.VITEST</code>:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cacheDir<span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">VITEST</span> <span class="token operator">?</span> <span class="token string">'custom-folder/.vitest'</span> <span class="token operator">:</span> <span class="token keyword nil">undefined</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level3"aria-labelledby="sequence"><h3 id="sequence">sequence</h3><ul><li><strong>Type</strong>: <code>{ sequencer?, shuffle?, seed?, hooks?, setupFiles? }</code></ul><p>Options for how tests should be sorted.<p>You can provide sequence options to CLI with dot notation:<pre class="language-sh"><code class="language-sh">npx vitest --sequence.shuffle --sequence.seed=1000</code></pre><section class="level4"aria-labelledby="sequencesequencer"><h4 id="sequencesequencer">sequence.sequencer<nonprojectoption></nonprojectoption></h4><ul><li><strong>Type</strong>: <code>TestSequencerConstructor</code><li><strong>Default</strong>: <code>BaseSequencer</code></ul><p>A custom class that defines methods for sharding and sorting. You can extend <code>BaseSequencer</code> from <code>vitest/node</code>, if you only need to redefine one of the <code>sort</code> and <code>shard</code> methods, but both should exist.<p>Sharding is happening before sorting, and only if <code>--shard</code> option is provided.</section><section class="level4"aria-labelledby="sequenceshuffle"><h4 id="sequenceshuffle">sequence.shuffle</h4><ul><li><strong>Type</strong>: <code>boolean | { files?, tests? }</code><li><strong>Default</strong>: <code>false</code><li><strong>CLI</strong>: <code>--sequence.shuffle</code>, <code>--sequence.shuffle=false</code></ul><p>If you want files and tests to run randomly, you can enable it with this option, or CLI argument <a href="/guide/cli"><code>--sequence.shuffle</code></a>.<p>Vitest usually uses cache to sort tests, so long running tests start earlier - this makes tests run faster. If your files and tests will run in random order you will lose this performance improvement, but it may be useful to track tests that accidentally depend on another run previously.</section><section class="level4"aria-labelledby="sequence-shuffle-files"><h4 id="sequence-shuffle-files">sequence.shuffle.files</h4><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code><li><strong>CLI</strong>: <code>--sequence.shuffle.files</code>, <code>--sequence.shuffle.files=false</code></ul><p>Whether to randomize files, be aware that long running tests will not start earlier if you enable this option.</section><section class="level4"aria-labelledby="sequence-shuffle-tests"><h4 id="sequence-shuffle-tests">sequence.shuffle.tests</h4><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code><li><strong>CLI</strong>: <code>--sequence.shuffle.tests</code>, <code>--sequence.shuffle.tests=false</code></ul><p>Whether to randomize tests.</section><section class="level4"aria-labelledby="sequence-concurrent"><h4 id="sequence-concurrent">sequence.concurrent</h4><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code><li><strong>CLI</strong>: <code>--sequence.concurrent</code>, <code>--sequence.concurrent=false</code></ul><p>If you want tests to run in parallel, you can enable it with this option, or CLI argument <a href="/guide/cli"><code>--sequence.concurrent</code></a>.</section><section class="level4"aria-labelledby="sequenceseed"><h4 id="sequenceseed">sequence.seed<nonprojectoption></nonprojectoption></h4><ul><li><strong>Type</strong>: <code>number</code><li><strong>Default</strong>: <code>Date.now()</code><li><strong>CLI</strong>: <code>--sequence.seed=1000</code></ul><p>Sets the randomization seed, if tests are running in random order.</section><section class="level4"aria-labelledby="sequencehooks"><h4 id="sequencehooks">sequence.hooks</h4><ul><li><strong>Type</strong>: <code>'stack' | 'list' | 'parallel'</code><li><strong>Default</strong>: <code>'parallel'</code><li><strong>CLI</strong>: <code>--sequence.hooks=&#x3C;value></code></ul><p>Changes the order in which hooks are executed.<ul><li><code>stack</code> will order "after" hooks in reverse order, "before" hooks will run in the order they were defined<li><code>list</code> will order all hooks in the order they are defined<li><code>parallel</code> will run hooks in a single group in parallel (hooks in parent suites will still run before the current suite's hooks)</ul><blockquote>This option doesn't affect [`onTestFinished`](../api.html#ontestfinished). It is always called in reverse order.</blockquote></section><section class="level4"aria-labelledby="sequence-setupfiles"><h4 id="sequence-setupfiles">sequence.setupFiles</h4><ul><li><strong>Type</strong>: <code>'list' | 'parallel'</code><li><strong>Default</strong>: <code>'parallel'</code><li><strong>CLI</strong>: <code>--sequence.setupFiles=&#x3C;value></code></ul><p>Changes the order in which setup files are executed.<ul><li><code>list</code> will run setup files in the order they are defined<li><code>parallel</code> will run setup files in parallel</ul></section></section><section class="level3"aria-labelledby="typecheck"><h3 id="typecheck">typecheck</h3><p>Options for configuring <a href="/guide/testing-types">typechecking</a> test environment.<section class="level4"aria-labelledby="typecheck-enabled"><h4 id="typecheck-enabled">typecheck.enabled</h4><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code><li><strong>CLI</strong>: <code>--typecheck</code>, <code>--typecheck.enabled</code></ul><p>Enable typechecking alongside your regular tests.</section><section class="level4"aria-labelledby="typecheck-only"><h4 id="typecheck-only">typecheck.only</h4><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code><li><strong>CLI</strong>: <code>--typecheck.only</code></ul><p>Run only typecheck tests, when typechecking is enabled. When using CLI, this option will automatically enable typechecking.</section><section class="level4"aria-labelledby="typecheckchecker"><h4 id="typecheckchecker">typecheck.checker</h4><ul><li><strong>Type</strong>: <code>'tsc' | 'vue-tsc' | string</code><li><strong>Default</strong>: <code>tsc</code></ul><p>What tools to use for type checking. Vitest will spawn a process with certain parameters for easier parsing, depending on the type. Checker should implement the same output format as <code>tsc</code>.<p>You need to have a package installed to use typechecker:<ul><li><code>tsc</code> requires <code>typescript</code> package<li><code>vue-tsc</code> requires <code>vue-tsc</code> package</ul><p>You can also pass down a path to custom binary or command name that produces the same output as <code>tsc --noEmit --pretty false</code>.</section><section class="level4"aria-labelledby="typecheckinclude"><h4 id="typecheckinclude">typecheck.include</h4><ul><li><strong>Type</strong>: <code>string[]</code><li><strong>Default</strong>: <code>['**/*.{test,spec}-d.?(c|m)[jt]s?(x)']</code></ul><p>Glob pattern for files that should be treated as test files</section><section class="level4"aria-labelledby="typecheckexclude"><h4 id="typecheckexclude">typecheck.exclude</h4><ul><li><strong>Type</strong>: <code>string[]</code><li><strong>Default</strong>: <code>['**/node_modules/**', '**/dist/**', '**/cypress/**', '**/.{idea,git,cache,output,temp}/**']</code></ul><p>Glob pattern for files that should not be treated as test files</section><section class="level4"aria-labelledby="typecheckallowjs"><h4 id="typecheckallowjs">typecheck.allowJs</h4><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code></ul><p>Check JS files that have <code>@ts-check</code> comment. If you have it enabled in tsconfig, this will not overwrite it.</section><section class="level4"aria-labelledby="typecheckignoresourceerrors"><h4 id="typecheckignoresourceerrors">typecheck.ignoreSourceErrors</h4><ul><li><strong>Type</strong>: <code>boolean</code><li><strong>Default</strong>: <code>false</code></ul><p>Do not fail, if Vitest found errors outside the test files. This will not show you non-test errors at all.<p>By default, if Vitest finds source error, it will fail test suite.</section><section class="level4"aria-labelledby="typechecktsconfig"><h4 id="typechecktsconfig">typecheck.tsconfig</h4><ul><li><strong>Type</strong>: <code>string</code><li><strong>Default</strong>: <em>tries to find closest tsconfig.json</em></ul><p>Path to custom tsconfig, relative to the project root.</section></section><section class="level3"aria-labelledby="slowtestthreshold"><h3 id="slowtestthreshold">slowTestThreshold<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type</strong>: <code>number</code><li><strong>Default</strong>: <code>300</code><li><strong>CLI</strong>: <code>--slow-test-threshold=&#x3C;number></code>, <code>--slowTestThreshold=&#x3C;number></code></ul><p>The number of milliseconds after which a test is considered slow and reported as such in the results.</section><section class="level3"aria-labelledby="chaiconfig"><h3 id="chaiconfig">chaiConfig</h3><ul><li><strong>Type:</strong> <code>{ includeStack?, showDiff?, truncateThreshold? }</code><li><strong>Default:</strong> <code>{ includeStack: false, showDiff: true, truncateThreshold: 40 }</code></ul><p>Equivalent to <a href="https://github.com/chaijs/chai/blob/4.x.x/lib/chai/config.js">Chai config</a>.<section class="level4"aria-labelledby="chaiconfigincludestack"><h4 id="chaiconfigincludestack">chaiConfig.includeStack</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Influences whether stack trace is included in Assertion error message. Default of false suppresses stack trace in the error message.</section><section class="level4"aria-labelledby="chaiconfigshowdiff"><h4 id="chaiconfigshowdiff">chaiConfig.showDiff</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code></ul><p>Influences whether or not the <code>showDiff</code> flag should be included in the thrown AssertionErrors. <code>false</code> will always be <code>false</code>; <code>true</code> will be true when the assertion has requested a diff to be shown.</section><section class="level4"aria-labelledby="chaiconfigtruncatethreshold"><h4 id="chaiconfigtruncatethreshold">chaiConfig.truncateThreshold</h4><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>40</code></ul><p>Sets length threshold for actual and expected values in assertion errors. If this threshold is exceeded, for example for large data structures, the value is replaced with something like <code>[ Array(3) ]</code> or <code>{ Object (prop1, prop2) }</code>. Set it to <code>0</code> if you want to disable truncating altogether.<p>This config option affects truncating values in <code>test.each</code> titles and inside the assertion error message.</section></section><section class="level3"aria-labelledby="bail"><h3 id="bail">bail</h3><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>0</code><li><strong>CLI</strong>: <code>--bail=&#x3C;value></code></ul><p>Stop test execution when given number of tests have failed.<p>By default Vitest will run all of your test cases even if some of them fail. This may not be desired for CI builds where you are only interested in 100% successful builds and would like to stop test execution as early as possible when test failures occur. The <code>bail</code> option can be used to speed up CI runs by preventing it from running more tests when failures have occurred.</section><section class="level3"aria-labelledby="retry"><h3 id="retry">retry</h3><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>0</code><li><strong>CLI:</strong> <code>--retry=&#x3C;value></code></ul><p>Retry the test specific number of times if it fails.</section><section class="level3"aria-labelledby="onconsolelog"><h3 id="onconsolelog">onConsoleLog<nonprojectoption></nonprojectoption></h3><ul><li><strong>Type</strong>: <code>(log: string, type: 'stdout' | 'stderr') => boolean | void</code></ul><p>Custom handler for <code>console.log</code> in tests. If you return <code>false</code>, Vitest will not print the log to the console.<p>Can be useful for filtering out logs from third-party libraries.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">onConsoleLog</span><span class="token punctuation">(</span>log<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'stdout'</span> <span class="token operator">|</span> <span class="token string">'stderr'</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>log <span class="token operator">===</span> <span class="token string">'message from third party library'</span> <span class="token operator">&#x26;&#x26;</span> type <span class="token operator">===</span> <span class="token string">'stdout'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level3"aria-labelledby="onstacktrace-onstacktrace"><h3 id="onstacktrace-onstacktrace">onStackTrace<nonprojectoption>{#onstacktrace}</nonprojectoption></h3><ul><li><strong>Type</strong>: <code>(error: Error, frame: ParsedStack) => boolean | void</code></ul><p>Apply a filtering function to each frame of each stack trace when handling errors. The first argument, <code>error</code>, is an object with the same properties as a standard <code>Error</code>, but it is not an actual instance.<p>Can be useful for filtering out stack trace frames from third-party libraries.<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">ParsedStack</span> <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">'vitest'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vitest/config'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">onStackTrace</span><span class="token punctuation">(</span>error<span class="token operator">:</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> file <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token maybe-class-name">ParsedStack</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
      <span class="token comment">// If we've encountered a ReferenceError, show the whole stack.</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> <span class="token string">'ReferenceError'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// Reject all frames from third party libraries.</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span><span class="token string">'node_modules'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></section><section class="level3"aria-labelledby="diff"><h3 id="diff">diff</h3><ul><li><strong>Type:</strong> <code>string</code><li><strong>CLI:</strong> <code>--diff=&#x3C;value></code></ul><p>Path to a diff config that will be used to generate diff interface. Useful if you want to customize diff display.</section>code-group ```ts [vitest.diff.ts] import type { DiffOptions } from 'vitest' import c from 'tinyrainbow'<p>export default { aIndicator: c.bold('--'), bIndicator: c.bold('++'), omitAnnotationLines: true, } satisfies DiffOptions<pre class="language-text"><code class="language-text">
```ts [vitest.config.js]
import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    diff: './vitest.diff.ts'
  }
})</code></pre><section class="level4"aria-labelledby="difftruncatethreshold"><h4 id="difftruncatethreshold">diff.truncateThreshold</h4><ul><li><strong>Type</strong>: <code>number</code><li><strong>Default</strong>: <code>0</code></ul><p>The maximum length of diff result to be displayed. Diffs above this threshold will be truncated. Truncation won't take effect with default value 0.</section><section class="level4"aria-labelledby="difftruncateannotation"><h4 id="difftruncateannotation">diff.truncateAnnotation</h4><ul><li><strong>Type</strong>: <code>string</code><li><strong>Default</strong>: <code>'... Diff result is truncated'</code></ul><p>Annotation that is output at the end of diff result if it's truncated.</section><section class="level4"aria-labelledby="difftruncateannotationcolor"><h4 id="difftruncateannotationcolor">diff.truncateAnnotationColor</h4><ul><li><strong>Type</strong>: <code>DiffOptionsColor = (arg: string) => string</code><li><strong>Default</strong>: <code>noColor = (string: string): string => string</code></ul><p>Color of truncate annotation, default is output with no color.</section><section class="level3"aria-labelledby="faketimers"><h3 id="faketimers">fakeTimers</h3><ul><li><strong>Type:</strong> <code>FakeTimerInstallOpts</code></ul><p>Options that Vitest will pass down to <a href="https://www.npmjs.com/package/@sinonjs/fake-timers"><code>@sinon/fake-timers</code></a> when using <a href="/api/vi#vi-usefaketimers"><code>vi.useFakeTimers()</code></a>.<section class="level4"aria-labelledby="faketimersnow"><h4 id="faketimersnow">fakeTimers.now</h4><ul><li><strong>Type:</strong> <code>number | Date</code><li><strong>Default:</strong> <code>Date.now()</code></ul><p>Installs fake timers with the specified Unix epoch.</section><section class="level4"aria-labelledby="faketimerstofake"><h4 id="faketimerstofake">fakeTimers.toFake</h4><ul><li><strong>Type:</strong> <code>('setTimeout' | 'clearTimeout' | 'setImmediate' | 'clearImmediate' | 'setInterval' | 'clearInterval' | 'Date' | 'nextTick' | 'hrtime' | 'requestAnimationFrame' | 'cancelAnimationFrame' | 'requestIdleCallback' | 'cancelIdleCallback' | 'performance' | 'queueMicrotask')[]</code><li><strong>Default:</strong> <code>['setTimeout', 'clearTimeout', 'setImmediate', 'clearImmediate', 'setInterval', 'clearInterval', 'Date']</code></ul><p>An array with names of global methods and APIs to fake.<p>To only mock <code>setTimeout()</code> and <code>nextTick()</code>, specify this property as <code>['setTimeout', 'nextTick']</code>.<p>Mocking <code>nextTick</code> is not supported when running Vitest inside <code>node:child_process</code> by using <code>--pool=forks</code>. NodeJS uses <code>process.nextTick</code> internally in <code>node:child_process</code> and hangs when it is mocked. Mocking <code>nextTick</code> is supported when running Vitest with <code>--pool=threads</code>.</section><section class="level4"aria-labelledby="faketimerslooplimit"><h4 id="faketimerslooplimit">fakeTimers.loopLimit</h4><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>10_000</code></ul><p>The maximum number of timers that will be run when calling <a href="/api/vi#vi-runalltimers"><code>vi.runAllTimers()</code></a>.</section><section class="level4"aria-labelledby="faketimersshouldadvancetime"><h4 id="faketimersshouldadvancetime">fakeTimers.shouldAdvanceTime</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Tells @sinonjs/fake-timers to increment mocked time automatically based on the real system time shift (e.g. the mocked time will be incremented by 20ms for every 20ms change in the real system time).</section><section class="level4"aria-labelledby="faketimersadvancetimedelta"><h4 id="faketimersadvancetimedelta">fakeTimers.advanceTimeDelta</h4><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>20</code></ul><p>Relevant only when using with <code>shouldAdvanceTime: true</code>. increment mocked time by advanceTimeDelta ms every advanceTimeDelta ms change in the real system time.</section><section class="level4"aria-labelledby="faketimersshouldclearnativetimers"><h4 id="faketimersshouldclearnativetimers">fakeTimers.shouldClearNativeTimers</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Tells fake timers to clear "native" (i.e. not fake) timers by delegating to their respective handlers. These are not cleared by default, leading to potentially unexpected behavior if timers existed prior to starting fake timers session.</section></section><section class="level3"aria-labelledby="workspace-workspace"><h3 id="workspace-workspace">workspace<nonprojectoption>{#workspace}</nonprojectoption></h3><ul><li><strong>Type:</strong> <code>string</code><li><strong>CLI:</strong> <code>--workspace=./file.js</code><li><strong>Default:</strong> <code>vitest.{workspace,projects}.{js,ts,json}</code> close to the config file or root</ul><p>Path to a <a href="/guide/workspace">workspace</a> config file relative to <a href="#root">root</a>.</section><section class="level3"aria-labelledby="isolate"><h3 id="isolate">isolate</h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>true</code><li><strong>CLI:</strong> <code>--no-isolate</code>, <code>--isolate=false</code></ul><p>Run tests in an isolated environment. This option has no effect on <code>vmThreads</code> and <code>vmForks</code> pools.<p>Disabling this option might <a href="/guide/improving-performance">improve performance</a> if your code doesn't rely on side effects (which is usually true for projects with <code>node</code> environment).<blockquote>You can disable isolation for specific pools by using [`poolOptions`](#pooloptions) property.</blockquote></section><section class="level3"aria-labelledby="includeTaskLocation"><h3 id="includeTaskLocation">includeTaskLocation</h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Should <code>location</code> property be included when Vitest API receives tasks in <a href="#reporters">reporters</a>. If you have a lot of tests, this might cause a small performance regression.<p>The <code>location</code> property has <code>column</code> and <code>line</code> values that correspond to the <code>test</code> or <code>describe</code> position in the original file.<p>This option will be auto-enabled if you don't disable it explicitly, and you are running Vitest with:<ul><li><a href="/guide/ui">Vitest UI</a><li>or using the <a href="../guide/browser/">Browser Mode</a> without <a href="/guide/browser.html#headless">headless</a> mode<li>or using <a href="/guide/reporters#html-reporter">HTML Reporter</a></ul><blockquote>This option has no effect if you do not use custom code that relies on this.</blockquote></section><section class="level3"aria-labelledby="snapshotEnvironment"><h3 id="snapshotEnvironment">snapshotEnvironment</h3><ul><li><strong>Type:</strong> <code>string</code></ul><p>Path to a custom snapshot environment implementation. This is useful if you are running your tests in an environment that doesn't support Node.js APIs. This option doesn't have any effect on a browser runner.<p>This object should have the shape of <code>SnapshotEnvironment</code> and is used to resolve and read/write snapshot files:<pre class="language-ts"><code class="language-ts"><span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">SnapshotEnvironment</span></span> <span class="token punctuation">{</span>
  <span class="token function-variable function">getVersion</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token builtin">string</span>
  <span class="token function-variable function">getHeader</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token builtin">string</span>
  <span class="token function-variable function">resolvePath</span><span class="token operator">:</span> <span class="token punctuation">(</span>filepath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token operator">></span>
  <span class="token function-variable function">resolveRawPath</span><span class="token operator">:</span> <span class="token punctuation">(</span>testPath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> rawPath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token operator">></span>
  <span class="token function-variable function">saveSnapshotFile</span><span class="token operator">:</span> <span class="token punctuation">(</span>filepath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> snapshot<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span>
  <span class="token function-variable function">readSnapshotFile</span><span class="token operator">:</span> <span class="token punctuation">(</span>filepath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword null nil">null</span><span class="token operator">></span>
  <span class="token function-variable function">removeSnapshotFile</span><span class="token operator">:</span> <span class="token punctuation">(</span>filepath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span>
<span class="token punctuation">}</span></code></pre><p>You can extend default <code>VitestSnapshotEnvironment</code> from <code>vitest/snapshot</code> entry point if you need to overwrite only a part of the API.<blockquote>This is a low-level option and should be used only for advanced cases where you don't have access to default Node.js APIs.<p>If you just need to configure snapshots feature, use <a href="#snapshotformat"><code>snapshotFormat</code></a> or <a href="#resolvesnapshotpath"><code>resolveSnapshotPath</code></a> options.</blockquote></section><section class="level3"aria-labelledby="env"><h3 id="env">env</h3><ul><li><strong>Type:</strong> <code>Partial&#x3C;NodeJS.ProcessEnv></code></ul><p>Environment variables available on <code>process.env</code> and <code>import.meta.env</code> during tests. These variables will not be available in the main process (in <code>globalSetup</code>, for example).</section><section class="level3"aria-labelledby="expect"><h3 id="expect">expect</h3><ul><li><strong>Type:</strong> <code>ExpectOptions</code></ul><section class="level4"aria-labelledby="expectrequireassertions"><h4 id="expectrequireassertions">expect.requireAssertions</h4><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>The same as calling <a href="/api/expect#expect-hasassertions"><code>expect.hasAssertions()</code></a> at the start of every test. This makes sure that no test will pass accidentally.<blockquote>This only works with Vitest's `expect`. If you use `assert` or `.should` assertions, they will not count, and your test will fail due to the lack of expect assertions.<p>You can change the value of this by calling <code>vi.setConfig({ expect: { requireAssertions: false } })</code>. The config will be applied to every subsequent <code>expect</code> call until the <code>vi.resetConfig</code> is called manually.</blockquote></section><section class="level4"aria-labelledby="expectpoll"><h4 id="expectpoll">expect.poll</h4><p>Global configuration options for <a href="/api/expect#poll"><code>expect.poll</code></a>. These are the same options you can pass down to <code>expect.poll(condition, options)</code>.<section class="level5"aria-labelledby="expectpollinterval"><h5 id="expectpollinterval">expect.poll.interval</h5><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>50</code></ul><p>Polling interval in milliseconds</section><section class="level5"aria-labelledby="expectpolltimeout"><h5 id="expectpolltimeout">expect.poll.timeout</h5><ul><li><strong>Type:</strong> <code>number</code><li><strong>Default:</strong> <code>1000</code></ul><p>Polling timeout in milliseconds</section></section></section><section class="level3"aria-labelledby="printconsoletrace"><h3 id="printconsoletrace">printConsoleTrace</h3><ul><li><strong>Type:</strong> <code>boolean</code><li><strong>Default:</strong> <code>false</code></ul><p>Always print console traces when calling any <code>console</code> method. This is useful for debugging. <span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section>